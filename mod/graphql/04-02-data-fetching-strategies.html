<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Estratègies de recuperació de dades</title>

    <link rel="alternate" href="https://campusempresa.com/mod/graphql/04-02-data-fetching-strategies" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/graphql/04-02-data-fetching-strategies" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/graphql/04-02-data-fetching-strategies" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<a href="https://enterprisecampus.net/mod/graphql/04-02-data-fetching-strategies" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/graphql/04-02-data-fetching-strategies" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</span>
			<span class="d-none d-md-inline"><br><cite>Tot el coneixement al teu abast</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					 				<a href="/"><i class="bi bi-house-fill"></i> HOME</a>
											</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-01-connecting-to-database' title="Connexió a una base de dades">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Estratègies de recuperació de dades</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-03-batching-and-caching' title="Agrupació i emmagatzematge en memòria cau">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, explorarem diverses estratègies per recuperar dades en una aplicació GraphQL. La manera com recuperem les dades pot tenir un impacte significatiu en el rendiment i l'eficiència de la nostra aplicació. Aprendrem a utilitzar diferents tècniques per optimitzar la recuperació de dades i assegurar-nos que les nostres consultes siguin eficients.</p>
</div><h1>Objectius d'aprenentatge</h1>
<div class='content'><ul>
<li>Comprendre les diferents estratègies de recuperació de dades.</li>
<li>Aprendre a implementar aquestes estratègies en un servidor GraphQL.</li>
<li>Optimitzar les consultes per millorar el rendiment.</li>
</ul>
</div><h1>Estratègies de recuperació de dades</h1>
<div class='content'></div><h2><ol>
<li>Recuperació directa</li>
</ol></h2>
<div class='content'><p>La recuperació directa és la manera més senzilla de recuperar dades. Consisteix a fer una consulta directa a la base de dades per obtenir les dades necessàries.</p>
<h4>Exemple</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgcmVzb2x2ZXJzID0gewogIFF1ZXJ5OiB7CiAgICB1c2VyOiBhc3luYyAoXywgeyBpZCB9LCB7IGRhdGFTb3VyY2VzIH0pID0+IHsKICAgICAgcmV0dXJuIGRhdGFTb3VyY2VzLnVzZXJBUEkuZ2V0VXNlckJ5SWQoaWQpOwogICAgfSwKICB9LAp9Ow=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const resolvers = {
  Query: {
    user: async (_, { id }, { dataSources }) =&gt; {
      return dataSources.userAPI.getUserById(id);
    },
  },
};</pre></div><div class='content'><p>En aquest exemple, <code>getUserById</code> és una funció que fa una consulta directa a la base de dades per obtenir un usuari pel seu ID.</p>
</div><h2><ol start="2">
<li>Recuperació amb DataLoader</li>
</ol></h2>
<div class='content'><p>DataLoader és una eina que permet agrupar i emmagatzemar en memòria cau les consultes a la base de dades per millorar el rendiment. És especialment útil per evitar la recuperació redundant de dades.</p>
<h4>Exemple</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgRGF0YUxvYWRlciA9IHJlcXVpcmUoJ2RhdGFsb2FkZXInKTsKCmNvbnN0IHVzZXJMb2FkZXIgPSBuZXcgRGF0YUxvYWRlcihhc3luYyAoa2V5cykgPT4gewogIGNvbnN0IHVzZXJzID0gYXdhaXQgZ2V0VXNlcnNCeUlkcyhrZXlzKTsKICByZXR1cm4ga2V5cy5tYXAoKGtleSkgPT4gdXNlcnMuZmluZCgodXNlcikgPT4gdXNlci5pZCA9PT0ga2V5KSk7Cn0pOwoKY29uc3QgcmVzb2x2ZXJzID0gewogIFF1ZXJ5OiB7CiAgICB1c2VyOiBhc3luYyAoXywgeyBpZCB9KSA9PiB7CiAgICAgIHJldHVybiB1c2VyTG9hZGVyLmxvYWQoaWQpOwogICAgfSwKICB9LAp9Ow=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const DataLoader = require('dataloader');

const userLoader = new DataLoader(async (keys) =&gt; {
  const users = await getUsersByIds(keys);
  return keys.map((key) =&gt; users.find((user) =&gt; user.id === key));
});

const resolvers = {
  Query: {
    user: async (_, { id }) =&gt; {
      return userLoader.load(id);
    },
  },
};</pre></div><div class='content'><p>En aquest exemple, <code>userLoader</code> agrupa les consultes per ID i les resol en una sola consulta a la base de dades.</p>
</div><h2><ol start="3">
<li>Recuperació amb paginació</li>
</ol></h2>
<div class='content'><p>La paginació és una tècnica per dividir les dades en pàgines més petites, la qual cosa permet recuperar només una part de les dades en cada consulta. Això és útil per gestionar grans volums de dades.</p>
<h4>Exemple</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgcmVzb2x2ZXJzID0gewogIFF1ZXJ5OiB7CiAgICB1c2VyczogYXN5bmMgKF8sIHsgcGFnZSwgbGltaXQgfSwgeyBkYXRhU291cmNlcyB9KSA9PiB7CiAgICAgIGNvbnN0IG9mZnNldCA9IChwYWdlIC0gMSkgKiBsaW1pdDsKICAgICAgcmV0dXJuIGRhdGFTb3VyY2VzLnVzZXJBUEkuZ2V0VXNlcnMoeyBvZmZzZXQsIGxpbWl0IH0pOwogICAgfSwKICB9LAp9Ow=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const resolvers = {
  Query: {
    users: async (_, { page, limit }, { dataSources }) =&gt; {
      const offset = (page - 1) * limit;
      return dataSources.userAPI.getUsers({ offset, limit });
    },
  },
};</pre></div><div class='content'><p>En aquest exemple, <code>getUsers</code> recupera un conjunt de dades limitat basat en la pàgina i el límit especificats.</p>
</div><h2><ol start="4">
<li>Recuperació amb filtratge</li>
</ol></h2>
<div class='content'><p>El filtratge permet recuperar només les dades que compleixen certs criteris. Això pot reduir la quantitat de dades recuperades i millorar el rendiment.</p>
<h4>Exemple</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgcmVzb2x2ZXJzID0gewogIFF1ZXJ5OiB7CiAgICB1c2VyczogYXN5bmMgKF8sIHsgZmlsdGVyIH0sIHsgZGF0YVNvdXJjZXMgfSkgPT4gewogICAgICByZXR1cm4gZGF0YVNvdXJjZXMudXNlckFQSS5nZXRVc2Vyc0J5RmlsdGVyKGZpbHRlcik7CiAgICB9LAogIH0sCn07"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const resolvers = {
  Query: {
    users: async (_, { filter }, { dataSources }) =&gt; {
      return dataSources.userAPI.getUsersByFilter(filter);
    },
  },
};</pre></div><div class='content'><p>En aquest exemple, <code>getUsersByFilter</code> recupera només els usuaris que compleixen els criteris de filtratge especificats.</p>
</div><h2><ol start="5">
<li>Recuperació amb emmagatzematge en memòria cau</li>
</ol></h2>
<div class='content'><p>L'emmagatzematge en memòria cau permet guardar les dades recuperades per evitar consultes repetides a la base de dades. Això pot millorar significativament el rendiment.</p>
<h4>Exemple</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgY2FjaGUgPSBuZXcgTWFwKCk7Cgpjb25zdCByZXNvbHZlcnMgPSB7CiAgUXVlcnk6IHsKICAgIHVzZXI6IGFzeW5jIChfLCB7IGlkIH0sIHsgZGF0YVNvdXJjZXMgfSkgPT4gewogICAgICBpZiAoY2FjaGUuaGFzKGlkKSkgewogICAgICAgIHJldHVybiBjYWNoZS5nZXQoaWQpOwogICAgICB9CiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBkYXRhU291cmNlcy51c2VyQVBJLmdldFVzZXJCeUlkKGlkKTsKICAgICAgY2FjaGUuc2V0KGlkLCB1c2VyKTsKICAgICAgcmV0dXJuIHVzZXI7CiAgICB9LAogIH0sCn07"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const cache = new Map();

const resolvers = {
  Query: {
    user: async (_, { id }, { dataSources }) =&gt; {
      if (cache.has(id)) {
        return cache.get(id);
      }
      const user = await dataSources.userAPI.getUserById(id);
      cache.set(id, user);
      return user;
    },
  },
};</pre></div><div class='content'><p>En aquest exemple, les dades de l'usuari es guarden en memòria cau després de la primera consulta, evitant consultes repetides a la base de dades.</p>
</div><h1>Exercicis pràctics</h1>
<div class='content'></div><h2>Exercici 1: Implementar DataLoader</h2>
<div class='content'><p>Implementa DataLoader per agrupar les consultes d'usuaris en una sola consulta a la base de dades.</p>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgRGF0YUxvYWRlciA9IHJlcXVpcmUoJ2RhdGFsb2FkZXInKTsKCmNvbnN0IHVzZXJMb2FkZXIgPSBuZXcgRGF0YUxvYWRlcihhc3luYyAoa2V5cykgPT4gewogIGNvbnN0IHVzZXJzID0gYXdhaXQgZ2V0VXNlcnNCeUlkcyhrZXlzKTsKICByZXR1cm4ga2V5cy5tYXAoKGtleSkgPT4gdXNlcnMuZmluZCgodXNlcikgPT4gdXNlci5pZCA9PT0ga2V5KSk7Cn0pOwoKY29uc3QgcmVzb2x2ZXJzID0gewogIFF1ZXJ5OiB7CiAgICB1c2VyOiBhc3luYyAoXywgeyBpZCB9KSA9PiB7CiAgICAgIHJldHVybiB1c2VyTG9hZGVyLmxvYWQoaWQpOwogICAgfSwKICB9LAp9Ow=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const DataLoader = require('dataloader');

const userLoader = new DataLoader(async (keys) =&gt; {
  const users = await getUsersByIds(keys);
  return keys.map((key) =&gt; users.find((user) =&gt; user.id === key));
});

const resolvers = {
  Query: {
    user: async (_, { id }) =&gt; {
      return userLoader.load(id);
    },
  },
};</pre></div><div class='content'></div><h2>Exercici 2: Implementar paginació</h2>
<div class='content'><p>Implementa la paginació per recuperar usuaris en pàgines de 10 elements.</p>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgcmVzb2x2ZXJzID0gewogIFF1ZXJ5OiB7CiAgICB1c2VyczogYXN5bmMgKF8sIHsgcGFnZSA9IDEsIGxpbWl0ID0gMTAgfSwgeyBkYXRhU291cmNlcyB9KSA9PiB7CiAgICAgIGNvbnN0IG9mZnNldCA9IChwYWdlIC0gMSkgKiBsaW1pdDsKICAgICAgcmV0dXJuIGRhdGFTb3VyY2VzLnVzZXJBUEkuZ2V0VXNlcnMoeyBvZmZzZXQsIGxpbWl0IH0pOwogICAgfSwKICB9LAp9Ow=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const resolvers = {
  Query: {
    users: async (_, { page = 1, limit = 10 }, { dataSources }) =&gt; {
      const offset = (page - 1) * limit;
      return dataSources.userAPI.getUsers({ offset, limit });
    },
  },
};</pre></div><div class='content'></div><h1>Resum</h1>
<div class='content'><p>En aquesta secció, hem après diverses estratègies per recuperar dades en una aplicació GraphQL, incloent la recuperació directa, l'ús de DataLoader, la paginació, el filtratge i l'emmagatzematge en memòria cau. Aquestes tècniques ens ajuden a optimitzar les nostres consultes i millorar el rendiment de la nostra aplicació.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-01-connecting-to-database' title="Connexió a una base de dades">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-03-batching-and-caching' title="Agrupació i emmagatzematge en memòria cau">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Publicitat</h1>
<p>Aquest espai està destinat a publicitat.</p>
<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Gràcies per col·laborar!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			









		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
