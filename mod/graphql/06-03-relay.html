<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    <title>Relay</title>

    <link rel="alternate" href="https://campusempresa.com/mod/graphql/06-03-relay" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/graphql/06-03-relay" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/graphql/06-03-relay" hreflang="en" />
    
	<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"> -->
	<link href="/css/bootstrap/bootstrap.css?v=1" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<!-- 
  	<style type="text/css">
  		img {
  			visibility:hidden;
  		}
  	</style>
  	 -->
  	<script>
  		var LANG = "ca";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "graphql";
  		var TEMA_NAME = "06-03";
  		var TYPE = "mod";
  		var PATH = "mod/graphql/06-03-relay";
  		var IS_INDEX = false;
  		var DEVELOP = sessionStorage.getItem("DEVELOP") == "true";
  		  		var ALL_PAGES_MOD = ["01-01-what-is-graphql","01-02-graphql-vs-rest","01-03-setting-up-graphql-server","01-04-graphql-schema-basics","02-01-queries","02-02-mutations","02-03-resolvers","02-04-graphql-types","02-05-graphql-scalars","03-01-interfaces","03-02-unions","03-03-enums","03-04-input-types","03-05-custom-scalars","04-01-connecting-to-database","04-02-data-fetching-strategies","04-03-batching-and-caching","04-04-error-handling","05-01-query-optimization","05-02-rate-limiting","05-03-authentication-authorization","05-04-persisted-queries","06-01-graphiql-playground","06-02-apollo-client","06-03-relay","06-04-graphql-subscriptions","07-01-unit-testing-resolvers","07-02-integration-testing","07-03-continuous-integration","07-04-deploying-graphql-servers","08-01-building-fullstack-application","08-02-graphql-in-microservices","08-03-graphql-federation","08-04-case-studies"];
  		  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
  	<script type="module" src="/js/app.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
</head>

<body class="">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/mod/graphql/06-03-relay" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/graphql/06-03-relay" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Tot el coneixement al teu abast</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my_modules" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Els meus cursos</b></i>
</a>
<a href="/end_modules" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalitzats             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" style="display:none;" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0">
	<div class="col-6 p-0" data-mod="graphql">
		<a  href="#" class="text-secondary d-none" data-read-mod="graphql" data-read-unit="06-03" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar com a llegit
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="graphql" data-unread-unit="06-03" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar com a no llegit
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contingut del curs
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2'>
					<a href='06-02-apollo-client' title="Client Apollo" class="py-2 px-3 btn btn-primary d-none d-md-inline">
				<i class="bi bi-caret-left-square-fill"></i> Anterior 
			</a>
			<a href='06-02-apollo-client' title="Client Apollo" class="py-2 px-3 btn btn-primary d-md-none">
				<i class="bi bi-caret-left-square-fill"></i>
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">Relay</h2>
			</div>
	<div class='col-2 text-end'>
					<a href='06-04-graphql-subscriptions' title="Subscripcions de GraphQL" class="py-2 px-3 d-none d-md-inline btn btn-primary"
				data-read-mod="graphql" data-read-unit="06-03">
				Següent <i class="bi bi-caret-right-square-fill"></i>
			</a>
			<a href='06-04-graphql-subscriptions' title="Subscripcions de GraphQL" class="py-2 px-3 d-md-none btn btn-primary" 
				data-read-mod="graphql" data-read-unit="06-03">
				<i class="bi bi-caret-right-square-fill"></i>
			</a>
			</div>
</div>
<div class='content'><p>Relay és un framework de JavaScript desenvolupat per Facebook que s'utilitza per construir aplicacions React que utilitzen GraphQL. Relay està dissenyat per gestionar de manera eficient les dades de les aplicacions, oferint una experiència d'usuari ràpida i fluida. En aquest tema, explorarem els conceptes bàsics de Relay, com configurar-lo i com utilitzar-lo per fer consultes i mutacions.</p>
</div><h1>Continguts</h1>
<div class='content'><ol>
<li><a href="#introducció-a-relay">Introducció a Relay</a></li>
<li><a href="#configuració-de-relay">Configuració de Relay</a></li>
<li><a href="#consultes-amb-relay">Consultes amb Relay</a></li>
<li><a href="#mutacions-amb-relay">Mutacions amb Relay</a></li>
<li><a href="#fragments-de-relay">Fragments de Relay</a></li>
<li><a href="#gestió-de-dades-amb-relay-store">Gestió de dades amb Relay Store</a></li>
<li><a href="#exercicis-pràctics">Exercicis pràctics</a></li>
</ol>
</div><h1>Introducció a Relay</h1>
<div class='content'><p>Relay és un framework que facilita la gestió de dades en aplicacions React utilitzant GraphQL. Algunes de les característiques clau de Relay són:</p>
<ul>
<li><strong>Declaratiu</strong>: Defineixes les dades que necessita cada component de manera declarativa.</li>
<li><strong>Eficiència</strong>: Optimitza les consultes per minimitzar la quantitat de dades transferides.</li>
<li><strong>Consistència</strong>: Manté la consistència de les dades a través de la Relay Store.</li>
</ul>
</div><h1>Configuració de Relay</h1>
<div class='content'><p>Per començar a utilitzar Relay en una aplicació React, necessitem configurar-lo. A continuació es mostren els passos bàsics per configurar Relay:</p>
<ol>
<li>
<p><strong>Instal·lació de dependències</strong>:</p>
<pre><code class="language-bash">npm install react-relay relay-runtime graphql
</code></pre>
</li>
<li>
<p><strong>Configuració de l'entorn de compilació</strong>:</p>
<p>Relay necessita un entorn de compilació per processar les consultes GraphQL. Això es fa mitjançant <code>relay-compiler</code>.</p>
<pre><code class="language-bash">npm install --save-dev relay-compiler babel-plugin-relay
</code></pre>
<p>Afegeix el següent a la configuració de Babel (<code>.babelrc</code>):</p>
<pre><code class="language-json">{
  &quot;plugins&quot;: [&quot;relay&quot;]
}
</code></pre>
</li>
<li>
<p><strong>Configuració del Relay Environment</strong>:</p>
<p>Crea un fitxer <code>RelayEnvironment.js</code> per configurar l'entorn de Relay.</p>
<pre><code class="language-javascript">import { Environment, Network, RecordSource, Store } from 'relay-runtime';

function fetchQuery(operation, variables) {
  return fetch('/graphql', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      query: operation.text,
      variables,
    }),
  }).then(response =&gt; response.json());
}

const environment = new Environment({
  network: Network.create(fetchQuery),
  store: new Store(new RecordSource()),
});

export default environment;
</code></pre>
</li>
<li>
<p><strong>Integració amb React</strong>:</p>
<p>Utilitza el <code>RelayEnvironment</code> en la teva aplicació React.</p>
<pre><code class="language-javascript">import React from 'react';
import ReactDOM from 'react-dom';
import { RelayEnvironmentProvider } from 'react-relay/hooks';
import environment from './RelayEnvironment';
import App from './App';

ReactDOM.render(
  &lt;RelayEnvironmentProvider environment={environment}&gt;
    &lt;App /&gt;
  &lt;/RelayEnvironmentProvider&gt;,
  document.getElementById('root')
);
</code></pre>
</li>
</ol>
</div><h1>Consultes amb Relay</h1>
<div class='content'><p>Relay utilitza el concepte de fragments per definir les dades que necessita cada component. A continuació es mostra un exemple de com fer una consulta amb Relay:</p>
<ol>
<li>
<p><strong>Definició del fragment</strong>:</p>
<pre><code class="language-javascript">import { graphql } from 'react-relay';

const userFragment = graphql`
  fragment UserFragment on User {
    id
    name
    email
  }
`;
</code></pre>
</li>
<li>
<p><strong>Utilització del fragment en un component</strong>:</p>
<pre><code class="language-javascript">import React from 'react';
import { useFragment } from 'react-relay/hooks';
import userFragment from './UserFragment';

function UserComponent(props) {
  const data = useFragment(userFragment, props.user);

  return (
    &lt;div&gt;
      &lt;h1&gt;{data.name}&lt;/h1&gt;
      &lt;p&gt;{data.email}&lt;/p&gt;
    &lt;/div&gt;
  );
}

export default UserComponent;
</code></pre>
</li>
</ol>
</div><h1>Mutacions amb Relay</h1>
<div class='content'><p>Les mutacions en Relay es defineixen de manera similar a les consultes. A continuació es mostra un exemple de com fer una mutació amb Relay:</p>
<ol>
<li>
<p><strong>Definició de la mutació</strong>:</p>
<pre><code class="language-javascript">import { graphql, commitMutation } from 'react-relay';
import environment from './RelayEnvironment';

const mutation = graphql`
  mutation AddUserMutation($input: AddUserInput!) {
    addUser(input: $input) {
      user {
        id
        name
        email
      }
    }
  }
`;

function addUser(input) {
  return commitMutation(environment, {
    mutation,
    variables: { input },
    onCompleted: (response, errors) =&gt; {
      console.log('Response received from server.');
    },
    onError: err =&gt; console.error(err),
  });
}

export default addUser;
</code></pre>
</li>
<li>
<p><strong>Utilització de la mutació en un component</strong>:</p>
<pre><code class="language-javascript">import React, { useState } from 'react';
import addUser from './AddUserMutation';

function AddUserComponent() {
  const [name, setName] = useState('');
  const [email, setEmail] = useState('');

  const handleSubmit = (e) =&gt; {
    e.preventDefault();
    addUser({ name, email });
  };

  return (
    &lt;form onSubmit={handleSubmit}&gt;
      &lt;input
        type=&quot;text&quot;
        value={name}
        onChange={(e) =&gt; setName(e.target.value)}
        placeholder=&quot;Name&quot;
      /&gt;
      &lt;input
        type=&quot;email&quot;
        value={email}
        onChange={(e) =&gt; setEmail(e.target.value)}
        placeholder=&quot;Email&quot;
      /&gt;
      &lt;button type=&quot;submit&quot;&gt;Add User&lt;/button&gt;
    &lt;/form&gt;
  );
}

export default AddUserComponent;
</code></pre>
</li>
</ol>
</div><h1>Fragments de Relay</h1>
<div class='content'><p>Els fragments són una part essencial de Relay, ja que permeten definir les dades que necessita cada component de manera modular. Això facilita la reutilització i la composició de components.</p>
</div><h2>Exemple de fragment</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHsgZ3JhcGhxbCB9IGZyb20gJ3JlYWN0LXJlbGF5JzsKCmNvbnN0IHVzZXJGcmFnbWVudCA9IGdyYXBocWxgCiAgZnJhZ21lbnQgVXNlckZyYWdtZW50IG9uIFVzZXIgewogICAgaWQKICAgIG5hbWUKICAgIGVtYWlsCiAgfQpgOwoKZXhwb3J0IGRlZmF1bHQgdXNlckZyYWdtZW50Ow=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import { graphql } from 'react-relay';

const userFragment = graphql`
  fragment UserFragment on User {
    id
    name
    email
  }
`;

export default userFragment;</pre></div><div class='content'></div><h1>Gestió de dades amb Relay Store</h1>
<div class='content'><p>Relay Store és el lloc on Relay emmagatzema les dades recuperades de les consultes GraphQL. Això permet a Relay mantenir la consistència de les dades i optimitzar les consultes.</p>
</div><h2>Exemple d'actualització de la Relay Store</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHsgY29tbWl0TXV0YXRpb24sIGdyYXBocWwgfSBmcm9tICdyZWFjdC1yZWxheSc7CmltcG9ydCBlbnZpcm9ubWVudCBmcm9tICcuL1JlbGF5RW52aXJvbm1lbnQnOwoKY29uc3QgbXV0YXRpb24gPSBncmFwaHFsYAogIG11dGF0aW9uIFVwZGF0ZVVzZXJNdXRhdGlvbigkaW5wdXQ6IFVwZGF0ZVVzZXJJbnB1dCEpIHsKICAgIHVwZGF0ZVVzZXIoaW5wdXQ6ICRpbnB1dCkgewogICAgICB1c2VyIHsKICAgICAgICBpZAogICAgICAgIG5hbWUKICAgICAgICBlbWFpbAogICAgICB9CiAgICB9CiAgfQpgOwoKZnVuY3Rpb24gdXBkYXRlVXNlcihpbnB1dCkgewogIHJldHVybiBjb21taXRNdXRhdGlvbihlbnZpcm9ubWVudCwgewogICAgbXV0YXRpb24sCiAgICB2YXJpYWJsZXM6IHsgaW5wdXQgfSwKICAgIHVwZGF0ZXI6IChzdG9yZSkgPT4gewogICAgICBjb25zdCBwYXlsb2FkID0gc3RvcmUuZ2V0Um9vdEZpZWxkKCd1cGRhdGVVc2VyJyk7CiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0gcGF5bG9hZC5nZXRMaW5rZWRSZWNvcmQoJ3VzZXInKTsKICAgICAgY29uc3QgdXNlcklkID0gdXBkYXRlZFVzZXIuZ2V0VmFsdWUoJ2lkJyk7CiAgICAgIGNvbnN0IHVzZXJSZWNvcmQgPSBzdG9yZS5nZXQodXNlcklkKTsKICAgICAgdXNlclJlY29yZC5zZXRWYWx1ZSh1cGRhdGVkVXNlci5nZXRWYWx1ZSgnbmFtZScpLCAnbmFtZScpOwogICAgICB1c2VyUmVjb3JkLnNldFZhbHVlKHVwZGF0ZWRVc2VyLmdldFZhbHVlKCdlbWFpbCcpLCAnZW1haWwnKTsKICAgIH0sCiAgICBvbkNvbXBsZXRlZDogKHJlc3BvbnNlLCBlcnJvcnMpID0+IHsKICAgICAgY29uc29sZS5sb2coJ1Jlc3BvbnNlIHJlY2VpdmVkIGZyb20gc2VydmVyLicpOwogICAgfSwKICAgIG9uRXJyb3I6IGVyciA9PiBjb25zb2xlLmVycm9yKGVyciksCiAgfSk7Cn0KCmV4cG9ydCBkZWZhdWx0IHVwZGF0ZVVzZXI7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import { commitMutation, graphql } from 'react-relay';
import environment from './RelayEnvironment';

const mutation = graphql`
  mutation UpdateUserMutation($input: UpdateUserInput!) {
    updateUser(input: $input) {
      user {
        id
        name
        email
      }
    }
  }
`;

function updateUser(input) {
  return commitMutation(environment, {
    mutation,
    variables: { input },
    updater: (store) =&gt; {
      const payload = store.getRootField('updateUser');
      const updatedUser = payload.getLinkedRecord('user');
      const userId = updatedUser.getValue('id');
      const userRecord = store.get(userId);
      userRecord.setValue(updatedUser.getValue('name'), 'name');
      userRecord.setValue(updatedUser.getValue('email'), 'email');
    },
    onCompleted: (response, errors) =&gt; {
      console.log('Response received from server.');
    },
    onError: err =&gt; console.error(err),
  });
}

export default updateUser;</pre></div><div class='content'></div><h1>Exercicis pràctics</h1>
<div class='content'></div><h2>Exercici 1: Configuració de Relay</h2>
<div class='content'><ol>
<li>Configura un nou projecte React amb Relay.</li>
<li>Crea un <code>RelayEnvironment</code> i integra'l amb la teva aplicació React.</li>
</ol>
</div><h2>Exercici 2: Consultes amb Relay</h2>
<div class='content'><ol>
<li>Defineix un fragment per a un tipus <code>User</code>.</li>
<li>Utilitza el fragment en un component per mostrar les dades d'un usuari.</li>
</ol>
</div><h2>Exercici 3: Mutacions amb Relay</h2>
<div class='content'><ol>
<li>Defineix una mutació per afegir un nou usuari.</li>
<li>Crea un formulari en un component React per afegir un nou usuari utilitzant la mutació.</li>
</ol>
</div><h2>Solucions</h2>
<div class='content'><h4>Solució a l'Exercici 1</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gUmVsYXlFbnZpcm9ubWVudC5qcwppbXBvcnQgeyBFbnZpcm9ubWVudCwgTmV0d29yaywgUmVjb3JkU291cmNlLCBTdG9yZSB9IGZyb20gJ3JlbGF5LXJ1bnRpbWUnOwoKZnVuY3Rpb24gZmV0Y2hRdWVyeShvcGVyYXRpb24sIHZhcmlhYmxlcykgewogIHJldHVybiBmZXRjaCgnL2dyYXBocWwnLCB7CiAgICBtZXRob2Q6ICdQT1NUJywKICAgIGhlYWRlcnM6IHsKICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgIH0sCiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgIHF1ZXJ5OiBvcGVyYXRpb24udGV4dCwKICAgICAgdmFyaWFibGVzLAogICAgfSksCiAgfSkudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpOwp9Cgpjb25zdCBlbnZpcm9ubWVudCA9IG5ldyBFbnZpcm9ubWVudCh7CiAgbmV0d29yazogTmV0d29yay5jcmVhdGUoZmV0Y2hRdWVyeSksCiAgc3RvcmU6IG5ldyBTdG9yZShuZXcgUmVjb3JkU291cmNlKCkpLAp9KTsKCmV4cG9ydCBkZWZhdWx0IGVudmlyb25tZW50Ow=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// RelayEnvironment.js
import { Environment, Network, RecordSource, Store } from 'relay-runtime';

function fetchQuery(operation, variables) {
  return fetch('/graphql', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      query: operation.text,
      variables,
    }),
  }).then(response =&gt; response.json());
}

const environment = new Environment({
  network: Network.create(fetchQuery),
  store: new Store(new RecordSource()),
});

export default environment;</pre></div><div class='content'><h4>Solució a l'Exercici 2</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gVXNlckZyYWdtZW50LmpzCmltcG9ydCB7IGdyYXBocWwgfSBmcm9tICdyZWFjdC1yZWxheSc7Cgpjb25zdCB1c2VyRnJhZ21lbnQgPSBncmFwaHFsYAogIGZyYWdtZW50IFVzZXJGcmFnbWVudCBvbiBVc2VyIHsKICAgIGlkCiAgICBuYW1lCiAgICBlbWFpbAogIH0KYDsKCmV4cG9ydCBkZWZhdWx0IHVzZXJGcmFnbWVudDsKCi8vIFVzZXJDb21wb25lbnQuanMKaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHsgdXNlRnJhZ21lbnQgfSBmcm9tICdyZWFjdC1yZWxheS9ob29rcyc7CmltcG9ydCB1c2VyRnJhZ21lbnQgZnJvbSAnLi9Vc2VyRnJhZ21lbnQnOwoKZnVuY3Rpb24gVXNlckNvbXBvbmVudChwcm9wcykgewogIGNvbnN0IGRhdGEgPSB1c2VGcmFnbWVudCh1c2VyRnJhZ21lbnQsIHByb3BzLnVzZXIpOwoKICByZXR1cm4gKAogICAgPGRpdj4KICAgICAgPGgxPntkYXRhLm5hbWV9PC9oMT4KICAgICAgPHA+e2RhdGEuZW1haWx9PC9wPgogICAgPC9kaXY+CiAgKTsKfQoKZXhwb3J0IGRlZmF1bHQgVXNlckNvbXBvbmVudDs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// UserFragment.js
import { graphql } from 'react-relay';

const userFragment = graphql`
  fragment UserFragment on User {
    id
    name
    email
  }
`;

export default userFragment;

// UserComponent.js
import React from 'react';
import { useFragment } from 'react-relay/hooks';
import userFragment from './UserFragment';

function UserComponent(props) {
  const data = useFragment(userFragment, props.user);

  return (
    &lt;div&gt;
      &lt;h1&gt;{data.name}&lt;/h1&gt;
      &lt;p&gt;{data.email}&lt;/p&gt;
    &lt;/div&gt;
  );
}

export default UserComponent;</pre></div><div class='content'><h4>Solució a l'Exercici 3</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQWRkVXNlck11dGF0aW9uLmpzCmltcG9ydCB7IGdyYXBocWwsIGNvbW1pdE11dGF0aW9uIH0gZnJvbSAncmVhY3QtcmVsYXknOwppbXBvcnQgZW52aXJvbm1lbnQgZnJvbSAnLi9SZWxheUVudmlyb25tZW50JzsKCmNvbnN0IG11dGF0aW9uID0gZ3JhcGhxbGAKICBtdXRhdGlvbiBBZGRVc2VyTXV0YXRpb24oJGlucHV0OiBBZGRVc2VySW5wdXQhKSB7CiAgICBhZGRVc2VyKGlucHV0OiAkaW5wdXQpIHsKICAgICAgdXNlciB7CiAgICAgICAgaWQKICAgICAgICBuYW1lCiAgICAgICAgZW1haWwKICAgICAgfQogICAgfQogIH0KYDsKCmZ1bmN0aW9uIGFkZFVzZXIoaW5wdXQpIHsKICByZXR1cm4gY29tbWl0TXV0YXRpb24oZW52aXJvbm1lbnQsIHsKICAgIG11dGF0aW9uLAogICAgdmFyaWFibGVzOiB7IGlucHV0IH0sCiAgICBvbkNvbXBsZXRlZDogKHJlc3BvbnNlLCBlcnJvcnMpID0+IHsKICAgICAgY29uc29sZS5sb2coJ1Jlc3BvbnNlIHJlY2VpdmVkIGZyb20gc2VydmVyLicpOwogICAgfSwKICAgIG9uRXJyb3I6IGVyciA9PiBjb25zb2xlLmVycm9yKGVyciksCiAgfSk7Cn0KCmV4cG9ydCBkZWZhdWx0IGFkZFVzZXI7CgovLyBBZGRVc2VyQ29tcG9uZW50LmpzCmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JzsKaW1wb3J0IGFkZFVzZXIgZnJvbSAnLi9BZGRVc2VyTXV0YXRpb24nOwoKZnVuY3Rpb24gQWRkVXNlckNvbXBvbmVudCgpIHsKICBjb25zdCBbbmFtZSwgc2V0TmFtZV0gPSB1c2VTdGF0ZSgnJyk7CiAgY29uc3QgW2VtYWlsLCBzZXRFbWFpbF0gPSB1c2VTdGF0ZSgnJyk7CgogIGNvbnN0IGhhbmRsZVN1Ym1pdCA9IChlKSA9PiB7CiAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICBhZGRVc2VyKHsgbmFtZSwgZW1haWwgfSk7CiAgfTsKCiAgcmV0dXJuICgKICAgIDxmb3JtIG9uU3VibWl0PXtoYW5kbGVTdWJtaXR9PgogICAgICA8aW5wdXQKICAgICAgICB0eXBlPSJ0ZXh0IgogICAgICAgIHZhbHVlPXtuYW1lfQogICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0TmFtZShlLnRhcmdldC52YWx1ZSl9CiAgICAgICAgcGxhY2Vob2xkZXI9Ik5hbWUiCiAgICAgIC8+CiAgICAgIDxpbnB1dAogICAgICAgIHR5cGU9ImVtYWlsIgogICAgICAgIHZhbHVlPXtlbWFpbH0KICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEVtYWlsKGUudGFyZ2V0LnZhbHVlKX0KICAgICAgICBwbGFjZWhvbGRlcj0iRW1haWwiCiAgICAgIC8+CiAgICAgIDxidXR0b24gdHlwZT0ic3VibWl0Ij5BZGQgVXNlcjwvYnV0dG9uPgogICAgPC9mb3JtPgogICk7Cn0KCmV4cG9ydCBkZWZhdWx0IEFkZFVzZXJDb21wb25lbnQ7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// AddUserMutation.js
import { graphql, commitMutation } from 'react-relay';
import environment from './RelayEnvironment';

const mutation = graphql`
  mutation AddUserMutation($input: AddUserInput!) {
    addUser(input: $input) {
      user {
        id
        name
        email
      }
    }
  }
`;

function addUser(input) {
  return commitMutation(environment, {
    mutation,
    variables: { input },
    onCompleted: (response, errors) =&gt; {
      console.log('Response received from server.');
    },
    onError: err =&gt; console.error(err),
  });
}

export default addUser;

// AddUserComponent.js
import React, { useState } from 'react';
import addUser from './AddUserMutation';

function AddUserComponent() {
  const [name, setName] = useState('');
  const [email, setEmail] = useState('');

  const handleSubmit = (e) =&gt; {
    e.preventDefault();
    addUser({ name, email });
  };

  return (
    &lt;form onSubmit={handleSubmit}&gt;
      &lt;input
        type=&quot;text&quot;
        value={name}
        onChange={(e) =&gt; setName(e.target.value)}
        placeholder=&quot;Name&quot;
      /&gt;
      &lt;input
        type=&quot;email&quot;
        value={email}
        onChange={(e) =&gt; setEmail(e.target.value)}
        placeholder=&quot;Email&quot;
      /&gt;
      &lt;button type=&quot;submit&quot;&gt;Add User&lt;/button&gt;
    &lt;/form&gt;
  );
}

export default AddUserComponent;</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Relay és una eina poderosa per gestionar dades en aplicacions React utilitzant GraphQL. En aquest tema, hem après a configurar Relay, fer consultes i mutacions, utilitzar fragments i gestionar dades amb Relay Store. Amb aquests coneixements, estàs preparat per començar a construir aplicacions React eficients i escalables amb Relay.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-02-apollo-client' title="Client Apollo" class="py-2 px-3 btn btn-primary d-none d-md-inline">
				<i class="bi bi-caret-left-square-fill"></i> Anterior 
			</a>
			<a href='06-02-apollo-client' title="Client Apollo" class="py-2 px-3 btn btn-primary d-md-none">
				<i class="bi bi-caret-left-square-fill"></i>
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-04-graphql-subscriptions' title="Subscripcions de GraphQL" class="py-2 px-3 d-none d-md-inline btn btn-primary"
				data-read-mod="graphql" data-read-unit="06-03">
				Següent <i class="bi bi-caret-right-square-fill"></i>
			</a>
			<a href='06-04-graphql-subscriptions' title="Subscripcions de GraphQL" class="py-2 px-3 d-md-none btn btn-primary" 
				data-read-mod="graphql" data-read-unit="06-03">
				<i class="bi bi-caret-right-square-fill"></i>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

			
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curs de GraphQL</h1>
<h2>Mòdul 1: Introducció a GraphQL</h2>
<ul>
<li><a href="01-01-what-is-graphql">Què és GraphQL?</a></li>
<li><a href="01-02-graphql-vs-rest">GraphQL vs REST</a></li>
<li><a href="01-03-setting-up-graphql-server">Configuració d'un servidor GraphQL</a></li>
<li><a href="01-04-graphql-schema-basics">Conceptes bàsics de l'esquema de GraphQL</a></li>
</ul>
<h2>Mòdul 2: Conceptes bàsics</h2>
<ul>
<li><a href="02-01-queries">Consultes</a></li>
<li><a href="02-02-mutations">Mutacions</a></li>
<li><a href="02-03-resolvers">Resolvers</a></li>
<li><a href="02-04-graphql-types">Tipus de GraphQL</a></li>
<li><a href="02-05-graphql-scalars">Escalars de GraphQL</a></li>
</ul>
<h2>Mòdul 3: Disseny avançat d'esquemes</h2>
<ul>
<li><a href="03-01-interfaces">Interfícies</a></li>
<li><a href="03-02-unions">Unions</a></li>
<li><a href="03-03-enums">Enums</a></li>
<li><a href="03-04-input-types">Tipus d'entrada</a></li>
<li><a href="03-05-custom-scalars">Escalars personalitzats</a></li>
</ul>
<h2>Mòdul 4: Treballant amb dades</h2>
<ul>
<li><a href="04-01-connecting-to-database">Connexió a una base de dades</a></li>
<li><a href="04-02-data-fetching-strategies">Estratègies de recuperació de dades</a></li>
<li><a href="04-03-batching-and-caching">Agrupació i emmagatzematge en memòria cau</a></li>
<li><a href="04-04-error-handling">Gestió d'errors</a></li>
</ul>
<h2>Mòdul 5: Rendiment i seguretat</h2>
<ul>
<li><a href="05-01-query-optimization">Optimització de consultes</a></li>
<li><a href="05-02-rate-limiting">Limitació de velocitat</a></li>
<li><a href="05-03-authentication-authorization">Autenticació i autorització</a></li>
<li><a href="05-04-persisted-queries">Consultes persistents</a></li>
</ul>
<h2>Mòdul 6: Eines i ecosistema</h2>
<ul>
<li><a href="06-01-graphiql-playground">GraphiQL i Playground</a></li>
<li><a href="06-02-apollo-client">Client Apollo</a></li>
<li><a href="06-03-relay">Relay</a></li>
<li><a href="06-04-graphql-subscriptions">Subscripcions de GraphQL</a></li>
</ul>
<h2>Mòdul 7: Proves i desplegament</h2>
<ul>
<li><a href="07-01-unit-testing-resolvers">Proves unitàries de resolvers</a></li>
<li><a href="07-02-integration-testing">Proves d'integració</a></li>
<li><a href="07-03-continuous-integration">Integració contínua</a></li>
<li><a href="07-04-deploying-graphql-servers">Desplegament de servidors GraphQL</a></li>
</ul>
<h2>Mòdul 8: Aplicacions del món real</h2>
<ul>
<li><a href="08-01-building-fullstack-application">Construcció d'una aplicació full-stack</a></li>
<li><a href="08-02-graphql-in-microservices">GraphQL en microserveis</a></li>
<li><a href="08-03-graphql-federation">Federació de GraphQL</a></li>
<li><a href="08-04-case-studies">Estudis de casos</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuari no autentificat</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<p id="loginModalEmail"></p>
            	<div id="mensaje" class="error"></div>
            	<div id="mensaje_info" class="text-success"></div>
            	
				<div class="mt-4 d-none" id="forgotPasswordSection">
					<div class="mb-3">
    <label for="recovery-email" class="form-label">Correu electrònic</label>
    <input type="email" required class="form-control" id="recovery-email" placeholder="Introdueix el teu correu electrònic">
</div>
<button class="btn btn-primary" id="btnRecover">Enviar enllaç de recuperació</button>

				</div>
								
				<div class="mt-4 d-none" id="deleteUserSection">	
					<div class="mb-3 alert alert-danger">
	Atenció! Estàs a punt d'eliminar totes les dades de registre i progrés.<br><b>Aquesta acció no es pot desfer.</b>
</div>
<div class="mb-3">
    <input type="password" required class="form-control" id="delete-user-pwd" placeholder="Introdueix la teva contrasenya">
</div>
<button class="btn btn-primary" id="btnDeleteUser">Eliminar usuari</button>

				</div>
				
				<div class="mt-4 d-none" id="changePassordSection">
					<div class="mb-3 row">
	<div class="col col-12 my-2">
	    <input type="password" required class="form-control" id="change-pwd-actual" placeholder="Introdueix la contrasenya actual">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-1" placeholder="Introdueix la nova contrasenya">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-2" placeholder="Repeteix la nova contrasenya">
	</div>
</div>
<button class="btn btn-primary" id="btnChangePassword">Canviar la contrasenya</button>

				</div>
				
				<div class="mt-4 d-none alert alert-warning" id="verifyPasswordSection">
					<p><b>Falta verificar correu</b></p>
					<a id="btnVerifyEmail" href="#">Enviar enllaç de verificació</a>

				</div>
				
				<div class="mt-4 d-none" id="disconnectUserSection">
					<div class="mb-3">
    <button id="btnDisconnect" class="btn btn-primary">Desconnectar</button>
</div>

<hr>

<div class="mt-3">
    <button class="btn btn-outline-secondary" id="change-password-link">Canviar la contrasenya</button>
</div>

<div class="mt-3">
    <a href="#" id="delete-user-link">Eliminar usuari</a>
</div>

				</div>
            
            	<div class="mt-4 d-none" id="modalTabsSection">
            		<ul class="nav nav-tabs" id="authTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login" type="button" role="tab" aria-controls="login" aria-selected="true">
        	Iniciar sessió
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="register-tab" data-bs-toggle="tab" data-bs-target="#register" type="button" role="tab" aria-controls="register" aria-selected="false">
        	Registrar-se
        </button>
    </li>
</ul>

<div class="tab-content mt-3" id="authTabsContent">
    <div class="tab-pane fade show active" id="login" role="tabpanel" aria-labelledby="login-tab">
    	<div class="mb-3">
    <label for="login-username" class="form-label">Correu electrònic</label>
    <input type="email" required class="form-control" id="login-username" placeholder="Introdueix el teu correu electrònic">
</div>
<div class="mb-3">
    <label for="login-password" class="form-label">Contrasenya</label>
    <input type="password"  required class="form-control" id="login-password" placeholder="Introdueix la teva contrasenya">
</div>
<button class="btn btn-primary" id="btnLogin">Iniciar sessió</button>
<div class="mt-3">
    <a href="#" id="forgot-password-link">Has oblidat la teva contrasenya?</a>
</div>
    </div>

    <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
    	<div class="mb-3">
    <label for="register-email" class="form-label">Correu electrònic</label>
    <input type="email" class="form-control" id="register-email" required placeholder="Introdueix el teu correu electrònic">
</div>

<div class="mb-3">
    <label for="register-password" class="form-label">Contrasenya</label>
    <input type="password" class="form-control"  required id="register-password" placeholder="Introdueix la teva contrasenya">
</div>

<div class="mb-3">
    <label for="register-name" class="form-label">Nom</label>
    <input type="text" class="form-control"  required id="register-name" placeholder="Introdueix el teu nom">
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-conditions-reg">
    <label for="accept-conditions-reg" class="form-check-label">
        He llegit i accepto la <a href="/privacity" target="blank">Política de Privacitat</a> i els <a href="/licence" target="blank">Termes i Condicions d'Ús</a>.
    </label>
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-allow_comunications">
    <label for="accept-allow_comunications" class="form-check-label">
        Vull rebre notícies i actualitzacions sobre els cursos (opcional).
    </label>
</div>

<button id="btnRegister" class="btn btn-primary">Registrar-se</button>
    </div>
</div>
            	</div>
            </div>
        </div>
    </div>
</div>

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
