<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NgRx Effects</title>

    <link rel="alternate" href="https://campusempresa.com/mod/angular2/09-04-ngrx-effects" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/angular2/09-04-ngrx-effects" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/angular2/09-04-ngrx-effects" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/angular2/09-04-ngrx-effects" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/angular2/09-04-ngrx-effects" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='09-03-ngrx-store' title="NgRx Store">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">NgRx Effects</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='10-01-unit-testing' title="Proves unitàries">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>NgRx Effects és una biblioteca que permet gestionar efectes secundaris en aplicacions Angular utilitzant el patró Redux. Els efectes són operacions que es desencadenen en resposta a accions i poden incloure operacions asíncrones com sol·licituds HTTP, accés a l'emmagatzematge local, navegació, etc. NgRx Effects ajuda a mantenir la lògica d'efectes secundaris fora dels reducers, mantenint-los purs i fàcils de provar.</p>
</div><h1>Objectius</h1>
<div class='content'><ul>
<li>Comprendre què són els efectes en NgRx.</li>
<li>Aprendre a crear i gestionar efectes.</li>
<li>Integrar efectes amb el flux d'accions i reducers.</li>
<li>Veure exemples pràctics d'ús d'efectes.</li>
</ul>
</div><h1>Conceptes Clau</h1>
<div class='content'><ol>
<li><strong>Efectes</strong>: Són classes que contenen lògica per gestionar efectes secundaris.</li>
<li><strong>Actions</strong>: Les accions que desencadenen els efectes.</li>
<li><strong>Effects Decorator</strong>: Decorador <code>@Effect</code> per marcar observables com efectes.</li>
<li><strong>Effects Module</strong>: Mòdul que registra els efectes en l'aplicació.</li>
</ol>
</div><h1>Creació d'Efectes</h1>
<div class='content'></div><h2>Instal·lació de NgRx Effects</h2>
<div class='content'><p>Abans de començar, assegura't d'haver instal·lat NgRx Effects en el teu projecte Angular:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluc3RhbGwgQG5ncngvZWZmZWN0cw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm install @ngrx/effects</pre></div><div class='content'></div><h2>Configuració del Mòdul d'Efectes</h2>
<div class='content'><p>Afegeix <code>EffectsModule</code> al mòdul principal de la teva aplicació (<code>app.module.ts</code>):</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHsgRWZmZWN0c01vZHVsZSB9IGZyb20gJ0BuZ3J4L2VmZmVjdHMnOwppbXBvcnQgeyBNeUVmZmVjdHMgfSBmcm9tICcuL2VmZmVjdHMvbXktZWZmZWN0cyc7CgpATmdNb2R1bGUoewogIGltcG9ydHM6IFsKICAgIC8vIGFsdHJlcyBpbXBvcnRzCiAgICBFZmZlY3RzTW9kdWxlLmZvclJvb3QoW015RWZmZWN0c10pCiAgXSwKICAvLyBhbHRyZXMgY29uZmlndXJhY2lvbnMKfSkKZXhwb3J0IGNsYXNzIEFwcE1vZHVsZSB7IH0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import { EffectsModule } from '@ngrx/effects';
import { MyEffects } from './effects/my-effects';

@NgModule({
  imports: [
    // altres imports
    EffectsModule.forRoot([MyEffects])
  ],
  // altres configuracions
})
export class AppModule { }</pre></div><div class='content'></div><h2>Creació d'una Classe d'Efectes</h2>
<div class='content'><p>Crea una classe d'efectes (<code>my-effects.ts</code>) per gestionar els efectes secundaris:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnOwppbXBvcnQgeyBBY3Rpb25zLCBvZlR5cGUsIGNyZWF0ZUVmZmVjdCB9IGZyb20gJ0BuZ3J4L2VmZmVjdHMnOwppbXBvcnQgeyBvZiB9IGZyb20gJ3J4anMnOwppbXBvcnQgeyBjYXRjaEVycm9yLCBtYXAsIG1lcmdlTWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnOwppbXBvcnQgeyBNeVNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9teS1zZXJ2aWNlJzsKaW1wb3J0ICogYXMgTXlBY3Rpb25zIGZyb20gJy4uL2FjdGlvbnMvbXktYWN0aW9ucyc7CgpASW5qZWN0YWJsZSgpCmV4cG9ydCBjbGFzcyBNeUVmZmVjdHMgewoKICBjb25zdHJ1Y3RvcigKICAgIHByaXZhdGUgYWN0aW9ucyQ6IEFjdGlvbnMsCiAgICBwcml2YXRlIG15U2VydmljZTogTXlTZXJ2aWNlCiAgKSB7fQoKICBsb2FkSXRlbXMkID0gY3JlYXRlRWZmZWN0KCgpID0+CiAgICB0aGlzLmFjdGlvbnMkLnBpcGUoCiAgICAgIG9mVHlwZShNeUFjdGlvbnMubG9hZEl0ZW1zKSwKICAgICAgbWVyZ2VNYXAoKCkgPT4gdGhpcy5teVNlcnZpY2UuZ2V0SXRlbXMoKQogICAgICAgIC5waXBlKAogICAgICAgICAgbWFwKGl0ZW1zID0+IE15QWN0aW9ucy5sb2FkSXRlbXNTdWNjZXNzKHsgaXRlbXMgfSkpLAogICAgICAgICAgY2F0Y2hFcnJvcihlcnJvciA9PiBvZihNeUFjdGlvbnMubG9hZEl0ZW1zRmFpbHVyZSh7IGVycm9yIH0pKSkKICAgICAgICApKQogICAgKQogICk7Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import { Injectable } from '@angular/core';
import { Actions, ofType, createEffect } from '@ngrx/effects';
import { of } from 'rxjs';
import { catchError, map, mergeMap } from 'rxjs/operators';
import { MyService } from '../services/my-service';
import * as MyActions from '../actions/my-actions';

@Injectable()
export class MyEffects {

  constructor(
    private actions$: Actions,
    private myService: MyService
  ) {}

  loadItems$ = createEffect(() =&gt;
    this.actions$.pipe(
      ofType(MyActions.loadItems),
      mergeMap(() =&gt; this.myService.getItems()
        .pipe(
          map(items =&gt; MyActions.loadItemsSuccess({ items })),
          catchError(error =&gt; of(MyActions.loadItemsFailure({ error })))
        ))
    )
  );
}</pre></div><div class='content'></div><h2>Explicació del Codi</h2>
<div class='content'><ul>
<li><strong>Actions</strong>: Flux d'accions que es poden escoltar.</li>
<li><strong>ofType</strong>: Filtra les accions per tipus.</li>
<li><strong>createEffect</strong>: Crea un efecte.</li>
<li><strong>mergeMap</strong>: Permet combinar múltiples observables.</li>
<li><strong>map</strong>: Transforma les dades emeses per l'observable.</li>
<li><strong>catchError</strong>: Gestiona errors i retorna una nova acció.</li>
</ul>
</div><h2>Exemple Pràctic</h2>
<div class='content'><p>Suposem que tenim un servei que obté una llista d'articles des d'un servidor:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gbXktc2VydmljZS50cwppbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7CmltcG9ydCB7IEh0dHBDbGllbnQgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7CmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJzsKCkBJbmplY3RhYmxlKHsKICBwcm92aWRlZEluOiAncm9vdCcKfSkKZXhwb3J0IGNsYXNzIE15U2VydmljZSB7CiAgY29uc3RydWN0b3IocHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50KSB7fQoKICBnZXRJdGVtcygpOiBPYnNlcnZhYmxlPEl0ZW1bXT4gewogICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8SXRlbVtdPignaHR0cHM6Ly9hcGkuZXhhbXBsZS5jb20vaXRlbXMnKTsKICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// my-service.ts
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class MyService {
  constructor(private http: HttpClient) {}

  getItems(): Observable&lt;Item[]&gt; {
    return this.http.get&lt;Item[]&gt;('https://api.example.com/items');
  }
}</pre></div><div class='content'><p>I les accions corresponents:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gbXktYWN0aW9ucy50cwppbXBvcnQgeyBjcmVhdGVBY3Rpb24sIHByb3BzIH0gZnJvbSAnQG5ncngvc3RvcmUnOwoKZXhwb3J0IGNvbnN0IGxvYWRJdGVtcyA9IGNyZWF0ZUFjdGlvbignW0l0ZW1zXSBMb2FkIEl0ZW1zJyk7CmV4cG9ydCBjb25zdCBsb2FkSXRlbXNTdWNjZXNzID0gY3JlYXRlQWN0aW9uKCdbSXRlbXNdIExvYWQgSXRlbXMgU3VjY2VzcycsIHByb3BzPHsgaXRlbXM6IEl0ZW1bXSB9PigpKTsKZXhwb3J0IGNvbnN0IGxvYWRJdGVtc0ZhaWx1cmUgPSBjcmVhdGVBY3Rpb24oJ1tJdGVtc10gTG9hZCBJdGVtcyBGYWlsdXJlJywgcHJvcHM8eyBlcnJvcjogYW55IH0+KCkpOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// my-actions.ts
import { createAction, props } from '@ngrx/store';

export const loadItems = createAction('[Items] Load Items');
export const loadItemsSuccess = createAction('[Items] Load Items Success', props&lt;{ items: Item[] }&gt;());
export const loadItemsFailure = createAction('[Items] Load Items Failure', props&lt;{ error: any }&gt;());</pre></div><div class='content'></div><h1>Exercici Pràctic</h1>
<div class='content'></div><h2>Objectiu</h2>
<div class='content'><p>Crear un efecte que carregui una llista d'usuaris des d'un servei i gestioni els casos d'èxit i error.</p>
</div><h2>Passos</h2>
<div class='content'><ol>
<li><strong>Crear el servei</strong> (<code>user.service.ts</code>):</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnOwppbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnOwppbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7CmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi9tb2RlbHMvdXNlci5tb2RlbCc7CgpASW5qZWN0YWJsZSh7CiAgcHJvdmlkZWRJbjogJ3Jvb3QnCn0pCmV4cG9ydCBjbGFzcyBVc2VyU2VydmljZSB7CiAgY29uc3RydWN0b3IocHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50KSB7fQoKICBnZXRVc2VycygpOiBPYnNlcnZhYmxlPFVzZXJbXT4gewogICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8VXNlcltdPignaHR0cHM6Ly9hcGkuZXhhbXBsZS5jb20vdXNlcnMnKTsKICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';
import { User } from '../models/user.model';

@Injectable({
  providedIn: 'root'
})
export class UserService {
  constructor(private http: HttpClient) {}

  getUsers(): Observable&lt;User[]&gt; {
    return this.http.get&lt;User[]&gt;('https://api.example.com/users');
  }
}</pre></div><div class='content'><ol start="2">
<li><strong>Definir les accions</strong> (<code>user.actions.ts</code>):</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHsgY3JlYXRlQWN0aW9uLCBwcm9wcyB9IGZyb20gJ0BuZ3J4L3N0b3JlJzsKaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uL21vZGVscy91c2VyLm1vZGVsJzsKCmV4cG9ydCBjb25zdCBsb2FkVXNlcnMgPSBjcmVhdGVBY3Rpb24oJ1tVc2VyXSBMb2FkIFVzZXJzJyk7CmV4cG9ydCBjb25zdCBsb2FkVXNlcnNTdWNjZXNzID0gY3JlYXRlQWN0aW9uKCdbVXNlcl0gTG9hZCBVc2VycyBTdWNjZXNzJywgcHJvcHM8eyB1c2VyczogVXNlcltdIH0+KCkpOwpleHBvcnQgY29uc3QgbG9hZFVzZXJzRmFpbHVyZSA9IGNyZWF0ZUFjdGlvbignW1VzZXJdIExvYWQgVXNlcnMgRmFpbHVyZScsIHByb3BzPHsgZXJyb3I6IGFueSB9PigpKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import { createAction, props } from '@ngrx/store';
import { User } from '../models/user.model';

export const loadUsers = createAction('[User] Load Users');
export const loadUsersSuccess = createAction('[User] Load Users Success', props&lt;{ users: User[] }&gt;());
export const loadUsersFailure = createAction('[User] Load Users Failure', props&lt;{ error: any }&gt;());</pre></div><div class='content'><ol start="3">
<li><strong>Crear l'efecte</strong> (<code>user.effects.ts</code>):</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnOwppbXBvcnQgeyBBY3Rpb25zLCBvZlR5cGUsIGNyZWF0ZUVmZmVjdCB9IGZyb20gJ0BuZ3J4L2VmZmVjdHMnOwppbXBvcnQgeyBvZiB9IGZyb20gJ3J4anMnOwppbXBvcnQgeyBjYXRjaEVycm9yLCBtYXAsIG1lcmdlTWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnOwppbXBvcnQgeyBVc2VyU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL3VzZXIuc2VydmljZSc7CmltcG9ydCAqIGFzIFVzZXJBY3Rpb25zIGZyb20gJy4uL2FjdGlvbnMvdXNlci5hY3Rpb25zJzsKCkBJbmplY3RhYmxlKCkKZXhwb3J0IGNsYXNzIFVzZXJFZmZlY3RzIHsKCiAgY29uc3RydWN0b3IoCiAgICBwcml2YXRlIGFjdGlvbnMkOiBBY3Rpb25zLAogICAgcHJpdmF0ZSB1c2VyU2VydmljZTogVXNlclNlcnZpY2UKICApIHt9CgogIGxvYWRVc2VycyQgPSBjcmVhdGVFZmZlY3QoKCkgPT4KICAgIHRoaXMuYWN0aW9ucyQucGlwZSgKICAgICAgb2ZUeXBlKFVzZXJBY3Rpb25zLmxvYWRVc2VycyksCiAgICAgIG1lcmdlTWFwKCgpID0+IHRoaXMudXNlclNlcnZpY2UuZ2V0VXNlcnMoKQogICAgICAgIC5waXBlKAogICAgICAgICAgbWFwKHVzZXJzID0+IFVzZXJBY3Rpb25zLmxvYWRVc2Vyc1N1Y2Nlc3MoeyB1c2VycyB9KSksCiAgICAgICAgICBjYXRjaEVycm9yKGVycm9yID0+IG9mKFVzZXJBY3Rpb25zLmxvYWRVc2Vyc0ZhaWx1cmUoeyBlcnJvciB9KSkpCiAgICAgICAgKSkKICAgICkKICApOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import { Injectable } from '@angular/core';
import { Actions, ofType, createEffect } from '@ngrx/effects';
import { of } from 'rxjs';
import { catchError, map, mergeMap } from 'rxjs/operators';
import { UserService } from '../services/user.service';
import * as UserActions from '../actions/user.actions';

@Injectable()
export class UserEffects {

  constructor(
    private actions$: Actions,
    private userService: UserService
  ) {}

  loadUsers$ = createEffect(() =&gt;
    this.actions$.pipe(
      ofType(UserActions.loadUsers),
      mergeMap(() =&gt; this.userService.getUsers()
        .pipe(
          map(users =&gt; UserActions.loadUsersSuccess({ users })),
          catchError(error =&gt; of(UserActions.loadUsersFailure({ error })))
        ))
    )
  );
}</pre></div><div class='content'><ol start="4">
<li><strong>Registrar l'efecte</strong> (<code>app.module.ts</code>):</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHsgRWZmZWN0c01vZHVsZSB9IGZyb20gJ0BuZ3J4L2VmZmVjdHMnOwppbXBvcnQgeyBVc2VyRWZmZWN0cyB9IGZyb20gJy4vZWZmZWN0cy91c2VyLmVmZmVjdHMnOwoKQE5nTW9kdWxlKHsKICBpbXBvcnRzOiBbCiAgICAvLyBhbHRyZXMgaW1wb3J0cwogICAgRWZmZWN0c01vZHVsZS5mb3JSb290KFtVc2VyRWZmZWN0c10pCiAgXSwKICAvLyBhbHRyZXMgY29uZmlndXJhY2lvbnMKfSkKZXhwb3J0IGNsYXNzIEFwcE1vZHVsZSB7IH0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import { EffectsModule } from '@ngrx/effects';
import { UserEffects } from './effects/user.effects';

@NgModule({
  imports: [
    // altres imports
    EffectsModule.forRoot([UserEffects])
  ],
  // altres configuracions
})
export class AppModule { }</pre></div><div class='content'></div><h2>Solució</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdXNlci5zZXJ2aWNlLnRzCmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJzsKaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJzsKaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnOwppbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vbW9kZWxzL3VzZXIubW9kZWwnOwoKQEluamVjdGFibGUoewogIHByb3ZpZGVkSW46ICdyb290Jwp9KQpleHBvcnQgY2xhc3MgVXNlclNlcnZpY2UgewogIGNvbnN0cnVjdG9yKHByaXZhdGUgaHR0cDogSHR0cENsaWVudCkge30KCiAgZ2V0VXNlcnMoKTogT2JzZXJ2YWJsZTxVc2VyW10+IHsKICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0PFVzZXJbXT4oJ2h0dHBzOi8vYXBpLmV4YW1wbGUuY29tL3VzZXJzJyk7CiAgfQp9CgovLyB1c2VyLmFjdGlvbnMudHMKaW1wb3J0IHsgY3JlYXRlQWN0aW9uLCBwcm9wcyB9IGZyb20gJ0BuZ3J4L3N0b3JlJzsKaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uL21vZGVscy91c2VyLm1vZGVsJzsKCmV4cG9ydCBjb25zdCBsb2FkVXNlcnMgPSBjcmVhdGVBY3Rpb24oJ1tVc2VyXSBMb2FkIFVzZXJzJyk7CmV4cG9ydCBjb25zdCBsb2FkVXNlcnNTdWNjZXNzID0gY3JlYXRlQWN0aW9uKCdbVXNlcl0gTG9hZCBVc2VycyBTdWNjZXNzJywgcHJvcHM8eyB1c2VyczogVXNlcltdIH0+KCkpOwpleHBvcnQgY29uc3QgbG9hZFVzZXJzRmFpbHVyZSA9IGNyZWF0ZUFjdGlvbignW1VzZXJdIExvYWQgVXNlcnMgRmFpbHVyZScsIHByb3BzPHsgZXJyb3I6IGFueSB9PigpKTsKCi8vIHVzZXIuZWZmZWN0cy50cwppbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7CmltcG9ydCB7IEFjdGlvbnMsIG9mVHlwZSwgY3JlYXRlRWZmZWN0IH0gZnJvbSAnQG5ncngvZWZmZWN0cyc7CmltcG9ydCB7IG9mIH0gZnJvbSAncnhqcyc7CmltcG9ydCB7IGNhdGNoRXJyb3IsIG1hcCwgbWVyZ2VNYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7CmltcG9ydCB7IFVzZXJTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvdXNlci5zZXJ2aWNlJzsKaW1wb3J0ICogYXMgVXNlckFjdGlvbnMgZnJvbSAnLi4vYWN0aW9ucy91c2VyLmFjdGlvbnMnOwoKQEluamVjdGFibGUoKQpleHBvcnQgY2xhc3MgVXNlckVmZmVjdHMgewoKICBjb25zdHJ1Y3RvcigKICAgIHByaXZhdGUgYWN0aW9ucyQ6IEFjdGlvbnMsCiAgICBwcml2YXRlIHVzZXJTZXJ2aWNlOiBVc2VyU2VydmljZQogICkge30KCiAgbG9hZFVzZXJzJCA9IGNyZWF0ZUVmZmVjdCgoKSA9PgogICAgdGhpcy5hY3Rpb25zJC5waXBlKAogICAgICBvZlR5cGUoVXNlckFjdGlvbnMubG9hZFVzZXJzKSwKICAgICAgbWVyZ2VNYXAoKCkgPT4gdGhpcy51c2VyU2VydmljZS5nZXRVc2VycygpCiAgICAgICAgLnBpcGUoCiAgICAgICAgICBtYXAodXNlcnMgPT4gVXNlckFjdGlvbnMubG9hZFVzZXJzU3VjY2Vzcyh7IHVzZXJzIH0pKSwKICAgICAgICAgIGNhdGNoRXJyb3IoZXJyb3IgPT4gb2YoVXNlckFjdGlvbnMubG9hZFVzZXJzRmFpbHVyZSh7IGVycm9yIH0pKSkKICAgICAgICApKQogICAgKQogICk7Cn0KCi8vIGFwcC5tb2R1bGUudHMKaW1wb3J0IHsgRWZmZWN0c01vZHVsZSB9IGZyb20gJ0BuZ3J4L2VmZmVjdHMnOwppbXBvcnQgeyBVc2VyRWZmZWN0cyB9IGZyb20gJy4vZWZmZWN0cy91c2VyLmVmZmVjdHMnOwoKQE5nTW9kdWxlKHsKICBpbXBvcnRzOiBbCiAgICAvLyBhbHRyZXMgaW1wb3J0cwogICAgRWZmZWN0c01vZHVsZS5mb3JSb290KFtVc2VyRWZmZWN0c10pCiAgXSwKICAvLyBhbHRyZXMgY29uZmlndXJhY2lvbnMKfSkKZXhwb3J0IGNsYXNzIEFwcE1vZHVsZSB7IH0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// user.service.ts
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';
import { User } from '../models/user.model';

@Injectable({
  providedIn: 'root'
})
export class UserService {
  constructor(private http: HttpClient) {}

  getUsers(): Observable&lt;User[]&gt; {
    return this.http.get&lt;User[]&gt;('https://api.example.com/users');
  }
}

// user.actions.ts
import { createAction, props } from '@ngrx/store';
import { User } from '../models/user.model';

export const loadUsers = createAction('[User] Load Users');
export const loadUsersSuccess = createAction('[User] Load Users Success', props&lt;{ users: User[] }&gt;());
export const loadUsersFailure = createAction('[User] Load Users Failure', props&lt;{ error: any }&gt;());

// user.effects.ts
import { Injectable } from '@angular/core';
import { Actions, ofType, createEffect } from '@ngrx/effects';
import { of } from 'rxjs';
import { catchError, map, mergeMap } from 'rxjs/operators';
import { UserService } from '../services/user.service';
import * as UserActions from '../actions/user.actions';

@Injectable()
export class UserEffects {

  constructor(
    private actions$: Actions,
    private userService: UserService
  ) {}

  loadUsers$ = createEffect(() =&gt;
    this.actions$.pipe(
      ofType(UserActions.loadUsers),
      mergeMap(() =&gt; this.userService.getUsers()
        .pipe(
          map(users =&gt; UserActions.loadUsersSuccess({ users })),
          catchError(error =&gt; of(UserActions.loadUsersFailure({ error })))
        ))
    )
  );
}

// app.module.ts
import { EffectsModule } from '@ngrx/effects';
import { UserEffects } from './effects/user.effects';

@NgModule({
  imports: [
    // altres imports
    EffectsModule.forRoot([UserEffects])
  ],
  // altres configuracions
})
export class AppModule { }</pre></div><div class='content'></div><h1>Resum</h1>
<div class='content'><p>En aquesta secció, hem après què són els efectes en NgRx i com utilitzar-los per gestionar efectes secundaris en aplicacions Angular. Hem vist com crear una classe d'efectes, definir accions i integrar els efectes amb el flux d'accions i reducers. També hem realitzat un exercici pràctic per consolidar els coneixements adquirits. Amb aquests coneixements, estàs preparat per gestionar efectes secundaris de manera eficient en les teves aplicacions Angular utilitzant NgRx Effects.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='09-03-ngrx-store' title="NgRx Store">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='10-01-unit-testing' title="Proves unitàries">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
