<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processament de Fluxos de Dades</title>

    <link rel="alternate" href="https://campusempresa.com/mod/arquitecturas_distribuidas/05-03-procesamiento-flujos" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/arquitecturas_distribuidas/05-03-processament-fluxos" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/arquitecturas_distribuidas/05-03-stream-processing" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/arquitecturas_distribuidas/05-03-stream-processing" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/arquitecturas_distribuidas/05-03-procesamiento-flujos" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-spark-computacio' title="Spark i Computació en Memòria">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Processament de Fluxos de Dades</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-01-autenticacio-autoritzacio' title="Autenticació i Autorització">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>El processament de fluxos de dades és una tècnica utilitzada per analitzar i actuar sobre dades en moviment en temps real. A diferència del processament per lots, que treballa amb grans volums de dades emmagatzemades, el processament de fluxos tracta amb dades que arriben contínuament i requereixen una resposta immediata.</p>
</div><h2>Objectius del Tema</h2>
<div class='content'><ol>
<li>Comprendre els conceptes bàsics del processament de fluxos de dades.</li>
<li>Aprendre sobre les arquitectures i tecnologies utilitzades en el processament de fluxos.</li>
<li>Implementar exemples pràctics utilitzant eines populars com Apache Kafka i Apache Flink.</li>
<li>Resoldre exercicis pràctics per reforçar els conceptes apresos.</li>
</ol>
</div><h1>Conceptes Bàsics</h1>
<div class='content'></div><h2>Què és el Processament de Fluxos de Dades?</h2>
<div class='content'><p>El processament de fluxos de dades implica la captura, l'anàlisi i l'actuació sobre dades que es generen contínuament. Aquestes dades poden provenir de diverses fonts com sensors, registres de servidors, aplicacions web, etc.</p>
</div><h2>Diferències entre Processament per Lots i Processament de Fluxos</h2>
<div class='content'><table>
<thead>
<tr>
<th>Característica</th>
<th>Processament per Lots</th>
<th>Processament de Fluxos</th>
</tr>
</thead>
<tbody>
<tr>
<td>Latència</td>
<td>Alta</td>
<td>Baixa</td>
</tr>
<tr>
<td>Volum de Dades</td>
<td>Gran</td>
<td>Continu</td>
</tr>
<tr>
<td>Temps de Resposta</td>
<td>Minuts a hores</td>
<td>Mil·lisegons a segons</td>
</tr>
<tr>
<td>Casos d'Ús</td>
<td>Anàlisi històrica, informes</td>
<td>Monitoratge en temps real, detecció de fraus</td>
</tr>
</tbody>
</table>
</div><h2>Arquitectures de Processament de Fluxos</h2>
<div class='content'><ol>
<li><strong>Lambda Architecture</strong>: Combina processament per lots i de fluxos per oferir una solució robusta i flexible.</li>
<li><strong>Kappa Architecture</strong>: Simplifica l'arquitectura Lambda eliminant el processament per lots i utilitzant només el processament de fluxos.</li>
</ol>
</div><h1>Tecnologies Populars</h1>
<div class='content'></div><h2>Apache Kafka</h2>
<div class='content'><p>Apache Kafka és una plataforma de missatgeria distribuïda que permet la publicació, subscripció, emmagatzematge i processament de fluxos de dades en temps real.</p>
<h4>Exemples de Codi</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gUHJvZHVjdG9yIGRlIEthZmthClByb3BlcnRpZXMgcHJvcHMgPSBuZXcgUHJvcGVydGllcygpOwpwcm9wcy5wdXQoImJvb3RzdHJhcC5zZXJ2ZXJzIiwgImxvY2FsaG9zdDo5MDkyIik7CnByb3BzLnB1dCgia2V5LnNlcmlhbGl6ZXIiLCAib3JnLmFwYWNoZS5rYWZrYS5jb21tb24uc2VyaWFsaXphdGlvbi5TdHJpbmdTZXJpYWxpemVyIik7CnByb3BzLnB1dCgidmFsdWUuc2VyaWFsaXplciIsICJvcmcuYXBhY2hlLmthZmthLmNvbW1vbi5zZXJpYWxpemF0aW9uLlN0cmluZ1NlcmlhbGl6ZXIiKTsKCkthZmthUHJvZHVjZXI8U3RyaW5nLCBTdHJpbmc+IHByb2R1Y2VyID0gbmV3IEthZmthUHJvZHVjZXI8Pihwcm9wcyk7CnByb2R1Y2VyLnNlbmQobmV3IFByb2R1Y2VyUmVjb3JkPD4oInRvcGljIiwgImtleSIsICJ2YWx1ZSIpKTsKcHJvZHVjZXIuY2xvc2UoKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Productor de Kafka
Properties props = new Properties();
props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
props.put(&quot;key.serializer&quot;, &quot;org.apache.kafka.common.serialization.StringSerializer&quot;);
props.put(&quot;value.serializer&quot;, &quot;org.apache.kafka.common.serialization.StringSerializer&quot;);

KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(props);
producer.send(new ProducerRecord&lt;&gt;(&quot;topic&quot;, &quot;key&quot;, &quot;value&quot;));
producer.close();</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ29uc3VtaWRvciBkZSBLYWZrYQpQcm9wZXJ0aWVzIHByb3BzID0gbmV3IFByb3BlcnRpZXMoKTsKcHJvcHMucHV0KCJib290c3RyYXAuc2VydmVycyIsICJsb2NhbGhvc3Q6OTA5MiIpOwpwcm9wcy5wdXQoImdyb3VwLmlkIiwgInRlc3QiKTsKcHJvcHMucHV0KCJrZXkuZGVzZXJpYWxpemVyIiwgIm9yZy5hcGFjaGUua2Fma2EuY29tbW9uLnNlcmlhbGl6YXRpb24uU3RyaW5nRGVzZXJpYWxpemVyIik7CnByb3BzLnB1dCgidmFsdWUuZGVzZXJpYWxpemVyIiwgIm9yZy5hcGFjaGUua2Fma2EuY29tbW9uLnNlcmlhbGl6YXRpb24uU3RyaW5nRGVzZXJpYWxpemVyIik7CgpLYWZrYUNvbnN1bWVyPFN0cmluZywgU3RyaW5nPiBjb25zdW1lciA9IG5ldyBLYWZrYUNvbnN1bWVyPD4ocHJvcHMpOwpjb25zdW1lci5zdWJzY3JpYmUoQXJyYXlzLmFzTGlzdCgidG9waWMiKSk7CndoaWxlICh0cnVlKSB7CiAgICBDb25zdW1lclJlY29yZHM8U3RyaW5nLCBTdHJpbmc+IHJlY29yZHMgPSBjb25zdW1lci5wb2xsKER1cmF0aW9uLm9mTWlsbGlzKDEwMCkpOwogICAgZm9yIChDb25zdW1lclJlY29yZDxTdHJpbmcsIFN0cmluZz4gcmVjb3JkIDogcmVjb3JkcykgewogICAgICAgIFN5c3RlbS5vdXQucHJpbnRmKCJvZmZzZXQgPSAlZCwga2V5ID0gJXMsIHZhbHVlID0gJXMlbiIsIHJlY29yZC5vZmZzZXQoKSwgcmVjb3JkLmtleSgpLCByZWNvcmQudmFsdWUoKSk7CiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Consumidor de Kafka
Properties props = new Properties();
props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
props.put(&quot;group.id&quot;, &quot;test&quot;);
props.put(&quot;key.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);
props.put(&quot;value.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);

KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);
consumer.subscribe(Arrays.asList(&quot;topic&quot;));
while (true) {
    ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(100));
    for (ConsumerRecord&lt;String, String&gt; record : records) {
        System.out.printf(&quot;offset = %d, key = %s, value = %s%n&quot;, record.offset(), record.key(), record.value());
    }
}</pre></div><div class='content'></div><h2>Apache Flink</h2>
<div class='content'><p>Apache Flink és un motor de processament de fluxos de dades que permet processar dades en temps real amb baixa latència i alta velocitat.</p>
<h4>Exemples de Codi</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ29uZmlndXJhY2nDsyBkZSBsJ2VudG9ybiBkZSBGbGluawpTdHJlYW1FeGVjdXRpb25FbnZpcm9ubWVudCBlbnYgPSBTdHJlYW1FeGVjdXRpb25FbnZpcm9ubWVudC5nZXRFeGVjdXRpb25FbnZpcm9ubWVudCgpOwoKLy8gRm9udCBkZSBkYWRlcwpEYXRhU3RyZWFtPFN0cmluZz4gdGV4dCA9IGVudi5zb2NrZXRUZXh0U3RyZWFtKCJsb2NhbGhvc3QiLCA5OTk5KTsKCi8vIFByb2Nlc3NhbWVudCBkZSBkYWRlcwpEYXRhU3RyZWFtPFR1cGxlMjxTdHJpbmcsIEludGVnZXI+PiB3b3JkQ291bnRzID0gdGV4dAogICAgLmZsYXRNYXAobmV3IEZsYXRNYXBGdW5jdGlvbjxTdHJpbmcsIFR1cGxlMjxTdHJpbmcsIEludGVnZXI+PigpIHsKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBmbGF0TWFwKFN0cmluZyB2YWx1ZSwgQ29sbGVjdG9yPFR1cGxlMjxTdHJpbmcsIEludGVnZXI+PiBvdXQpIHsKICAgICAgICAgICAgZm9yIChTdHJpbmcgd29yZCA6IHZhbHVlLnNwbGl0KCIgIikpIHsKICAgICAgICAgICAgICAgIG91dC5jb2xsZWN0KG5ldyBUdXBsZTI8Pih3b3JkLCAxKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9KQogICAgLmtleUJ5KDApCiAgICAuc3VtKDEpOwoKLy8gSW1wcmltaXIgcmVzdWx0YXRzCndvcmRDb3VudHMucHJpbnQoKTsKCi8vIEV4ZWN1dGFyIGwnYXBsaWNhY2nDswplbnYuZXhlY3V0ZSgiV29yZCBDb3VudCBFeGFtcGxlIik7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Configuraci&oacute; de l'entorn de Flink
StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

// Font de dades
DataStream&lt;String&gt; text = env.socketTextStream(&quot;localhost&quot;, 9999);

// Processament de dades
DataStream&lt;Tuple2&lt;String, Integer&gt;&gt; wordCounts = text
    .flatMap(new FlatMapFunction&lt;String, Tuple2&lt;String, Integer&gt;&gt;() {
        @Override
        public void flatMap(String value, Collector&lt;Tuple2&lt;String, Integer&gt;&gt; out) {
            for (String word : value.split(&quot; &quot;)) {
                out.collect(new Tuple2&lt;&gt;(word, 1));
            }
        }
    })
    .keyBy(0)
    .sum(1);

// Imprimir resultats
wordCounts.print();

// Executar l'aplicaci&oacute;
env.execute(&quot;Word Count Example&quot;);</pre></div><div class='content'></div><h1>Exercicis Pràctics</h1>
<div class='content'></div><h2>Exercici 1: Configuració d'un Productor i Consumidor de Kafka</h2>
<div class='content'><ol>
<li>Configura un productor de Kafka que enviï missatges a un tema anomenat &quot;test-topic&quot;.</li>
<li>Configura un consumidor de Kafka que llegeixi missatges del tema &quot;test-topic&quot; i imprimeixi els missatges a la consola.</li>
</ol>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gUHJvZHVjdG9yIGRlIEthZmthClByb3BlcnRpZXMgcHJvcHMgPSBuZXcgUHJvcGVydGllcygpOwpwcm9wcy5wdXQoImJvb3RzdHJhcC5zZXJ2ZXJzIiwgImxvY2FsaG9zdDo5MDkyIik7CnByb3BzLnB1dCgia2V5LnNlcmlhbGl6ZXIiLCAib3JnLmFwYWNoZS5rYWZrYS5jb21tb24uc2VyaWFsaXphdGlvbi5TdHJpbmdTZXJpYWxpemVyIik7CnByb3BzLnB1dCgidmFsdWUuc2VyaWFsaXplciIsICJvcmcuYXBhY2hlLmthZmthLmNvbW1vbi5zZXJpYWxpemF0aW9uLlN0cmluZ1NlcmlhbGl6ZXIiKTsKCkthZmthUHJvZHVjZXI8U3RyaW5nLCBTdHJpbmc+IHByb2R1Y2VyID0gbmV3IEthZmthUHJvZHVjZXI8Pihwcm9wcyk7CnByb2R1Y2VyLnNlbmQobmV3IFByb2R1Y2VyUmVjb3JkPD4oInRlc3QtdG9waWMiLCAia2V5IiwgIkhlbGxvLCBLYWZrYSEiKSk7CnByb2R1Y2VyLmNsb3NlKCk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Productor de Kafka
Properties props = new Properties();
props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
props.put(&quot;key.serializer&quot;, &quot;org.apache.kafka.common.serialization.StringSerializer&quot;);
props.put(&quot;value.serializer&quot;, &quot;org.apache.kafka.common.serialization.StringSerializer&quot;);

KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(props);
producer.send(new ProducerRecord&lt;&gt;(&quot;test-topic&quot;, &quot;key&quot;, &quot;Hello, Kafka!&quot;));
producer.close();</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ29uc3VtaWRvciBkZSBLYWZrYQpQcm9wZXJ0aWVzIHByb3BzID0gbmV3IFByb3BlcnRpZXMoKTsKcHJvcHMucHV0KCJib290c3RyYXAuc2VydmVycyIsICJsb2NhbGhvc3Q6OTA5MiIpOwpwcm9wcy5wdXQoImdyb3VwLmlkIiwgInRlc3QtZ3JvdXAiKTsKcHJvcHMucHV0KCJrZXkuZGVzZXJpYWxpemVyIiwgIm9yZy5hcGFjaGUua2Fma2EuY29tbW9uLnNlcmlhbGl6YXRpb24uU3RyaW5nRGVzZXJpYWxpemVyIik7CnByb3BzLnB1dCgidmFsdWUuZGVzZXJpYWxpemVyIiwgIm9yZy5hcGFjaGUua2Fma2EuY29tbW9uLnNlcmlhbGl6YXRpb24uU3RyaW5nRGVzZXJpYWxpemVyIik7CgpLYWZrYUNvbnN1bWVyPFN0cmluZywgU3RyaW5nPiBjb25zdW1lciA9IG5ldyBLYWZrYUNvbnN1bWVyPD4ocHJvcHMpOwpjb25zdW1lci5zdWJzY3JpYmUoQXJyYXlzLmFzTGlzdCgidGVzdC10b3BpYyIpKTsKd2hpbGUgKHRydWUpIHsKICAgIENvbnN1bWVyUmVjb3JkczxTdHJpbmcsIFN0cmluZz4gcmVjb3JkcyA9IGNvbnN1bWVyLnBvbGwoRHVyYXRpb24ub2ZNaWxsaXMoMTAwKSk7CiAgICBmb3IgKENvbnN1bWVyUmVjb3JkPFN0cmluZywgU3RyaW5nPiByZWNvcmQgOiByZWNvcmRzKSB7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGYoIm9mZnNldCA9ICVkLCBrZXkgPSAlcywgdmFsdWUgPSAlcyVuIiwgcmVjb3JkLm9mZnNldCgpLCByZWNvcmQua2V5KCksIHJlY29yZC52YWx1ZSgpKTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Consumidor de Kafka
Properties props = new Properties();
props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
props.put(&quot;group.id&quot;, &quot;test-group&quot;);
props.put(&quot;key.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);
props.put(&quot;value.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);

KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);
consumer.subscribe(Arrays.asList(&quot;test-topic&quot;));
while (true) {
    ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(100));
    for (ConsumerRecord&lt;String, String&gt; record : records) {
        System.out.printf(&quot;offset = %d, key = %s, value = %s%n&quot;, record.offset(), record.key(), record.value());
    }
}</pre></div><div class='content'></div><h2>Exercici 2: Implementació d'un Comptador de Paraules amb Apache Flink</h2>
<div class='content'><ol>
<li>Configura un entorn de Flink per llegir dades d'un socket.</li>
<li>Implementa un comptador de paraules que llegeixi línies de text des d'un socket i compti la freqüència de cada paraula.</li>
</ol>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ29uZmlndXJhY2nDsyBkZSBsJ2VudG9ybiBkZSBGbGluawpTdHJlYW1FeGVjdXRpb25FbnZpcm9ubWVudCBlbnYgPSBTdHJlYW1FeGVjdXRpb25FbnZpcm9ubWVudC5nZXRFeGVjdXRpb25FbnZpcm9ubWVudCgpOwoKLy8gRm9udCBkZSBkYWRlcwpEYXRhU3RyZWFtPFN0cmluZz4gdGV4dCA9IGVudi5zb2NrZXRUZXh0U3RyZWFtKCJsb2NhbGhvc3QiLCA5OTk5KTsKCi8vIFByb2Nlc3NhbWVudCBkZSBkYWRlcwpEYXRhU3RyZWFtPFR1cGxlMjxTdHJpbmcsIEludGVnZXI+PiB3b3JkQ291bnRzID0gdGV4dAogICAgLmZsYXRNYXAobmV3IEZsYXRNYXBGdW5jdGlvbjxTdHJpbmcsIFR1cGxlMjxTdHJpbmcsIEludGVnZXI+PigpIHsKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBmbGF0TWFwKFN0cmluZyB2YWx1ZSwgQ29sbGVjdG9yPFR1cGxlMjxTdHJpbmcsIEludGVnZXI+PiBvdXQpIHsKICAgICAgICAgICAgZm9yIChTdHJpbmcgd29yZCA6IHZhbHVlLnNwbGl0KCIgIikpIHsKICAgICAgICAgICAgICAgIG91dC5jb2xsZWN0KG5ldyBUdXBsZTI8Pih3b3JkLCAxKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9KQogICAgLmtleUJ5KDApCiAgICAuc3VtKDEpOwoKLy8gSW1wcmltaXIgcmVzdWx0YXRzCndvcmRDb3VudHMucHJpbnQoKTsKCi8vIEV4ZWN1dGFyIGwnYXBsaWNhY2nDswplbnYuZXhlY3V0ZSgiV29yZCBDb3VudCBFeGFtcGxlIik7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Configuraci&oacute; de l'entorn de Flink
StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

// Font de dades
DataStream&lt;String&gt; text = env.socketTextStream(&quot;localhost&quot;, 9999);

// Processament de dades
DataStream&lt;Tuple2&lt;String, Integer&gt;&gt; wordCounts = text
    .flatMap(new FlatMapFunction&lt;String, Tuple2&lt;String, Integer&gt;&gt;() {
        @Override
        public void flatMap(String value, Collector&lt;Tuple2&lt;String, Integer&gt;&gt; out) {
            for (String word : value.split(&quot; &quot;)) {
                out.collect(new Tuple2&lt;&gt;(word, 1));
            }
        }
    })
    .keyBy(0)
    .sum(1);

// Imprimir resultats
wordCounts.print();

// Executar l'aplicaci&oacute;
env.execute(&quot;Word Count Example&quot;);</pre></div><div class='content'></div><h1>Errors Comuns i Consells</h1>
<div class='content'></div><h2>Errors Comuns</h2>
<div class='content'><ol>
<li><strong>No configurar correctament les propietats de Kafka</strong>: Assegura't que les propietats com <code>bootstrap.servers</code> i <code>group.id</code> estiguin correctament configurades.</li>
<li><strong>No gestionar correctament les excepcions</strong>: Sempre gestiona les excepcions per evitar que l'aplicació es bloquegi.</li>
<li><strong>No tancar els productors i consumidors</strong>: Assegura't de tancar els productors i consumidors de Kafka per alliberar recursos.</li>
</ol>
</div><h2>Consells Addicionals</h2>
<div class='content'><ol>
<li><strong>Utilitza eines de monitoratge</strong>: Utilitza eines com Kafka Manager per monitorar els teus clústers de Kafka.</li>
<li><strong>Optimitza el rendiment</strong>: Ajusta els paràmetres de configuració de Kafka i Flink per optimitzar el rendiment segons les necessitats de la teva aplicació.</li>
<li><strong>Prova en entorns de desenvolupament</strong>: Abans de desplegar en producció, prova les teves aplicacions en entorns de desenvolupament per assegurar-te que funcionen correctament.</li>
</ol>
</div><h1>Conclusió</h1>
<div class='content'><p>En aquesta secció, hem explorat els conceptes bàsics del processament de fluxos de dades, les diferències amb el processament per lots, i les arquitectures i tecnologies populars com Apache Kafka i Apache Flink. També hem implementat exemples pràctics i resolt exercicis per reforçar els conceptes apresos. Amb aquests coneixements, estàs preparat per abordar el processament de fluxos de dades en aplicacions reals i gestionar dades en temps real de manera eficient.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-spark-computacio' title="Spark i Computació en Memòria">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-01-autenticacio-autoritzacio' title="Autenticació i Autorització">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
