<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuració de fonts de dades</title>

    <link rel="alternate" href="https://campusempresa.com/mod/springboot/04-02-configuring-data-sources" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/springboot/04-02-configuring-data-sources" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/springboot/04-02-configuring-data-sources" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/springboot/04-02-configuring-data-sources" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/springboot/04-02-configuring-data-sources" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Contingut del curs</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Competències tècniques</a>
				<a href="/all/conocimientos">Coneixements</a>
				<a href="/all/soft_skills">Competències socials</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-01-introduction-spring-data-jpa' title="Introducció a Spring Data JPA">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Configuració de fonts de dades</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-03-creating-jpa-entities' title="Creant entitats JPA">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem com configurar fonts de dades en una aplicació Spring Boot. Les fonts de dades són essencials per a qualsevol aplicació que necessiti interactuar amb una base de dades. Spring Boot facilita aquesta configuració mitjançant propietats i anotacions.</p>
</div><h1><p>Objectius</p>
</h1>
<div class='content'><ul>
<li>Entendre què és una font de dades.</li>
<li>Configurar una font de dades en una aplicació Spring Boot.</li>
<li>Utilitzar propietats de configuració per personalitzar la connexió a la base de dades.</li>
<li>Provar la configuració de la font de dades.</li>
</ul>
</div><h1><p>Què és una font de dades?</p>
</h1>
<div class='content'><p>Una font de dades (DataSource) és un objecte que proporciona una connexió a una base de dades. En una aplicació Spring Boot, la font de dades és responsable de gestionar les connexions a la base de dades, incloent-hi la configuració de paràmetres com l'URL de la base de dades, l'usuari, la contrasenya, etc.</p>
</div><h1><p>Configurant una font de dades</p>
</h1>
<div class='content'></div><h2><ol>
<li>Dependències necessàries</li>
</ol>
</h2>
<div class='content'><p>Primer, assegura't de tenir les dependències necessàries en el teu fitxer <code>pom.xml</code> (per a Maven) o <code>build.gradle</code> (per a Gradle). Per exemple, per a una base de dades MySQL:</p>
<p><strong>pom.xml:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGRlcGVuZGVuY3k+CiAgICA8Z3JvdXBJZD5teXNxbDwvZ3JvdXBJZD4KICAgIDxhcnRpZmFjdElkPm15c3FsLWNvbm5lY3Rvci1qYXZhPC9hcnRpZmFjdElkPgogICAgPHNjb3BlPnJ1bnRpbWU8L3Njb3BlPgo8L2RlcGVuZGVuY3k+CjxkZXBlbmRlbmN5PgogICAgPGdyb3VwSWQ+b3JnLnNwcmluZ2ZyYW1ld29yay5ib290PC9ncm91cElkPgogICAgPGFydGlmYWN0SWQ+c3ByaW5nLWJvb3Qtc3RhcnRlci1kYXRhLWpwYTwvYXJ0aWZhY3RJZD4KPC9kZXBlbmRlbmN5Pg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;dependency&gt;
    &lt;groupId&gt;mysql&lt;/groupId&gt;
    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;</pre></div><div class='content'><p><strong>build.gradle:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wbGVtZW50YXRpb24gJ215c3FsOm15c3FsLWNvbm5lY3Rvci1qYXZhJwppbXBsZW1lbnRhdGlvbiAnb3JnLnNwcmluZ2ZyYW1ld29yay5ib290OnNwcmluZy1ib290LXN0YXJ0ZXItZGF0YS1qcGEn"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>implementation 'mysql:mysql-connector-java'
implementation 'org.springframework.boot:spring-boot-starter-data-jpa'</pre></div><div class='content'></div><h2><ol start="2">
<li>Propietats de configuració</li>
</ol>
</h2>
<div class='content'><p>Spring Boot utilitza el fitxer <code>application.properties</code> o <code>application.yml</code> per configurar les propietats de la font de dades. Aquí tens un exemple de configuració per a una base de dades MySQL:</p>
<p><strong>application.properties:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3ByaW5nLmRhdGFzb3VyY2UudXJsPWpkYmM6bXlzcWw6Ly9sb2NhbGhvc3Q6MzMwNi9ub21fZGVfbGFfYmFzZV9kZV9kYWRlcwpzcHJpbmcuZGF0YXNvdXJjZS51c2VybmFtZT11c3VhcmkKc3ByaW5nLmRhdGFzb3VyY2UucGFzc3dvcmQ9Y29udHJhc2VueWEKc3ByaW5nLmRhdGFzb3VyY2UuZHJpdmVyLWNsYXNzLW5hbWU9Y29tLm15c3FsLmNqLmpkYmMuRHJpdmVyCnNwcmluZy5qcGEuaGliZXJuYXRlLmRkbC1hdXRvPXVwZGF0ZQpzcHJpbmcuanBhLnNob3ctc3FsPXRydWU="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>spring.datasource.url=jdbc:mysql://localhost:3306/nom_de_la_base_de_dades
spring.datasource.username=usuari
spring.datasource.password=contrasenya
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true</pre></div><div class='content'><p><strong>application.yml:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3ByaW5nOgogIGRhdGFzb3VyY2U6CiAgICB1cmw6IGpkYmM6bXlzcWw6Ly9sb2NhbGhvc3Q6MzMwNi9ub21fZGVfbGFfYmFzZV9kZV9kYWRlcwogICAgdXNlcm5hbWU6IHVzdWFyaQogICAgcGFzc3dvcmQ6IGNvbnRyYXNlbnlhCiAgICBkcml2ZXItY2xhc3MtbmFtZTogY29tLm15c3FsLmNqLmpkYmMuRHJpdmVyCiAganBhOgogICAgaGliZXJuYXRlOgogICAgICBkZGwtYXV0bzogdXBkYXRlCiAgICBzaG93LXNxbDogdHJ1ZQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>spring:
  datasource:
    url: jdbc:mysql://localhost:3306/nom_de_la_base_de_dades
    username: usuari
    password: contrasenya
    driver-class-name: com.mysql.cj.jdbc.Driver
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true</pre></div><div class='content'></div><h2><ol start="3">
<li>Configuració avançada</li>
</ol>
</h2>
<div class='content'><p>A més de les propietats bàsiques, pots configurar altres paràmetres com el pool de connexions. Aquí tens un exemple utilitzant HikariCP, que és el pool de connexions per defecte en Spring Boot:</p>
<p><strong>application.properties:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3ByaW5nLmRhdGFzb3VyY2UuaGlrYXJpLm1heGltdW0tcG9vbC1zaXplPTEwCnNwcmluZy5kYXRhc291cmNlLmhpa2FyaS5taW5pbXVtLWlkbGU9NQpzcHJpbmcuZGF0YXNvdXJjZS5oaWthcmkuaWRsZS10aW1lb3V0PTMwMDAwCnNwcmluZy5kYXRhc291cmNlLmhpa2FyaS5tYXgtbGlmZXRpbWU9MTgwMDAwMA=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.max-lifetime=1800000</pre></div><div class='content'><p><strong>application.yml:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3ByaW5nOgogIGRhdGFzb3VyY2U6CiAgICBoaWthcmk6CiAgICAgIG1heGltdW0tcG9vbC1zaXplOiAxMAogICAgICBtaW5pbXVtLWlkbGU6IDUKICAgICAgaWRsZS10aW1lb3V0OiAzMDAwMAogICAgICBtYXgtbGlmZXRpbWU6IDE4MDAwMDA="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>spring:
  datasource:
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      idle-timeout: 30000
      max-lifetime: 1800000</pre></div><div class='content'></div><h2><ol start="4">
<li>Provar la configuració</li>
</ol>
</h2>
<div class='content'><p>Per assegurar-te que la configuració de la font de dades és correcta, pots crear un simple repositori JPA i una entitat per provar la connexió a la base de dades.</p>
<p><strong>Entitat:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkdlbmVyYXRlZFZhbHVlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuR2VuZXJhdGlvblR5cGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5JZDsKCkBFbnRpdHkKcHVibGljIGNsYXNzIFVzdWFyaSB7CiAgICBASWQKICAgIEBHZW5lcmF0ZWRWYWx1ZShzdHJhdGVneSA9IEdlbmVyYXRpb25UeXBlLklERU5USVRZKQogICAgcHJpdmF0ZSBMb25nIGlkOwogICAgcHJpdmF0ZSBTdHJpbmcgbm9tOwogICAgcHJpdmF0ZSBTdHJpbmcgZW1haWw7CgogICAgLy8gR2V0dGVycyBpIHNldHRlcnMKfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

@Entity
public class Usuari {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String nom;
    private String email;

    // Getters i setters
}</pre></div><div class='content'><p><strong>Repositori:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuZGF0YS5qcGEucmVwb3NpdG9yeS5KcGFSZXBvc2l0b3J5OwoKcHVibGljIGludGVyZmFjZSBVc3VhcmlSZXBvc2l0b3J5IGV4dGVuZHMgSnBhUmVwb3NpdG9yeTxVc3VhcmksIExvbmc+IHsKfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.springframework.data.jpa.repository.JpaRepository;

public interface UsuariRepository extends JpaRepository&lt;Usuari, Long&gt; {
}</pre></div><div class='content'><p><strong>Controlador:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuYmVhbnMuZmFjdG9yeS5hbm5vdGF0aW9uLkF1dG93aXJlZDsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLmJpbmQuYW5ub3RhdGlvbi5HZXRNYXBwaW5nOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay53ZWIuYmluZC5hbm5vdGF0aW9uLlJlc3RDb250cm9sbGVyOwoKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKQFJlc3RDb250cm9sbGVyCnB1YmxpYyBjbGFzcyBVc3VhcmlDb250cm9sbGVyIHsKICAgIEBBdXRvd2lyZWQKICAgIHByaXZhdGUgVXN1YXJpUmVwb3NpdG9yeSB1c3VhcmlSZXBvc2l0b3J5OwoKICAgIEBHZXRNYXBwaW5nKCIvdXN1YXJpcyIpCiAgICBwdWJsaWMgTGlzdDxVc3Vhcmk+IG9idGVuaXJVc3VhcmlzKCkgewogICAgICAgIHJldHVybiB1c3VhcmlSZXBvc2l0b3J5LmZpbmRBbGwoKTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

@RestController
public class UsuariController {
    @Autowired
    private UsuariRepository usuariRepository;

    @GetMapping(&quot;/usuaris&quot;)
    public List&lt;Usuari&gt; obtenirUsuaris() {
        return usuariRepository.findAll();
    }
}</pre></div><div class='content'><p>Amb aquesta configuració, pots iniciar l'aplicació i accedir a <code>http://localhost:8080/usuaris</code> per veure si la connexió a la base de dades funciona correctament.</p>
</div><h1><p>Resum</p>
</h1>
<div class='content'><p>En aquesta secció, hem après com configurar una font de dades en una aplicació Spring Boot. Hem vist com afegir les dependències necessàries, configurar les propietats de la font de dades i provar la configuració amb un simple repositori JPA. Aquesta configuració és essencial per a qualsevol aplicació que necessiti interactuar amb una base de dades.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-01-introduction-spring-data-jpa' title="Introducció a Spring Data JPA">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-03-creating-jpa-entities' title="Creant entitats JPA">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
