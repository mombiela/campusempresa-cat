<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    <title>Accedir a bases de dades amb VBA</title>

    <link rel="alternate" href="https://campusempresa.com/mod/vba/05-03-accessing-databases-vba" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/vba/05-03-accessing-databases-vba" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/vba/05-03-accessing-databases-vba" hreflang="en" />
    
	<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"> -->
	<link href="/css/bootstrap/bootstrap.css?v=1" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<!-- 
  	<style type="text/css">
  		img {
  			visibility:hidden;
  		}
  	</style>
  	 -->
  	<script>
  		var LANG = "ca";
  		var CATEGORY = "languages";
  		var MOD_NAME = "vba";
  		var TEMA_NAME = "05-03";
  		var TYPE = "mod";
  		var PATH = "mod/vba/05-03-accessing-databases-vba";
  		var IS_INDEX = false;
  		var DEVELOP = sessionStorage.getItem("DEVELOP") == "true";
  		  		var ALL_PAGES_MOD = ["01-01-what-is-vba","01-02-setting-up-vba-environment","01-03-first-vba-program","01-04-understanding-vba-editor","02-01-variables-data-types","02-02-operators-in-vba","02-03-control-structures-if-then-else","02-04-loops-for-while-do-until","02-05-working-with-arrays","03-01-understanding-excel-object-model","03-02-working-with-workbooks-worksheets","03-03-manipulating-cells-ranges","03-04-using-range-object","03-05-formatting-cells-vba","04-01-creating-using-functions","04-02-error-handling-vba","04-03-debugging-techniques","04-04-working-with-userforms","04-05-event-driven-programming","05-01-automating-word-vba","05-02-automating-outlook-vba","05-03-accessing-databases-vba","05-04-using-vba-control-powerpoint","06-01-writing-efficient-vba-code","06-02-code-refactoring-techniques","06-03-documenting-your-code","06-04-version-control-vba-projects","07-01-automating-reports-excel","07-02-creating-custom-excel-addin","07-03-building-data-entry-form","07-04-developing-dashboard-vba"];
  		  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
  	<script type="module" src="/js/app.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
</head>

<body class="">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/mod/vba/05-03-accessing-databases-vba" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/vba/05-03-accessing-databases-vba" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Tot el coneixement al teu abast</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my_modules" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Els meus cursos</b></i>
</a>
<a href="/end_modules" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalitzats             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" style="display:none;" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0">
	<div class="col-6 p-0" data-mod="vba">
		<a  href="#" class="text-secondary d-none" data-read-mod="vba" data-read-unit="05-03" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar com a llegit
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="vba" data-unread-unit="05-03" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar com a no llegit
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contingut del curs
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-automating-outlook-vba' title="Automatitzar Outlook amb VBA" class="py-2 px-3 btn btn-primary d-none d-md-inline">
				&#x25C4; Anterior 
			</a>
			<a href='05-02-automating-outlook-vba' title="Automatitzar Outlook amb VBA" class="py-2 px-3 btn btn-primary d-md-none">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">Accedir a bases de dades amb VBA</h2>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-using-vba-control-powerpoint' title="Utilitzar VBA per controlar PowerPoint" class="py-2 px-3 d-none d-md-inline btn btn-primary"
				data-read-mod="vba" data-read-unit="05-03">
				Següent &#x25BA;
			</a>
			<a href='05-04-using-vba-control-powerpoint' title="Utilitzar VBA per controlar PowerPoint" class="py-2 px-3 d-md-none btn btn-primary" 
				data-read-mod="vba" data-read-unit="05-03">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem com accedir a bases de dades des de VBA. Això és especialment útil quan necessitem treballar amb grans volums de dades que es troben emmagatzemades en bases de dades externes. Utilitzarem ADO (ActiveX Data Objects) per establir connexions i manipular dades.</p>
</div><h1><ol>
<li>Introducció a ADO</li>
</ol></h1>
<div class='content'><p>ADO és una biblioteca que permet accedir a dades emmagatzemades en diverses fonts de dades, com ara bases de dades SQL Server, Access, i altres. ADO proporciona una interfície per connectar-se a la base de dades, executar consultes SQL i manipular els resultats.</p>
</div><h2>Conceptes clau:</h2>
<div class='content'><ul>
<li><strong>Connexió</strong>: Establir una connexió amb la base de dades.</li>
<li><strong>Comandament</strong>: Executar instruccions SQL.</li>
<li><strong>Registre</strong>: Manipular els resultats de les consultes.</li>
</ul>
</div><h1><ol start="2">
<li>Configuració de l'entorn</li>
</ol></h1>
<div class='content'><p>Abans de començar a treballar amb ADO, hem d'assegurar-nos que la biblioteca ADO estigui referenciada en el nostre projecte VBA.</p>
</div><h2>Passos per referenciar ADO:</h2>
<div class='content'><ol>
<li>Obre l'Editor VBA (Alt + F11).</li>
<li>Ves a <code>Eines</code> &gt; <code>Referències</code>.</li>
<li>Cerca i selecciona <code>Microsoft ActiveX Data Objects x.x Library</code> (on x.x és la versió de la biblioteca).</li>
</ol>
</div><h1><ol start="3">
<li>Establir una connexió amb la base de dades</li>
</ol></h1>
<div class='content'><p>Per establir una connexió amb una base de dades, necessitem una cadena de connexió que contingui la informació necessària per connectar-nos a la base de dades.</p>
</div><h2>Exemple de codi:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIENvbm5lY3RUb0RhdGFiYXNlKCkKICAgIERpbSBjb25uIEFzIE9iamVjdAogICAgU2V0IGNvbm4gPSBDcmVhdGVPYmplY3QoIkFET0RCLkNvbm5lY3Rpb24iKQogICAgCiAgICBEaW0gY29ubmVjdGlvblN0cmluZyBBcyBTdHJpbmcKICAgIGNvbm5lY3Rpb25TdHJpbmcgPSAiUHJvdmlkZXI9TWljcm9zb2Z0LkFDRS5PTEVEQi4xMi4wO0RhdGEgU291cmNlPUM6XHBhdGhcdG9ceW91clxkYXRhYmFzZS5hY2NkYjsiCiAgICAKICAgIGNvbm4uT3BlbiBjb25uZWN0aW9uU3RyaW5nCiAgICAKICAgIElmIGNvbm4uU3RhdGUgPSAxIFRoZW4KICAgICAgICBNc2dCb3ggIkNvbm5leGnDsyBlc3RhYmxlcnRhIGNvcnJlY3RhbWVudCEiCiAgICBFbHNlCiAgICAgICAgTXNnQm94ICJObyBzJ2hhIHBvZ3V0IGVzdGFibGlyIGxhIGNvbm5leGnDsy4iCiAgICBFbmQgSWYKICAgIAogICAgY29ubi5DbG9zZQogICAgU2V0IGNvbm4gPSBOb3RoaW5nCkVuZCBTdWI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub ConnectToDatabase()
    Dim conn As Object
    Set conn = CreateObject(&quot;ADODB.Connection&quot;)
    
    Dim connectionString As String
    connectionString = &quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\path\to\your\database.accdb;&quot;
    
    conn.Open connectionString
    
    If conn.State = 1 Then
        MsgBox &quot;Connexi&oacute; establerta correctament!&quot;
    Else
        MsgBox &quot;No s'ha pogut establir la connexi&oacute;.&quot;
    End If
    
    conn.Close
    Set conn = Nothing
End Sub</pre></div><div class='content'></div><h2>Explicació del codi:</h2>
<div class='content'><ul>
<li><strong>CreateObject(&quot;ADODB.Connection&quot;)</strong>: Crea una instància de l'objecte de connexió ADO.</li>
<li><strong>connectionString</strong>: Conté la informació necessària per connectar-se a la base de dades.</li>
<li><strong>conn.Open</strong>: Estableix la connexió amb la base de dades.</li>
<li><strong>conn.State</strong>: Verifica l'estat de la connexió (1 significa que la connexió està oberta).</li>
<li><strong>conn.Close</strong>: Tanca la connexió.</li>
</ul>
</div><h1><ol start="4">
<li>Executar consultes SQL</li>
</ol></h1>
<div class='content'><p>Un cop establerta la connexió, podem executar consultes SQL per recuperar o manipular dades.</p>
</div><h2>Exemple de codi per executar una consulta SELECT:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEV4ZWN1dGVTZWxlY3RRdWVyeSgpCiAgICBEaW0gY29ubiBBcyBPYmplY3QKICAgIERpbSBycyBBcyBPYmplY3QKICAgIFNldCBjb25uID0gQ3JlYXRlT2JqZWN0KCJBRE9EQi5Db25uZWN0aW9uIikKICAgIFNldCBycyA9IENyZWF0ZU9iamVjdCgiQURPREIuUmVjb3Jkc2V0IikKICAgIAogICAgRGltIGNvbm5lY3Rpb25TdHJpbmcgQXMgU3RyaW5nCiAgICBjb25uZWN0aW9uU3RyaW5nID0gIlByb3ZpZGVyPU1pY3Jvc29mdC5BQ0UuT0xFREIuMTIuMDtEYXRhIFNvdXJjZT1DOlxwYXRoXHRvXHlvdXJcZGF0YWJhc2UuYWNjZGI7IgogICAgCiAgICBjb25uLk9wZW4gY29ubmVjdGlvblN0cmluZwogICAgCiAgICBEaW0gc3FsIEFzIFN0cmluZwogICAgc3FsID0gIlNFTEVDVCAqIEZST00gWW91clRhYmxlIgogICAgCiAgICBycy5PcGVuIHNxbCwgY29ubgogICAgCiAgICBEbyBXaGlsZSBOb3QgcnMuRU9GCiAgICAgICAgRGVidWcuUHJpbnQgcnMuRmllbGRzKCJZb3VyRmllbGROYW1lIikuVmFsdWUKICAgICAgICBycy5Nb3ZlTmV4dAogICAgTG9vcAogICAgCiAgICBycy5DbG9zZQogICAgY29ubi5DbG9zZQogICAgU2V0IHJzID0gTm90aGluZwogICAgU2V0IGNvbm4gPSBOb3RoaW5nCkVuZCBTdWI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub ExecuteSelectQuery()
    Dim conn As Object
    Dim rs As Object
    Set conn = CreateObject(&quot;ADODB.Connection&quot;)
    Set rs = CreateObject(&quot;ADODB.Recordset&quot;)
    
    Dim connectionString As String
    connectionString = &quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\path\to\your\database.accdb;&quot;
    
    conn.Open connectionString
    
    Dim sql As String
    sql = &quot;SELECT * FROM YourTable&quot;
    
    rs.Open sql, conn
    
    Do While Not rs.EOF
        Debug.Print rs.Fields(&quot;YourFieldName&quot;).Value
        rs.MoveNext
    Loop
    
    rs.Close
    conn.Close
    Set rs = Nothing
    Set conn = Nothing
End Sub</pre></div><div class='content'></div><h2>Explicació del codi:</h2>
<div class='content'><ul>
<li><strong>rs.Open sql, conn</strong>: Executa la consulta SQL i emmagatzema els resultats en l'objecte Recordset.</li>
<li><strong>rs.EOF</strong>: Comprova si s'ha arribat al final del Recordset.</li>
<li><strong>rs.Fields(&quot;YourFieldName&quot;).Value</strong>: Accedeix al valor d'un camp específic en el Recordset.</li>
<li><strong>rs.MoveNext</strong>: Mou el cursor al següent registre del Recordset.</li>
</ul>
</div><h1><ol start="5">
<li>Manipular dades</li>
</ol></h1>
<div class='content'><p>A més de recuperar dades, també podem inserir, actualitzar i eliminar registres en la base de dades.</p>
</div><h2>Exemple de codi per inserir un registre:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEluc2VydFJlY29yZCgpCiAgICBEaW0gY29ubiBBcyBPYmplY3QKICAgIFNldCBjb25uID0gQ3JlYXRlT2JqZWN0KCJBRE9EQi5Db25uZWN0aW9uIikKICAgIAogICAgRGltIGNvbm5lY3Rpb25TdHJpbmcgQXMgU3RyaW5nCiAgICBjb25uZWN0aW9uU3RyaW5nID0gIlByb3ZpZGVyPU1pY3Jvc29mdC5BQ0UuT0xFREIuMTIuMDtEYXRhIFNvdXJjZT1DOlxwYXRoXHRvXHlvdXJcZGF0YWJhc2UuYWNjZGI7IgogICAgCiAgICBjb25uLk9wZW4gY29ubmVjdGlvblN0cmluZwogICAgCiAgICBEaW0gc3FsIEFzIFN0cmluZwogICAgc3FsID0gIklOU0VSVCBJTlRPIFlvdXJUYWJsZSAoRmllbGROYW1lMSwgRmllbGROYW1lMikgVkFMVUVTICgnVmFsdWUxJywgJ1ZhbHVlMicpIgogICAgCiAgICBjb25uLkV4ZWN1dGUgc3FsCiAgICAKICAgIGNvbm4uQ2xvc2UKICAgIFNldCBjb25uID0gTm90aGluZwpFbmQgU3Vi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub InsertRecord()
    Dim conn As Object
    Set conn = CreateObject(&quot;ADODB.Connection&quot;)
    
    Dim connectionString As String
    connectionString = &quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\path\to\your\database.accdb;&quot;
    
    conn.Open connectionString
    
    Dim sql As String
    sql = &quot;INSERT INTO YourTable (FieldName1, FieldName2) VALUES ('Value1', 'Value2')&quot;
    
    conn.Execute sql
    
    conn.Close
    Set conn = Nothing
End Sub</pre></div><div class='content'></div><h2>Explicació del codi:</h2>
<div class='content'><ul>
<li><strong>conn.Execute sql</strong>: Executa la instrucció SQL per inserir un nou registre en la taula especificada.</li>
</ul>
</div><h1>Exercicis pràctics</h1>
<div class='content'></div><h2>Exercici 1: Establir una connexió</h2>
<div class='content'><p>Escriu un codi VBA que estableixi una connexió amb una base de dades Access i mostri un missatge si la connexió és exitosa.</p>
</div><h2>Exercici 2: Executar una consulta SELECT</h2>
<div class='content'><p>Escriu un codi VBA que executi una consulta SELECT per recuperar tots els registres d'una taula i mostri els valors d'un camp específic en la finestra de depuració.</p>
</div><h2>Exercici 3: Inserir un registre</h2>
<div class='content'><p>Escriu un codi VBA que insereixi un nou registre en una taula de la base de dades.</p>
</div><h1>Solucions</h1>
<div class='content'></div><h2>Solució a l'Exercici 1:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEV4ZXJjaXNlMSgpCiAgICBEaW0gY29ubiBBcyBPYmplY3QKICAgIFNldCBjb25uID0gQ3JlYXRlT2JqZWN0KCJBRE9EQi5Db25uZWN0aW9uIikKICAgIAogICAgRGltIGNvbm5lY3Rpb25TdHJpbmcgQXMgU3RyaW5nCiAgICBjb25uZWN0aW9uU3RyaW5nID0gIlByb3ZpZGVyPU1pY3Jvc29mdC5BQ0UuT0xFREIuMTIuMDtEYXRhIFNvdXJjZT1DOlxwYXRoXHRvXHlvdXJcZGF0YWJhc2UuYWNjZGI7IgogICAgCiAgICBjb25uLk9wZW4gY29ubmVjdGlvblN0cmluZwogICAgCiAgICBJZiBjb25uLlN0YXRlID0gMSBUaGVuCiAgICAgICAgTXNnQm94ICJDb25uZXhpw7MgZXN0YWJsZXJ0YSBjb3JyZWN0YW1lbnQhIgogICAgRWxzZQogICAgICAgIE1zZ0JveCAiTm8gcydoYSBwb2d1dCBlc3RhYmxpciBsYSBjb25uZXhpw7MuIgogICAgRW5kIElmCiAgICAKICAgIGNvbm4uQ2xvc2UKICAgIFNldCBjb25uID0gTm90aGluZwpFbmQgU3Vi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub Exercise1()
    Dim conn As Object
    Set conn = CreateObject(&quot;ADODB.Connection&quot;)
    
    Dim connectionString As String
    connectionString = &quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\path\to\your\database.accdb;&quot;
    
    conn.Open connectionString
    
    If conn.State = 1 Then
        MsgBox &quot;Connexi&oacute; establerta correctament!&quot;
    Else
        MsgBox &quot;No s'ha pogut establir la connexi&oacute;.&quot;
    End If
    
    conn.Close
    Set conn = Nothing
End Sub</pre></div><div class='content'></div><h2>Solució a l'Exercici 2:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEV4ZXJjaXNlMigpCiAgICBEaW0gY29ubiBBcyBPYmplY3QKICAgIERpbSBycyBBcyBPYmplY3QKICAgIFNldCBjb25uID0gQ3JlYXRlT2JqZWN0KCJBRE9EQi5Db25uZWN0aW9uIikKICAgIFNldCBycyA9IENyZWF0ZU9iamVjdCgiQURPREIuUmVjb3Jkc2V0IikKICAgIAogICAgRGltIGNvbm5lY3Rpb25TdHJpbmcgQXMgU3RyaW5nCiAgICBjb25uZWN0aW9uU3RyaW5nID0gIlByb3ZpZGVyPU1pY3Jvc29mdC5BQ0UuT0xFREIuMTIuMDtEYXRhIFNvdXJjZT1DOlxwYXRoXHRvXHlvdXJcZGF0YWJhc2UuYWNjZGI7IgogICAgCiAgICBjb25uLk9wZW4gY29ubmVjdGlvblN0cmluZwogICAgCiAgICBEaW0gc3FsIEFzIFN0cmluZwogICAgc3FsID0gIlNFTEVDVCAqIEZST00gWW91clRhYmxlIgogICAgCiAgICBycy5PcGVuIHNxbCwgY29ubgogICAgCiAgICBEbyBXaGlsZSBOb3QgcnMuRU9GCiAgICAgICAgRGVidWcuUHJpbnQgcnMuRmllbGRzKCJZb3VyRmllbGROYW1lIikuVmFsdWUKICAgICAgICBycy5Nb3ZlTmV4dAogICAgTG9vcAogICAgCiAgICBycy5DbG9zZQogICAgY29ubi5DbG9zZQogICAgU2V0IHJzID0gTm90aGluZwogICAgU2V0IGNvbm4gPSBOb3RoaW5nCkVuZCBTdWI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub Exercise2()
    Dim conn As Object
    Dim rs As Object
    Set conn = CreateObject(&quot;ADODB.Connection&quot;)
    Set rs = CreateObject(&quot;ADODB.Recordset&quot;)
    
    Dim connectionString As String
    connectionString = &quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\path\to\your\database.accdb;&quot;
    
    conn.Open connectionString
    
    Dim sql As String
    sql = &quot;SELECT * FROM YourTable&quot;
    
    rs.Open sql, conn
    
    Do While Not rs.EOF
        Debug.Print rs.Fields(&quot;YourFieldName&quot;).Value
        rs.MoveNext
    Loop
    
    rs.Close
    conn.Close
    Set rs = Nothing
    Set conn = Nothing
End Sub</pre></div><div class='content'></div><h2>Solució a l'Exercici 3:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEV4ZXJjaXNlMygpCiAgICBEaW0gY29ubiBBcyBPYmplY3QKICAgIFNldCBjb25uID0gQ3JlYXRlT2JqZWN0KCJBRE9EQi5Db25uZWN0aW9uIikKICAgIAogICAgRGltIGNvbm5lY3Rpb25TdHJpbmcgQXMgU3RyaW5nCiAgICBjb25uZWN0aW9uU3RyaW5nID0gIlByb3ZpZGVyPU1pY3Jvc29mdC5BQ0UuT0xFREIuMTIuMDtEYXRhIFNvdXJjZT1DOlxwYXRoXHRvXHlvdXJcZGF0YWJhc2UuYWNjZGI7IgogICAgCiAgICBjb25uLk9wZW4gY29ubmVjdGlvblN0cmluZwogICAgCiAgICBEaW0gc3FsIEFzIFN0cmluZwogICAgc3FsID0gIklOU0VSVCBJTlRPIFlvdXJUYWJsZSAoRmllbGROYW1lMSwgRmllbGROYW1lMikgVkFMVUVTICgnVmFsdWUxJywgJ1ZhbHVlMicpIgogICAgCiAgICBjb25uLkV4ZWN1dGUgc3FsCiAgICAKICAgIGNvbm4uQ2xvc2UKICAgIFNldCBjb25uID0gTm90aGluZwpFbmQgU3Vi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub Exercise3()
    Dim conn As Object
    Set conn = CreateObject(&quot;ADODB.Connection&quot;)
    
    Dim connectionString As String
    connectionString = &quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\path\to\your\database.accdb;&quot;
    
    conn.Open connectionString
    
    Dim sql As String
    sql = &quot;INSERT INTO YourTable (FieldName1, FieldName2) VALUES ('Value1', 'Value2')&quot;
    
    conn.Execute sql
    
    conn.Close
    Set conn = Nothing
End Sub</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>En aquest tema, hem après com accedir a bases de dades des de VBA utilitzant ADO. Hem vist com establir una connexió, executar consultes SQL i manipular dades. Aquests coneixements ens permetran treballar amb dades emmagatzemades en bases de dades externes de manera eficient i efectiva. En el proper tema, explorarem com utilitzar VBA per controlar PowerPoint.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-automating-outlook-vba' title="Automatitzar Outlook amb VBA" class="py-2 px-3 btn btn-primary d-none d-md-inline">
				&#x25C4; Anterior 
			</a>
			<a href='05-02-automating-outlook-vba' title="Automatitzar Outlook amb VBA" class="py-2 px-3 btn btn-primary d-md-none">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-using-vba-control-powerpoint' title="Utilitzar VBA per controlar PowerPoint" class="py-2 px-3 d-none d-md-inline btn btn-primary"
				data-read-mod="vba" data-read-unit="05-03">
				Següent &#x25BA;
			</a>
			<a href='05-04-using-vba-control-powerpoint' title="Utilitzar VBA per controlar PowerPoint" class="py-2 px-3 d-md-none btn btn-primary" 
				data-read-mod="vba" data-read-unit="05-03">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

			
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curs de VBA (Visual Basic for Applications)</h1>
<h2>Mòdul 1: Introducció a VBA</h2>
<ul>
<li><a href="01-01-what-is-vba">Què és VBA?</a></li>
<li><a href="01-02-setting-up-vba-environment">Configuració de l'entorn VBA</a></li>
<li><a href="01-03-first-vba-program">Primer programa VBA</a></li>
<li><a href="01-04-understanding-vba-editor">Comprendre l'editor VBA</a></li>
</ul>
<h2>Mòdul 2: Conceptes bàsics de VBA</h2>
<ul>
<li><a href="02-01-variables-data-types">Variables i tipus de dades</a></li>
<li><a href="02-02-operators-in-vba">Operadors en VBA</a></li>
<li><a href="02-03-control-structures-if-then-else">Estructures de control: If...Then...Else</a></li>
<li><a href="02-04-loops-for-while-do-until">Bucles: For, While, Do Until</a></li>
<li><a href="02-05-working-with-arrays">Treballar amb arrays</a></li>
</ul>
<h2>Mòdul 3: Treballar amb objectes d'Excel</h2>
<ul>
<li><a href="03-01-understanding-excel-object-model">Comprendre el model d'objectes d'Excel</a></li>
<li><a href="03-02-working-with-workbooks-worksheets">Treballar amb llibres i fulls de càlcul</a></li>
<li><a href="03-03-manipulating-cells-ranges">Manipulació de cel·les i rangs</a></li>
<li><a href="03-04-using-range-object">Utilitzar l'objecte Range</a></li>
<li><a href="03-05-formatting-cells-vba">Formatar cel·les amb VBA</a></li>
</ul>
<h2>Mòdul 4: Programació avançada en VBA</h2>
<ul>
<li><a href="04-01-creating-using-functions">Crear i utilitzar funcions</a></li>
<li><a href="04-02-error-handling-vba">Gestió d'errors en VBA</a></li>
<li><a href="04-03-debugging-techniques">Tècniques de depuració</a></li>
<li><a href="04-04-working-with-userforms">Treballar amb UserForms</a></li>
<li><a href="04-05-event-driven-programming">Programació basada en esdeveniments</a></li>
</ul>
<h2>Mòdul 5: Interactuar amb altres aplicacions</h2>
<ul>
<li><a href="05-01-automating-word-vba">Automatitzar Word amb VBA</a></li>
<li><a href="05-02-automating-outlook-vba">Automatitzar Outlook amb VBA</a></li>
<li><a href="05-03-accessing-databases-vba">Accedir a bases de dades amb VBA</a></li>
<li><a href="05-04-using-vba-control-powerpoint">Utilitzar VBA per controlar PowerPoint</a></li>
</ul>
<h2>Mòdul 6: Millors pràctiques i optimització</h2>
<ul>
<li><a href="06-01-writing-efficient-vba-code">Escriure codi VBA eficient</a></li>
<li><a href="06-02-code-refactoring-techniques">Tècniques de refactorització de codi</a></li>
<li><a href="06-03-documenting-your-code">Documentar el teu codi</a></li>
<li><a href="06-04-version-control-vba-projects">Control de versions per a projectes VBA</a></li>
</ul>
<h2>Mòdul 7: Projectes del món real</h2>
<ul>
<li><a href="07-01-automating-reports-excel">Automatitzar informes a Excel</a></li>
<li><a href="07-02-creating-custom-excel-addin">Crear un complement personalitzat d'Excel</a></li>
<li><a href="07-03-building-data-entry-form">Construir un formulari d'entrada de dades</a></li>
<li><a href="07-04-developing-dashboard-vba">Desenvolupar un quadre de comandament amb VBA</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuari no autentificat</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<p id="loginModalEmail"></p>
            	<div id="mensaje" class="error"></div>
            	<div id="mensaje_info" class="text-success"></div>
            	
				<div class="mt-4 d-none" id="forgotPasswordSection">
					<div class="mb-3">
    <label for="recovery-email" class="form-label">Correu electrònic</label>
    <input type="email" required class="form-control" id="recovery-email" placeholder="Introdueix el teu correu electrònic">
</div>
<button class="btn btn-primary" id="btnRecover">Enviar enllaç de recuperació</button>

				</div>
								
				<div class="mt-4 d-none" id="deleteUserSection">	
					<div class="mb-3 alert alert-danger">
	Atenció! Estàs a punt d'eliminar totes les dades de registre i progrés.<br><b>Aquesta acció no es pot desfer.</b>
</div>
<div class="mb-3">
    <input type="password" required class="form-control" id="delete-user-pwd" placeholder="Introdueix la teva contrasenya">
</div>
<button class="btn btn-primary" id="btnDeleteUser">Eliminar usuari</button>

				</div>
				
				<div class="mt-4 d-none" id="changePassordSection">
					<div class="mb-3 row">
	<div class="col col-12 my-2">
	    <input type="password" required class="form-control" id="change-pwd-actual" placeholder="Introdueix la contrasenya actual">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-1" placeholder="Introdueix la nova contrasenya">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-2" placeholder="Repeteix la nova contrasenya">
	</div>
</div>
<button class="btn btn-primary" id="btnChangePassword">Canviar la contrasenya</button>

				</div>
				
				<div class="mt-4 d-none alert alert-warning" id="verifyPasswordSection">
					<p><b>Falta verificar correu</b></p>
					<a id="btnVerifyEmail" href="#">Enviar enllaç de verificació</a>

				</div>
				
				<div class="mt-4 d-none" id="disconnectUserSection">
					<div class="mb-3">
    <button id="btnDisconnect" class="btn btn-primary">Desconnectar</button>
</div>

<hr>

<div class="mt-3">
    <button class="btn btn-outline-secondary" id="change-password-link">Canviar la contrasenya</button>
</div>

<div class="mt-3">
    <a href="#" id="delete-user-link">Eliminar usuari</a>
</div>

				</div>
            
            	<div class="mt-4 d-none" id="modalTabsSection">
            		<ul class="nav nav-tabs" id="authTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login" type="button" role="tab" aria-controls="login" aria-selected="true">
        	Iniciar sessió
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="register-tab" data-bs-toggle="tab" data-bs-target="#register" type="button" role="tab" aria-controls="register" aria-selected="false">
        	Registrar-se
        </button>
    </li>
</ul>

<div class="tab-content mt-3" id="authTabsContent">
    <div class="tab-pane fade show active" id="login" role="tabpanel" aria-labelledby="login-tab">
    	<div class="mb-3">
    <label for="login-username" class="form-label">Correu electrònic</label>
    <input type="email" required class="form-control" id="login-username" placeholder="Introdueix el teu correu electrònic">
</div>
<div class="mb-3">
    <label for="login-password" class="form-label">Contrasenya</label>
    <input type="password"  required class="form-control" id="login-password" placeholder="Introdueix la teva contrasenya">
</div>
<button class="btn btn-primary" id="btnLogin">Iniciar sessió</button>
<div class="mt-3">
    <a href="#" id="forgot-password-link">Has oblidat la teva contrasenya?</a>
</div>
    </div>

    <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
    	<div class="mb-3">
    <label for="register-email" class="form-label">Correu electrònic</label>
    <input type="email" class="form-control" id="register-email" required placeholder="Introdueix el teu correu electrònic">
</div>

<div class="mb-3">
    <label for="register-password" class="form-label">Contrasenya</label>
    <input type="password" class="form-control"  required id="register-password" placeholder="Introdueix la teva contrasenya">
</div>

<div class="mb-3">
    <label for="register-name" class="form-label">Nom</label>
    <input type="text" class="form-control"  required id="register-name" placeholder="Introdueix el teu nom">
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-conditions-reg">
    <label for="accept-conditions-reg" class="form-check-label">
        He llegit i accepto la <a href="/privacity" target="blank">Política de Privacitat</a> i els <a href="/licence" target="blank">Termes i Condicions d'Ús</a>.
    </label>
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-allow_comunications">
    <label for="accept-allow_comunications" class="form-check-label">
        Vull rebre notícies i actualitzacions sobre els cursos (opcional).
    </label>
</div>

<button id="btnRegister" class="btn btn-primary">Registrar-se</button>
    </div>
</div>
            	</div>
            </div>
        </div>
    </div>
</div>

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
