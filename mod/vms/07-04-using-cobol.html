<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ús de COBOL a OpenVMS</title>

    <link rel="alternate" href="https://campusempresa.com/mod/vms/07-04-using-cobol" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/vms/07-04-using-cobol" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/vms/07-04-using-cobol" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/vms/07-04-using-cobol" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/vms/07-04-using-cobol" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-using-fortran' title="Ús de Fortran a OpenVMS">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Ús de COBOL a OpenVMS</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-05-interfacing-system-services' title="Interfície amb Serveis del Sistema">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>COBOL (Common Business-Oriented Language) és un llenguatge de programació dissenyat per a aplicacions de negocis. És conegut per la seva llegibilitat i la seva capacitat per gestionar grans volums de dades. En aquest mòdul, aprendrem com utilitzar COBOL en l'entorn OpenVMS.</p>
</div><h1>Continguts</h1>
<div class='content'><ol>
<li><a href="#instal·lació-del-compilador-cobol-a-openvms">Instal·lació del Compilador COBOL a OpenVMS</a></li>
<li><a href="#estructura-bàsica-dun-programa-cobol">Estructura Bàsica d'un Programa COBOL</a></li>
<li><a href="#compilació-i-execució-de-programes-cobol">Compilació i Execució de Programes COBOL</a></li>
<li><a href="#gestió-de-fitxers-amb-cobol">Gestió de Fitxers amb COBOL</a></li>
<li><a href="#interfície-amb-serveis-del-sistema">Interfície amb Serveis del Sistema</a></li>
<li><a href="#exercicis-pràctics">Exercicis Pràctics</a></li>
</ol>
</div><h1>Instal·lació del Compilador COBOL a OpenVMS</h1>
<div class='content'><p>Abans de començar a programar en COBOL, necessitem assegurar-nos que el compilador COBOL està instal·lat al sistema OpenVMS.</p>
</div><h2>Passos per a la Instal·lació</h2>
<div class='content'><ol>
<li>
<p><strong>Verificar la Presència del Compilador:</strong></p>
<pre><code class="language-shell">$ SHOW LOGICAL SYS$SYSTEM
</code></pre>
<p>Busca el fitxer <code>COBOL.EXE</code> en el directori del sistema.</p>
</li>
<li>
<p><strong>Instal·lació del Compilador (si no està present):</strong></p>
<ul>
<li>Contacta amb l'administrador del sistema per obtenir els fitxers d'instal·lació.</li>
<li>Executa el procediment d'instal·lació proporcionat.</li>
</ul>
</li>
</ol>
</div><h1>Estructura Bàsica d'un Programa COBOL</h1>
<div class='content'><p>Un programa COBOL típic consta de quatre divisions principals:</p>
<ol>
<li>
<p><strong>IDENTIFICATION DIVISION:</strong>
Conté informació sobre el programa, com el nom i l'autor.</p>
</li>
<li>
<p><strong>ENVIRONMENT DIVISION:</strong>
Defineix l'entorn en què s'executarà el programa, incloent-hi els fitxers d'entrada i sortida.</p>
</li>
<li>
<p><strong>DATA DIVISION:</strong>
Declara les variables i les estructures de dades utilitzades en el programa.</p>
</li>
<li>
<p><strong>PROCEDURE DIVISION:</strong>
Conté el codi executable del programa.</p>
</li>
</ol>
</div><h2>Exemple de Programa COBOL</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEhlbGxvV29ybGQuCgpFTlZJUk9OTUVOVCBESVZJU0lPTi4KCkRBVEEgRElWSVNJT04uCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBESVNQTEFZICdIZWxsbywgT3BlblZNUyBXb3JsZCEnLgogICAgU1RPUCBSVU4u"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. HelloWorld.

ENVIRONMENT DIVISION.

DATA DIVISION.

PROCEDURE DIVISION.
    DISPLAY 'Hello, OpenVMS World!'.
    STOP RUN.</pre></div><div class='content'></div><h1>Compilació i Execució de Programes COBOL</h1>
<div class='content'></div><h2>Compilació</h2>
<div class='content'><p>Per compilar un programa COBOL a OpenVMS, utilitza la comanda <code>COBOL</code> seguida del nom del fitxer font:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JCBDT0JPTCBIZWxsb1dvcmxkLkNPQg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$ COBOL HelloWorld.COB</pre></div><div class='content'><p>Això generarà un fitxer objecte (<code>HelloWorld.OBJ</code>).</p>
</div><h2>Enllaç</h2>
<div class='content'><p>Després de compilar, necessitem enllaçar el fitxer objecte per crear un executable:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JCBMSU5LIEhlbGxvV29ybGQ="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$ LINK HelloWorld</pre></div><div class='content'></div><h2>Execució</h2>
<div class='content'><p>Finalment, podem executar el programa resultant:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JCBSVU4gSGVsbG9Xb3JsZA=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$ RUN HelloWorld</pre></div><div class='content'></div><h1>Gestió de Fitxers amb COBOL</h1>
<div class='content'><p>COBOL és especialment potent en la gestió de fitxers. A continuació, es mostra un exemple de com llegir i escriure fitxers en COBOL.</p>
</div><h2>Exemple de Gestió de Fitxers</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEZpbGVFeGFtcGxlLgoKRU5WSVJPTk1FTlQgRElWSVNJT04uCklOUFVULU9VVFBVVCBTRUNUSU9OLgpGSUxFLUNPTlRST0wuCiAgICBTRUxFQ1QgSW5wdXRGaWxlIEFTU0lHTiBUTyAnaW5wdXQudHh0JwogICAgT1JHQU5JWkFUSU9OIElTIExJTkUgU0VRVUVOVElBTC4KICAgIFNFTEVDVCBPdXRwdXRGaWxlIEFTU0lHTiBUTyAnb3V0cHV0LnR4dCcKICAgIE9SR0FOSVpBVElPTiBJUyBMSU5FIFNFUVVFTlRJQUwuCgpEQVRBIERJVklTSU9OLgpGSUxFIFNFQ1RJT04uCkZEICBJbnB1dEZpbGUuCjAxICBJbnB1dFJlY29yZCBQSUMgWCgxMDApLgoKRkQgIE91dHB1dEZpbGUuCjAxICBPdXRwdXRSZWNvcmQgUElDIFgoMTAwKS4KCldPUktJTkctU1RPUkFHRSBTRUNUSU9OLgowMSAgV1MtRU9GIFBJQyBYIFZBTFVFICdOJy4KClBST0NFRFVSRSBESVZJU0lPTi4KICAgIE9QRU4gSU5QVVQgSW5wdXRGaWxlCiAgICBPUEVOIE9VVFBVVCBPdXRwdXRGaWxlCgogICAgUEVSRk9STSBVTlRJTCBXUy1FT0YgPSAnWScKICAgICAgICBSRUFEIElucHV0RmlsZSBJTlRPIElucHV0UmVjb3JkCiAgICAgICAgICAgIEFUIEVORAogICAgICAgICAgICAgICAgTU9WRSAnWScgVE8gV1MtRU9GCiAgICAgICAgICAgIE5PVCBBVCBFTkQKICAgICAgICAgICAgICAgIE1PVkUgSW5wdXRSZWNvcmQgVE8gT3V0cHV0UmVjb3JkCiAgICAgICAgICAgICAgICBXUklURSBPdXRwdXRSZWNvcmQKICAgICAgICBFTkQtUkVBRAogICAgRU5ELVBFUkZPUk0KCiAgICBDTE9TRSBJbnB1dEZpbGUKICAgIENMT1NFIE91dHB1dEZpbGUKICAgIFNUT1AgUlVOLg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. FileExample.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT InputFile ASSIGN TO 'input.txt'
    ORGANIZATION IS LINE SEQUENTIAL.
    SELECT OutputFile ASSIGN TO 'output.txt'
    ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  InputFile.
01  InputRecord PIC X(100).

FD  OutputFile.
01  OutputRecord PIC X(100).

WORKING-STORAGE SECTION.
01  WS-EOF PIC X VALUE 'N'.

PROCEDURE DIVISION.
    OPEN INPUT InputFile
    OPEN OUTPUT OutputFile

    PERFORM UNTIL WS-EOF = 'Y'
        READ InputFile INTO InputRecord
            AT END
                MOVE 'Y' TO WS-EOF
            NOT AT END
                MOVE InputRecord TO OutputRecord
                WRITE OutputRecord
        END-READ
    END-PERFORM

    CLOSE InputFile
    CLOSE OutputFile
    STOP RUN.</pre></div><div class='content'></div><h1>Interfície amb Serveis del Sistema</h1>
<div class='content'><p>COBOL a OpenVMS pot interactuar amb serveis del sistema per realitzar tasques avançades com la gestió de processos i la comunicació entre processos.</p>
</div><h2>Exemple d'Interfície amb Serveis del Sistema</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFN5c3RlbVNlcnZpY2VFeGFtcGxlLgoKRU5WSVJPTk1FTlQgRElWSVNJT04uCgpEQVRBIERJVklTSU9OLgpXT1JLSU5HLVNUT1JBR0UgU0VDVElPTi4KMDEgIFdTLVNUQVRVUyBQSUMgUzkoOSkgQ09NUC4KClBST0NFRFVSRSBESVZJU0lPTi4KICAgIENBTEwgJ0xJQiRHRVRKUEknIFVTSU5HIEJZIFZBTFVFIEpQSSRfUElECiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQlkgUkVGRVJFTkNFIFdTLVNUQVRVUwogICAgSUYgV1MtU1RBVFVTID0gMAogICAgICAgIERJU1BMQVkgJ1Byb2Nlc3MgSUQgb2J0YWluZWQgc3VjY2Vzc2Z1bGx5LicKICAgIEVMU0UKICAgICAgICBESVNQTEFZICdFcnJvciBvYnRhaW5pbmcgUHJvY2VzcyBJRC4nCiAgICBFTkQtSUYKICAgIFNUT1AgUlVOLg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. SystemServiceExample.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  WS-STATUS PIC S9(9) COMP.

PROCEDURE DIVISION.
    CALL 'LIB$GETJPI' USING BY VALUE JPI$_PID
                             BY REFERENCE WS-STATUS
    IF WS-STATUS = 0
        DISPLAY 'Process ID obtained successfully.'
    ELSE
        DISPLAY 'Error obtaining Process ID.'
    END-IF
    STOP RUN.</pre></div><div class='content'></div><h1>Exercicis Pràctics</h1>
<div class='content'></div><h2>Exercici 1: Programa Bàsic</h2>
<div class='content'><p>Escriu un programa COBOL que mostri el missatge &quot;Benvingut a OpenVMS amb COBOL!&quot;.</p>
</div><h2>Exercici 2: Gestió de Fitxers</h2>
<div class='content'><p>Crea un programa COBOL que llegeixi un fitxer d'entrada, modifiqui cada línia afegint un prefix &quot;Processed: &quot; i escrigui el resultat en un fitxer de sortida.</p>
</div><h2>Solucions</h2>
<div class='content'><h4>Solució Exercici 1</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFdlbGNvbWUuCgpFTlZJUk9OTUVOVCBESVZJU0lPTi4KCkRBVEEgRElWSVNJT04uCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBESVNQTEFZICdCZW52aW5ndXQgYSBPcGVuVk1TIGFtYiBDT0JPTCEnLgogICAgU1RPUCBSVU4u"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. Welcome.

ENVIRONMENT DIVISION.

DATA DIVISION.

PROCEDURE DIVISION.
    DISPLAY 'Benvingut a OpenVMS amb COBOL!'.
    STOP RUN.</pre></div><div class='content'><h4>Solució Exercici 2</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFByb2Nlc3NGaWxlLgoKRU5WSVJPTk1FTlQgRElWSVNJT04uCklOUFVULU9VVFBVVCBTRUNUSU9OLgpGSUxFLUNPTlRST0wuCiAgICBTRUxFQ1QgSW5wdXRGaWxlIEFTU0lHTiBUTyAnaW5wdXQudHh0JwogICAgT1JHQU5JWkFUSU9OIElTIExJTkUgU0VRVUVOVElBTC4KICAgIFNFTEVDVCBPdXRwdXRGaWxlIEFTU0lHTiBUTyAnb3V0cHV0LnR4dCcKICAgIE9SR0FOSVpBVElPTiBJUyBMSU5FIFNFUVVFTlRJQUwuCgpEQVRBIERJVklTSU9OLgpGSUxFIFNFQ1RJT04uCkZEICBJbnB1dEZpbGUuCjAxICBJbnB1dFJlY29yZCBQSUMgWCgxMDApLgoKRkQgIE91dHB1dEZpbGUuCjAxICBPdXRwdXRSZWNvcmQgUElDIFgoMTAwKS4KCldPUktJTkctU1RPUkFHRSBTRUNUSU9OLgowMSAgV1MtRU9GIFBJQyBYIFZBTFVFICdOJy4KClBST0NFRFVSRSBESVZJU0lPTi4KICAgIE9QRU4gSU5QVVQgSW5wdXRGaWxlCiAgICBPUEVOIE9VVFBVVCBPdXRwdXRGaWxlCgogICAgUEVSRk9STSBVTlRJTCBXUy1FT0YgPSAnWScKICAgICAgICBSRUFEIElucHV0RmlsZSBJTlRPIElucHV0UmVjb3JkCiAgICAgICAgICAgIEFUIEVORAogICAgICAgICAgICAgICAgTU9WRSAnWScgVE8gV1MtRU9GCiAgICAgICAgICAgIE5PVCBBVCBFTkQKICAgICAgICAgICAgICAgIE1PVkUgJ1Byb2Nlc3NlZDogJyBUTyBPdXRwdXRSZWNvcmQKICAgICAgICAgICAgICAgIFNUUklORyBJbnB1dFJlY29yZCBERUxJTUlURUQgQlkgU0laRQogICAgICAgICAgICAgICAgICAgICAgIElOVE8gT3V0cHV0UmVjb3JkIFdJVEggUE9JTlRFUiAxMQogICAgICAgICAgICAgICAgV1JJVEUgT3V0cHV0UmVjb3JkCiAgICAgICAgRU5ELVJFQUQKICAgIEVORC1QRVJGT1JNCgogICAgQ0xPU0UgSW5wdXRGaWxlCiAgICBDTE9TRSBPdXRwdXRGaWxlCiAgICBTVE9QIFJVTi4="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. ProcessFile.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT InputFile ASSIGN TO 'input.txt'
    ORGANIZATION IS LINE SEQUENTIAL.
    SELECT OutputFile ASSIGN TO 'output.txt'
    ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  InputFile.
01  InputRecord PIC X(100).

FD  OutputFile.
01  OutputRecord PIC X(100).

WORKING-STORAGE SECTION.
01  WS-EOF PIC X VALUE 'N'.

PROCEDURE DIVISION.
    OPEN INPUT InputFile
    OPEN OUTPUT OutputFile

    PERFORM UNTIL WS-EOF = 'Y'
        READ InputFile INTO InputRecord
            AT END
                MOVE 'Y' TO WS-EOF
            NOT AT END
                MOVE 'Processed: ' TO OutputRecord
                STRING InputRecord DELIMITED BY SIZE
                       INTO OutputRecord WITH POINTER 11
                WRITE OutputRecord
        END-READ
    END-PERFORM

    CLOSE InputFile
    CLOSE OutputFile
    STOP RUN.</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>En aquest mòdul, hem après com utilitzar COBOL a l'entorn OpenVMS, des de la instal·lació del compilador fins a la gestió de fitxers i la interfície amb serveis del sistema. Els exercicis pràctics proporcionats ajuden a consolidar els conceptes apresos. En el següent mòdul, explorarem la interfície amb altres llenguatges de programació a OpenVMS.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-using-fortran' title="Ús de Fortran a OpenVMS">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-05-interfacing-system-services' title="Interfície amb Serveis del Sistema">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
