<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ús d'Invoke-Command</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/using-invoke-command" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/using-invoke-command" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/using-invoke-command" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/powershell/using-invoke-command" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/powershell/using-invoke-command" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='configuring-remoting'>&#x25C4;Configurar la Remotització</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Ús d'Invoke-Command</a>
	</div>
	<div class='col-4 text-end'>
					<a href='automating-tasks-with-scheduled-jobs'>Automatitzar Tasques amb Feines Programades &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció a Invoke-Command</h1>
<div class='content'><p>Invoke-Command és un cmdlet potent a PowerShell que et permet executar comandes en ordinadors locals i remots. Això és particularment útil per gestionar múltiples sistemes des d'un únic punt de control.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Cmdlet</strong>: Una comanda lleugera utilitzada en l'entorn PowerShell.</li>
<li><strong>Execució Remota</strong>: Executar comandes en una màquina diferent de la que estàs utilitzant actualment.</li>
<li><strong>Sessió</strong>: Una connexió persistent a un ordinador remot.</li>
</ul>
</div><h1>Ús Bàsic d'Invoke-Command</h1>
<div class='content'><p>Invoke-Command es pot utilitzar per executar comandes simples en ordinadors locals o remots.</p>
</div><h2>Executar Comandes Localment</h2>
<div class='content'><p>Pots utilitzar Invoke-Command per executar una comanda en la teva màquina local.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLVNjcmlwdEJsb2NrIHsgR2V0LVByb2Nlc3MgfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><strong>-ScriptBlock</strong>: Defineix el bloc de codi a executar.</li>
<li><strong>Get-Process</strong>: Un cmdlet que recupera els processos que s'estan executant en la màquina local.</li>
</ul>
</div><h2>Executar Comandes Remotament</h2>
<div class='content'><p>Per executar comandes en un ordinador remot, has d'especificar el nom de l'ordinador.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAiUmVtb3RlUEMiIC1TY3JpcHRCbG9jayB7IEdldC1Qcm9jZXNzIH0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &quot;RemotePC&quot; -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><strong>-ComputerName</strong>: Especifica l'ordinador remot en el qual executar la comanda.</li>
</ul>
</div><h1>Ús Avançat d'Invoke-Command</h1>
<div class='content'><p>Invoke-Command ofereix funcions més avançades com executar comandes en múltiples ordinadors i utilitzar credencials.</p>
</div><h2>Executar Comandes en Múltiples Ordinadors</h2>
<div class='content'><p>Pots executar una comanda en múltiples ordinadors remots especificant una matriu de noms d'ordinadors.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAiUmVtb3RlUEMxIiwgIlJlbW90ZVBDMiIgLVNjcmlwdEJsb2NrIHsgR2V0LVByb2Nlc3MgfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &quot;RemotePC1&quot;, &quot;RemotePC2&quot; -ScriptBlock { Get-Process }</pre></div><div class='content'></div><h2>Utilitzar Credencials</h2>
<div class='content'><p>Si l'ordinador remot requereix credencials diferents, pots utilitzar el paràmetre -Credential.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNyZWQgPSBHZXQtQ3JlZGVudGlhbApJbnZva2UtQ29tbWFuZCAtQ29tcHV0ZXJOYW1lICJSZW1vdGVQQyIgLUNyZWRlbnRpYWwgJGNyZWQgLVNjcmlwdEJsb2NrIHsgR2V0LVByb2Nlc3MgfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$cred = Get-Credential
Invoke-Command -ComputerName &quot;RemotePC&quot; -Credential $cred -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><strong>Get-Credential</strong>: Sol·licita un nom d'usuari i una contrasenya.</li>
<li><strong>-Credential</strong>: Especifica el compte d'usuari a utilitzar quan s'executa la comanda.</li>
</ul>
</div><h2>Utilitzar Sessions</h2>
<div class='content'><p>Per a escenaris més complexos, pots crear una sessió persistent a un ordinador remot.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JHNlc3Npb24gPSBOZXctUFNTZXNzaW9uIC1Db21wdXRlck5hbWUgIlJlbW90ZVBDIgpJbnZva2UtQ29tbWFuZCAtU2Vzc2lvbiAkc2Vzc2lvbiAtU2NyaXB0QmxvY2sgeyBHZXQtUHJvY2VzcyB9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$session = New-PSSession -ComputerName &quot;RemotePC&quot;
Invoke-Command -Session $session -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><strong>New-PSSession</strong>: Crea una nova sessió a un ordinador remot.</li>
<li><strong>-Session</strong>: Especifica la sessió a utilitzar per a la comanda.</li>
</ul>
</div><h1>Gestió d'Errors i Sortida</h1>
<div class='content'><p>Invoke-Command proporciona mecanismes per gestionar errors i capturar la sortida.</p>
</div><h2>Capturar la Sortida</h2>
<div class='content'><p>Pots capturar la sortida de la comanda en una variable.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JG91dHB1dCA9IEludm9rZS1Db21tYW5kIC1Db21wdXRlck5hbWUgIlJlbW90ZVBDIiAtU2NyaXB0QmxvY2sgeyBHZXQtUHJvY2VzcyB9CiRvdXRwdXQ="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$output = Invoke-Command -ComputerName &quot;RemotePC&quot; -ScriptBlock { Get-Process }
$output</pre></div><div class='content'></div><h2>Gestió d'Errors</h2>
<div class='content'><p>Pots gestionar errors utilitzant blocs try-catch.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJ5IHsKICAgIEludm9rZS1Db21tYW5kIC1Db21wdXRlck5hbWUgIlJlbW90ZVBDIiAtU2NyaXB0QmxvY2sgeyBHZXQtUHJvY2VzcyB9Cn0gY2F0Y2ggewogICAgV3JpdGUtSG9zdCAiUydoYSBwcm9kdcOvdCB1biBlcnJvcjogJF8iCn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>try {
    Invoke-Command -ComputerName &quot;RemotePC&quot; -ScriptBlock { Get-Process }
} catch {
    Write-Host &quot;S'ha produ&iuml;t un error: $_&quot;
}</pre></div><div class='content'></div><h1>Resum</h1>
<div class='content'><p>Invoke-Command és un cmdlet versàtil a PowerShell que et permet executar comandes en ordinadors locals i remots. Admet executar comandes en múltiples ordinadors, utilitzar credencials diferents i crear sessions persistents. En dominar Invoke-Command, pots gestionar eficientment múltiples sistemes i automatitzar tasques complexes.</p>
</div><h2>Punts Clau</h2>
<div class='content'><ul>
<li><strong>Invoke-Command</strong>: Executa comandes localment o remotament.</li>
<li><strong>-ScriptBlock</strong>: Defineix el codi a executar.</li>
<li><strong>-ComputerName</strong>: Especifica ordinadors remots.</li>
<li><strong>-Credential</strong>: Utilitza comptes d'usuari diferents.</li>
<li><strong>New-PSSession</strong>: Crea connexions persistents.</li>
<li><strong>Gestió d'Errors</strong>: Utilitza try-catch per a scripts robustos.</li>
</ul>
<p>En comprendre i utilitzar aquestes funcions, pots millorar les teves capacitats de scripting a PowerShell i agilitzar les teves tasques administratives.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='configuring-remoting'>&#x25C4;Configurar la Remotització</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Ús d'Invoke-Command</a>
	</div>
	<div class='col-4 text-end'>
					<a href='automating-tasks-with-scheduled-jobs'>Automatitzar Tasques amb Feines Programades &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
