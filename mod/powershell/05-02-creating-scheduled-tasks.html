<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creació de Tasques Programades</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/05-02-creating-scheduled-tasks" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/05-02-creating-scheduled-tasks" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/05-02-creating-scheduled-tasks" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/powershell/05-02-creating-scheduled-tasks" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/powershell/05-02-creating-scheduled-tasks" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-01-introduction-automation' title="Introducció a l'Automatització">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Creació de Tasques Programades</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-03-system-administration' title="Ús de PowerShell per a l'Administració del Sistema">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem com crear tasques programades utilitzant PowerShell. Les tasques programades són essencials per automatitzar processos repetitius i assegurar que certes accions es realitzin en moments específics sense intervenció manual.</p>
</div><h1>Objectius del Tema</h1>
<div class='content'><ul>
<li>Comprendre què són les tasques programades.</li>
<li>Aprendre a crear, modificar i eliminar tasques programades amb PowerShell.</li>
<li>Veure exemples pràctics de tasques programades.</li>
<li>Realitzar exercicis pràctics per reforçar els conceptes apresos.</li>
</ul>
</div><h1>Què són les Tasques Programades?</h1>
<div class='content'><p>Les tasques programades són accions que es configuren per executar-se automàticament en moments específics o en resposta a esdeveniments determinats. A Windows, aquestes tasques es gestionen mitjançant el &quot;Task Scheduler&quot;.</p>
</div><h1>Cmdlets Clau per a la Gestió de Tasques Programades</h1>
<div class='content'><p>PowerShell proporciona diversos cmdlets per treballar amb tasques programades. A continuació es mostren els més importants:</p>
<table>
<thead>
<tr>
<th>Cmdlet</th>
<th>Descripció</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Get-ScheduledTask</code></td>
<td>Obté una o més tasques programades.</td>
</tr>
<tr>
<td><code>New-ScheduledTaskTrigger</code></td>
<td>Crea un nou desencadenador de tasca programada.</td>
</tr>
<tr>
<td><code>New-ScheduledTaskAction</code></td>
<td>Crea una nova acció de tasca programada.</td>
</tr>
<tr>
<td><code>Register-ScheduledTask</code></td>
<td>Registra una nova tasca programada.</td>
</tr>
<tr>
<td><code>Set-ScheduledTask</code></td>
<td>Modifica una tasca programada existent.</td>
</tr>
<tr>
<td><code>Unregister-ScheduledTask</code></td>
<td>Elimina una tasca programada.</td>
</tr>
<tr>
<td><code>Start-ScheduledTask</code></td>
<td>Inicia una tasca programada manualment.</td>
</tr>
<tr>
<td><code>Stop-ScheduledTask</code></td>
<td>Atura una tasca programada en execució.</td>
</tr>
</tbody>
</table>
</div><h1>Creació d'una Tasca Programada</h1>
<div class='content'></div><h2>Pas 1: Crear un Desencadenador</h2>
<div class='content'><p>Un desencadenador defineix quan s'executarà la tasca. Per exemple, podem crear un desencadenador que executi la tasca cada dia a les 9:00 AM.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JHRyaWdnZXIgPSBOZXctU2NoZWR1bGVkVGFza1RyaWdnZXIgLURhaWx5IC1BdCA5OjAwQU0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$trigger = New-ScheduledTaskTrigger -Daily -At 9:00AM</pre></div><div class='content'></div><h2>Pas 2: Crear una Acció</h2>
<div class='content'><p>Una acció defineix què farà la tasca. Per exemple, podem crear una acció que executi un script de PowerShell.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGFjdGlvbiA9IE5ldy1TY2hlZHVsZWRUYXNrQWN0aW9uIC1FeGVjdXRlICJQb3dlclNoZWxsLmV4ZSIgLUFyZ3VtZW50ICItRmlsZSBDOlxTY3JpcHRzXE15U2NyaXB0LnBzMSI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$action = New-ScheduledTaskAction -Execute &quot;PowerShell.exe&quot; -Argument &quot;-File C:\Scripts\MyScript.ps1&quot;</pre></div><div class='content'></div><h2>Pas 3: Registrar la Tasca Programada</h2>
<div class='content'><p>Finalment, registrem la tasca programada amb un nom i opcionalment amb una descripció.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UmVnaXN0ZXItU2NoZWR1bGVkVGFzayAtVGFza05hbWUgIk15RGFpbHlUYXNrIiAtVHJpZ2dlciAkdHJpZ2dlciAtQWN0aW9uICRhY3Rpb24gLURlc2NyaXB0aW9uICJFeGVjdXRlcyBNeVNjcmlwdC5wczEgZGFpbHkgYXQgOTowMCBBTSI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Register-ScheduledTask -TaskName &quot;MyDailyTask&quot; -Trigger $trigger -Action $action -Description &quot;Executes MyScript.ps1 daily at 9:00 AM&quot;</pre></div><div class='content'></div><h1>Exemple Complet</h1>
<div class='content'><p>A continuació es mostra un exemple complet de com crear una tasca programada que executi un script de PowerShell cada dia a les 9:00 AM.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhciBlbCBkZXNlbmNhZGVuYWRvcgokdHJpZ2dlciA9IE5ldy1TY2hlZHVsZWRUYXNrVHJpZ2dlciAtRGFpbHkgLUF0IDk6MDBBTQoKIyBDcmVhciBsJ2FjY2nDswokYWN0aW9uID0gTmV3LVNjaGVkdWxlZFRhc2tBY3Rpb24gLUV4ZWN1dGUgIlBvd2VyU2hlbGwuZXhlIiAtQXJndW1lbnQgIi1GaWxlIEM6XFNjcmlwdHNcTXlTY3JpcHQucHMxIgoKIyBSZWdpc3RyYXIgbGEgdGFzY2EgcHJvZ3JhbWFkYQpSZWdpc3Rlci1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiTXlEYWlseVRhc2siIC1UcmlnZ2VyICR0cmlnZ2VyIC1BY3Rpb24gJGFjdGlvbiAtRGVzY3JpcHRpb24gIkV4ZWN1dGVzIE15U2NyaXB0LnBzMSBkYWlseSBhdCA5OjAwIEFNIg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Crear el desencadenador
$trigger = New-ScheduledTaskTrigger -Daily -At 9:00AM

# Crear l'acci&oacute;
$action = New-ScheduledTaskAction -Execute &quot;PowerShell.exe&quot; -Argument &quot;-File C:\Scripts\MyScript.ps1&quot;

# Registrar la tasca programada
Register-ScheduledTask -TaskName &quot;MyDailyTask&quot; -Trigger $trigger -Action $action -Description &quot;Executes MyScript.ps1 daily at 9:00 AM&quot;</pre></div><div class='content'></div><h1>Exercicis Pràctics</h1>
<div class='content'></div><h2>Exercici 1: Crear una Tasca Programada Setmanal</h2>
<div class='content'><p>Crea una tasca programada que executi un script de PowerShell cada dilluns a les 8:00 AM.</p>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhciBlbCBkZXNlbmNhZGVuYWRvcgokdHJpZ2dlciA9IE5ldy1TY2hlZHVsZWRUYXNrVHJpZ2dlciAtV2Vla2x5IC1EYXlzT2ZXZWVrIE1vbmRheSAtQXQgODowMEFNCgojIENyZWFyIGwnYWNjacOzCiRhY3Rpb24gPSBOZXctU2NoZWR1bGVkVGFza0FjdGlvbiAtRXhlY3V0ZSAiUG93ZXJTaGVsbC5leGUiIC1Bcmd1bWVudCAiLUZpbGUgQzpcU2NyaXB0c1xXZWVrbHlTY3JpcHQucHMxIgoKIyBSZWdpc3RyYXIgbGEgdGFzY2EgcHJvZ3JhbWFkYQpSZWdpc3Rlci1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiV2Vla2x5VGFzayIgLVRyaWdnZXIgJHRyaWdnZXIgLUFjdGlvbiAkYWN0aW9uIC1EZXNjcmlwdGlvbiAiRXhlY3V0ZXMgV2Vla2x5U2NyaXB0LnBzMSBldmVyeSBNb25kYXkgYXQgODowMCBBTSI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Crear el desencadenador
$trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Monday -At 8:00AM

# Crear l'acci&oacute;
$action = New-ScheduledTaskAction -Execute &quot;PowerShell.exe&quot; -Argument &quot;-File C:\Scripts\WeeklyScript.ps1&quot;

# Registrar la tasca programada
Register-ScheduledTask -TaskName &quot;WeeklyTask&quot; -Trigger $trigger -Action $action -Description &quot;Executes WeeklyScript.ps1 every Monday at 8:00 AM&quot;</pre></div><div class='content'></div><h2>Exercici 2: Modificar una Tasca Programada</h2>
<div class='content'><p>Modifica la tasca &quot;MyDailyTask&quot; per executar-se a les 10:00 AM en lloc de les 9:00 AM.</p>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhciBlbCBub3UgZGVzZW5jYWRlbmFkb3IKJG5ld1RyaWdnZXIgPSBOZXctU2NoZWR1bGVkVGFza1RyaWdnZXIgLURhaWx5IC1BdCAxMDowMEFNCgojIE9idGVuaXIgbGEgdGFzY2EgZXhpc3RlbnQKJHRhc2sgPSBHZXQtU2NoZWR1bGVkVGFzayAtVGFza05hbWUgIk15RGFpbHlUYXNrIgoKIyBNb2RpZmljYXIgbGEgdGFzY2EgYW1iIGVsIG5vdSBkZXNlbmNhZGVuYWRvcgpTZXQtU2NoZWR1bGVkVGFzayAtVGFza05hbWUgIk15RGFpbHlUYXNrIiAtVHJpZ2dlciAkbmV3VHJpZ2dlciAtQWN0aW9uICR0YXNrLkFjdGlvbnM="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Crear el nou desencadenador
$newTrigger = New-ScheduledTaskTrigger -Daily -At 10:00AM

# Obtenir la tasca existent
$task = Get-ScheduledTask -TaskName &quot;MyDailyTask&quot;

# Modificar la tasca amb el nou desencadenador
Set-ScheduledTask -TaskName &quot;MyDailyTask&quot; -Trigger $newTrigger -Action $task.Actions</pre></div><div class='content'></div><h2>Exercici 3: Eliminar una Tasca Programada</h2>
<div class='content'><p>Elimina la tasca programada &quot;WeeklyTask&quot;.</p>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VW5yZWdpc3Rlci1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiV2Vla2x5VGFzayIgLUNvbmZpcm06JGZhbHNl"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Unregister-ScheduledTask -TaskName &quot;WeeklyTask&quot; -Confirm:$false</pre></div><div class='content'></div><h1>Resum</h1>
<div class='content'><p>En aquest tema, hem après com crear, modificar i eliminar tasques programades utilitzant PowerShell. Hem vist com utilitzar els cmdlets clau per gestionar les tasques programades i hem practicat amb exemples concrets. Les tasques programades són una eina poderosa per automatitzar processos i assegurar que certes accions es realitzin de manera consistent i sense intervenció manual.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-01-introduction-automation' title="Introducció a l'Automatització">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-03-system-administration' title="Ús de PowerShell per a l'Administració del Sistema">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
