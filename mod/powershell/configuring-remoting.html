<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurant la Remotització</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/configuring-remoting" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/configuring-remoting" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/configuring-remoting" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body  class="test" >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/powershell/configuring-remoting" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/powershell/configuring-remoting" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
									<div class="assert">
						<p><b>Atenció!</b> Hi ha hagut un error en la generació del curs i pot contenir errors de traducció.Estem treballant per solucionar-ho, per la qual cosa s'ha d'utilitzar el contingut amb cura.Es pot consultar el contingut correcte en un altre idioma en el següent enllaç:<br>
						<a href="https://enterprisecampus.net/mod/powershell/configuring-remoting">https://enterprisecampus.net/mod/powershell/configuring-remoting</a></p>
					</div>
								<div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-powershell-remoting'>&#x25C4;Introducció a la Remotització de PowerShell</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Configurant la Remotització</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-invoke-command'>Utilitzar Invoke-Command &#x25BA;</a>
			</div>
</div>
<div class='content'><p>La remotització de PowerShell és una característica potent que et permet executar comandes en sistemes remots. Aquest tema et guiarà a través del procés de configuració i ús de la remotització de PowerShell, des de la configuració bàsica fins a configuracions avançades.</p>
</div><h1>Introducció a la Remotització de PowerShell</h1>
<div class='content'><p>La remotització de PowerShell permet als administradors gestionar múltiples sistemes des d'una única consola. Utilitza el protocol WS-Management i es pot configurar per utilitzar HTTP o HTTPS per a una comunicació segura.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Protocol WS-Management</strong>: Un protocol estàndard per a la gestió remota.</li>
<li><strong>WinRM (Windows Remote Management)</strong>: La implementació de Microsoft del WS-Management.</li>
<li><strong>Punts finals</strong>: Configuracions que defineixen quines comandes es poden executar remotament.</li>
<li><strong>Sessions</strong>: Connexions a sistemes remots on s'executen les comandes.</li>
</ul>
</div><h1>Activant la Remotització de PowerShell</h1>
<div class='content'><p>Abans de poder utilitzar la remotització de PowerShell, has d'activar-la en els sistemes que vols gestionar.</p>
</div><h2>Activant la Remotització en una Única Màquina</h2>
<div class='content'><p>Per activar la remotització de PowerShell en una única màquina, utilitza el cmdlet <code>Enable-PSRemoting</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RW5hYmxlLVBTUmVtb3RpbmcgLUZvcmNl"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Enable-PSRemoting -Force</pre></div><div class='content'><ul>
<li><code>-Force</code>: Salta les sol·licituds de l'usuari i força l'execució de la comanda.</li>
</ul>
</div><h2>Activant la Remotització en Múltiples Màquines</h2>
<div class='content'><p>Per activar la remotització en múltiples màquines, pots utilitzar Polítiques de Grup o un script que executi el cmdlet <code>Enable-PSRemoting</code> en cada màquina.</p>
<h4>Utilitzant Polítiques de Grup</h4>
<ol>
<li>Obre la Consola de Gestió de Polítiques de Grup (GPMC).</li>
<li>Crea un nou Objecte de Política de Grup (GPO) o edita'n un d'existent.</li>
<li>Navega a <code>Configuració de l'ordinador -&gt; Plantilles administratives -&gt; Components de Windows -&gt; Gestió remota de Windows (WinRM) -&gt; Servei WinRM</code>.</li>
<li>Activa la política <code>Permetre la gestió remota del servidor a través de WinRM</code>.</li>
</ol>
<h4>Utilitzant un Script</h4>
<p>Pots utilitzar un script per activar la remotització en múltiples màquines. Aquí tens un exemple utilitzant PowerShell:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNvbXB1dGVycyA9IEAoIkNvbXB1dGVyMSIsICJDb21wdXRlcjIiLCAiQ29tcHV0ZXIzIikKZm9yZWFjaCAoJGNvbXB1dGVyIGluICRjb21wdXRlcnMpIHsKICAgIEludm9rZS1Db21tYW5kIC1Db21wdXRlck5hbWUgJGNvbXB1dGVyIC1TY3JpcHRCbG9jayB7CiAgICAgICAgRW5hYmxlLVBTUmVtb3RpbmcgLUZvcmNlCiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$computers = @(&quot;Computer1&quot;, &quot;Computer2&quot;, &quot;Computer3&quot;)
foreach ($computer in $computers) {
    Invoke-Command -ComputerName $computer -ScriptBlock {
        Enable-PSRemoting -Force
    }
}</pre></div><div class='content'></div><h1>Configurant la Remotització per HTTPS</h1>
<div class='content'><p>Per a una comunicació segura, es recomana configurar la remotització de PowerShell per utilitzar HTTPS.</p>
</div><h2>Passos per Configurar HTTPS</h2>
<div class='content'><ol>
<li><strong>Crear o Obtenir un Certificat</strong>: Necessites un certificat per al servidor que sigui de confiança per les màquines clients.</li>
<li><strong>Configurar el Listener</strong>: Utilitza el cmdlet <code>New-WSManInstance</code> per crear un nou listener.</li>
</ol>
<h4>Exemple: Configurant un Listener HTTPS</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhciB1biBub3UgbGlzdGVuZXIgSFRUUFMKJGNlcnRUaHVtYnByaW50ID0gIllPVVJfQ0VSVF9USFVNQlBSSU5UIgpOZXctV1NNYW5JbnN0YW5jZSAtUmVzb3VyY2VVUkkgd2lucm0vY29uZmlnL0xpc3RlbmVyIC1TZWxlY3RvclNldCBAe0FkZHJlc3M9IioiO1RyYW5zcG9ydD0iSFRUUFMifSAtVmFsdWVTZXQgQHtDZXJ0aWZpY2F0ZVRodW1icHJpbnQ9JGNlcnRUaHVtYnByaW50fQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Crear un nou listener HTTPS
$certThumbprint = &quot;YOUR_CERT_THUMBPRINT&quot;
New-WSManInstance -ResourceURI winrm/config/Listener -SelectorSet @{Address=&quot;*&quot;;Transport=&quot;HTTPS&quot;} -ValueSet @{CertificateThumbprint=$certThumbprint}</pre></div><div class='content'><ul>
<li><code>CertificateThumbprint</code>: L'empremta digital del certificat que estàs utilitzant.</li>
</ul>
</div><h2>Verificant el Listener</h2>
<div class='content'><p>Per verificar que el listener està configurat correctament, utilitza el cmdlet <code>Get-WSManInstance</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LVdTTWFuSW5zdGFuY2UgLVJlc291cmNlVVJJIHdpbnJtL2NvbmZpZy9MaXN0ZW5lciAtU2VsZWN0b3JTZXQgQHtBZGRyZXNzPSIqIjtUcmFuc3BvcnQ9IkhUVFBTIn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-WSManInstance -ResourceURI winrm/config/Listener -SelectorSet @{Address=&quot;*&quot;;Transport=&quot;HTTPS&quot;}</pre></div><div class='content'></div><h1>Utilitzant la Remotització de PowerShell</h1>
<div class='content'><p>Un cop la remotització està activada i configurada, pots començar a utilitzar-la per executar comandes en sistemes remots.</p>
</div><h2>Executant Comandes en una Única Màquina Remota</h2>
<div class='content'><p>Utilitza el cmdlet <code>Invoke-Command</code> per executar comandes en una màquina remota:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAiUmVtb3RlQ29tcHV0ZXIiIC1TY3JpcHRCbG9jayB7IEdldC1Qcm9jZXNzIH0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &quot;RemoteComputer&quot; -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><code>-ComputerName</code>: Especifica la màquina remota.</li>
<li><code>-ScriptBlock</code>: Les comandes a executar en la màquina remota.</li>
</ul>
</div><h2>Executant Comandes en Múltiples Màquines Remotes</h2>
<div class='content'><p>També pots executar comandes en múltiples màquines remotes especificant una matriu de noms de màquines:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNvbXB1dGVycyA9IEAoIkNvbXB1dGVyMSIsICJDb21wdXRlcjIiLCAiQ29tcHV0ZXIzIikKSW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAkY29tcHV0ZXJzIC1TY3JpcHRCbG9jayB7IEdldC1Qcm9jZXNzIH0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$computers = @(&quot;Computer1&quot;, &quot;Computer2&quot;, &quot;Computer3&quot;)
Invoke-Command -ComputerName $computers -ScriptBlock { Get-Process }</pre></div><div class='content'></div><h2>Entrant en una Sessió Remota</h2>
<div class='content'><p>Per entrar en una sessió interactiva amb una màquina remota, utilitza el cmdlet <code>Enter-PSSession</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RW50ZXItUFNTZXNzaW9uIC1Db21wdXRlck5hbWUgIlJlbW90ZUNvbXB1dGVyIg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Enter-PSSession -ComputerName &quot;RemoteComputer&quot;</pre></div><div class='content'><ul>
<li><code>Exit-PSSession</code>: Per sortir de la sessió remota, simplement escriu <code>Exit-PSSession</code>.</li>
</ul>
</div><h1>Configuracions Avançades</h1>
<div class='content'></div><h2>Personalitzant Punts Finals</h2>
<div class='content'><p>Pots crear punts finals personalitzats per controlar quines comandes i scripts es poden executar remotament.</p>
<h4>Exemple: Creant un Punt Final Personalitzat</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGVuZHBvaW50ID0gQHsKICAgIE5hbWUgPSAiQ3VzdG9tRW5kcG9pbnQiCiAgICBDb25maWd1cmF0aW9uTmFtZSA9ICJDdXN0b21Db25maWciCiAgICBSdW5Bc1VzZXIgPSAiRG9tYWluXFVzZXIiCn0KUmVnaXN0ZXItUFNTZXNzaW9uQ29uZmlndXJhdGlvbiBAZW5kcG9pbnQ="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$endpoint = @{
    Name = &quot;CustomEndpoint&quot;
    ConfigurationName = &quot;CustomConfig&quot;
    RunAsUser = &quot;Domain\User&quot;
}
Register-PSSessionConfiguration @endpoint</pre></div><div class='content'><ul>
<li><code>Name</code>: El nom del punt final.</li>
<li><code>ConfigurationName</code>: La configuració a utilitzar.</li>
<li><code>RunAsUser</code>: El compte d'usuari sota el qual s'executaran les comandes.</li>
</ul>
</div><h2>Gestionant Sessions</h2>
<div class='content'><p>Pots gestionar sessions remotes utilitzant els cmdlets <code>New-PSSession</code>, <code>Get-PSSession</code>, i <code>Remove-PSSession</code>.</p>
<h4>Exemple: Creant i Gestionant Sessions</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhciB1bmEgbm92YSBzZXNzacOzCiRzZXNzaW9uID0gTmV3LVBTU2Vzc2lvbiAtQ29tcHV0ZXJOYW1lICJSZW1vdGVDb21wdXRlciIKCiMgRXhlY3V0YXIgdW5hIGNvbWFuZGEgZW4gbGEgc2Vzc2nDswpJbnZva2UtQ29tbWFuZCAtU2Vzc2lvbiAkc2Vzc2lvbiAtU2NyaXB0QmxvY2sgeyBHZXQtUHJvY2VzcyB9CgojIE9idGVuaXIgdG90ZXMgbGVzIHNlc3Npb25zIGFjdGl2ZXMKR2V0LVBTU2Vzc2lvbgoKIyBFbGltaW5hciBsYSBzZXNzacOzClJlbW92ZS1QU1Nlc3Npb24gLVNlc3Npb24gJHNlc3Npb24="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Crear una nova sessi&oacute;
$session = New-PSSession -ComputerName &quot;RemoteComputer&quot;

# Executar una comanda en la sessi&oacute;
Invoke-Command -Session $session -ScriptBlock { Get-Process }

# Obtenir totes les sessions actives
Get-PSSession

# Eliminar la sessi&oacute;
Remove-PSSession -Session $session</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Configurar la remotització de PowerShell és una habilitat crucial per gestionar múltiples sistemes de manera eficient. Activant la remotització, configurant la comunicació segura, i utilitzant cmdlets per executar comandes i gestionar sessions, pots agilitzar les tasques administratives i millorar la productivitat. Practica aquests passos per convertir-te en un expert en l'ús de la remotització de PowerShell en les teves operacions diàries.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-powershell-remoting'>&#x25C4;Introducció a la Remotització de PowerShell</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Configurant la Remotització</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-invoke-command'>Utilitzar Invoke-Command &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
