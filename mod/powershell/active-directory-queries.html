<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultes de l'Active Directory</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/active-directory-queries" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/active-directory-queries" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/active-directory-queries" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body  class="test" >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/powershell/active-directory-queries" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/powershell/active-directory-queries" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
									<div class="assert">
						<p><b>Atenció!</b> Hi ha hagut un error en la generació del curs i pot contenir errors de traducció.Estem treballant per solucionar-ho, per la qual cosa s'ha d'utilitzar el contingut amb cura.Es pot consultar el contingut correcte en un altre idioma en el següent enllaç:<br>
						<a href="https://enterprisecampus.net/mod/powershell/active-directory-queries">https://enterprisecampus.net/mod/powershell/active-directory-queries</a></p>
					</div>
								<div class='row navigation'>
	<div class='col-4'>
					<a href='managing-users-and-groups'>&#x25C4;Gestionar Usuaris i Grups</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Consultes de l'Active Directory</a>
	</div>
	<div class='col-4 text-end'>
					<a href='automating-active-directory-tasks'>Automatitzar Tasques d'Active Directory &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>Active Directory (AD) és un servei de directori desenvolupat per Microsoft per a xarxes de dominis de Windows. PowerShell proporciona una manera poderosa d'interactuar amb AD, permetent als administradors consultar i gestionar objectes AD de manera eficient. Aquesta secció et guiarà a través de la consulta de l'Active Directory utilitzant PowerShell, des de tècniques bàsiques fins a avançades.</p>
</div><h1>Prerequisits</h1>
<div class='content'><p>Abans d'endinsar-te en les consultes de l'Active Directory, assegura't de tenir:</p>
<ul>
<li>Coneixement bàsic de PowerShell.</li>
<li>Mòdul d'Active Directory instal·lat (<code>RSAT-AD-PowerShell</code>).</li>
</ul>
</div><h1>Consultes Bàsiques</h1>
<div class='content'></div><h2>Connexió a l'Active Directory</h2>
<div class='content'><p>Per realitzar qualsevol consulta, necessites importar el mòdul d'Active Directory:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW1wb3J0LU1vZHVsZSBBY3RpdmVEaXJlY3Rvcnk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Import-Module ActiveDirectory</pre></div><div class='content'></div><h2>Recuperar un Usuari Únic</h2>
<div class='content'><p>Per recuperar un usuari únic pel seu nom d'usuari (sAMAccountName):</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtSWRlbnRpdHkgInVzZXJuYW1lIg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Identity &quot;username&quot;</pre></div><div class='content'><ul>
<li><code>-Identity</code>: Especifica l'usuari a recuperar.</li>
</ul>
</div><h2>Recuperar Múltiples Usuaris</h2>
<div class='content'><p>Per recuperar tots els usuaris del domini:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtRmlsdGVyICo="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Filter *</pre></div><div class='content'><ul>
<li><code>-Filter *</code>: Recupera tots els usuaris.</li>
</ul>
</div><h2>Filtrar Usuaris</h2>
<div class='content'><p>Per filtrar usuaris basant-se en criteris específics, com ara usuaris en un departament específic:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtRmlsdGVyIHtEZXBhcnRtZW50IC1lcSAiU2FsZXMifQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Filter {Department -eq &quot;Sales&quot;}</pre></div><div class='content'><ul>
<li><code>-Filter {Department -eq &quot;Sales&quot;}</code>: Recupera usuaris del departament de Vendes.</li>
</ul>
</div><h2>Seleccionar Propietats Específiques</h2>
<div class='content'><p>Per defecte, <code>Get-ADUser</code> retorna un conjunt limitat de propietats. Per seleccionar propietats específiques:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtSWRlbnRpdHkgInVzZXJuYW1lIiAtUHJvcGVydGllcyBEaXNwbGF5TmFtZSwgRW1haWxBZGRyZXNz"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Identity &quot;username&quot; -Properties DisplayName, EmailAddress</pre></div><div class='content'><ul>
<li><code>-Properties</code>: Especifica propietats addicionals a recuperar.</li>
</ul>
</div><h1>Consultes Intermèdies</h1>
<div class='content'></div><h2>Recuperar Grups</h2>
<div class='content'><p>Per recuperar tots els grups del domini:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFER3JvdXAgLUZpbHRlciAq"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADGroup -Filter *</pre></div><div class='content'></div><h2>Filtrar Grups</h2>
<div class='content'><p>Per filtrar grups basant-se en criteris específics, com ara grups que comencen amb &quot;Admin&quot;:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFER3JvdXAgLUZpbHRlciB7TmFtZSAtbGlrZSAiQWRtaW4qIn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADGroup -Filter {Name -like &quot;Admin*&quot;}</pre></div><div class='content'></div><h2>Recuperar Membres del Grup</h2>
<div class='content'><p>Per recuperar membres d'un grup específic:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFER3JvdXBNZW1iZXIgLUlkZW50aXR5ICJHcm91cE5hbWUi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADGroupMember -Identity &quot;GroupName&quot;</pre></div><div class='content'></div><h2>Combinació de Filtres i Propietats</h2>
<div class='content'><p>Per recuperar usuaris amb propietats específiques i criteris de filtre:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtRmlsdGVyIHtUaXRsZSAtZXEgIk1hbmFnZXIifSAtUHJvcGVydGllcyBEaXNwbGF5TmFtZSwgRW1haWxBZGRyZXNz"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Filter {Title -eq &quot;Manager&quot;} -Properties DisplayName, EmailAddress</pre></div><div class='content'></div><h1>Consultes Avançades</h1>
<div class='content'></div><h2>Utilitzar Filtres LDAP</h2>
<div class='content'><p>Els filtres LDAP proporcionen un control més granular sobre les consultes. Per recuperar usuaris amb un filtre LDAP:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtTERBUEZpbHRlciAiKG9iamVjdENsYXNzPXVzZXIpIg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -LDAPFilter &quot;(objectClass=user)&quot;</pre></div><div class='content'><ul>
<li><code>-LDAPFilter</code>: Especifica un filtre LDAP.</li>
</ul>
</div><h2>Consultar Unitats Organitzatives (OUs)</h2>
<div class='content'><p>Per recuperar totes les OUs del domini:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFET3JnYW5pemF0aW9uYWxVbml0IC1GaWx0ZXIgKg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADOrganizationalUnit -Filter *</pre></div><div class='content'></div><h2>Consultes Recursives</h2>
<div class='content'><p>Per recuperar tots els usuaris en una OU específica i les seves OUs filles:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtRmlsdGVyICogLVNlYXJjaEJhc2UgIk9VPVNhbGVzLERDPWV4YW1wbGUsREM9Y29tIiAtU2VhcmNoU2NvcGUgU3VidHJlZQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Filter * -SearchBase &quot;OU=Sales,DC=example,DC=com&quot; -SearchScope Subtree</pre></div><div class='content'><ul>
<li><code>-SearchBase</code>: Especifica la base de la cerca.</li>
<li><code>-SearchScope Subtree</code>: Cerca la OU especificada i totes les seves OUs filles.</li>
</ul>
</div><h2>Atributs Personalitzats</h2>
<div class='content'><p>Per recuperar usuaris amb atributs personalitzats:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtRmlsdGVyICogLVByb3BlcnRpZXMgQ3VzdG9tQXR0cmlidXRlMQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Filter * -Properties CustomAttribute1</pre></div><div class='content'></div><h2>Exportar Resultats de la Consulta</h2>
<div class='content'><p>Per exportar els resultats de la consulta a un fitxer CSV:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtRmlsdGVyICogfCBTZWxlY3QtT2JqZWN0IE5hbWUsIEVtYWlsQWRkcmVzcyB8IEV4cG9ydC1Dc3YgLVBhdGggIkM6XFVzZXJzLmNzdiIgLU5vVHlwZUluZm9ybWF0aW9u"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Filter * | Select-Object Name, EmailAddress | Export-Csv -Path &quot;C:\Users.csv&quot; -NoTypeInformation</pre></div><div class='content'><ul>
<li><code>Select-Object</code>: Selecciona propietats específiques.</li>
<li><code>Export-Csv</code>: Exporta els resultats a un fitxer CSV.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>PowerShell proporciona un conjunt robust de cmdlets per consultar l'Active Directory, permetent als administradors gestionar i recuperar objectes AD de manera eficient. En dominar aquestes consultes, pots automatitzar i agilitzar moltes tasques administratives, fent el teu flux de treball més eficient i efectiu. Practica aquestes consultes i explora les vastes capacitats de PowerShell per convertir-te en un expert en la gestió de l'Active Directory.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='managing-users-and-groups'>&#x25C4;Gestionar Usuaris i Grups</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Consultes de l'Active Directory</a>
	</div>
	<div class='col-4 text-end'>
					<a href='automating-active-directory-tasks'>Automatitzar Tasques d'Active Directory &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
