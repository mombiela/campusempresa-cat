<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automatització de Tasques amb Treballs Programats</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/automating-tasks-with-scheduled-jobs" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/automating-tasks-with-scheduled-jobs" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/automating-tasks-with-scheduled-jobs" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body  class="test" >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/powershell/automating-tasks-with-scheduled-jobs" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/powershell/automating-tasks-with-scheduled-jobs" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
									<div class="assert">
						<p><b>Atenció!</b> Hi ha hagut un error en la generació del curs i pot contenir errors de traducció.Estem treballant per solucionar-ho, per la qual cosa s'ha d'utilitzar el contingut amb cura.Es pot consultar el contingut correcte en un altre idioma en el següent enllaç:<br>
						<a href="https://enterprisecampus.net/mod/powershell/automating-tasks-with-scheduled-jobs">https://enterprisecampus.net/mod/powershell/automating-tasks-with-scheduled-jobs</a></p>
					</div>
								<div class='row navigation'>
	<div class='col-4'>
					<a href='using-invoke-command'>&#x25C4;Utilitzar Invoke-Command</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Automatització de Tasques amb Treballs Programats</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-active-directory-cmdlets'>Introducció als Cmdlets d'Active Directory &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>Automatitzar tasques repetitives és una habilitat crucial per a qualsevol professional de TI. PowerShell proporciona capacitats robustes per programar i automatitzar tasques utilitzant Treballs Programats. Aquesta secció et guiarà des dels conceptes bàsics fins a tècniques avançades per crear i gestionar treballs programats en PowerShell.</p>
</div><h1>Què són els Treballs Programats?</h1>
<div class='content'><ul>
<li><strong>Treballs Programats</strong> són tasques de PowerShell que s'executen en un horari especificat.</li>
<li>Són similars a les tasques del Programador de Tasques però es gestionen dins de PowerShell.</li>
<li>Útils per automatitzar tasques de manteniment, còpies de seguretat, recopilació de dades, i més.</li>
</ul>
</div><h1>Prerequisits</h1>
<div class='content'><ul>
<li>Comprensió bàsica de la sintaxi i les ordres de PowerShell.</li>
<li>Versió de PowerShell 3.0 o posterior.</li>
</ul>
</div><h1>Creació d'un Treball Programat Bàsic</h1>
<div class='content'><p>Per crear un treball programat, utilitzes el cmdlet <code>Register-ScheduledJob</code>.</p>
</div><h2>Exemple: Creació d'un Treball Programat Simple</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBBcXVlc3Qgc2NyaXB0IGNyZWEgdW4gdHJlYmFsbCBwcm9ncmFtYXQgcXVlIGV4ZWN1dGEgdW4gc2NyaXB0IGRlIFBvd2VyU2hlbGwgY2FkYSBkaWEgYSBsZXMgMyBBTQokdHJpZ2dlciA9IE5ldy1Kb2JUcmlnZ2VyIC1EYWlseSAtQXQgIjM6MDBBTSIKUmVnaXN0ZXItU2NoZWR1bGVkSm9iIC1OYW1lICJEYWlseUJhY2t1cCIgLUZpbGVQYXRoICJDOlxTY3JpcHRzXEJhY2t1cFNjcmlwdC5wczEiIC1UcmlnZ2VyICR0cmlnZ2Vy"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Aquest script crea un treball programat que executa un script de PowerShell cada dia a les 3 AM
$trigger = New-JobTrigger -Daily -At &quot;3:00AM&quot;
Register-ScheduledJob -Name &quot;DailyBackup&quot; -FilePath &quot;C:\Scripts\BackupScript.ps1&quot; -Trigger $trigger</pre></div><div class='content'><ul>
<li><strong>New-JobTrigger</strong>: Crea un desencadenant que defineix quan s'executa el treball.</li>
<li><strong>Register-ScheduledJob</strong>: Registra el treball amb un nom, ruta de l'script, i desencadenant.</li>
</ul>
</div><h1>Gestió de Treballs Programats</h1>
<div class='content'><p>Un cop creat un treball, pots gestionar-lo utilitzant diversos cmdlets.</p>
</div><h2>Visualització de Treballs Programats</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMbGlzdGFyIHRvdHMgZWxzIHRyZWJhbGxzIHByb2dyYW1hdHMKR2V0LVNjaGVkdWxlZEpvYg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Llistar tots els treballs programats
Get-ScheduledJob</pre></div><div class='content'><ul>
<li><strong>Get-ScheduledJob</strong>: Recupera tots els treballs programats registrats.</li>
</ul>
</div><h2>Deshabilitar i Habilitar Treballs</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZXNoYWJpbGl0YXIgdW4gdHJlYmFsbCBwcm9ncmFtYXQKRGlzYWJsZS1TY2hlZHVsZWRKb2IgLU5hbWUgIkRhaWx5QmFja3VwIgoKIyBIYWJpbGl0YXIgdW4gdHJlYmFsbCBwcm9ncmFtYXQKRW5hYmxlLVNjaGVkdWxlZEpvYiAtTmFtZSAiRGFpbHlCYWNrdXAi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Deshabilitar un treball programat
Disable-ScheduledJob -Name &quot;DailyBackup&quot;

# Habilitar un treball programat
Enable-ScheduledJob -Name &quot;DailyBackup&quot;</pre></div><div class='content'><ul>
<li><strong>Disable-ScheduledJob</strong>: Deshabilita un treball programat.</li>
<li><strong>Enable-ScheduledJob</strong>: Habilita un treball programat.</li>
</ul>
</div><h2>Eliminació de Treballs Programats</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFbGltaW5hciB1biB0cmViYWxsIHByb2dyYW1hdApVbnJlZ2lzdGVyLVNjaGVkdWxlZEpvYiAtTmFtZSAiRGFpbHlCYWNrdXAi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Eliminar un treball programat
Unregister-ScheduledJob -Name &quot;DailyBackup&quot;</pre></div><div class='content'><ul>
<li><strong>Unregister-ScheduledJob</strong>: Elimina un treball programat del sistema.</li>
</ul>
</div><h1>Opcions Avançades de Programació</h1>
<div class='content'><p>PowerShell permet escenaris de programació més complexos utilitzant diferents desencadenants i opcions.</p>
</div><h2>Exemple: Treball Setmanal amb Múltiples Desencadenants</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhciB1biB0cmViYWxsIHF1ZSBzJ2V4ZWN1dGEgY2FkYSBkaWxsdW5zIGkgZGl2ZW5kcmVzIGEgbGVzIDUgUE0KJHRyaWdnZXIxID0gTmV3LUpvYlRyaWdnZXIgLVdlZWtseSAtRGF5c09mV2VlayBNb25kYXkgLUF0ICI1OjAwUE0iCiR0cmlnZ2VyMiA9IE5ldy1Kb2JUcmlnZ2VyIC1XZWVrbHkgLURheXNPZldlZWsgRnJpZGF5IC1BdCAiNTowMFBNIgpSZWdpc3Rlci1TY2hlZHVsZWRKb2IgLU5hbWUgIldlZWtseVJlcG9ydCIgLUZpbGVQYXRoICJDOlxTY3JpcHRzXFJlcG9ydFNjcmlwdC5wczEiIC1UcmlnZ2VyICR0cmlnZ2VyMSwgJHRyaWdnZXIy"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Crear un treball que s'executa cada dilluns i divendres a les 5 PM
$trigger1 = New-JobTrigger -Weekly -DaysOfWeek Monday -At &quot;5:00PM&quot;
$trigger2 = New-JobTrigger -Weekly -DaysOfWeek Friday -At &quot;5:00PM&quot;
Register-ScheduledJob -Name &quot;WeeklyReport&quot; -FilePath &quot;C:\Scripts\ReportScript.ps1&quot; -Trigger $trigger1, $trigger2</pre></div><div class='content'><ul>
<li><strong>Múltiples Desencadenants</strong>: Pots especificar múltiples desencadenants per a un sol treball.</li>
</ul>
</div><h2>Exemple: Treball amb Dates d'Inici i Fi Específiques</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhciB1biB0cmViYWxsIHF1ZSBzJ2V4ZWN1dGEgZGnDoHJpYW1lbnQgYSBsZXMgMiBBTSwgY29tZW7Dp2FudCBkZXMgZCd1bmEgZGF0YSBlc3BlY8OtZmljYSBpIGFjYWJhbnQgZW4gdW5hIGFsdHJhIGRhdGEKJHRyaWdnZXIgPSBOZXctSm9iVHJpZ2dlciAtRGFpbHkgLUF0ICIyOjAwQU0iIC1CZWdpbiAiMjAyMy0wMS0wMSIgLUVuZCAiMjAyMy0xMi0zMSIKUmVnaXN0ZXItU2NoZWR1bGVkSm9iIC1OYW1lICJZZWFybHlUYXNrIiAtRmlsZVBhdGggIkM6XFNjcmlwdHNcWWVhcmx5VGFzay5wczEiIC1UcmlnZ2VyICR0cmlnZ2Vy"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Crear un treball que s'executa di&agrave;riament a les 2 AM, comen&ccedil;ant des d'una data espec&iacute;fica i acabant en una altra data
$trigger = New-JobTrigger -Daily -At &quot;2:00AM&quot; -Begin &quot;2023-01-01&quot; -End &quot;2023-12-31&quot;
Register-ScheduledJob -Name &quot;YearlyTask&quot; -FilePath &quot;C:\Scripts\YearlyTask.ps1&quot; -Trigger $trigger</pre></div><div class='content'><ul>
<li><strong>Dates d'Inici i Fi</strong>: Defineixen el període durant el qual el treball està actiu.</li>
</ul>
</div><h1>Monitorització i Registre</h1>
<div class='content'><p>Monitoritzar l'execució dels treballs programats és essencial per assegurar-se que s'executen com s'espera.</p>
</div><h2>Exemple: Recuperació de Resultats del Treball</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBPYnRlbmlyIGVscyByZXN1bHRhdHMgZGUgbCfDumx0aW1hIGV4ZWN1Y2nDsyBkJ3VuIHRyZWJhbGwgcHJvZ3JhbWF0CkdldC1Kb2IgLU5hbWUgIkRhaWx5QmFja3VwIiB8IFJlY2VpdmUtSm9i"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Obtenir els resultats de l'&uacute;ltima execuci&oacute; d'un treball programat
Get-Job -Name &quot;DailyBackup&quot; | Receive-Job</pre></div><div class='content'><ul>
<li><strong>Get-Job</strong>: Recupera instàncies de treballs.</li>
<li><strong>Receive-Job</strong>: Recupera els resultats d'un treball.</li>
</ul>
</div><h2>Exemple: Comprovació de l'Historial del Treball</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBPYnRlbmlyIGwnaGlzdG9yaWFsIGQndW4gdHJlYmFsbCBwcm9ncmFtYXQKR2V0LVNjaGVkdWxlZEpvYiAtTmFtZSAiRGFpbHlCYWNrdXAiIHwgR2V0LUpvYlRyaWdnZXI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Obtenir l'historial d'un treball programat
Get-ScheduledJob -Name &quot;DailyBackup&quot; | Get-JobTrigger</pre></div><div class='content'><ul>
<li><strong>Get-JobTrigger</strong>: Recupera els desencadenants i l'historial d'un treball programat.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Els Treballs Programats en PowerShell proporcionen una manera poderosa d'automatitzar tasques de manera regular. Comprenent com crear, gestionar i monitoritzar aquests treballs, pots augmentar significativament la teva productivitat i assegurar-te que les tasques crítiques es realitzen de manera consistent i fiable. Practica creant i gestionant treballs programats per esdevenir proficient en l'automatització dels teus fluxos de treball amb PowerShell.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='using-invoke-command'>&#x25C4;Utilitzar Invoke-Command</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Automatització de Tasques amb Treballs Programats</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-active-directory-cmdlets'>Introducció als Cmdlets d'Active Directory &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
