<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arbres de Decisió i Boscos Aleatoris</title>

    <link rel="alternate" href="https://campusempresa.com/mod/analisis_datos/04-03-arboles-bosques" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/analisis_datos/04-03-arbres-boscos" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/analisis_datos/04-03-trees-forests" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/analisis_datos/04-03-trees-forests" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/analisis_datos/04-03-arboles-bosques" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-02-regressio' title="Regressió Lineal i Logística">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Arbres de Decisió i Boscos Aleatoris</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-metrics-avaluacio' title="Mètriques d'Avaluació de Models">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En aquest tema, explorarem dues tècniques de modelatge molt potents i àmpliament utilitzades en l'anàlisi de dades: els arbres de decisió i els boscos aleatoris. Aquestes tècniques són especialment útils per a tasques de classificació i regressió, i són conegudes per la seva capacitat d'interpretació i precisió.</p>
</div><h1>Arbres de Decisió</h1>
<div class='content'></div><h2>Conceptes Bàsics</h2>
<div class='content'><p>Un arbre de decisió és un model predictiu que utilitza un conjunt de regles basades en les característiques de les dades per prendre decisions. Es representa com un arbre, on cada node intern representa una característica o atribut, cada branca representa una regla de decisió, i cada fulla representa un resultat o classe.</p>
</div><h2>Construcció d'un Arbre de Decisió</h2>
<div class='content'><ol>
<li><strong>Selecció de la Característica</strong>: Seleccionem la característica que millor divideix les dades en termes de la variable objectiu. Això es fa utilitzant mètriques com la impuresa de Gini o la informació entropia.</li>
<li><strong>Divisió de les Dades</strong>: Les dades es divideixen en subgrups basats en la característica seleccionada.</li>
<li><strong>Repetició</strong>: Aquest procés es repeteix recursivament per a cada subgrup fins que es compleixin certs criteris d'aturada, com ara una profunditat màxima de l'arbre o un nombre mínim de mostres per fulla.</li>
</ol>
</div><h2>Exemple de Codi</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLmRhdGFzZXRzIGltcG9ydCBsb2FkX2lyaXMKZnJvbSBza2xlYXJuLnRyZWUgaW1wb3J0IERlY2lzaW9uVHJlZUNsYXNzaWZpZXIKZnJvbSBza2xlYXJuLm1vZGVsX3NlbGVjdGlvbiBpbXBvcnQgdHJhaW5fdGVzdF9zcGxpdApmcm9tIHNrbGVhcm4ubWV0cmljcyBpbXBvcnQgYWNjdXJhY3lfc2NvcmUKCiMgQ2FycmVnYXIgZWwgY29uanVudCBkZSBkYWRlcyBJcmlzCmlyaXMgPSBsb2FkX2lyaXMoKQpYID0gaXJpcy5kYXRhCnkgPSBpcmlzLnRhcmdldAoKIyBEaXZpZGlyIGxlcyBkYWRlcyBlbiBlbnRyZW5hbWVudCBpIHByb3ZhClhfdHJhaW4sIFhfdGVzdCwgeV90cmFpbiwgeV90ZXN0ID0gdHJhaW5fdGVzdF9zcGxpdChYLCB5LCB0ZXN0X3NpemU9MC4zLCByYW5kb21fc3RhdGU9NDIpCgojIENyZWFyIGkgZW50cmVuYXIgbCdhcmJyZSBkZSBkZWNpc2nDswpjbGYgPSBEZWNpc2lvblRyZWVDbGFzc2lmaWVyKCkKY2xmLmZpdChYX3RyYWluLCB5X3RyYWluKQoKIyBQcmVkaXIgbGVzIGV0aXF1ZXRlcyBwZXIgYWwgY29uanVudCBkZSBwcm92YQp5X3ByZWQgPSBjbGYucHJlZGljdChYX3Rlc3QpCgojIEF2YWx1YXIgZWwgbW9kZWwKYWNjdXJhY3kgPSBhY2N1cmFjeV9zY29yZSh5X3Rlc3QsIHlfcHJlZCkKcHJpbnQoZidQcmVjaXNpw7MgZGUgbFwnYXJicmUgZGUgZGVjaXNpw7M6IHthY2N1cmFjeTouMmZ9Jyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.datasets import load_iris
from sklearn.tree import DecisionTreeClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score

# Carregar el conjunt de dades Iris
iris = load_iris()
X = iris.data
y = iris.target

# Dividir les dades en entrenament i prova
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# Crear i entrenar l'arbre de decisi&oacute;
clf = DecisionTreeClassifier()
clf.fit(X_train, y_train)

# Predir les etiquetes per al conjunt de prova
y_pred = clf.predict(X_test)

# Avaluar el model
accuracy = accuracy_score(y_test, y_pred)
print(f'Precisi&oacute; de l\'arbre de decisi&oacute;: {accuracy:.2f}')</pre></div><div class='content'></div><h2>Avantatges i Desavantatges</h2>
<div class='content'><p><strong>Avantatges</strong>:</p>
<ul>
<li>Fàcil d'interpretar i visualitzar.</li>
<li>No requereix molta preparació de les dades.</li>
<li>Pot manejar tant dades numèriques com categòriques.</li>
</ul>
<p><strong>Desavantatges</strong>:</p>
<ul>
<li>Pot sobreajustar-se fàcilment a les dades d'entrenament.</li>
<li>Sensible a petites variacions en les dades.</li>
</ul>
</div><h1>Boscos Aleatoris</h1>
<div class='content'></div><h2>Conceptes Bàsics</h2>
<div class='content'><p>Un bosc aleatori és un conjunt d'arbres de decisió entrenats de manera independent sobre diferents subconjunts de les dades i/o diferents subconjunts de característiques. La predicció final es fa mitjançant la mitjana (per a la regressió) o la majoria de vots (per a la classificació) de les prediccions de tots els arbres.</p>
</div><h2>Construcció d'un Bosc Aleatori</h2>
<div class='content'><ol>
<li><strong>Bootstrap Aggregating (Bagging)</strong>: Es generen múltiples subconjunts de les dades d'entrenament mitjançant mostreig amb reemplaçament.</li>
<li><strong>Entrenament d'Arbres</strong>: Cada arbre es construeix utilitzant un subconjunt diferent de les dades i un subconjunt aleatori de característiques.</li>
<li><strong>Agregació de Prediccions</strong>: Les prediccions dels arbres es combinen per obtenir la predicció final.</li>
</ol>
</div><h2>Exemple de Codi</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLmVuc2VtYmxlIGltcG9ydCBSYW5kb21Gb3Jlc3RDbGFzc2lmaWVyCgojIENyZWFyIGkgZW50cmVuYXIgZWwgYm9zYyBhbGVhdG9yaQpyZl9jbGYgPSBSYW5kb21Gb3Jlc3RDbGFzc2lmaWVyKG5fZXN0aW1hdG9ycz0xMDAsIHJhbmRvbV9zdGF0ZT00MikKcmZfY2xmLmZpdChYX3RyYWluLCB5X3RyYWluKQoKIyBQcmVkaXIgbGVzIGV0aXF1ZXRlcyBwZXIgYWwgY29uanVudCBkZSBwcm92YQp5X3ByZWRfcmYgPSByZl9jbGYucHJlZGljdChYX3Rlc3QpCgojIEF2YWx1YXIgZWwgbW9kZWwKYWNjdXJhY3lfcmYgPSBhY2N1cmFjeV9zY29yZSh5X3Rlc3QsIHlfcHJlZF9yZikKcHJpbnQoZidQcmVjaXNpw7MgZGVsIGJvc2MgYWxlYXRvcmk6IHthY2N1cmFjeV9yZjouMmZ9Jyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.ensemble import RandomForestClassifier

# Crear i entrenar el bosc aleatori
rf_clf = RandomForestClassifier(n_estimators=100, random_state=42)
rf_clf.fit(X_train, y_train)

# Predir les etiquetes per al conjunt de prova
y_pred_rf = rf_clf.predict(X_test)

# Avaluar el model
accuracy_rf = accuracy_score(y_test, y_pred_rf)
print(f'Precisi&oacute; del bosc aleatori: {accuracy_rf:.2f}')</pre></div><div class='content'></div><h2>Avantatges i Desavantatges</h2>
<div class='content'><p><strong>Avantatges</strong>:</p>
<ul>
<li>Redueix el risc de sobreajustament.</li>
<li>Pot manejar grans conjunts de dades amb moltes característiques.</li>
<li>Menys sensible a petites variacions en les dades.</li>
</ul>
<p><strong>Desavantatges</strong>:</p>
<ul>
<li>Més complex i més lent d'entrenar que un arbre de decisió individual.</li>
<li>Menys interpretable que un arbre de decisió individual.</li>
</ul>
</div><h1>Exercici Pràctic</h1>
<div class='content'></div><h2>Enunciat</h2>
<div class='content'><p>Utilitzant el conjunt de dades Iris, construeix un arbre de decisió i un bosc aleatori per a la tasca de classificació. Compara la precisió dels dos models i discuteix els resultats.</p>
</div><h2>Solució</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFbnRyZW5hciBsJ2FyYnJlIGRlIGRlY2lzacOzCmNsZiA9IERlY2lzaW9uVHJlZUNsYXNzaWZpZXIoKQpjbGYuZml0KFhfdHJhaW4sIHlfdHJhaW4pCnlfcHJlZCA9IGNsZi5wcmVkaWN0KFhfdGVzdCkKYWNjdXJhY3kgPSBhY2N1cmFjeV9zY29yZSh5X3Rlc3QsIHlfcHJlZCkKcHJpbnQoZidQcmVjaXNpw7MgZGUgbFwnYXJicmUgZGUgZGVjaXNpw7M6IHthY2N1cmFjeTouMmZ9JykKCiMgRW50cmVuYXIgZWwgYm9zYyBhbGVhdG9yaQpyZl9jbGYgPSBSYW5kb21Gb3Jlc3RDbGFzc2lmaWVyKG5fZXN0aW1hdG9ycz0xMDAsIHJhbmRvbV9zdGF0ZT00MikKcmZfY2xmLmZpdChYX3RyYWluLCB5X3RyYWluKQp5X3ByZWRfcmYgPSByZl9jbGYucHJlZGljdChYX3Rlc3QpCmFjY3VyYWN5X3JmID0gYWNjdXJhY3lfc2NvcmUoeV90ZXN0LCB5X3ByZWRfcmYpCnByaW50KGYnUHJlY2lzacOzIGRlbCBib3NjIGFsZWF0b3JpOiB7YWNjdXJhY3lfcmY6LjJmfScp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Entrenar l'arbre de decisi&oacute;
clf = DecisionTreeClassifier()
clf.fit(X_train, y_train)
y_pred = clf.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)
print(f'Precisi&oacute; de l\'arbre de decisi&oacute;: {accuracy:.2f}')

# Entrenar el bosc aleatori
rf_clf = RandomForestClassifier(n_estimators=100, random_state=42)
rf_clf.fit(X_train, y_train)
y_pred_rf = rf_clf.predict(X_test)
accuracy_rf = accuracy_score(y_test, y_pred_rf)
print(f'Precisi&oacute; del bosc aleatori: {accuracy_rf:.2f}')</pre></div><div class='content'></div><h2>Discussió</h2>
<div class='content'><p>En general, el bosc aleatori tendeix a tenir una precisió més alta que un arbre de decisió individual perquè combina les prediccions de múltiples arbres, reduint el risc de sobreajustament i millorant la generalització. No obstant això, aquesta millora en la precisió ve a costa d'una major complexitat i temps de càlcul.</p>
</div><h1>Conclusió</h1>
<div class='content'><p>En aquest tema, hem après sobre els arbres de decisió i els boscos aleatoris, dues tècniques de modelatge molt potents en l'anàlisi de dades. Hem vist com es construeixen, els seus avantatges i desavantatges, i hem practicat amb exemples de codi en Python. A la propera secció, explorarem com avaluar i validar aquests models per assegurar-nos que funcionen bé amb dades noves.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-02-regressio' title="Regressió Lineal i Logística">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-metrics-avaluacio' title="Mètriques d'Avaluació de Models">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
