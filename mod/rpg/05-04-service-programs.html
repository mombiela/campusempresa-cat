<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Programes de Servei i Procediments</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rpg/05-04-service-programs" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rpg/05-04-service-programs" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rpg/05-04-service-programs" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/rpg/05-04-service-programs" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/rpg/05-04-service-programs" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-03-ile-concepts' title="Conceptes ILE">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Programes de Servei i Procediments</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-01-web-services' title="Serveis Web">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En aquest tema, explorarem els programes de servei i els procediments en RPG IV. Els programes de servei són una part fonamental de la programació modular en RPG, ja que permeten la reutilització de codi i la separació de funcionalitats en mòduls independents. Els procediments, per altra banda, són subrutines que encapsulen funcionalitats específiques dins dels programes de servei o altres programes.</p>
</div><h1>Objectius d'Aprenentatge</h1>
<div class='content'><ul>
<li>Comprendre què són els programes de servei i els procediments.</li>
<li>Aprendre a crear i utilitzar programes de servei en RPG IV.</li>
<li>Saber com definir i cridar procediments dins dels programes de servei.</li>
<li>Entendre els avantatges de la programació modular i la reutilització de codi.</li>
</ul>
</div><h1>Què és un Programa de Servei?</h1>
<div class='content'><p>Un programa de servei és un tipus especial de programa en RPG que conté procediments que poden ser cridats des d'altres programes. Els programes de servei permeten agrupar funcionalitats relacionades en un sol lloc, facilitant la seva reutilització i manteniment.</p>
</div><h2>Avantatges dels Programes de Servei</h2>
<div class='content'><ul>
<li><strong>Reutilització de Codi:</strong> Permet compartir funcionalitats comunes entre diferents programes.</li>
<li><strong>Manteniment:</strong> Facilita l'actualització i manteniment del codi, ja que les modificacions es fan en un sol lloc.</li>
<li><strong>Modularitat:</strong> Promou la separació de funcionalitats en mòduls independents, millorant l'organització del codi.</li>
</ul>
</div><h1>Creació d'un Programa de Servei</h1>
<div class='content'></div><h2>Pas 1: Definir el Programa de Servei</h2>
<div class='content'><p>Per crear un programa de servei, primer hem de definir-lo utilitzant la paraula clau <code>H</code> per especificar que es tracta d'un programa de servei.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SCBERlRBQ1RHUlAoKk5PKSBBQ1RHUlAoKk5FVyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>H DFTACTGRP(*NO) ACTGRP(*NEW)</pre></div><div class='content'></div><h2>Pas 2: Definir els Procediments</h2>
<div class='content'><p>A continuació, definim els procediments que formaran part del programa de servei. Utilitzem la paraula clau <code>P</code> per definir un procediment.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UCBNeVByb2NlZHVyZSBCCkQgTXlQcm9jZWR1cmUgUEkKRCBwYXJtMSBTIDEwQQpEIHBhcm0yIFMgMTBBCgogL2ZyZWUKICAgICAvLyBDb2RpIGRlbCBwcm9jZWRpbWVudAogICAgIGRzcGx5ICdIZWxsbywgJyArIHBhcm0xICsgJyAnICsgcGFybTI7CiAvZW5kLWZyZWUKClAgTXlQcm9jZWR1cmUgRQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>P MyProcedure B
D MyProcedure PI
D parm1 S 10A
D parm2 S 10A

 /free
     // Codi del procediment
     dsply 'Hello, ' + parm1 + ' ' + parm2;
 /end-free

P MyProcedure E</pre></div><div class='content'></div><h2>Pas 3: Compilar el Programa de Servei</h2>
<div class='content'><p>Un cop definit el programa de servei i els seus procediments, el compilarem utilitzant la comanda <code>CRTSRVPGM</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JUU1JWUEdNIFNSVlBHTShNWUxJQi9NWVNSVlBHTSkgTU9EVUxFKE1ZTElCL01ZTU9EVUxFKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CRTSRVPGM SRVPGM(MYLIB/MYSRVPGM) MODULE(MYLIB/MYMODULE)</pre></div><div class='content'></div><h1>Utilització d'un Programa de Servei</h1>
<div class='content'></div><h2>Pas 1: Declarar el Programa de Servei</h2>
<div class='content'><p>Per utilitzar un programa de servei en un altre programa, primer hem de declarar-lo utilitzant la paraula clau <code>D</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RCBNeVNlcnZpY2UgUFIKRCBNeVByb2NlZHVyZSBQUgpEIHBhcm0xIFMgMTBBCkQgcGFybTIgUyAxMEE="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>D MyService PR
D MyProcedure PR
D parm1 S 10A
D parm2 S 10A</pre></div><div class='content'></div><h2>Pas 2: Cridar el Procediment</h2>
<div class='content'><p>Un cop declarat el programa de servei, podem cridar els seus procediments com si fossin subrutines locals.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IC9mcmVlCiAgICAgTXlQcm9jZWR1cmUoJ0pvaG4nLCAnRG9lJyk7CiAvZW5kLWZyZWU="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'> /free
     MyProcedure('John', 'Doe');
 /end-free</pre></div><div class='content'></div><h1>Exercici Pràctic</h1>
<div class='content'></div><h2>Exercici 1: Crear un Programa de Servei</h2>
<div class='content'><ol>
<li><strong>Definir el Programa de Servei:</strong> Crea un programa de servei anomenat <code>UTILS</code> que contingui un procediment <code>AddNumbers</code> que sumi dos números i retorni el resultat.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SCBERlRBQ1RHUlAoKk5PKSBBQ1RHUlAoKk5FVykKClAgQWRkTnVtYmVycyBCCkQgQWRkTnVtYmVycyBQSSAxMEkgMApEIG51bTEgUyAxMEkgMApEIG51bTIgUyAxMEkgMAoKIC9mcmVlCiAgICAgcmV0dXJuIG51bTEgKyBudW0yOwogL2VuZC1mcmVlCgpQIEFkZE51bWJlcnMgRQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>H DFTACTGRP(*NO) ACTGRP(*NEW)

P AddNumbers B
D AddNumbers PI 10I 0
D num1 S 10I 0
D num2 S 10I 0

 /free
     return num1 + num2;
 /end-free

P AddNumbers E</pre></div><div class='content'><ol start="2">
<li><strong>Compilar el Programa de Servei:</strong> Compila el programa de servei utilitzant la comanda <code>CRTSRVPGM</code>.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JUU1JWUEdNIFNSVlBHTShNWUxJQi9VVElMUykgTU9EVUxFKE1ZTElCL1VUSUxTKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CRTSRVPGM SRVPGM(MYLIB/UTILS) MODULE(MYLIB/UTILS)</pre></div><div class='content'></div><h2>Exercici 2: Utilitzar el Programa de Servei</h2>
<div class='content'><ol>
<li><strong>Declarar el Programa de Servei:</strong> En un altre programa, declara el programa de servei <code>UTILS</code> i el procediment <code>AddNumbers</code>.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RCBVVElMUyBQUgpEIEFkZE51bWJlcnMgUFIgMTBJIDAKRCBudW0xIFMgMTBJIDAKRCBudW0yIFMgMTBJIDA="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>D UTILS PR
D AddNumbers PR 10I 0
D num1 S 10I 0
D num2 S 10I 0</pre></div><div class='content'><ol start="2">
<li><strong>Cridar el Procediment:</strong> Crida el procediment <code>AddNumbers</code> per sumar dos números i mostrar el resultat.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IC9mcmVlCiAgICAgcmVzdWx0ID0gQWRkTnVtYmVycyg1LCAxMCk7CiAgICAgZHNwbHkgcmVzdWx0OwogL2VuZC1mcmVl"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'> /free
     result = AddNumbers(5, 10);
     dsply result;
 /end-free</pre></div><div class='content'></div><h1>Resum</h1>
<div class='content'><p>En aquesta secció, hem après què són els programes de servei i els procediments en RPG IV, com crear-los i utilitzar-los. Els programes de servei permeten la reutilització de codi i la separació de funcionalitats en mòduls independents, facilitant el manteniment i la modularitat del codi. Hem vist com definir un programa de servei, compilar-lo i utilitzar-lo en altres programes. A més, hem realitzat exercicis pràctics per reforçar els conceptes apresos.</p>
<p>En el següent tema, explorarem RPG en format lliure, una característica que permet escriure codi RPG de manera més flexible i llegible.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-03-ile-concepts' title="Conceptes ILE">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-01-web-services' title="Serveis Web">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
