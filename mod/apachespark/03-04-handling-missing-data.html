<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Gestió de Dades Faltants</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/03-04-handling-missing-data" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/03-04-handling-missing-data" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/03-04-handling-missing-data" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<a href="https://enterprisecampus.net/mod/apachespark/03-04-handling-missing-data" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/apachespark/03-04-handling-missing-data" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</span>
			<span class="d-none d-md-inline"><br><cite>Tot el coneixement al teu abast</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					 				<a href="/"><i class="bi bi-house-fill"></i> HOME</a>
											</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-03-working-with-datasets' title="Treballar amb Datasets">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Gestió de Dades Faltants</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-01-spark-streaming' title="Spark Streaming">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem com gestionar dades faltants en Apache Spark. La gestió de dades faltants és una part crucial del processament de dades, ja que les dades incompletes poden afectar la qualitat de les anàlisis i els resultats dels models d'aprenentatge automàtic.</p>
</div><h1>Objectius</h1>
<div class='content'><ul>
<li>Comprendre què són les dades faltants i per què és important gestionar-les.</li>
<li>Aprendre diferents tècniques per identificar i gestionar dades faltants en DataFrames de Spark.</li>
<li>Aplicar aquestes tècniques en exemples pràctics.</li>
</ul>
</div><h1>Què són les Dades Faltants?</h1>
<div class='content'><p>Les dades faltants es refereixen a valors que no estan presents en un conjunt de dades. Això pot ocórrer per diverses raons, com errors en la recopilació de dades, problemes tècnics o simplement perquè la informació no estava disponible en el moment de la recopilació.</p>
</div><h1>Importància de Gestionar les Dades Faltants</h1>
<div class='content'><ul>
<li><strong>Qualitat de les Dades</strong>: Les dades incompletes poden portar a conclusions errònies.</li>
<li><strong>Modelatge</strong>: Molts algoritmes d'aprenentatge automàtic no poden manejar dades faltants i requereixen que es tractin abans de l'entrenament.</li>
<li><strong>Anàlisi</strong>: Les anàlisis estadístiques poden ser esbiaixades si no es gestionen adequadament les dades faltants.</li>
</ul>
</div><h1>Identificació de Dades Faltants</h1>
<div class='content'></div><h2>Exemple Pràctic</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCmZyb20gcHlzcGFyay5zcWwuZnVuY3Rpb25zIGltcG9ydCBjb2wsIGlzbmFuLCB3aGVuLCBjb3VudAoKIyBDcmVhciB1bmEgc2Vzc2nDsyBkZSBTcGFyawpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkhhbmRsaW5nTWlzc2luZ0RhdGEiKS5nZXRPckNyZWF0ZSgpCgojIENyZWFyIHVuIERhdGFGcmFtZSBkJ2V4ZW1wbGUKZGF0YSA9IFsoMSwgIkFsaWNlIiwgNTApLCAoMiwgIkJvYiIsIE5vbmUpLCAoMywgTm9uZSwgMzApLCAoNCwgIkRhdmlkIiwgNDUpLCAoNSwgIkV2ZSIsIE5vbmUpXQpjb2x1bW5zID0gWyJpZCIsICJuYW1lIiwgImFnZSJdCgpkZiA9IHNwYXJrLmNyZWF0ZURhdGFGcmFtZShkYXRhLCBjb2x1bW5zKQoKIyBNb3N0cmFyIGVsIERhdGFGcmFtZSBvcmlnaW5hbApkZi5zaG93KCkKCiMgSWRlbnRpZmljYXIgbGVzIGRhZGVzIGZhbHRhbnRzCmRmLnNlbGVjdChbY291bnQod2hlbihpc25hbihjKSB8IGNvbChjKS5pc051bGwoKSwgYykpLmFsaWFzKGMpIGZvciBjIGluIGRmLmNvbHVtbnNdKS5zaG93KCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession
from pyspark.sql.functions import col, isnan, when, count

# Crear una sessi&oacute; de Spark
spark = SparkSession.builder.appName(&quot;HandlingMissingData&quot;).getOrCreate()

# Crear un DataFrame d'exemple
data = [(1, &quot;Alice&quot;, 50), (2, &quot;Bob&quot;, None), (3, None, 30), (4, &quot;David&quot;, 45), (5, &quot;Eve&quot;, None)]
columns = [&quot;id&quot;, &quot;name&quot;, &quot;age&quot;]

df = spark.createDataFrame(data, columns)

# Mostrar el DataFrame original
df.show()

# Identificar les dades faltants
df.select([count(when(isnan(c) | col(c).isNull(), c)).alias(c) for c in df.columns]).show()</pre></div><div class='content'></div><h2>Explicació del Codi</h2>
<div class='content'><ol>
<li><strong>Crear una Sessió de Spark</strong>: Iniciem una sessió de Spark.</li>
<li><strong>Crear un DataFrame d'Exemple</strong>: Definim un DataFrame amb algunes dades faltants.</li>
<li><strong>Mostrar el DataFrame Original</strong>: Utilitzem <code>show()</code> per veure el contingut del DataFrame.</li>
<li><strong>Identificar les Dades Faltants</strong>: Utilitzem <code>isnan</code> i <code>isNull</code> per comptar els valors faltants en cada columna.</li>
</ol>
</div><h1>Tècniques per Gestionar Dades Faltants</h1>
<div class='content'></div><h2><ol>
<li>Eliminar Files o Columnes</li>
</ol></h2>
<div class='content'><h4>Exemple Pràctic</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFbGltaW5hciBmaWxlcyBhbWIgcXVhbHNldm9sIHZhbG9yIGZhbHRhbnQKZGZfY2xlYW5lZCA9IGRmLm5hLmRyb3AoKQpkZl9jbGVhbmVkLnNob3coKQoKIyBFbGltaW5hciBjb2x1bW5lcyBhbWIgcXVhbHNldm9sIHZhbG9yIGZhbHRhbnQKZGZfY2xlYW5lZF9jb2xzID0gZGYuZHJvcG5hKGhvdz0nYW55Jywgc3Vic2V0PVsnbmFtZScsICdhZ2UnXSkKZGZfY2xlYW5lZF9jb2xzLnNob3coKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Eliminar files amb qualsevol valor faltant
df_cleaned = df.na.drop()
df_cleaned.show()

# Eliminar columnes amb qualsevol valor faltant
df_cleaned_cols = df.dropna(how='any', subset=['name', 'age'])
df_cleaned_cols.show()</pre></div><div class='content'></div><h2>Explicació del Codi</h2>
<div class='content'><ol>
<li><strong>Eliminar Files amb Valors Faltants</strong>: Utilitzem <code>na.drop()</code> per eliminar files que continguin qualsevol valor faltant.</li>
<li><strong>Eliminar Columnes amb Valors Faltants</strong>: Utilitzem <code>dropna()</code> amb el paràmetre <code>subset</code> per eliminar columnes específiques amb valors faltants.</li>
</ol>
</div><h2><ol start="2">
<li>Imputació de Valors</li>
</ol></h2>
<div class='content'><h4>Exemple Pràctic</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmZlYXR1cmUgaW1wb3J0IEltcHV0ZXIKCiMgSW1wdXRhciB2YWxvcnMgZmFsdGFudHMgYW1iIGxhIG1pdGphbmEKaW1wdXRlciA9IEltcHV0ZXIoaW5wdXRDb2xzPVsiYWdlIl0sIG91dHB1dENvbHM9WyJpbXB1dGVkX2FnZSJdKS5zZXRTdHJhdGVneSgibWVhbiIpCmRmX2ltcHV0ZWQgPSBpbXB1dGVyLmZpdChkZikudHJhbnNmb3JtKGRmKQpkZl9pbXB1dGVkLnNob3coKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.feature import Imputer

# Imputar valors faltants amb la mitjana
imputer = Imputer(inputCols=[&quot;age&quot;], outputCols=[&quot;imputed_age&quot;]).setStrategy(&quot;mean&quot;)
df_imputed = imputer.fit(df).transform(df)
df_imputed.show()</pre></div><div class='content'></div><h2>Explicació del Codi</h2>
<div class='content'><ol>
<li><strong>Imputació de Valors</strong>: Utilitzem <code>Imputer</code> de <code>pyspark.ml.feature</code> per substituir els valors faltants amb la mitjana de la columna.</li>
</ol>
</div><h2><ol start="3">
<li>Substituir amb un Valor Específic</li>
</ol></h2>
<div class='content'><h4>Exemple Pràctic</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdWJzdGl0dWlyIHZhbG9ycyBmYWx0YW50cyBhbWIgdW4gdmFsb3IgZXNwZWPDrWZpYwpkZl9maWxsZWQgPSBkZi5uYS5maWxsKHsiYWdlIjogMCwgIm5hbWUiOiAiVW5rbm93biJ9KQpkZl9maWxsZWQuc2hvdygp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Substituir valors faltants amb un valor espec&iacute;fic
df_filled = df.na.fill({&quot;age&quot;: 0, &quot;name&quot;: &quot;Unknown&quot;})
df_filled.show()</pre></div><div class='content'></div><h2>Explicació del Codi</h2>
<div class='content'><ol>
<li><strong>Substituir amb un Valor Específic</strong>: Utilitzem <code>na.fill()</code> per substituir els valors faltants amb un valor específic per a cada columna.</li>
</ol>
</div><h1>Exercicis Pràctics</h1>
<div class='content'></div><h2>Exercici 1</h2>
<div class='content'><p><strong>Descripció</strong>: Carrega un DataFrame amb dades faltants i elimina totes les files que continguin valors faltants.</p>
<p><strong>Codi</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYXJyZWdhciB1biBEYXRhRnJhbWUgYW1iIGRhZGVzIGZhbHRhbnRzCmRhdGEgPSBbKDEsICJBbGljZSIsIDUwKSwgKDIsICJCb2IiLCBOb25lKSwgKDMsIE5vbmUsIDMwKSwgKDQsICJEYXZpZCIsIDQ1KSwgKDUsICJFdmUiLCBOb25lKV0KY29sdW1ucyA9IFsiaWQiLCAibmFtZSIsICJhZ2UiXQpkZiA9IHNwYXJrLmNyZWF0ZURhdGFGcmFtZShkYXRhLCBjb2x1bW5zKQoKIyBFbGltaW5hciBmaWxlcyBhbWIgdmFsb3JzIGZhbHRhbnRzCmRmX2NsZWFuZWQgPSBkZi5uYS5kcm9wKCkKZGZfY2xlYW5lZC5zaG93KCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Carregar un DataFrame amb dades faltants
data = [(1, &quot;Alice&quot;, 50), (2, &quot;Bob&quot;, None), (3, None, 30), (4, &quot;David&quot;, 45), (5, &quot;Eve&quot;, None)]
columns = [&quot;id&quot;, &quot;name&quot;, &quot;age&quot;]
df = spark.createDataFrame(data, columns)

# Eliminar files amb valors faltants
df_cleaned = df.na.drop()
df_cleaned.show()</pre></div><div class='content'></div><h2>Exercici 2</h2>
<div class='content'><p><strong>Descripció</strong>: Imputa els valors faltants en la columna <code>age</code> amb la mitjana de la columna.</p>
<p><strong>Codi</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmZlYXR1cmUgaW1wb3J0IEltcHV0ZXIKCiMgSW1wdXRhciB2YWxvcnMgZmFsdGFudHMgYW1iIGxhIG1pdGphbmEKaW1wdXRlciA9IEltcHV0ZXIoaW5wdXRDb2xzPVsiYWdlIl0sIG91dHB1dENvbHM9WyJpbXB1dGVkX2FnZSJdKS5zZXRTdHJhdGVneSgibWVhbiIpCmRmX2ltcHV0ZWQgPSBpbXB1dGVyLmZpdChkZikudHJhbnNmb3JtKGRmKQpkZl9pbXB1dGVkLnNob3coKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.feature import Imputer

# Imputar valors faltants amb la mitjana
imputer = Imputer(inputCols=[&quot;age&quot;], outputCols=[&quot;imputed_age&quot;]).setStrategy(&quot;mean&quot;)
df_imputed = imputer.fit(df).transform(df)
df_imputed.show()</pre></div><div class='content'></div><h1>Resum</h1>
<div class='content'><p>En aquesta secció, hem après què són les dades faltants i per què és important gestionar-les. Hem explorat diverses tècniques per identificar i gestionar dades faltants en DataFrames de Spark, incloent l'eliminació de files o columnes, la imputació de valors i la substitució amb valors específics. A més, hem aplicat aquestes tècniques en exemples pràctics i hem proporcionat exercicis per reforçar els conceptes apresos.</p>
<p>En el següent mòdul, explorarem la programació avançada amb Spark, incloent Spark Streaming i Spark MLlib.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-03-working-with-datasets' title="Treballar amb Datasets">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-01-spark-streaming' title="Spark Streaming">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Publicitat</h1>
<p>Aquest espai està destinat a publicitat.</p>
<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Gràcies per col·laborar!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			









		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
