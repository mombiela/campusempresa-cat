<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processament de Dades en Temps Real</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/07-01-real-time-data-processing" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/07-01-real-time-data-processing" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/07-01-real-time-data-processing" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/apachespark/07-01-real-time-data-processing" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/apachespark/07-01-real-time-data-processing" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-04-spark-kubernetes' title="Spark amb Kubernetes">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Processament de Dades en Temps Real</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-02-big-data-analytics' title="Anàlisi de Big Data">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En aquest tema, explorarem com Apache Spark pot ser utilitzat per processar dades en temps real. Això és especialment útil en aplicacions on la latència baixa és crítica, com ara la detecció de fraus, la monitorització de sistemes, i l'anàlisi de xarxes socials.</p>
</div><h1><p>Objectius del Tema</p>
</h1>
<div class='content'><ul>
<li>Comprendre els conceptes bàsics del processament de dades en temps real.</li>
<li>Aprendre a utilitzar Spark Streaming per processar fluxos de dades en temps real.</li>
<li>Implementar un exemple pràctic de processament de dades en temps real amb Spark Streaming.</li>
</ul>
</div><h1><p>Conceptes Bàsics del Processament de Dades en Temps Real</p>
</h1>
<div class='content'></div><h2><p>Què és el Processament de Dades en Temps Real?</p>
</h2>
<div class='content'><p>El processament de dades en temps real implica l'anàlisi i l'extracció d'informació de les dades a mesura que aquestes arriben. A diferència del processament per lots, on les dades es processen en blocs, el processament en temps real tracta les dades de manera contínua i immediata.</p>
</div><h2><p>Avantatges del Processament en Temps Real</p>
</h2>
<div class='content'><ul>
<li><strong>Latència Baixa:</strong> Permet prendre decisions immediates basades en dades recents.</li>
<li><strong>Actualització Contínua:</strong> Les dades i els resultats es mantenen actualitzats constantment.</li>
<li><strong>Reacció Ràpida:</strong> Ideal per a aplicacions que requereixen una resposta ràpida, com la detecció de fraus o la monitorització de sistemes.</li>
</ul>
</div><h1><p>Spark Streaming</p>
</h1>
<div class='content'></div><h2><p>Què és Spark Streaming?</p>
</h2>
<div class='content'><p>Spark Streaming és una extensió de l'API de Spark que permet processar fluxos de dades en temps real. Utilitza el concepte de micro-batching, on les dades es divideixen en petits lots que es processen de manera contínua.</p>
</div><h2><p>Arquitectura de Spark Streaming</p>
</h2>
<div class='content'><ul>
<li><strong>DStream (Discretized Stream):</strong> És l'abstracció bàsica de Spark Streaming, que representa un flux de dades dividit en petits lots.</li>
<li><strong>Transformacions:</strong> Operacions aplicades als DStreams per produir nous DStreams.</li>
<li><strong>Accions:</strong> Operacions que retornen un valor o emmagatzemen dades externament.</li>
</ul>
</div><h2><p>Exemple de Codi: Processament de Dades en Temps Real amb Spark Streaming</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrIGltcG9ydCBTcGFya0NvbnRleHQKZnJvbSBweXNwYXJrLnN0cmVhbWluZyBpbXBvcnQgU3RyZWFtaW5nQ29udGV4dAoKIyBDcmVhciB1biBTcGFya0NvbnRleHQKc2MgPSBTcGFya0NvbnRleHQoImxvY2FsWzJdIiwgIk5ldHdvcmtXb3JkQ291bnQiKQoKIyBDcmVhciB1biBTdHJlYW1pbmdDb250ZXh0IGFtYiB1biBpbnRlcnZhbCBkZSBiYXRjaCBkZSAxIHNlZ29uCnNzYyA9IFN0cmVhbWluZ0NvbnRleHQoc2MsIDEpCgojIENyZWFyIHVuIERTdHJlYW0gcXVlIGVzIGNvbm5lY3RhIGEgdW4gc2Vydmlkb3IgZGUgc29ja2V0IGVuIGVsIHBvcnQgOTk5OQpsaW5lcyA9IHNzYy5zb2NrZXRUZXh0U3RyZWFtKCJsb2NhbGhvc3QiLCA5OTk5KQoKIyBEaXZpZGlyIGNhZGEgbMOtbmlhIGVuIHBhcmF1bGVzCndvcmRzID0gbGluZXMuZmxhdE1hcChsYW1iZGEgbGluZTogbGluZS5zcGxpdCgiICIpKQoKIyBDb21wdGFyIGNhZGEgcGFyYXVsYSBlbiBjYWRhIGJhdGNoCnBhaXJzID0gd29yZHMubWFwKGxhbWJkYSB3b3JkOiAod29yZCwgMSkpCndvcmRDb3VudHMgPSBwYWlycy5yZWR1Y2VCeUtleShsYW1iZGEgeCwgeTogeCArIHkpCgojIEltcHJpbWlyIGxlcyBwYXJhdWxlcyBhbWIgZWxzIHNldXMgcmVzcGVjdGl1cyBjb21wdGVzCndvcmRDb3VudHMucHByaW50KCkKCiMgSW5pY2lhciBlbCBwcm9jZXNzYW1lbnQKc3NjLnN0YXJ0KCkKCiMgRXNwZXJhciBxdWUgZWwgcHJvY2Vzc2FtZW50IGFjYWJpCnNzYy5hd2FpdFRlcm1pbmF0aW9uKCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark import SparkContext
from pyspark.streaming import StreamingContext

# Crear un SparkContext
sc = SparkContext(&quot;local[2]&quot;, &quot;NetworkWordCount&quot;)

# Crear un StreamingContext amb un interval de batch de 1 segon
ssc = StreamingContext(sc, 1)

# Crear un DStream que es connecta a un servidor de socket en el port 9999
lines = ssc.socketTextStream(&quot;localhost&quot;, 9999)

# Dividir cada l&iacute;nia en paraules
words = lines.flatMap(lambda line: line.split(&quot; &quot;))

# Comptar cada paraula en cada batch
pairs = words.map(lambda word: (word, 1))
wordCounts = pairs.reduceByKey(lambda x, y: x + y)

# Imprimir les paraules amb els seus respectius comptes
wordCounts.pprint()

# Iniciar el processament
ssc.start()

# Esperar que el processament acabi
ssc.awaitTermination()</pre></div><div class='content'></div><h2><p>Explicació del Codi</p>
</h2>
<div class='content'><ol>
<li><strong>Creació del SparkContext i StreamingContext:</strong> Es crea un SparkContext per inicialitzar Spark i un StreamingContext per gestionar els fluxos de dades amb un interval de batch d'1 segon.</li>
<li><strong>Creació del DStream:</strong> Es crea un DStream que es connecta a un servidor de socket en el port 9999.</li>
<li><strong>Transformacions:</strong> Es divideixen les línies en paraules, es mapeja cada paraula a un parell (paraula, 1) i es redueixen els parells per clau per comptar les paraules.</li>
<li><strong>Accions:</strong> Es mostren els resultats per pantalla.</li>
<li><strong>Inici i Espera:</strong> Es comença el processament i es manté en espera fins que es finalitzi.</li>
</ol>
</div><h1><p>Exercici Pràctic</p>
</h1>
<div class='content'></div><h2><p>Exercici</p>
</h2>
<div class='content'><p>Implementa un sistema de comptatge de paraules en temps real que llegeixi dades d'un fitxer en lloc d'un socket.</p>
</div><h2><p>Solució</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrIGltcG9ydCBTcGFya0NvbnRleHQKZnJvbSBweXNwYXJrLnN0cmVhbWluZyBpbXBvcnQgU3RyZWFtaW5nQ29udGV4dAoKIyBDcmVhciB1biBTcGFya0NvbnRleHQKc2MgPSBTcGFya0NvbnRleHQoImxvY2FsWzJdIiwgIkZpbGVXb3JkQ291bnQiKQoKIyBDcmVhciB1biBTdHJlYW1pbmdDb250ZXh0IGFtYiB1biBpbnRlcnZhbCBkZSBiYXRjaCBkZSAxIHNlZ29uCnNzYyA9IFN0cmVhbWluZ0NvbnRleHQoc2MsIDEpCgojIENyZWFyIHVuIERTdHJlYW0gcXVlIGxsZWdlaXggZGFkZXMgZCd1biBkaXJlY3RvcmkKbGluZXMgPSBzc2MudGV4dEZpbGVTdHJlYW0oInBhdGgvdG8vZGlyZWN0b3J5IikKCiMgRGl2aWRpciBjYWRhIGzDrW5pYSBlbiBwYXJhdWxlcwp3b3JkcyA9IGxpbmVzLmZsYXRNYXAobGFtYmRhIGxpbmU6IGxpbmUuc3BsaXQoIiAiKSkKCiMgQ29tcHRhciBjYWRhIHBhcmF1bGEgZW4gY2FkYSBiYXRjaApwYWlycyA9IHdvcmRzLm1hcChsYW1iZGEgd29yZDogKHdvcmQsIDEpKQp3b3JkQ291bnRzID0gcGFpcnMucmVkdWNlQnlLZXkobGFtYmRhIHgsIHk6IHggKyB5KQoKIyBJbXByaW1pciBsZXMgcGFyYXVsZXMgYW1iIGVscyBzZXVzIHJlc3BlY3RpdXMgY29tcHRlcwp3b3JkQ291bnRzLnBwcmludCgpCgojIEluaWNpYXIgZWwgcHJvY2Vzc2FtZW50CnNzYy5zdGFydCgpCgojIEVzcGVyYXIgcXVlIGVsIHByb2Nlc3NhbWVudCBhY2FiaQpzc2MuYXdhaXRUZXJtaW5hdGlvbigp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark import SparkContext
from pyspark.streaming import StreamingContext

# Crear un SparkContext
sc = SparkContext(&quot;local[2]&quot;, &quot;FileWordCount&quot;)

# Crear un StreamingContext amb un interval de batch de 1 segon
ssc = StreamingContext(sc, 1)

# Crear un DStream que llegeix dades d'un directori
lines = ssc.textFileStream(&quot;path/to/directory&quot;)

# Dividir cada l&iacute;nia en paraules
words = lines.flatMap(lambda line: line.split(&quot; &quot;))

# Comptar cada paraula en cada batch
pairs = words.map(lambda word: (word, 1))
wordCounts = pairs.reduceByKey(lambda x, y: x + y)

# Imprimir les paraules amb els seus respectius comptes
wordCounts.pprint()

# Iniciar el processament
ssc.start()

# Esperar que el processament acabi
ssc.awaitTermination()</pre></div><div class='content'></div><h2><p>Explicació de la Solució</p>
</h2>
<div class='content'><p>Aquest codi és similar a l'exemple anterior, però en lloc de llegir dades d'un socket, llegeix dades d'un directori especificat. Això permet processar fitxers que es van afegint al directori en temps real.</p>
</div><h1><p>Resum</p>
</h1>
<div class='content'><p>En aquest tema, hem après els conceptes bàsics del processament de dades en temps real i com utilitzar Spark Streaming per implementar solucions de processament en temps real. Hem vist exemples pràctics de codi i hem realitzat un exercici per reforçar els conceptes apresos. En el següent tema, explorarem l'anàlisi de Big Data amb Apache Spark.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-04-spark-kubernetes' title="Spark amb Kubernetes">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-02-big-data-analytics' title="Anàlisi de Big Data">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
