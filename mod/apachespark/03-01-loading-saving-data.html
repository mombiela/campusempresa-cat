<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carregar i Desar Dades</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/03-01-loading-saving-data" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/03-01-loading-saving-data" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/03-01-loading-saving-data" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/apachespark/03-01-loading-saving-data" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/apachespark/03-01-loading-saving-data" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-spark-sql' title="Spark SQL">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Carregar i Desar Dades</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-dataframe-operations' title="Operacions amb DataFrame">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem com carregar i desar dades utilitzant Apache Spark. Aquest és un aspecte fonamental del treball amb Spark, ja que la majoria de les aplicacions de dades impliquen la lectura de dades d'alguna font, la seva transformació i l'escriptura dels resultats en una destinació.</p>
</div><h1>Objectius</h1>
<div class='content'><ul>
<li>Entendre com carregar dades en Spark.</li>
<li>Aprendre a desar dades processades.</li>
<li>Conèixer els diferents formats de fitxers suportats per Spark.</li>
</ul>
</div><h1>1. Carregar Dades en Spark</h1>
<div class='content'></div><h2>1.1. Formats de Fitxers Suportats</h2>
<div class='content'><p>Spark suporta una àmplia varietat de formats de fitxers, incloent:</p>
<ul>
<li>CSV</li>
<li>JSON</li>
<li>Parquet</li>
<li>ORC</li>
<li>Avro</li>
</ul>
</div><h2>1.2. Carregar un Fitxer CSV</h2>
<div class='content'><p>Per carregar un fitxer CSV en un DataFrame de Spark, utilitzarem el mètode <code>spark.read.csv</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIGRmID0gc3BhcmsucmVhZAogIC5vcHRpb24oImhlYWRlciIsICJ0cnVlIikgLy8gSW5kaWNhIHF1ZSBlbCBmaXR4ZXIgQ1NWIHTDqSB1bmEgY2Fww6dhbGVyYQogIC5vcHRpb24oImluZmVyU2NoZW1hIiwgInRydWUiKSAvLyBJbmZlcmlyIGF1dG9tw6B0aWNhbWVudCBlbHMgdGlwdXMgZGUgZGFkZXMKICAuY3N2KCJwYXRoL3RvL3lvdXIvZmlsZS5jc3YiKQoKZGYuc2hvdygpIC8vIE1vc3RyYSBsZXMgcHJpbWVyZXMgZmlsZXMgZGVsIERhdGFGcmFtZQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val df = spark.read
  .option(&quot;header&quot;, &quot;true&quot;) // Indica que el fitxer CSV t&eacute; una cap&ccedil;alera
  .option(&quot;inferSchema&quot;, &quot;true&quot;) // Inferir autom&agrave;ticament els tipus de dades
  .csv(&quot;path/to/your/file.csv&quot;)

df.show() // Mostra les primeres files del DataFrame</pre></div><div class='content'></div><h2>1.3. Carregar un Fitxer JSON</h2>
<div class='content'><p>Per carregar un fitxer JSON, utilitzarem el mètode <code>spark.read.json</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIGRmID0gc3BhcmsucmVhZC5qc29uKCJwYXRoL3RvL3lvdXIvZmlsZS5qc29uIikKCmRmLnNob3coKSAvLyBNb3N0cmEgbGVzIHByaW1lcmVzIGZpbGVzIGRlbCBEYXRhRnJhbWU="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val df = spark.read.json(&quot;path/to/your/file.json&quot;)

df.show() // Mostra les primeres files del DataFrame</pre></div><div class='content'></div><h2>1.4. Carregar un Fitxer Parquet</h2>
<div class='content'><p>El format Parquet és un format de fitxer columnar que és molt eficient per a l'emmagatzematge i la consulta de dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIGRmID0gc3BhcmsucmVhZC5wYXJxdWV0KCJwYXRoL3RvL3lvdXIvZmlsZS5wYXJxdWV0IikKCmRmLnNob3coKSAvLyBNb3N0cmEgbGVzIHByaW1lcmVzIGZpbGVzIGRlbCBEYXRhRnJhbWU="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val df = spark.read.parquet(&quot;path/to/your/file.parquet&quot;)

df.show() // Mostra les primeres files del DataFrame</pre></div><div class='content'></div><h1>2. Desar Dades en Spark</h1>
<div class='content'></div><h2>2.1. Desar un DataFrame com a Fitxer CSV</h2>
<div class='content'><p>Per desar un DataFrame com a fitxer CSV, utilitzarem el mètode <code>write.csv</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGYud3JpdGUKICAub3B0aW9uKCJoZWFkZXIiLCAidHJ1ZSIpIC8vIEluY2xvdXJlIGxhIGNhcMOnYWxlcmEgZW4gZWwgZml0eGVyIENTVgogIC5jc3YoInBhdGgvdG8vc2F2ZS9maWxlLmNzdiIp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>df.write
  .option(&quot;header&quot;, &quot;true&quot;) // Incloure la cap&ccedil;alera en el fitxer CSV
  .csv(&quot;path/to/save/file.csv&quot;)</pre></div><div class='content'></div><h2>2.2. Desar un DataFrame com a Fitxer JSON</h2>
<div class='content'><p>Per desar un DataFrame com a fitxer JSON, utilitzarem el mètode <code>write.json</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGYud3JpdGUuanNvbigicGF0aC90by9zYXZlL2ZpbGUuanNvbiIp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>df.write.json(&quot;path/to/save/file.json&quot;)</pre></div><div class='content'></div><h2>2.3. Desar un DataFrame com a Fitxer Parquet</h2>
<div class='content'><p>Per desar un DataFrame com a fitxer Parquet, utilitzarem el mètode <code>write.parquet</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGYud3JpdGUucGFycXVldCgicGF0aC90by9zYXZlL2ZpbGUucGFycXVldCIp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>df.write.parquet(&quot;path/to/save/file.parquet&quot;)</pre></div><div class='content'></div><h1>3. Exemples Pràctics</h1>
<div class='content'></div><h2>Exemple 1: Carregar i Desar un Fitxer CSV</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ2FycmVnYXIgZWwgZml0eGVyIENTVgp2YWwgZGYgPSBzcGFyay5yZWFkCiAgLm9wdGlvbigiaGVhZGVyIiwgInRydWUiKQogIC5vcHRpb24oImluZmVyU2NoZW1hIiwgInRydWUiKQogIC5jc3YoInBhdGgvdG8veW91ci9pbnB1dC5jc3YiKQoKLy8gUmVhbGl0emFyIGFsZ3VuYSB0cmFuc2Zvcm1hY2nDsyAocGVyIGV4ZW1wbGUsIGZpbHRyYXIgbGVzIGZpbGVzIGFtYiB2YWxvcnMgbnVscykKdmFsIGZpbHRlcmVkRGYgPSBkZi5maWx0ZXIoImNvbHVtbl9uYW1lIElTIE5PVCBOVUxMIikKCi8vIERlc2FyIGVsIERhdGFGcmFtZSByZXN1bHRhbnQgY29tIGEgZml0eGVyIENTVgpmaWx0ZXJlZERmLndyaXRlCiAgLm9wdGlvbigiaGVhZGVyIiwgInRydWUiKQogIC5jc3YoInBhdGgvdG8vc2F2ZS9vdXRwdXQuY3N2Iik="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Carregar el fitxer CSV
val df = spark.read
  .option(&quot;header&quot;, &quot;true&quot;)
  .option(&quot;inferSchema&quot;, &quot;true&quot;)
  .csv(&quot;path/to/your/input.csv&quot;)

// Realitzar alguna transformaci&oacute; (per exemple, filtrar les files amb valors nuls)
val filteredDf = df.filter(&quot;column_name IS NOT NULL&quot;)

// Desar el DataFrame resultant com a fitxer CSV
filteredDf.write
  .option(&quot;header&quot;, &quot;true&quot;)
  .csv(&quot;path/to/save/output.csv&quot;)</pre></div><div class='content'></div><h2>Exemple 2: Carregar i Desar un Fitxer JSON</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ2FycmVnYXIgZWwgZml0eGVyIEpTT04KdmFsIGRmID0gc3BhcmsucmVhZC5qc29uKCJwYXRoL3RvL3lvdXIvaW5wdXQuanNvbiIpCgovLyBSZWFsaXR6YXIgYWxndW5hIHRyYW5zZm9ybWFjacOzIChwZXIgZXhlbXBsZSwgc2VsZWNjaW9uYXIgY29sdW1uZXMgZXNwZWPDrWZpcXVlcykKdmFsIHNlbGVjdGVkRGYgPSBkZi5zZWxlY3QoImNvbHVtbjEiLCAiY29sdW1uMiIpCgovLyBEZXNhciBlbCBEYXRhRnJhbWUgcmVzdWx0YW50IGNvbSBhIGZpdHhlciBKU09OCnNlbGVjdGVkRGYud3JpdGUuanNvbigicGF0aC90by9zYXZlL291dHB1dC5qc29uIik="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Carregar el fitxer JSON
val df = spark.read.json(&quot;path/to/your/input.json&quot;)

// Realitzar alguna transformaci&oacute; (per exemple, seleccionar columnes espec&iacute;fiques)
val selectedDf = df.select(&quot;column1&quot;, &quot;column2&quot;)

// Desar el DataFrame resultant com a fitxer JSON
selectedDf.write.json(&quot;path/to/save/output.json&quot;)</pre></div><div class='content'></div><h1>Exercicis Pràctics</h1>
<div class='content'></div><h2>Exercici 1: Carregar i Desar un Fitxer Parquet</h2>
<div class='content'><ol>
<li>Carrega un fitxer Parquet des de la ruta <code>path/to/your/input.parquet</code>.</li>
<li>Filtra les files on la columna <code>age</code> és major que 30.</li>
<li>Desa el DataFrame resultant com a fitxer Parquet a la ruta <code>path/to/save/output.parquet</code>.</li>
</ol>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ2FycmVnYXIgZWwgZml0eGVyIFBhcnF1ZXQKdmFsIGRmID0gc3BhcmsucmVhZC5wYXJxdWV0KCJwYXRoL3RvL3lvdXIvaW5wdXQucGFycXVldCIpCgovLyBGaWx0cmFyIGxlcyBmaWxlcyBvbiBsYSBjb2x1bW5hICdhZ2UnIMOpcyBtYWpvciBxdWUgMzAKdmFsIGZpbHRlcmVkRGYgPSBkZi5maWx0ZXIoImFnZSA+IDMwIikKCi8vIERlc2FyIGVsIERhdGFGcmFtZSByZXN1bHRhbnQgY29tIGEgZml0eGVyIFBhcnF1ZXQKZmlsdGVyZWREZi53cml0ZS5wYXJxdWV0KCJwYXRoL3RvL3NhdmUvb3V0cHV0LnBhcnF1ZXQiKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Carregar el fitxer Parquet
val df = spark.read.parquet(&quot;path/to/your/input.parquet&quot;)

// Filtrar les files on la columna 'age' &eacute;s major que 30
val filteredDf = df.filter(&quot;age &gt; 30&quot;)

// Desar el DataFrame resultant com a fitxer Parquet
filteredDf.write.parquet(&quot;path/to/save/output.parquet&quot;)</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>En aquesta secció, hem après com carregar i desar dades utilitzant Apache Spark. Hem vist com treballar amb diferents formats de fitxers com CSV, JSON i Parquet. Aquests coneixements són essencials per a qualsevol treball amb dades en Spark, ja que la majoria de les aplicacions impliquen la lectura i escriptura de dades. En el proper tema, explorarem les operacions amb DataFrames per manipular i transformar les dades carregades.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-spark-sql' title="Spark SQL">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-dataframe-operations' title="Operacions amb DataFrame">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
