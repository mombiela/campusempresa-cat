<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Verificant Interaccions</title>

    <link rel="alternate" href="https://campusempresa.com/mod/junit/06-04-verifying-interactions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/junit/06-04-verifying-interactions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/junit/06-04-verifying-interactions" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<a href="https://enterprisecampus.net/mod/junit/06-04-verifying-interactions" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/junit/06-04-verifying-interactions" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</span>
			<span class="d-none d-md-inline"><br><cite>Tot el coneixement al teu abast</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					 				<a href="/"><i class="bi bi-house-fill"></i> HOME</a>
											</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-03-creating-mocks' title="Creant Mocks">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Verificant Interaccions</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-01-timeouts-in-junit' title="Timeouts a JUnit">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem com verificar les interaccions entre els mocks i els objectes reals utilitzant Mockito amb JUnit. La verificació d'interaccions és crucial per assegurar-nos que els nostres mocks es comporten com esperem durant les proves.</p>
</div><h1>Objectius</h1>
<div class='content'><ul>
<li>Entendre la importància de verificar interaccions.</li>
<li>Aprendre a utilitzar les funcions de verificació de Mockito.</li>
<li>Veure exemples pràctics de verificació d'interaccions.</li>
</ul>
</div><h1>Importància de Verificar Interaccions</h1>
<div class='content'><p>Quan fem servir mocks en les nostres proves, no només ens interessa el resultat final, sinó també com s'ha arribat a aquest resultat. Verificar les interaccions ens permet assegurar-nos que els mètodes dels mocks s'han cridat amb els arguments correctes i en l'ordre esperat.</p>
</div><h1>Funcions de Verificació de Mockito</h1>
<div class='content'><p>Mockito proporciona diverses funcions per verificar interaccions. Les més comunes són:</p>
<ul>
<li><code>verify(mock)</code>: Verifica que un mètode del mock s'ha cridat.</li>
<li><code>verify(mock, times(n))</code>: Verifica que un mètode del mock s'ha cridat exactament <code>n</code> vegades.</li>
<li><code>verify(mock, never())</code>: Verifica que un mètode del mock no s'ha cridat mai.</li>
<li><code>verify(mock, atLeast(n))</code>: Verifica que un mètode del mock s'ha cridat almenys <code>n</code> vegades.</li>
<li><code>verify(mock, atMost(n))</code>: Verifica que un mètode del mock s'ha cridat com a màxim <code>n</code> vegades.</li>
</ul>
</div><h1>Exemple Pràctic</h1>
<div class='content'></div><h2>Escenari</h2>
<div class='content'><p>Suposem que tenim una classe <code>UserService</code> que depèn d'una interfície <code>UserRepository</code> per obtenir informació dels usuaris. Volem verificar que el mètode <code>findUserById</code> de <code>UserRepository</code> s'ha cridat correctament.</p>
</div><h2>Codi</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gVXNlclNlcnZpY2UuamF2YQpwdWJsaWMgY2xhc3MgVXNlclNlcnZpY2UgewogICAgcHJpdmF0ZSBVc2VyUmVwb3NpdG9yeSB1c2VyUmVwb3NpdG9yeTsKCiAgICBwdWJsaWMgVXNlclNlcnZpY2UoVXNlclJlcG9zaXRvcnkgdXNlclJlcG9zaXRvcnkpIHsKICAgICAgICB0aGlzLnVzZXJSZXBvc2l0b3J5ID0gdXNlclJlcG9zaXRvcnk7CiAgICB9CgogICAgcHVibGljIFVzZXIgZ2V0VXNlckJ5SWQoaW50IGlkKSB7CiAgICAgICAgcmV0dXJuIHVzZXJSZXBvc2l0b3J5LmZpbmRVc2VyQnlJZChpZCk7CiAgICB9Cn0KCi8vIFVzZXJSZXBvc2l0b3J5LmphdmEKcHVibGljIGludGVyZmFjZSBVc2VyUmVwb3NpdG9yeSB7CiAgICBVc2VyIGZpbmRVc2VyQnlJZChpbnQgaWQpOwp9CgovLyBVc2VyU2VydmljZVRlc3QuamF2YQppbXBvcnQgc3RhdGljIG9yZy5tb2NraXRvLk1vY2tpdG8uKjsKaW1wb3J0IHN0YXRpYyBvcmcuanVuaXQuanVwaXRlci5hcGkuQXNzZXJ0aW9ucy4qOwppbXBvcnQgb3JnLmp1bml0Lmp1cGl0ZXIuYXBpLkJlZm9yZUVhY2g7CmltcG9ydCBvcmcuanVuaXQuanVwaXRlci5hcGkuVGVzdDsKCnB1YmxpYyBjbGFzcyBVc2VyU2VydmljZVRlc3QgewogICAgcHJpdmF0ZSBVc2VyUmVwb3NpdG9yeSB1c2VyUmVwb3NpdG9yeTsKICAgIHByaXZhdGUgVXNlclNlcnZpY2UgdXNlclNlcnZpY2U7CgogICAgQEJlZm9yZUVhY2gKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgewogICAgICAgIHVzZXJSZXBvc2l0b3J5ID0gbW9jayhVc2VyUmVwb3NpdG9yeS5jbGFzcyk7CiAgICAgICAgdXNlclNlcnZpY2UgPSBuZXcgVXNlclNlcnZpY2UodXNlclJlcG9zaXRvcnkpOwogICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0R2V0VXNlckJ5SWQoKSB7CiAgICAgICAgVXNlciB1c2VyID0gbmV3IFVzZXIoMSwgIkpvaG4gRG9lIik7CiAgICAgICAgd2hlbih1c2VyUmVwb3NpdG9yeS5maW5kVXNlckJ5SWQoMSkpLnRoZW5SZXR1cm4odXNlcik7CgogICAgICAgIFVzZXIgcmVzdWx0ID0gdXNlclNlcnZpY2UuZ2V0VXNlckJ5SWQoMSk7CgogICAgICAgIGFzc2VydEVxdWFscyh1c2VyLCByZXN1bHQpOwogICAgICAgIHZlcmlmeSh1c2VyUmVwb3NpdG9yeSkuZmluZFVzZXJCeUlkKDEpOyAvLyBWZXJpZmljYSBxdWUgZWwgbcOodG9kZSBzJ2hhIGNyaWRhdCB1bmEgdmVnYWRhCiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// UserService.java
public class UserService {
    private UserRepository userRepository;

    public UserService(UserRepository userRepository) {
        this.userRepository = userRepository;
    }

    public User getUserById(int id) {
        return userRepository.findUserById(id);
    }
}

// UserRepository.java
public interface UserRepository {
    User findUserById(int id);
}

// UserServiceTest.java
import static org.mockito.Mockito.*;
import static org.junit.jupiter.api.Assertions.*;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

public class UserServiceTest {
    private UserRepository userRepository;
    private UserService userService;

    @BeforeEach
    public void setUp() {
        userRepository = mock(UserRepository.class);
        userService = new UserService(userRepository);
    }

    @Test
    public void testGetUserById() {
        User user = new User(1, &quot;John Doe&quot;);
        when(userRepository.findUserById(1)).thenReturn(user);

        User result = userService.getUserById(1);

        assertEquals(user, result);
        verify(userRepository).findUserById(1); // Verifica que el m&egrave;tode s'ha cridat una vegada
    }
}</pre></div><div class='content'></div><h2>Explicació del Codi</h2>
<div class='content'><ol>
<li><strong>Mocking</strong>: Utilitzem <code>mock(UserRepository.class)</code> per crear un mock de <code>UserRepository</code>.</li>
<li><strong>Configuració</strong>: Utilitzem <code>when(userRepository.findUserById(1)).thenReturn(user)</code> per definir el comportament del mock.</li>
<li><strong>Verificació</strong>: Utilitzem <code>verify(userRepository).findUserById(1)</code> per verificar que el mètode <code>findUserById</code> s'ha cridat amb l'argument <code>1</code>.</li>
</ol>
</div><h1>Exercicis Pràctics</h1>
<div class='content'></div><h2>Exercici 1</h2>
<div class='content'><p>Crea una classe <code>OrderService</code> que depengui d'una interfície <code>OrderRepository</code>. Escriu una prova que verifiqui que el mètode <code>saveOrder</code> de <code>OrderRepository</code> s'ha cridat exactament una vegada quan es guarda una comanda.</p>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gT3JkZXJTZXJ2aWNlLmphdmEKcHVibGljIGNsYXNzIE9yZGVyU2VydmljZSB7CiAgICBwcml2YXRlIE9yZGVyUmVwb3NpdG9yeSBvcmRlclJlcG9zaXRvcnk7CgogICAgcHVibGljIE9yZGVyU2VydmljZShPcmRlclJlcG9zaXRvcnkgb3JkZXJSZXBvc2l0b3J5KSB7CiAgICAgICAgdGhpcy5vcmRlclJlcG9zaXRvcnkgPSBvcmRlclJlcG9zaXRvcnk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2F2ZU9yZGVyKE9yZGVyIG9yZGVyKSB7CiAgICAgICAgb3JkZXJSZXBvc2l0b3J5LnNhdmVPcmRlcihvcmRlcik7CiAgICB9Cn0KCi8vIE9yZGVyUmVwb3NpdG9yeS5qYXZhCnB1YmxpYyBpbnRlcmZhY2UgT3JkZXJSZXBvc2l0b3J5IHsKICAgIHZvaWQgc2F2ZU9yZGVyKE9yZGVyIG9yZGVyKTsKfQoKLy8gT3JkZXJTZXJ2aWNlVGVzdC5qYXZhCmltcG9ydCBzdGF0aWMgb3JnLm1vY2tpdG8uTW9ja2l0by4qOwppbXBvcnQgb3JnLmp1bml0Lmp1cGl0ZXIuYXBpLkJlZm9yZUVhY2g7CmltcG9ydCBvcmcuanVuaXQuanVwaXRlci5hcGkuVGVzdDsKCnB1YmxpYyBjbGFzcyBPcmRlclNlcnZpY2VUZXN0IHsKICAgIHByaXZhdGUgT3JkZXJSZXBvc2l0b3J5IG9yZGVyUmVwb3NpdG9yeTsKICAgIHByaXZhdGUgT3JkZXJTZXJ2aWNlIG9yZGVyU2VydmljZTsKCiAgICBAQmVmb3JlRWFjaAogICAgcHVibGljIHZvaWQgc2V0VXAoKSB7CiAgICAgICAgb3JkZXJSZXBvc2l0b3J5ID0gbW9jayhPcmRlclJlcG9zaXRvcnkuY2xhc3MpOwogICAgICAgIG9yZGVyU2VydmljZSA9IG5ldyBPcmRlclNlcnZpY2Uob3JkZXJSZXBvc2l0b3J5KTsKICAgIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdFNhdmVPcmRlcigpIHsKICAgICAgICBPcmRlciBvcmRlciA9IG5ldyBPcmRlcigxLCAiUHJvZHVjdCBBIik7CgogICAgICAgIG9yZGVyU2VydmljZS5zYXZlT3JkZXIob3JkZXIpOwoKICAgICAgICB2ZXJpZnkob3JkZXJSZXBvc2l0b3J5KS5zYXZlT3JkZXIob3JkZXIpOyAvLyBWZXJpZmljYSBxdWUgZWwgbcOodG9kZSBzJ2hhIGNyaWRhdCB1bmEgdmVnYWRhCiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// OrderService.java
public class OrderService {
    private OrderRepository orderRepository;

    public OrderService(OrderRepository orderRepository) {
        this.orderRepository = orderRepository;
    }

    public void saveOrder(Order order) {
        orderRepository.saveOrder(order);
    }
}

// OrderRepository.java
public interface OrderRepository {
    void saveOrder(Order order);
}

// OrderServiceTest.java
import static org.mockito.Mockito.*;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

public class OrderServiceTest {
    private OrderRepository orderRepository;
    private OrderService orderService;

    @BeforeEach
    public void setUp() {
        orderRepository = mock(OrderRepository.class);
        orderService = new OrderService(orderRepository);
    }

    @Test
    public void testSaveOrder() {
        Order order = new Order(1, &quot;Product A&quot;);

        orderService.saveOrder(order);

        verify(orderRepository).saveOrder(order); // Verifica que el m&egrave;tode s'ha cridat una vegada
    }
}</pre></div><div class='content'></div><h2>Exercici 2</h2>
<div class='content'><p>Modifica la prova anterior per verificar que el mètode <code>saveOrder</code> no s'ha cridat mai quan es passa una comanda nul·la.</p>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFRlc3QKcHVibGljIHZvaWQgdGVzdFNhdmVPcmRlcldpdGhOdWxsKCkgewogICAgb3JkZXJTZXJ2aWNlLnNhdmVPcmRlcihudWxsKTsKCiAgICB2ZXJpZnkob3JkZXJSZXBvc2l0b3J5LCBuZXZlcigpKS5zYXZlT3JkZXIoYW55KE9yZGVyLmNsYXNzKSk7IC8vIFZlcmlmaWNhIHF1ZSBlbCBtw6h0b2RlIG5vIHMnaGEgY3JpZGF0IG1haQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@Test
public void testSaveOrderWithNull() {
    orderService.saveOrder(null);

    verify(orderRepository, never()).saveOrder(any(Order.class)); // Verifica que el m&egrave;tode no s'ha cridat mai
}</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>La verificació d'interaccions és una part essencial de les proves amb mocks. Ens permet assegurar-nos que els nostres mocks es comporten com esperem i que els mètodes s'han cridat amb els arguments correctes. Amb les funcions de verificació de Mockito, podem escriure proves més robustes i fiables.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-03-creating-mocks' title="Creant Mocks">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-01-timeouts-in-junit' title="Timeouts a JUnit">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Publicitat</h1>
<p>Aquest espai està destinat a publicitat.</p>
<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Gràcies per col·laborar!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			









		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
