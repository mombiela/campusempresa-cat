<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carregant dades</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/03-01-loading-data" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/03-01-loading-data" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/03-01-loading-data" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/tensorflow/03-01-loading-data" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/03-01-loading-data" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-eager-execution' title="Execució immediata">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Carregant dades</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-data-pipelines-with-tf-data' title="Pipelines de dades amb tf.data">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem com carregar dades en TensorFlow, una habilitat fonamental per a qualsevol projecte de machine learning. TensorFlow proporciona diverses eines i mètodes per gestionar i carregar dades de manera eficient. Explorarem les següents àrees:</p>
<ol>
<li><strong>Carregant dades des de fitxers CSV</strong></li>
<li><strong>Carregant dades des de fitxers d'imatge</strong></li>
<li><strong>Carregant dades des de fitxers TFRecord</strong></li>
<li><strong>Utilitzant <code>tf.data.Dataset</code> per gestionar dades</strong></li>
</ol>
</div><h1><ol>
<li>Carregant dades des de fitxers CSV</li>
</ol>
</h1>
<div class='content'><p>Els fitxers CSV són un format comú per emmagatzemar dades tabulars. TensorFlow ofereix funcions per carregar i processar aquests fitxers fàcilment.</p>
</div><h2><p>Exemple pràctic: Carregar un fitxer CSV</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgRGVmaW5pbSBlbCBjYW3DrSBkZWwgZml0eGVyIENTVgpjc3ZfZmlsZV9wYXRoID0gJ3BhdGgvdG8veW91ci9maWxlLmNzdicKCiMgVXRpbGl0emVtIHRmLmRhdGEuZXhwZXJpbWVudGFsLm1ha2VfY3N2X2RhdGFzZXQgcGVyIGNhcnJlZ2FyIGVsIGZpdHhlciBDU1YKZGF0YXNldCA9IHRmLmRhdGEuZXhwZXJpbWVudGFsLm1ha2VfY3N2X2RhdGFzZXQoCiAgICBjc3ZfZmlsZV9wYXRoLAogICAgYmF0Y2hfc2l6ZT0zMiwgICMgTm9tYnJlIGRlIG1vc3RyZXMgcGVyIGJhdGNoCiAgICBsYWJlbF9uYW1lPSd0YXJnZXRfY29sdW1uJywgICMgTm9tIGRlIGxhIGNvbHVtbmEgb2JqZWN0aXUKICAgIG5hX3ZhbHVlPSI/IiwgICMgVmFsb3IgcGVyIGEgbGVzIGRhZGVzIG1hbmNhbnRzCiAgICBudW1fZXBvY2hzPTEsICAjIE5vbWJyZSBkJ8OocG9xdWVzCiAgICBpZ25vcmVfZXJyb3JzPVRydWUgICMgSWdub3JhciBlcnJvcnMgZHVyYW50IGxhIGxlY3R1cmEKKQoKIyBNb3N0cmVtIGFsZ3VuZXMgbW9zdHJlcyBkZWwgZGF0YXNldApmb3IgZmVhdHVyZXMsIGxhYmVsIGluIGRhdGFzZXQudGFrZSgxKToKICAgIHByaW50KCJGZWF0dXJlczoiLCBmZWF0dXJlcykKICAgIHByaW50KCJMYWJlbDoiLCBsYWJlbCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Definim el cam&iacute; del fitxer CSV
csv_file_path = 'path/to/your/file.csv'

# Utilitzem tf.data.experimental.make_csv_dataset per carregar el fitxer CSV
dataset = tf.data.experimental.make_csv_dataset(
    csv_file_path,
    batch_size=32,  # Nombre de mostres per batch
    label_name='target_column',  # Nom de la columna objectiu
    na_value=&quot;?&quot;,  # Valor per a les dades mancants
    num_epochs=1,  # Nombre d'&egrave;poques
    ignore_errors=True  # Ignorar errors durant la lectura
)

# Mostrem algunes mostres del dataset
for features, label in dataset.take(1):
    print(&quot;Features:&quot;, features)
    print(&quot;Label:&quot;, label)</pre></div><div class='content'></div><h2><p>Explicació del codi</p>
</h2>
<div class='content'><ul>
<li><strong><code>tf.data.experimental.make_csv_dataset</code></strong>: Aquesta funció llegeix un fitxer CSV i el converteix en un <code>tf.data.Dataset</code>.</li>
<li><strong><code>batch_size</code></strong>: Defineix el nombre de mostres per batch.</li>
<li><strong><code>label_name</code></strong>: El nom de la columna que conté les etiquetes.</li>
<li><strong><code>na_value</code></strong>: El valor que representa dades mancants.</li>
<li><strong><code>num_epochs</code></strong>: El nombre de vegades que el dataset serà iterat.</li>
<li><strong><code>ignore_errors</code></strong>: Si es <code>True</code>, ignora els errors durant la lectura del fitxer.</li>
</ul>
</div><h1><ol start="2">
<li>Carregant dades des de fitxers d'imatge</li>
</ol>
</h1>
<div class='content'><p>TensorFlow també facilita la càrrega d'imatges des de directoris. Utilitzarem <code>tf.keras.preprocessing.image_dataset_from_directory</code> per carregar imatges.</p>
</div><h2><p>Exemple pràctic: Carregar imatges des d'un directori</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgRGVmaW5pbSBlbCBjYW3DrSBkZWwgZGlyZWN0b3JpIGQnaW1hdGdlcwppbWFnZV9kaXJlY3RvcnkgPSAncGF0aC90by95b3VyL2ltYWdlX2RpcmVjdG9yeScKCiMgVXRpbGl0emVtIGltYWdlX2RhdGFzZXRfZnJvbV9kaXJlY3RvcnkgcGVyIGNhcnJlZ2FyIGxlcyBpbWF0Z2VzCmRhdGFzZXQgPSB0Zi5rZXJhcy5wcmVwcm9jZXNzaW5nLmltYWdlX2RhdGFzZXRfZnJvbV9kaXJlY3RvcnkoCiAgICBpbWFnZV9kaXJlY3RvcnksCiAgICBiYXRjaF9zaXplPTMyLCAgIyBOb21icmUgZCdpbWF0Z2VzIHBlciBiYXRjaAogICAgaW1hZ2Vfc2l6ZT0oMjU2LCAyNTYpLCAgIyBNaWRhIGRlIGxlcyBpbWF0Z2VzCiAgICBsYWJlbF9tb2RlPSdpbnQnICAjIE1vZGUgZCdldGlxdWV0YXRnZSAoaW50LCBjYXRlZ29yaWNhbCwgTm9uZSkKKQoKIyBNb3N0cmVtIGFsZ3VuZXMgaW1hdGdlcyBkZWwgZGF0YXNldAppbXBvcnQgbWF0cGxvdGxpYi5weXBsb3QgYXMgcGx0Cgpmb3IgaW1hZ2VzLCBsYWJlbHMgaW4gZGF0YXNldC50YWtlKDEpOgogICAgcGx0LmZpZ3VyZShmaWdzaXplPSgxMCwgMTApKQogICAgZm9yIGkgaW4gcmFuZ2UoOSk6CiAgICAgICAgYXggPSBwbHQuc3VicGxvdCgzLCAzLCBpICsgMSkKICAgICAgICBwbHQuaW1zaG93KGltYWdlc1tpXS5udW1weSgpLmFzdHlwZSgidWludDgiKSkKICAgICAgICBwbHQudGl0bGUoaW50KGxhYmVsc1tpXSkpCiAgICAgICAgcGx0LmF4aXMoIm9mZiIpCiAgICBwbHQuc2hvdygp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Definim el cam&iacute; del directori d'imatges
image_directory = 'path/to/your/image_directory'

# Utilitzem image_dataset_from_directory per carregar les imatges
dataset = tf.keras.preprocessing.image_dataset_from_directory(
    image_directory,
    batch_size=32,  # Nombre d'imatges per batch
    image_size=(256, 256),  # Mida de les imatges
    label_mode='int'  # Mode d'etiquetatge (int, categorical, None)
)

# Mostrem algunes imatges del dataset
import matplotlib.pyplot as plt

for images, labels in dataset.take(1):
    plt.figure(figsize=(10, 10))
    for i in range(9):
        ax = plt.subplot(3, 3, i + 1)
        plt.imshow(images[i].numpy().astype(&quot;uint8&quot;))
        plt.title(int(labels[i]))
        plt.axis(&quot;off&quot;)
    plt.show()</pre></div><div class='content'></div><h2><p>Explicació del codi</p>
</h2>
<div class='content'><ul>
<li><strong><code>tf.keras.preprocessing.image_dataset_from_directory</code></strong>: Aquesta funció llegeix imatges d'un directori i les converteix en un <code>tf.data.Dataset</code>.</li>
<li><strong><code>batch_size</code></strong>: Defineix el nombre d'imatges per batch.</li>
<li><strong><code>image_size</code></strong>: Defineix la mida de les imatges.</li>
<li><strong><code>label_mode</code></strong>: Defineix el mode d'etiquetatge (<code>int</code>, <code>categorical</code>, <code>None</code>).</li>
</ul>
</div><h1><ol start="3">
<li>Carregant dades des de fitxers TFRecord</li>
</ol>
</h1>
<div class='content'><p>Els fitxers TFRecord són un format binari eficient per emmagatzemar dades. Són especialment útils per a datasets grans.</p>
</div><h2><p>Exemple pràctic: Carregar un fitxer TFRecord</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgRGVmaW5pbSBlbCBjYW3DrSBkZWwgZml0eGVyIFRGUmVjb3JkCnRmcmVjb3JkX2ZpbGVfcGF0aCA9ICdwYXRoL3RvL3lvdXIvZmlsZS50ZnJlY29yZCcKCiMgRGVmaW5pbSB1bmEgZnVuY2nDsyBwZXIgcGFyc2VqYXIgZWxzIGV4ZW1wbGVzCmRlZiBfcGFyc2VfZnVuY3Rpb24ocHJvdG8pOgogICAgIyBEZWZpbmltIGxlcyBjYXJhY3RlcsOtc3RpcXVlcwogICAgZmVhdHVyZV9kZXNjcmlwdGlvbiA9IHsKICAgICAgICAnZmVhdHVyZTEnOiB0Zi5pby5GaXhlZExlbkZlYXR1cmUoW10sIHRmLmZsb2F0MzIpLAogICAgICAgICdmZWF0dXJlMic6IHRmLmlvLkZpeGVkTGVuRmVhdHVyZShbXSwgdGYuaW50NjQpLAogICAgICAgICdsYWJlbCc6IHRmLmlvLkZpeGVkTGVuRmVhdHVyZShbXSwgdGYuaW50NjQpLAogICAgfQogICAgcmV0dXJuIHRmLmlvLnBhcnNlX3NpbmdsZV9leGFtcGxlKHByb3RvLCBmZWF0dXJlX2Rlc2NyaXB0aW9uKQoKIyBVdGlsaXR6ZW0gdGYuZGF0YS5URlJlY29yZERhdGFzZXQgcGVyIGNhcnJlZ2FyIGVsIGZpdHhlciBURlJlY29yZApkYXRhc2V0ID0gdGYuZGF0YS5URlJlY29yZERhdGFzZXQodGZyZWNvcmRfZmlsZV9wYXRoKQpkYXRhc2V0ID0gZGF0YXNldC5tYXAoX3BhcnNlX2Z1bmN0aW9uKQoKIyBNb3N0cmVtIGFsZ3VuZXMgbW9zdHJlcyBkZWwgZGF0YXNldApmb3IgcmVjb3JkIGluIGRhdGFzZXQudGFrZSgxKToKICAgIHByaW50KHJlY29yZCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Definim el cam&iacute; del fitxer TFRecord
tfrecord_file_path = 'path/to/your/file.tfrecord'

# Definim una funci&oacute; per parsejar els exemples
def _parse_function(proto):
    # Definim les caracter&iacute;stiques
    feature_description = {
        'feature1': tf.io.FixedLenFeature([], tf.float32),
        'feature2': tf.io.FixedLenFeature([], tf.int64),
        'label': tf.io.FixedLenFeature([], tf.int64),
    }
    return tf.io.parse_single_example(proto, feature_description)

# Utilitzem tf.data.TFRecordDataset per carregar el fitxer TFRecord
dataset = tf.data.TFRecordDataset(tfrecord_file_path)
dataset = dataset.map(_parse_function)

# Mostrem algunes mostres del dataset
for record in dataset.take(1):
    print(record)</pre></div><div class='content'></div><h2><p>Explicació del codi</p>
</h2>
<div class='content'><ul>
<li><strong><code>tf.data.TFRecordDataset</code></strong>: Aquesta funció llegeix un fitxer TFRecord i el converteix en un <code>tf.data.Dataset</code>.</li>
<li><strong><code>_parse_function</code></strong>: Una funció per parsejar els exemples del fitxer TFRecord.</li>
<li><strong><code>tf.io.parse_single_example</code></strong>: Aquesta funció parseja un sol exemple del fitxer TFRecord.</li>
</ul>
</div><h1><ol start="4">
<li>Utilitzant <code>tf.data.Dataset</code> per gestionar dades</li>
</ol>
</h1>
<div class='content'><p>El mòdul <code>tf.data</code> proporciona una API potent per construir pipelines de dades eficients.</p>
</div><h2><p>Exemple pràctic: Crear un pipeline de dades</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgRGVmaW5pbSB1bmEgbGxpc3RhIGRlIGRhZGVzCmRhdGEgPSBbMSwgMiwgMywgNCwgNV0KCiMgQ29udmVydGltIGxhIGxsaXN0YSBlbiB1biB0Zi5kYXRhLkRhdGFzZXQKZGF0YXNldCA9IHRmLmRhdGEuRGF0YXNldC5mcm9tX3RlbnNvcl9zbGljZXMoZGF0YSkKCiMgQXBsaXF1ZW0gdHJhbnNmb3JtYWNpb25zIGFsIGRhdGFzZXQKZGF0YXNldCA9IGRhdGFzZXQubWFwKGxhbWJkYSB4OiB4ICogMikKZGF0YXNldCA9IGRhdGFzZXQuYmF0Y2goMikKCiMgTW9zdHJlbSBhbGd1bmVzIG1vc3RyZXMgZGVsIGRhdGFzZXQKZm9yIGJhdGNoIGluIGRhdGFzZXQ6CiAgICBwcmludChiYXRjaCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Definim una llista de dades
data = [1, 2, 3, 4, 5]

# Convertim la llista en un tf.data.Dataset
dataset = tf.data.Dataset.from_tensor_slices(data)

# Apliquem transformacions al dataset
dataset = dataset.map(lambda x: x * 2)
dataset = dataset.batch(2)

# Mostrem algunes mostres del dataset
for batch in dataset:
    print(batch)</pre></div><div class='content'></div><h2><p>Explicació del codi</p>
</h2>
<div class='content'><ul>
<li><strong><code>tf.data.Dataset.from_tensor_slices</code></strong>: Aquesta funció converteix una llista en un <code>tf.data.Dataset</code>.</li>
<li><strong><code>map</code></strong>: Aplica una transformació a cada element del dataset.</li>
<li><strong><code>batch</code></strong>: Agrupa els elements del dataset en batches.</li>
</ul>
</div><h1><p>Resum</p>
</h1>
<div class='content'><p>En aquest tema, hem après com carregar dades en TensorFlow utilitzant diferents mètodes i formats, incloent fitxers CSV, imatges, fitxers TFRecord i el mòdul <code>tf.data.Dataset</code>. Aquests coneixements són essencials per gestionar dades de manera eficient en projectes de machine learning. En el proper tema, explorarem com crear pipelines de dades amb <code>tf.data</code>.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-eager-execution' title="Execució immediata">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-data-pipelines-with-tf-data' title="Pipelines de dades amb tf.data">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
