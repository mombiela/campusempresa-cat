<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TensorFlow Federated</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/10-03-tensorflow-federated" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/10-03-tensorflow-federated" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/10-03-tensorflow-federated" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/tensorflow/10-03-tensorflow-federated" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/10-03-tensorflow-federated" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='10-02-tensorflow-js' title="TensorFlow.js">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">TensorFlow Federated</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='10-04-tensorflow-quantum' title="TensorFlow Quantum">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció a TensorFlow Federated</h1>
<div class='content'><p>TensorFlow Federated (TFF) és una biblioteca de codi obert per a l'aprenentatge federat (FL) i altres computacions distribuïdes en dispositius. L'aprenentatge federat permet entrenar models de machine learning en dades distribuïdes en múltiples dispositius sense necessitat de centralitzar les dades. Això és especialment útil en escenaris on la privacitat de les dades és crítica, com en aplicacions mòbils o de salut.</p>
</div><h2>Objectius del Tema</h2>
<div class='content'><ul>
<li>Entendre què és TensorFlow Federated i els seus avantatges.</li>
<li>Aprendre a configurar un entorn de treball amb TFF.</li>
<li>Explorar els conceptes bàsics de l'aprenentatge federat.</li>
<li>Implementar un exemple pràctic d'aprenentatge federat amb TFF.</li>
</ul>
</div><h1>Què és TensorFlow Federated?</h1>
<div class='content'><p>TensorFlow Federated és una extensió de TensorFlow que permet la implementació d'algoritmes d'aprenentatge federat. Els principals avantatges de TFF són:</p>
<ul>
<li><strong>Privacitat de les dades</strong>: Les dades romanen en els dispositius dels usuaris, reduint el risc de filtracions de dades.</li>
<li><strong>Escalabilitat</strong>: Permet entrenar models en milers o milions de dispositius.</li>
<li><strong>Eficiència</strong>: Redueix la necessitat de transferir grans volums de dades a un servidor central.</li>
</ul>
</div><h1>Configuració de TensorFlow Federated</h1>
<div class='content'></div><h2>Requisits previs</h2>
<div class='content'><p>Abans de començar, assegura't de tenir instal·lats els següents components:</p>
<ul>
<li>Python 3.6 o superior</li>
<li>TensorFlow 2.x</li>
<li>TensorFlow Federated</li>
</ul>
</div><h2>Instal·lació</h2>
<div class='content'><p>Pots instal·lar TensorFlow Federated utilitzant pip:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgdGVuc29yZmxvdyB0ZW5zb3JmbG93LWZlZGVyYXRlZA=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install tensorflow tensorflow-federated</pre></div><div class='content'></div><h1>Conceptes bàsics de l'aprenentatge federat</h1>
<div class='content'></div><h2>Arquitectura de l'aprenentatge federat</h2>
<div class='content'><p>L'aprenentatge federat es basa en una arquitectura client-servidor:</p>
<ul>
<li><strong>Clients</strong>: Dispositius que contenen les dades locals i entrenen models localment.</li>
<li><strong>Servidor</strong>: Coordina l'entrenament, agregant els models locals dels clients per actualitzar el model global.</li>
</ul>
</div><h2>Flux de treball de l'aprenentatge federat</h2>
<div class='content'><ol>
<li><strong>Inicialització</strong>: El servidor inicialitza el model global.</li>
<li><strong>Distribució</strong>: El model global es distribueix als clients.</li>
<li><strong>Entrenament local</strong>: Els clients entrenen el model amb les seves dades locals.</li>
<li><strong>Agregació</strong>: Els models locals es retornen al servidor, que els agrega per actualitzar el model global.</li>
<li><strong>Iteració</strong>: El procés es repeteix fins que el model global convergeix.</li>
</ol>
</div><h1>Exemple pràctic: Classificació de dígits amb MNIST</h1>
<div class='content'></div><h2>Pas 1: Importar les biblioteques necessàries</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKaW1wb3J0IHRlbnNvcmZsb3dfZmVkZXJhdGVkIGFzIHRmZgppbXBvcnQgbnVtcHkgYXMgbnA="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
import tensorflow_federated as tff
import numpy as np</pre></div><div class='content'></div><h2>Pas 2: Preparar les dades</h2>
<div class='content'><p>Utilitzarem el dataset MNIST per a aquest exemple. Primer, carreguem i preprocessem les dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIHByZXByb2Nlc3MoZGF0YXNldCk6CiAgICBkZWYgYmF0Y2hfZm9ybWF0X2ZuKGVsZW1lbnQpOgogICAgICAgIHJldHVybiAodGYucmVzaGFwZShlbGVtZW50WydwaXhlbHMnXSwgWy0xLCA3ODRdKSwgZWxlbWVudFsnbGFiZWwnXSkKICAgIHJldHVybiBkYXRhc2V0LnJlcGVhdCgxMCkuc2h1ZmZsZSgxMDAwKS5iYXRjaCgyMCkubWFwKGJhdGNoX2Zvcm1hdF9mbikKCm1uaXN0X3RyYWluLCBtbmlzdF90ZXN0ID0gdGYua2VyYXMuZGF0YXNldHMubW5pc3QubG9hZF9kYXRhKCkKbW5pc3RfdHJhaW4gPSB0Zi5kYXRhLkRhdGFzZXQuZnJvbV90ZW5zb3Jfc2xpY2VzKHsKICAgICdwaXhlbHMnOiBtbmlzdF90cmFpblswXS5hc3R5cGUobnAuZmxvYXQzMikgLyAyNTUuMCwKICAgICdsYWJlbCc6IG1uaXN0X3RyYWluWzFdLmFzdHlwZShucC5pbnQzMikKfSkuYXBwbHkocHJlcHJvY2Vzcyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def preprocess(dataset):
    def batch_format_fn(element):
        return (tf.reshape(element['pixels'], [-1, 784]), element['label'])
    return dataset.repeat(10).shuffle(1000).batch(20).map(batch_format_fn)

mnist_train, mnist_test = tf.keras.datasets.mnist.load_data()
mnist_train = tf.data.Dataset.from_tensor_slices({
    'pixels': mnist_train[0].astype(np.float32) / 255.0,
    'label': mnist_train[1].astype(np.int32)
}).apply(preprocess)</pre></div><div class='content'></div><h2>Pas 3: Definir el model</h2>
<div class='content'><p>Definim un model simple de xarxa neuronal per a la classificació de dígits.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIGNyZWF0ZV9rZXJhc19tb2RlbCgpOgogICAgcmV0dXJuIHRmLmtlcmFzLm1vZGVscy5TZXF1ZW50aWFsKFsKICAgICAgICB0Zi5rZXJhcy5sYXllcnMuSW5wdXRMYXllcihpbnB1dF9zaGFwZT0oNzg0LCkpLAogICAgICAgIHRmLmtlcmFzLmxheWVycy5EZW5zZSgxMCwgYWN0aXZhdGlvbj0nc29mdG1heCcpCiAgICBdKQoKZGVmIG1vZGVsX2ZuKCk6CiAgICBrZXJhc19tb2RlbCA9IGNyZWF0ZV9rZXJhc19tb2RlbCgpCiAgICByZXR1cm4gdGZmLmxlYXJuaW5nLmZyb21fa2VyYXNfbW9kZWwoCiAgICAgICAga2VyYXNfbW9kZWwsCiAgICAgICAgaW5wdXRfc3BlYz1tbmlzdF90cmFpbi5lbGVtZW50X3NwZWMsCiAgICAgICAgbG9zcz10Zi5rZXJhcy5sb3NzZXMuU3BhcnNlQ2F0ZWdvcmljYWxDcm9zc2VudHJvcHkoKSwKICAgICAgICBtZXRyaWNzPVt0Zi5rZXJhcy5tZXRyaWNzLlNwYXJzZUNhdGVnb3JpY2FsQWNjdXJhY3koKV0KICAgICk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def create_keras_model():
    return tf.keras.models.Sequential([
        tf.keras.layers.InputLayer(input_shape=(784,)),
        tf.keras.layers.Dense(10, activation='softmax')
    ])

def model_fn():
    keras_model = create_keras_model()
    return tff.learning.from_keras_model(
        keras_model,
        input_spec=mnist_train.element_spec,
        loss=tf.keras.losses.SparseCategoricalCrossentropy(),
        metrics=[tf.keras.metrics.SparseCategoricalAccuracy()]
    )</pre></div><div class='content'></div><h2>Pas 4: Configurar l'entrenament federat</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aXRlcmF0aXZlX3Byb2Nlc3MgPSB0ZmYubGVhcm5pbmcuYnVpbGRfZmVkZXJhdGVkX2F2ZXJhZ2luZ19wcm9jZXNzKG1vZGVsX2ZuKQpzdGF0ZSA9IGl0ZXJhdGl2ZV9wcm9jZXNzLmluaXRpYWxpemUoKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>iterative_process = tff.learning.build_federated_averaging_process(model_fn)
state = iterative_process.initialize()</pre></div><div class='content'></div><h2>Pas 5: Entrenar el model</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Zm9yIHJvdW5kX251bSBpbiByYW5nZSgxLCAxMSk6CiAgICBzdGF0ZSwgbWV0cmljcyA9IGl0ZXJhdGl2ZV9wcm9jZXNzLm5leHQoc3RhdGUsIFttbmlzdF90cmFpbl0pCiAgICBwcmludChmJ1JvdW5kIHtyb3VuZF9udW19LCBNZXRyaWNzPXttZXRyaWNzfScp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>for round_num in range(1, 11):
    state, metrics = iterative_process.next(state, [mnist_train])
    print(f'Round {round_num}, Metrics={metrics}')</pre></div><div class='content'></div><h1>Exercici pràctic</h1>
<div class='content'></div><h2>Exercici 1: Modificar el model</h2>
<div class='content'><p>Modifica el model de xarxa neuronal per afegir una capa oculta amb 128 neurones i activació ReLU. Entrena el model modificat i compara els resultats amb el model original.</p>
</div><h2>Solució</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIGNyZWF0ZV9rZXJhc19tb2RlbCgpOgogICAgcmV0dXJuIHRmLmtlcmFzLm1vZGVscy5TZXF1ZW50aWFsKFsKICAgICAgICB0Zi5rZXJhcy5sYXllcnMuSW5wdXRMYXllcihpbnB1dF9zaGFwZT0oNzg0LCkpLAogICAgICAgIHRmLmtlcmFzLmxheWVycy5EZW5zZSgxMjgsIGFjdGl2YXRpb249J3JlbHUnKSwKICAgICAgICB0Zi5rZXJhcy5sYXllcnMuRGVuc2UoMTAsIGFjdGl2YXRpb249J3NvZnRtYXgnKQogICAgXSk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def create_keras_model():
    return tf.keras.models.Sequential([
        tf.keras.layers.InputLayer(input_shape=(784,)),
        tf.keras.layers.Dense(128, activation='relu'),
        tf.keras.layers.Dense(10, activation='softmax')
    ])</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>En aquest tema, hem explorat TensorFlow Federated i els seus avantatges per a l'aprenentatge federat. Hem après a configurar un entorn de treball amb TFF, a preparar dades i a definir un model simple de xarxa neuronal. Finalment, hem implementat un exemple pràctic d'aprenentatge federat utilitzant el dataset MNIST. Amb aquests coneixements, estàs preparat per explorar aplicacions més avançades d'aprenentatge federat amb TensorFlow Federated.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='10-02-tensorflow-js' title="TensorFlow.js">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='10-04-tensorflow-quantum' title="TensorFlow Quantum">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
