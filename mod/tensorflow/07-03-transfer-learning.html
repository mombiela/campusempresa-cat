<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aprenentatge per transferència</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/07-03-transfer-learning" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/07-03-transfer-learning" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/07-03-transfer-learning" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/tensorflow/07-03-transfer-learning" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/07-03-transfer-learning" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-02-tensorflow-hub' title="TensorFlow Hub">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Aprenentatge per transferència</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-04-hyperparameter-tuning' title="Ajust de hiperparàmetres">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'><p>L'aprenentatge per transferència és una tècnica poderosa en el camp de l'aprenentatge automàtic que permet utilitzar un model preentrenat en una tasca similar per millorar el rendiment i reduir el temps d'entrenament en una nova tasca. En aquest tema, aprendrem com utilitzar models preentrenats amb TensorFlow per aplicar l'aprenentatge per transferència.</p>
</div><h1>Continguts</h1>
<div class='content'><ol>
<li>Què és l'aprenentatge per transferència?</li>
<li>Avantatges de l'aprenentatge per transferència</li>
<li>Com utilitzar models preentrenats amb TensorFlow</li>
<li>Exemple pràctic: Classificació d'imatges amb un model preentrenat</li>
<li>Exercicis pràctics</li>
</ol>
</div><h1>1. Què és l'aprenentatge per transferència?</h1>
<div class='content'><p>L'aprenentatge per transferència implica prendre un model que ha estat entrenat en una gran quantitat de dades en una tasca específica i reutilitzar-lo com a punt de partida per a una nova tasca. Això és especialment útil quan no es disposa d'una gran quantitat de dades per entrenar un model des de zero.</p>
</div><h1>2. Avantatges de l'aprenentatge per transferència</h1>
<div class='content'><ul>
<li><strong>Reducció del temps d'entrenament:</strong> Els models preentrenats ja han après característiques útils, per la qual cosa necessiten menys temps per adaptar-se a la nova tasca.</li>
<li><strong>Millor rendiment:</strong> Els models preentrenats solen oferir un millor rendiment, especialment quan es disposa de poques dades.</li>
<li><strong>Menor necessitat de dades:</strong> Es pot aconseguir un bon rendiment amb menys dades d'entrenament.</li>
</ul>
</div><h1>3. Com utilitzar models preentrenats amb TensorFlow</h1>
<div class='content'><p>TensorFlow ofereix una àmplia gamma de models preentrenats a través de la seva biblioteca <code>tf.keras.applications</code>. Aquests models es poden carregar fàcilment i adaptar-se a noves tasques.</p>
</div><h2>Passos per utilitzar un model preentrenat:</h2>
<div class='content'><ol>
<li>
<p><strong>Carregar el model preentrenat:</strong></p>
<pre><code class="language-python">import tensorflow as tf
from tensorflow.keras.applications import VGG16

# Carregar el model VGG16 preentrenat sense la capa de classificació final
base_model = VGG16(weights='imagenet', include_top=False, input_shape=(224, 224, 3))
</code></pre>
</li>
<li>
<p><strong>Congelar les capes del model preentrenat:</strong></p>
<pre><code class="language-python">for layer in base_model.layers:
    layer.trainable = False
</code></pre>
</li>
<li>
<p><strong>Afegir capes personalitzades per a la nova tasca:</strong></p>
<pre><code class="language-python">from tensorflow.keras import layers, models

model = models.Sequential([
    base_model,
    layers.Flatten(),
    layers.Dense(256, activation='relu'),
    layers.Dropout(0.5),
    layers.Dense(10, activation='softmax')  # Suposant que tenim 10 classes
])
</code></pre>
</li>
<li>
<p><strong>Compilar el model:</strong></p>
<pre><code class="language-python">model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])
</code></pre>
</li>
<li>
<p><strong>Entrenar el model:</strong></p>
<pre><code class="language-python"># Suposant que tenim dades d'entrenament i validació
model.fit(train_data, train_labels, epochs=10, validation_data=(val_data, val_labels))
</code></pre>
</li>
</ol>
</div><h1>4. Exemple pràctic: Classificació d'imatges amb un model preentrenat</h1>
<div class='content'></div><h2>Descripció de l'exemple</h2>
<div class='content'><p>En aquest exemple, utilitzarem el model preentrenat VGG16 per classificar imatges de gats i gossos. Utilitzarem un conjunt de dades reduït per demostrar com l'aprenentatge per transferència pot ajudar a obtenir bons resultats amb menys dades.</p>
</div><h2>Codi complet de l'exemple</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmFwcGxpY2F0aW9ucyBpbXBvcnQgVkdHMTYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzIGltcG9ydCBsYXllcnMsIG1vZGVscwpmcm9tIHRlbnNvcmZsb3cua2VyYXMucHJlcHJvY2Vzc2luZy5pbWFnZSBpbXBvcnQgSW1hZ2VEYXRhR2VuZXJhdG9yCgojIENhcnJlZ2FyIGVsIG1vZGVsIFZHRzE2IHByZWVudHJlbmF0IHNlbnNlIGxhIGNhcGEgZGUgY2xhc3NpZmljYWNpw7MgZmluYWwKYmFzZV9tb2RlbCA9IFZHRzE2KHdlaWdodHM9J2ltYWdlbmV0JywgaW5jbHVkZV90b3A9RmFsc2UsIGlucHV0X3NoYXBlPSgyMjQsIDIyNCwgMykpCgojIENvbmdlbGFyIGxlcyBjYXBlcyBkZWwgbW9kZWwgcHJlZW50cmVuYXQKZm9yIGxheWVyIGluIGJhc2VfbW9kZWwubGF5ZXJzOgogICAgbGF5ZXIudHJhaW5hYmxlID0gRmFsc2UKCiMgQWZlZ2lyIGNhcGVzIHBlcnNvbmFsaXR6YWRlcyBwZXIgYSBsYSBub3ZhIHRhc2NhCm1vZGVsID0gbW9kZWxzLlNlcXVlbnRpYWwoWwogICAgYmFzZV9tb2RlbCwKICAgIGxheWVycy5GbGF0dGVuKCksCiAgICBsYXllcnMuRGVuc2UoMjU2LCBhY3RpdmF0aW9uPSdyZWx1JyksCiAgICBsYXllcnMuRHJvcG91dCgwLjUpLAogICAgbGF5ZXJzLkRlbnNlKDEsIGFjdGl2YXRpb249J3NpZ21vaWQnKSAgIyBDbGFzc2lmaWNhY2nDsyBiaW7DoHJpYTogZ2F0cyB2cyBnb3Nzb3MKXSkKCiMgQ29tcGlsYXIgZWwgbW9kZWwKbW9kZWwuY29tcGlsZShvcHRpbWl6ZXI9J2FkYW0nLCBsb3NzPSdiaW5hcnlfY3Jvc3NlbnRyb3B5JywgbWV0cmljcz1bJ2FjY3VyYWN5J10pCgojIFByZXBhcmFyIGxlcyBkYWRlcwp0cmFpbl9kYXRhZ2VuID0gSW1hZ2VEYXRhR2VuZXJhdG9yKHJlc2NhbGU9MS4vMjU1LCBzaGVhcl9yYW5nZT0wLjIsIHpvb21fcmFuZ2U9MC4yLCBob3Jpem9udGFsX2ZsaXA9VHJ1ZSkKdmFsX2RhdGFnZW4gPSBJbWFnZURhdGFHZW5lcmF0b3IocmVzY2FsZT0xLi8yNTUpCgp0cmFpbl9nZW5lcmF0b3IgPSB0cmFpbl9kYXRhZ2VuLmZsb3dfZnJvbV9kaXJlY3RvcnkoCiAgICAnZGF0YS90cmFpbicsICAjIERpcmVjdG9yaSBhbWIgbGVzIGltYXRnZXMgZCdlbnRyZW5hbWVudAogICAgdGFyZ2V0X3NpemU9KDIyNCwgMjI0KSwKICAgIGJhdGNoX3NpemU9MzIsCiAgICBjbGFzc19tb2RlPSdiaW5hcnknCikKCnZhbF9nZW5lcmF0b3IgPSB2YWxfZGF0YWdlbi5mbG93X2Zyb21fZGlyZWN0b3J5KAogICAgJ2RhdGEvdmFsaWRhdGlvbicsICAjIERpcmVjdG9yaSBhbWIgbGVzIGltYXRnZXMgZGUgdmFsaWRhY2nDswogICAgdGFyZ2V0X3NpemU9KDIyNCwgMjI0KSwKICAgIGJhdGNoX3NpemU9MzIsCiAgICBjbGFzc19tb2RlPSdiaW5hcnknCikKCiMgRW50cmVuYXIgZWwgbW9kZWwKbW9kZWwuZml0KHRyYWluX2dlbmVyYXRvciwgZXBvY2hzPTEwLCB2YWxpZGF0aW9uX2RhdGE9dmFsX2dlbmVyYXRvcik="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.applications import VGG16
from tensorflow.keras import layers, models
from tensorflow.keras.preprocessing.image import ImageDataGenerator

# Carregar el model VGG16 preentrenat sense la capa de classificaci&oacute; final
base_model = VGG16(weights='imagenet', include_top=False, input_shape=(224, 224, 3))

# Congelar les capes del model preentrenat
for layer in base_model.layers:
    layer.trainable = False

# Afegir capes personalitzades per a la nova tasca
model = models.Sequential([
    base_model,
    layers.Flatten(),
    layers.Dense(256, activation='relu'),
    layers.Dropout(0.5),
    layers.Dense(1, activation='sigmoid')  # Classificaci&oacute; bin&agrave;ria: gats vs gossos
])

# Compilar el model
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# Preparar les dades
train_datagen = ImageDataGenerator(rescale=1./255, shear_range=0.2, zoom_range=0.2, horizontal_flip=True)
val_datagen = ImageDataGenerator(rescale=1./255)

train_generator = train_datagen.flow_from_directory(
    'data/train',  # Directori amb les imatges d'entrenament
    target_size=(224, 224),
    batch_size=32,
    class_mode='binary'
)

val_generator = val_datagen.flow_from_directory(
    'data/validation',  # Directori amb les imatges de validaci&oacute;
    target_size=(224, 224),
    batch_size=32,
    class_mode='binary'
)

# Entrenar el model
model.fit(train_generator, epochs=10, validation_data=val_generator)</pre></div><div class='content'></div><h1>5. Exercicis pràctics</h1>
<div class='content'></div><h2>Exercici 1: Utilitzar un model preentrenat diferent</h2>
<div class='content'><ol>
<li>Carrega un model preentrenat diferent de <code>tf.keras.applications</code> (per exemple, <code>ResNet50</code>).</li>
<li>Congela les capes del model preentrenat.</li>
<li>Afegir capes personalitzades per a una nova tasca de classificació.</li>
<li>Compila i entrena el model amb un conjunt de dades de la teva elecció.</li>
</ol>
</div><h2>Exercici 2: Ajustar les capes del model preentrenat</h2>
<div class='content'><ol>
<li>Descongela algunes de les capes superiors del model preentrenat.</li>
<li>Reentrena el model amb un conjunt de dades de la teva elecció.</li>
<li>Compara els resultats amb els obtinguts quan totes les capes estaven congelades.</li>
</ol>
</div><h2>Solucions</h2>
<div class='content'><h4>Solució a l'Exercici 1</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmFwcGxpY2F0aW9ucyBpbXBvcnQgUmVzTmV0NTAKCiMgQ2FycmVnYXIgZWwgbW9kZWwgUmVzTmV0NTAgcHJlZW50cmVuYXQgc2Vuc2UgbGEgY2FwYSBkZSBjbGFzc2lmaWNhY2nDsyBmaW5hbApiYXNlX21vZGVsID0gUmVzTmV0NTAod2VpZ2h0cz0naW1hZ2VuZXQnLCBpbmNsdWRlX3RvcD1GYWxzZSwgaW5wdXRfc2hhcGU9KDIyNCwgMjI0LCAzKSkKCiMgQ29uZ2VsYXIgbGVzIGNhcGVzIGRlbCBtb2RlbCBwcmVlbnRyZW5hdApmb3IgbGF5ZXIgaW4gYmFzZV9tb2RlbC5sYXllcnM6CiAgICBsYXllci50cmFpbmFibGUgPSBGYWxzZQoKIyBBZmVnaXIgY2FwZXMgcGVyc29uYWxpdHphZGVzIHBlciBhIGxhIG5vdmEgdGFzY2EKbW9kZWwgPSBtb2RlbHMuU2VxdWVudGlhbChbCiAgICBiYXNlX21vZGVsLAogICAgbGF5ZXJzLkdsb2JhbEF2ZXJhZ2VQb29saW5nMkQoKSwKICAgIGxheWVycy5EZW5zZSgyNTYsIGFjdGl2YXRpb249J3JlbHUnKSwKICAgIGxheWVycy5Ecm9wb3V0KDAuNSksCiAgICBsYXllcnMuRGVuc2UoMSwgYWN0aXZhdGlvbj0nc2lnbW9pZCcpICAjIENsYXNzaWZpY2FjacOzIGJpbsOgcmlhCl0pCgojIENvbXBpbGFyIGVsIG1vZGVsCm1vZGVsLmNvbXBpbGUob3B0aW1pemVyPSdhZGFtJywgbG9zcz0nYmluYXJ5X2Nyb3NzZW50cm9weScsIG1ldHJpY3M9WydhY2N1cmFjeSddKQoKIyBFbnRyZW5hciBlbCBtb2RlbCAoc3Vwb3NhbnQgcXVlIGphIHRlbmltIGVscyBnZW5lcmFkb3JzIGRlIGRhZGVzKQptb2RlbC5maXQodHJhaW5fZ2VuZXJhdG9yLCBlcG9jaHM9MTAsIHZhbGlkYXRpb25fZGF0YT12YWxfZ2VuZXJhdG9yKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from tensorflow.keras.applications import ResNet50

# Carregar el model ResNet50 preentrenat sense la capa de classificaci&oacute; final
base_model = ResNet50(weights='imagenet', include_top=False, input_shape=(224, 224, 3))

# Congelar les capes del model preentrenat
for layer in base_model.layers:
    layer.trainable = False

# Afegir capes personalitzades per a la nova tasca
model = models.Sequential([
    base_model,
    layers.GlobalAveragePooling2D(),
    layers.Dense(256, activation='relu'),
    layers.Dropout(0.5),
    layers.Dense(1, activation='sigmoid')  # Classificaci&oacute; bin&agrave;ria
])

# Compilar el model
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# Entrenar el model (suposant que ja tenim els generadors de dades)
model.fit(train_generator, epochs=10, validation_data=val_generator)</pre></div><div class='content'><h4>Solució a l'Exercici 2</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZXNjb25nZWxhciBsZXMgY2FwZXMgc3VwZXJpb3JzIGRlbCBtb2RlbCBwcmVlbnRyZW5hdApmb3IgbGF5ZXIgaW4gYmFzZV9tb2RlbC5sYXllcnNbLTQ6XToKICAgIGxheWVyLnRyYWluYWJsZSA9IFRydWUKCiMgQ29tcGlsYXIgZWwgbW9kZWwgYW1iIHVuIGFwcmVuZW50YXRnZSBtw6lzIGJhaXggcGVyIGV2aXRhciBzb2JyZWFqdXN0YW1lbnQKbW9kZWwuY29tcGlsZShvcHRpbWl6ZXI9dGYua2VyYXMub3B0aW1pemVycy5BZGFtKGxlYXJuaW5nX3JhdGU9MWUtNSksIGxvc3M9J2JpbmFyeV9jcm9zc2VudHJvcHknLCBtZXRyaWNzPVsnYWNjdXJhY3knXSkKCiMgUmVlbnRyZW5hciBlbCBtb2RlbAptb2RlbC5maXQodHJhaW5fZ2VuZXJhdG9yLCBlcG9jaHM9MTAsIHZhbGlkYXRpb25fZGF0YT12YWxfZ2VuZXJhdG9yKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Descongelar les capes superiors del model preentrenat
for layer in base_model.layers[-4:]:
    layer.trainable = True

# Compilar el model amb un aprenentatge m&eacute;s baix per evitar sobreajustament
model.compile(optimizer=tf.keras.optimizers.Adam(learning_rate=1e-5), loss='binary_crossentropy', metrics=['accuracy'])

# Reentrenar el model
model.fit(train_generator, epochs=10, validation_data=val_generator)</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>L'aprenentatge per transferència és una tècnica molt útil per millorar el rendiment dels models d'aprenentatge automàtic, especialment quan es disposa de poques dades. En aquest tema, hem après com utilitzar models preentrenats amb TensorFlow i hem vist un exemple pràctic de classificació d'imatges. Els exercicis pràctics proporcionats t'ajudaran a consolidar els coneixements adquirits i a experimentar amb diferents models i configuracions.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-02-tensorflow-hub' title="TensorFlow Hub">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-04-hyperparameter-tuning' title="Ajust de hiperparàmetres">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
