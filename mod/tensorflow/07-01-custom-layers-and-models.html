<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capes i models personalitzats</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/07-01-custom-layers-and-models" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/07-01-custom-layers-and-models" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/07-01-custom-layers-and-models" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<a href="https://enterprisecampus.net/mod/tensorflow/07-01-custom-layers-and-models" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/tensorflow/07-01-custom-layers-and-models" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
<br>
			<cite>Construint la societat d'avui i del demà</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
									<a href="./">Contingut del curs</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Competències tècniques</a>
				<a href="/all/conocimientos">Coneixements</a>
				<a href="/all/soft_skills">Competències socials</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-04-gated-recurrent-units' title="Unitats recurrents amb porta (GRUs)">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Capes i models personalitzats</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-02-tensorflow-hub' title="TensorFlow Hub">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem com crear capes i models personalitzats a TensorFlow. Això és especialment útil quan les capes predefinides no s'ajusten exactament a les necessitats del nostre projecte. A més, la creació de models personalitzats ens permet tenir un control més gran sobre l'arquitectura i el comportament del nostre model.</p>
</div><h1><p>Objectius del tema</p>
</h1>
<div class='content'><ol>
<li>Entendre la necessitat de capes i models personalitzats.</li>
<li>Aprendre a crear capes personalitzades.</li>
<li>Aprendre a crear models personalitzats.</li>
<li>Implementar un exemple pràctic de capa i model personalitzat.</li>
</ol>
</div><h1><ol>
<li>Necessitat de capes i models personalitzats</li>
</ol>
</h1>
<div class='content'></div><h2><p>Per què capes personalitzades?</p>
</h2>
<div class='content'><ul>
<li><strong>Flexibilitat</strong>: Permet implementar operacions específiques que no estan disponibles en les capes predefinides.</li>
<li><strong>Optimització</strong>: Pot ajudar a optimitzar el rendiment del model per a tasques específiques.</li>
<li><strong>Innovació</strong>: Facilita la investigació i desenvolupament de noves arquitectures de xarxes neuronals.</li>
</ul>
</div><h2><p>Per què models personalitzats?</p>
</h2>
<div class='content'><ul>
<li><strong>Control</strong>: Proporciona un control complet sobre l'arquitectura del model.</li>
<li><strong>Modularitat</strong>: Permet crear models complexos a partir de components més senzills.</li>
<li><strong>Reutilització</strong>: Facilita la reutilització de components en diferents projectes.</li>
</ul>
</div><h1><ol start="2">
<li>Creació de capes personalitzades</li>
</ol>
</h1>
<div class='content'></div><h2><p>Exemple bàsic de capa personalitzada</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCmNsYXNzIE15Q3VzdG9tTGF5ZXIodGYua2VyYXMubGF5ZXJzLkxheWVyKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB1bml0cz0zMiwgKiprd2FyZ3MpOgogICAgICAgIHN1cGVyKE15Q3VzdG9tTGF5ZXIsIHNlbGYpLl9faW5pdF9fKCoqa3dhcmdzKQogICAgICAgIHNlbGYudW5pdHMgPSB1bml0cwoKICAgIGRlZiBidWlsZChzZWxmLCBpbnB1dF9zaGFwZSk6CiAgICAgICAgc2VsZi53ID0gc2VsZi5hZGRfd2VpZ2h0KHNoYXBlPShpbnB1dF9zaGFwZVstMV0sIHNlbGYudW5pdHMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsaXplcj0ncmFuZG9tX25vcm1hbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWluYWJsZT1UcnVlKQogICAgICAgIHNlbGYuYiA9IHNlbGYuYWRkX3dlaWdodChzaGFwZT0oc2VsZi51bml0cywpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsaXplcj0nemVyb3MnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFpbmFibGU9VHJ1ZSkKCiAgICBkZWYgY2FsbChzZWxmLCBpbnB1dHMpOgogICAgICAgIHJldHVybiB0Zi5tYXRtdWwoaW5wdXRzLCBzZWxmLncpICsgc2VsZi5i"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

class MyCustomLayer(tf.keras.layers.Layer):
    def __init__(self, units=32, **kwargs):
        super(MyCustomLayer, self).__init__(**kwargs)
        self.units = units

    def build(self, input_shape):
        self.w = self.add_weight(shape=(input_shape[-1], self.units),
                                 initializer='random_normal',
                                 trainable=True)
        self.b = self.add_weight(shape=(self.units,),
                                 initializer='zeros',
                                 trainable=True)

    def call(self, inputs):
        return tf.matmul(inputs, self.w) + self.b</pre></div><div class='content'></div><h2><p>Explicació del codi</p>
</h2>
<div class='content'><ul>
<li><strong><code>__init__</code></strong>: Inicialitza la capa amb el nombre d'unitats especificades.</li>
<li><strong><code>build</code></strong>: Crea els pesos de la capa (<code>w</code> i <code>b</code>). Aquesta funció es crida una vegada quan es coneix la forma de les dades d'entrada.</li>
<li><strong><code>call</code></strong>: Defineix la lògica de la capa. En aquest cas, simplement aplica una operació de matriu (<code>matmul</code>) i afegeix un biaix (<code>b</code>).</li>
</ul>
</div><h1><ol start="3">
<li>Creació de models personalitzats</li>
</ol>
</h1>
<div class='content'></div><h2><p>Exemple bàsic de model personalitzat</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgTXlDdXN0b21Nb2RlbCh0Zi5rZXJhcy5Nb2RlbCk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoTXlDdXN0b21Nb2RlbCwgc2VsZikuX19pbml0X18oKQogICAgICAgIHNlbGYuZGVuc2UxID0gdGYua2VyYXMubGF5ZXJzLkRlbnNlKDY0LCBhY3RpdmF0aW9uPSdyZWx1JykKICAgICAgICBzZWxmLmN1c3RvbV9sYXllciA9IE15Q3VzdG9tTGF5ZXIoMzIpCiAgICAgICAgc2VsZi5kZW5zZTIgPSB0Zi5rZXJhcy5sYXllcnMuRGVuc2UoMTApCgogICAgZGVmIGNhbGwoc2VsZiwgaW5wdXRzKToKICAgICAgICB4ID0gc2VsZi5kZW5zZTEoaW5wdXRzKQogICAgICAgIHggPSBzZWxmLmN1c3RvbV9sYXllcih4KQogICAgICAgIHJldHVybiBzZWxmLmRlbnNlMih4KQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class MyCustomModel(tf.keras.Model):
    def __init__(self):
        super(MyCustomModel, self).__init__()
        self.dense1 = tf.keras.layers.Dense(64, activation='relu')
        self.custom_layer = MyCustomLayer(32)
        self.dense2 = tf.keras.layers.Dense(10)

    def call(self, inputs):
        x = self.dense1(inputs)
        x = self.custom_layer(x)
        return self.dense2(x)</pre></div><div class='content'></div><h2><p>Explicació del codi</p>
</h2>
<div class='content'><ul>
<li><strong><code>__init__</code></strong>: Inicialitza les capes del model, incloent-hi la capa personalitzada.</li>
<li><strong><code>call</code></strong>: Defineix la lògica del model, especificant com les dades passen a través de les capes.</li>
</ul>
</div><h1><ol start="4">
<li>Exemple pràctic</li>
</ol>
</h1>
<div class='content'></div><h2><p>Construcció d'un model amb una capa personalitzada</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCgojIEdlbmVyYXIgZGFkZXMgZGUgbW9zdHJhCnhfdHJhaW4gPSBucC5yYW5kb20ucmFuZG9tKCgxMDAwLCAzMikpCnlfdHJhaW4gPSBucC5yYW5kb20ucmFuZG9tKCgxMDAwLCAxMCkpCgojIENyZWFyIGVsIG1vZGVsCm1vZGVsID0gTXlDdXN0b21Nb2RlbCgpCgojIENvbXBpbGFyIGVsIG1vZGVsCm1vZGVsLmNvbXBpbGUob3B0aW1pemVyPSdhZGFtJywgbG9zcz0nbXNlJykKCiMgRW50cmVuYXIgZWwgbW9kZWwKbW9kZWwuZml0KHhfdHJhaW4sIHlfdHJhaW4sIGVwb2Nocz0xMCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np

# Generar dades de mostra
x_train = np.random.random((1000, 32))
y_train = np.random.random((1000, 10))

# Crear el model
model = MyCustomModel()

# Compilar el model
model.compile(optimizer='adam', loss='mse')

# Entrenar el model
model.fit(x_train, y_train, epochs=10)</pre></div><div class='content'></div><h2><p>Explicació del codi</p>
</h2>
<div class='content'><ul>
<li><strong>Generació de dades</strong>: Es generen dades de mostra aleatòries per entrenar el model.</li>
<li><strong>Creació del model</strong>: Es crea una instància del model personalitzat.</li>
<li><strong>Compilació del model</strong>: Es compila el model especificant l'optimitzador i la funció de pèrdua.</li>
<li><strong>Entrenament del model</strong>: Es realitza l'entrenament del model amb les dades de mostra.</li>
</ul>
</div><h1><p>Resum</p>
</h1>
<div class='content'><p>En aquest tema, hem après a crear capes i models personalitzats a TensorFlow. Hem vist com les capes personalitzades ens permeten implementar operacions específiques i com els models personalitzats ens proporcionen un control complet sobre l'arquitectura del model. Finalment, hem implementat un exemple pràctic per consolidar els conceptes apresos.</p>
<p>En el següent tema, explorarem TensorFlow Hub i com podem utilitzar models preentrenats per millorar els nostres projectes.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-04-gated-recurrent-units' title="Unitats recurrents amb porta (GRUs)">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-02-tensorflow-hub' title="TensorFlow Hub">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
