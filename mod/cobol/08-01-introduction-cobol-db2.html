<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Introducció al COBOL-DB2</title>

    <link rel="alternate" href="https://campusempresa.com/mod/cobol/08-01-introduction-cobol-db2" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/cobol/08-01-introduction-cobol-db2" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/cobol/08-01-introduction-cobol-db2" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/mod/cobol/08-01-introduction-cobol-db2" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/cobol/08-01-introduction-cobol-db2" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Tot el coneixement al teu abast</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Contingut del curs
	</a>

			</div>
		</div>
	</div>
</div>

<!--  
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Contingut del curs
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>
 -->				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-03-common-errors-solutions' title="Errors Comuns i Solucions">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">Introducció al COBOL-DB2</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-02-embedded-sql-cobol' title="SQL Inserit en COBOL">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, explorarem la integració del llenguatge COBOL amb el sistema de gestió de bases de dades DB2 d'IBM. Aquesta combinació és molt utilitzada en entorns empresarials per gestionar grans volums de dades de manera eficient. Aprendrem com utilitzar SQL incrustat en programes COBOL per interactuar amb bases de dades DB2.</p>
</div><h1>Objectius del Tema</h1>
<div class='content'><ul>
<li>Comprendre la relació entre COBOL i DB2.</li>
<li>Aprendre a incrustar sentències SQL en programes COBOL.</li>
<li>Conèixer les estructures bàsiques per a la integració de COBOL amb DB2.</li>
</ul>
</div><h1><ol>
<li>Què és DB2?</li>
</ol></h1>
<div class='content'><p>DB2 és un sistema de gestió de bases de dades relacional (RDBMS) desenvolupat per IBM. És conegut per la seva robustesa, escalabilitat i capacitat per gestionar grans volums de dades. DB2 és àmpliament utilitzat en entorns empresarials, especialment en sistemes mainframe.</p>
</div><h1><ol start="2">
<li>Integració de COBOL amb DB2</li>
</ol></h1>
<div class='content'><p>La integració de COBOL amb DB2 es realitza mitjançant l'ús de SQL incrustat. Això permet als programes COBOL executar sentències SQL per interactuar amb la base de dades DB2. Aquesta combinació és molt potent, ja que permet aprofitar la capacitat de processament de COBOL juntament amb la gestió de dades de DB2.</p>
</div><h1><ol start="3">
<li>Estructura Bàsica d'un Programa COBOL-DB2</li>
</ol></h1>
<div class='content'><p>Un programa COBOL que interactua amb DB2 segueix una estructura específica. A continuació, es mostra un exemple bàsic:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEVYRU1QTEUtQ09CT0wtREIyLgoKRU5WSVJPTk1FTlQgRElWSVNJT04uCkNPTkZJR1VSQVRJT04gU0VDVElPTi4KU09VUkNFLUNPTVBVVEVSLiBJQk0tMzcwLgpPQkpFQ1QtQ09NUFVURVIuIElCTS0zNzAuCgpEQVRBIERJVklTSU9OLgpXT1JLSU5HLVNUT1JBR0UgU0VDVElPTi4KMDEgU1FMQ09ERSBQSUMgUzkoOSkgQ09NUC4KMDEgU1FMRVJSTSBQSUMgWCg3MCkuCgpQUk9DRURVUkUgRElWSVNJT04uCkJFR0lOLgogICAgRVhFQyBTUUwKICAgICAgICBDT05ORUNUIFRPICdOT01fREVfTEFfQkFTRV9ERV9EQURFUycKICAgIEVORC1FWEVDLgoKICAgIElGIFNRTENPREUgTk9UID0gMAogICAgICAgIERJU1BMQVkgJ0Vycm9yIGVuIGxhIGNvbm5leGnDszogJyBTUUxDT0RFCiAgICAgICAgU1RPUCBSVU4KICAgIEVORC1JRi4KCiAgICBFWEVDIFNRTAogICAgICAgIFNFTEVDVCBOT00sIEVEQVQKICAgICAgICBJTlRPIDpOT00sIDpFREFUCiAgICAgICAgRlJPTSBFTVBMRUFUUwogICAgICAgIFdIRVJFIEVNUExFQVRfSUQgPSAxMjM0NQogICAgRU5ELUVYRUMuCgogICAgSUYgU1FMQ09ERSA9IDAKICAgICAgICBESVNQTEFZICdOb206ICcgTk9NCiAgICAgICAgRElTUExBWSAnRWRhdDogJyBFREFUCiAgICBFTFNFCiAgICAgICAgRElTUExBWSAnRXJyb3IgZW4gbGEgY29uc3VsdGE6ICcgU1FMQ09ERQogICAgRU5ELUlGLgoKICAgIEVYRUMgU1FMCiAgICAgICAgQ09NTUlUCiAgICBFTkQtRVhFQy4KCiAgICBFWEVDIFNRTAogICAgICAgIERJU0NPTk5FQ1QKICAgIEVORC1FWEVDLgoKICAgIFNUT1AgUlVOLg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. EXEMPLE-COBOL-DB2.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
SOURCE-COMPUTER. IBM-370.
OBJECT-COMPUTER. IBM-370.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 SQLCODE PIC S9(9) COMP.
01 SQLERRM PIC X(70).

PROCEDURE DIVISION.
BEGIN.
    EXEC SQL
        CONNECT TO 'NOM_DE_LA_BASE_DE_DADES'
    END-EXEC.

    IF SQLCODE NOT = 0
        DISPLAY 'Error en la connexi&oacute;: ' SQLCODE
        STOP RUN
    END-IF.

    EXEC SQL
        SELECT NOM, EDAT
        INTO :NOM, :EDAT
        FROM EMPLEATS
        WHERE EMPLEAT_ID = 12345
    END-EXEC.

    IF SQLCODE = 0
        DISPLAY 'Nom: ' NOM
        DISPLAY 'Edat: ' EDAT
    ELSE
        DISPLAY 'Error en la consulta: ' SQLCODE
    END-IF.

    EXEC SQL
        COMMIT
    END-EXEC.

    EXEC SQL
        DISCONNECT
    END-EXEC.

    STOP RUN.</pre></div><div class='content'></div><h2>Explicació del Codi</h2>
<div class='content'><ol>
<li><strong>IDENTIFICATION DIVISION</strong>: Defineix el nom del programa.</li>
<li><strong>ENVIRONMENT DIVISION</strong>: Especifica la configuració del sistema.</li>
<li><strong>DATA DIVISION</strong>: Defineix les variables necessàries per a la interacció amb DB2, com <code>SQLCODE</code> i <code>SQLERRM</code>.</li>
<li><strong>PROCEDURE DIVISION</strong>: Conté la lògica del programa, incloent les sentències SQL incrustades.</li>
</ol>
</div><h2>Sentències SQL Incrustades</h2>
<div class='content'><ul>
<li><strong>CONNECT</strong>: Estableix una connexió amb la base de dades.</li>
<li><strong>SELECT</strong>: Recupera dades de la base de dades.</li>
<li><strong>COMMIT</strong>: Confirma les transaccions.</li>
<li><strong>DISCONNECT</strong>: Tanca la connexió amb la base de dades.</li>
</ul>
</div><h1><ol start="4">
<li>Exercici Pràctic</li>
</ol></h1>
<h2>Exercici</h2>
<div class='content'><p>Escriu un programa COBOL que es connecti a una base de dades DB2, recuperi el nom i el salari d'un empleat amb un ID específic, i mostri aquesta informació per pantalla.</p>
</div><h2>Solució</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEVYRVJDSUNJLUNPQk9MLURCMi4KCkVOVklST05NRU5UIERJVklTSU9OLgpDT05GSUdVUkFUSU9OIFNFQ1RJT04uClNPVVJDRS1DT01QVVRFUi4gSUJNLTM3MC4KT0JKRUNULUNPTVBVVEVSLiBJQk0tMzcwLgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCjAxIFNRTENPREUgUElDIFM5KDkpIENPTVAuCjAxIFNRTEVSUk0gUElDIFgoNzApLgowMSBFTVBMRUFULU5PTSBQSUMgWCg1MCkuCjAxIEVNUExFQVQtU0FMQVJJIFBJQyA5KDcpVjk5LgoKUFJPQ0VEVVJFIERJVklTSU9OLgpCRUdJTi4KICAgIEVYRUMgU1FMCiAgICAgICAgQ09OTkVDVCBUTyAnTk9NX0RFX0xBX0JBU0VfREVfREFERVMnCiAgICBFTkQtRVhFQy4KCiAgICBJRiBTUUxDT0RFIE5PVCA9IDAKICAgICAgICBESVNQTEFZICdFcnJvciBlbiBsYSBjb25uZXhpw7M6ICcgU1FMQ09ERQogICAgICAgIFNUT1AgUlVOCiAgICBFTkQtSUYuCgogICAgRVhFQyBTUUwKICAgICAgICBTRUxFQ1QgTk9NLCBTQUxBUkkKICAgICAgICBJTlRPIDpFTVBMRUFULU5PTSwgOkVNUExFQVQtU0FMQVJJCiAgICAgICAgRlJPTSBFTVBMRUFUUwogICAgICAgIFdIRVJFIEVNUExFQVRfSUQgPSAxMjM0NQogICAgRU5ELUVYRUMuCgogICAgSUYgU1FMQ09ERSA9IDAKICAgICAgICBESVNQTEFZICdOb206ICcgRU1QTEVBVC1OT00KICAgICAgICBESVNQTEFZICdTYWxhcmk6ICcgRU1QTEVBVC1TQUxBUkkKICAgIEVMU0UKICAgICAgICBESVNQTEFZICdFcnJvciBlbiBsYSBjb25zdWx0YTogJyBTUUxDT0RFCiAgICBFTkQtSUYuCgogICAgRVhFQyBTUUwKICAgICAgICBDT01NSVQKICAgIEVORC1FWEVDLgoKICAgIEVYRUMgU1FMCiAgICAgICAgRElTQ09OTkVDVAogICAgRU5ELUVYRUMuCgogICAgU1RPUCBSVU4u"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. EXERCICI-COBOL-DB2.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
SOURCE-COMPUTER. IBM-370.
OBJECT-COMPUTER. IBM-370.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 SQLCODE PIC S9(9) COMP.
01 SQLERRM PIC X(70).
01 EMPLEAT-NOM PIC X(50).
01 EMPLEAT-SALARI PIC 9(7)V99.

PROCEDURE DIVISION.
BEGIN.
    EXEC SQL
        CONNECT TO 'NOM_DE_LA_BASE_DE_DADES'
    END-EXEC.

    IF SQLCODE NOT = 0
        DISPLAY 'Error en la connexi&oacute;: ' SQLCODE
        STOP RUN
    END-IF.

    EXEC SQL
        SELECT NOM, SALARI
        INTO :EMPLEAT-NOM, :EMPLEAT-SALARI
        FROM EMPLEATS
        WHERE EMPLEAT_ID = 12345
    END-EXEC.

    IF SQLCODE = 0
        DISPLAY 'Nom: ' EMPLEAT-NOM
        DISPLAY 'Salari: ' EMPLEAT-SALARI
    ELSE
        DISPLAY 'Error en la consulta: ' SQLCODE
    END-IF.

    EXEC SQL
        COMMIT
    END-EXEC.

    EXEC SQL
        DISCONNECT
    END-EXEC.

    STOP RUN.</pre></div><div class='content'></div><h1><ol start="5">
<li>Errors Comuns i Solucions</li>
</ol></h1>
<div class='content'><ul>
<li><strong>Error de Connexió (SQLCODE ≠ 0)</strong>: Assegura't que el nom de la base de dades i les credencials de connexió són correctes.</li>
<li><strong>Error en la Consulta (SQLCODE ≠ 0)</strong>: Verifica que la taula i les columnes existeixen i que l'ID de l'empleat és vàlid.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>En aquest tema, hem après com integrar COBOL amb DB2 utilitzant SQL incrustat. Hem vist l'estructura bàsica d'un programa COBOL-DB2 i hem practicat amb un exercici pràctic. Aquesta combinació és molt potent per gestionar grans volums de dades en entorns empresarials. En el proper tema, explorarem com utilitzar SQL incrustat en COBOL amb més detall.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-03-common-errors-solutions' title="Errors Comuns i Solucions">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-02-embedded-sql-cobol' title="SQL Inserit en COBOL">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<!-- 
	<h1>Publicitat</h1>
	<p>Aquest espai està destinat a publicitat.</p>
	<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
	<p>Gràcies per col·laborar!</p>
	 -->
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curs de Programació COBOL</h1>
<h2>Mòdul 1: Introducció al COBOL</h2>
<ul>
<li><a href="01-01-what-is-cobol">Què és el COBOL?</a></li>
<li><a href="01-02-history-of-cobol">Història del COBOL</a></li>
<li><a href="01-03-setting-up-cobol-environment">Configuració de l'Entorn COBOL</a></li>
<li><a href="01-04-basic-structure-cobol-program">Estructura Bàsica d'un Programa COBOL</a></li>
</ul>
<h2>Mòdul 2: Sintaxi Bàsica del COBOL i Tipus de Dades</h2>
<ul>
<li><a href="02-01-cobol-syntax">Sintaxi del COBOL</a></li>
<li><a href="02-02-data-types-cobol">Tipus de Dades en COBOL</a></li>
<li><a href="02-03-variables-constants">Variables i Constants</a></li>
<li><a href="02-04-arithmetic-operations">Operacions Aritmètiques</a></li>
</ul>
<h2>Mòdul 3: Estructures de Control</h2>
<ul>
<li><a href="03-01-conditional-statements">Sentències Condicionals</a></li>
<li><a href="03-02-looping-constructs">Construccions de Bucle</a></li>
<li><a href="03-03-nested-control-structures">Estructures de Control Imbricades</a></li>
</ul>
<h2>Mòdul 4: Treballant amb Dades</h2>
<ul>
<li><a href="04-01-file-handling-cobol">Gestió d'Arxius en COBOL</a></li>
<li><a href="04-02-sequential-file-processing">Processament d'Arxius Seqüencials</a></li>
<li><a href="04-03-indexed-file-processing">Processament d'Arxius Indexats</a></li>
<li><a href="04-04-relative-file-processing">Processament d'Arxius Relatius</a></li>
</ul>
<h2>Mòdul 5: Gestió Avançada de Dades</h2>
<ul>
<li><a href="05-01-tables-arrays">Taules i Arrays</a></li>
<li><a href="05-02-multi-dimensional-arrays">Arrays Multidimensionals</a></li>
<li><a href="05-03-string-handling">Gestió de Cadenes</a></li>
<li><a href="05-04-sorting-merging-data">Ordenació i Fusió de Dades</a></li>
</ul>
<h2>Mòdul 6: Subprogrames i Programació Modular</h2>
<ul>
<li><a href="06-01-introduction-subprograms">Introducció als Subprogrames</a></li>
<li><a href="06-02-call-statement">Sentència CALL</a></li>
<li><a href="06-03-passing-parameters">Passant Paràmetres</a></li>
<li><a href="06-04-modular-programming-techniques">Tècniques de Programació Modular</a></li>
</ul>
<h2>Mòdul 7: Gestió d'Errors i Depuració</h2>
<ul>
<li><a href="07-01-error-handling-techniques">Tècniques de Gestió d'Errors</a></li>
<li><a href="07-02-debugging-cobol-programs">Depuració de Programes COBOL</a></li>
<li><a href="07-03-common-errors-solutions">Errors Comuns i Solucions</a></li>
</ul>
<h2>Mòdul 8: COBOL i Bases de Dades</h2>
<ul>
<li><a href="08-01-introduction-cobol-db2">Introducció al COBOL-DB2</a></li>
<li><a href="08-02-embedded-sql-cobol">SQL Inserit en COBOL</a></li>
<li><a href="08-03-database-operations">Operacions de Base de Dades</a></li>
<li><a href="08-04-handling-cursors">Gestió de Cursors</a></li>
</ul>
<h2>Mòdul 9: Temes Avançats</h2>
<ul>
<li><a href="09-01-object-oriented-cobol">COBOL Orientat a Objectes</a></li>
<li><a href="09-02-cobol-web-services">COBOL i Serveis Web</a></li>
<li><a href="09-03-performance-tuning">Optimització del Rendiment</a></li>
<li><a href="09-04-best-practices-cobol">Millors Pràctiques en Programació COBOL</a></li>
</ul>
<h2>Mòdul 10: Projecte i Estudis de Cas</h2>
<ul>
<li><a href="10-01-real-world-cobol-projects">Projectes COBOL del Món Real</a></li>
<li><a href="10-02-case-study-banking-system">Estudi de Cas 1: Sistema Bancari</a></li>
<li><a href="10-03-case-study-inventory-management">Estudi de Cas 2: Gestió d'Inventari</a></li>
<li><a href="10-04-final-project-guidelines">Directrius del Projecte Final</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
