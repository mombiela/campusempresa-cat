<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Gestió de Cursors</title>

    <link rel="alternate" href="https://campusempresa.com/mod/cobol/08-04-handling-cursors" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/cobol/08-04-handling-cursors" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/cobol/08-04-handling-cursors" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<a href="https://enterprisecampus.net/mod/cobol/08-04-handling-cursors" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/cobol/08-04-handling-cursors" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</span>
			<span class="d-none d-md-inline"><br><cite>Tot el coneixement al teu abast</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					 				<a href="/"><i class="bi bi-house-fill"></i> HOME</a>
											</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-03-database-operations' title="Operacions de Base de Dades">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Gestió de Cursors</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-01-object-oriented-cobol' title="COBOL Orientat a Objectes">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem sobre la gestió de cursors en COBOL quan treballem amb bases de dades. Els cursors són una eina essencial per gestionar conjunts de resultats de consultes SQL dins d'un programa COBOL. Ens permeten processar múltiples files de dades una a una, cosa que és crucial per a moltes aplicacions empresarials.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ol>
<li>
<p><strong>Què és un Cursor?</strong></p>
<ul>
<li>Un cursor és un mecanisme que permet recórrer un conjunt de resultats fila per fila.</li>
<li>S'utilitza per gestionar consultes SQL que retornen múltiples files.</li>
</ul>
</li>
<li>
<p><strong>Tipus de Cursors</strong></p>
<ul>
<li><strong>Cursors Implícits</strong>: Creats automàticament pel sistema per a operacions SQL simples.</li>
<li><strong>Cursors Explícits</strong>: Definits i gestionats pel programador per a un control més gran sobre el conjunt de resultats.</li>
</ul>
</li>
<li>
<p><strong>Operacions Bàsiques amb Cursors</strong></p>
<ul>
<li><strong>Declaració del Cursor</strong>: Definir el cursor i l'SQL associat.</li>
<li><strong>Obertura del Cursor</strong>: Executar la consulta SQL i preparar el conjunt de resultats.</li>
<li><strong>Extracció de Files</strong>: Recuperar files del conjunt de resultats una a una.</li>
<li><strong>Tancament del Cursor</strong>: Alliberar els recursos associats amb el cursor.</li>
</ul>
</li>
</ol>
</div><h1>Declaració del Cursor</h1>
<div class='content'><p>Per declarar un cursor en COBOL, utilitzem la sentència <code>DECLARE CURSOR</code>. Aquí teniu un exemple bàsic:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIERFQ0xBUkUgbXlfY3Vyc29yIENVUlNPUiBGT1IKICAgIFNFTEVDVCBlbXBfaWQsIGVtcF9uYW1lLCBlbXBfc2FsYXJ5CiAgICBGUk9NIGVtcGxveWVlcwogICAgV0hFUkUgZW1wX2RlcGFydG1lbnQgPSAnU0FMRVMnCkVORC1FWEVDLg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    DECLARE my_cursor CURSOR FOR
    SELECT emp_id, emp_name, emp_salary
    FROM employees
    WHERE emp_department = 'SALES'
END-EXEC.</pre></div><div class='content'></div><h1>Obertura del Cursor</h1>
<div class='content'><p>Després de declarar el cursor, l'hem d'obrir per executar la consulta SQL i preparar el conjunt de resultats:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIE9QRU4gbXlfY3Vyc29yCkVORC1FWEVDLg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    OPEN my_cursor
END-EXEC.</pre></div><div class='content'></div><h1>Extracció de Files</h1>
<div class='content'><p>Per recuperar files del conjunt de resultats, utilitzem la sentència <code>FETCH</code>. Aquí teniu un exemple de com fer-ho:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIEZFVENIIG15X2N1cnNvciBJTlRPIDplbXAtaWQsIDplbXAtbmFtZSwgOmVtcC1zYWxhcnkKRU5ELUVYRUMu"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    FETCH my_cursor INTO :emp-id, :emp-name, :emp-salary
END-EXEC.</pre></div><div class='content'><p>Aquest codi recupera una fila del conjunt de resultats i emmagatzema els valors en les variables COBOL <code>emp-id</code>, <code>emp-name</code> i <code>emp-salary</code>.</p>
</div><h1>Tancament del Cursor</h1>
<div class='content'><p>Un cop hem acabat de processar les files, hem de tancar el cursor per alliberar els recursos:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIENMT1NFIG15X2N1cnNvcgpFTkQtRVhFQy4="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    CLOSE my_cursor
END-EXEC.</pre></div><div class='content'></div><h1>Exemple Complet</h1>
<div class='content'><p>A continuació, es mostra un exemple complet que inclou la declaració, obertura, extracció i tancament d'un cursor:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEN1cnNvckV4YW1wbGUuCgpEQVRBIERJVklTSU9OLgpXT1JLSU5HLVNUT1JBR0UgU0VDVElPTi4KMDEgZW1wLWlkICAgICAgUElDIDkoNSkuCjAxIGVtcC1uYW1lICAgIFBJQyBYKDIwKS4KMDEgZW1wLXNhbGFyeSAgUElDIDkoNylWOTkuCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBFWEVDIFNRTAogICAgICAgIERFQ0xBUkUgbXlfY3Vyc29yIENVUlNPUiBGT1IKICAgICAgICBTRUxFQ1QgZW1wX2lkLCBlbXBfbmFtZSwgZW1wX3NhbGFyeQogICAgICAgIEZST00gZW1wbG95ZWVzCiAgICAgICAgV0hFUkUgZW1wX2RlcGFydG1lbnQgPSAnU0FMRVMnCiAgICBFTkQtRVhFQy4KCiAgICBFWEVDIFNRTAogICAgICAgIE9QRU4gbXlfY3Vyc29yCiAgICBFTkQtRVhFQy4KCiAgICBQRVJGT1JNIFVOVElMIFNRTENPREUgTk9UID0gMAogICAgICAgIEVYRUMgU1FMCiAgICAgICAgICAgIEZFVENIIG15X2N1cnNvciBJTlRPIDplbXAtaWQsIDplbXAtbmFtZSwgOmVtcC1zYWxhcnkKICAgICAgICBFTkQtRVhFQwoKICAgICAgICBJRiBTUUxDT0RFID0gMAogICAgICAgICAgICBESVNQTEFZICdFbXBsb3llZSBJRDogJyBlbXAtaWQKICAgICAgICAgICAgRElTUExBWSAnRW1wbG95ZWUgTmFtZTogJyBlbXAtbmFtZQogICAgICAgICAgICBESVNQTEFZICdFbXBsb3llZSBTYWxhcnk6ICcgZW1wLXNhbGFyeQogICAgICAgIEVORC1JRgogICAgRU5ELVBFUkZPUk0uCgogICAgRVhFQyBTUUwKICAgICAgICBDTE9TRSBteV9jdXJzb3IKICAgIEVORC1FWEVDLgoKICAgIFNUT1AgUlVOLg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. CursorExample.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 emp-id      PIC 9(5).
01 emp-name    PIC X(20).
01 emp-salary  PIC 9(7)V99.

PROCEDURE DIVISION.
    EXEC SQL
        DECLARE my_cursor CURSOR FOR
        SELECT emp_id, emp_name, emp_salary
        FROM employees
        WHERE emp_department = 'SALES'
    END-EXEC.

    EXEC SQL
        OPEN my_cursor
    END-EXEC.

    PERFORM UNTIL SQLCODE NOT = 0
        EXEC SQL
            FETCH my_cursor INTO :emp-id, :emp-name, :emp-salary
        END-EXEC

        IF SQLCODE = 0
            DISPLAY 'Employee ID: ' emp-id
            DISPLAY 'Employee Name: ' emp-name
            DISPLAY 'Employee Salary: ' emp-salary
        END-IF
    END-PERFORM.

    EXEC SQL
        CLOSE my_cursor
    END-EXEC.

    STOP RUN.</pre></div><div class='content'></div><h1>Exercici Pràctic</h1>
<div class='content'><p><strong>Exercici:</strong>
Creeu un programa COBOL que utilitzi un cursor per recuperar i mostrar tots els productes d'una taula <code>products</code> on el preu sigui superior a 100.</p>
<p><strong>Solució:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFByb2R1Y3RDdXJzb3JFeGFtcGxlLgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCjAxIHByb2QtaWQgICAgICBQSUMgOSg1KS4KMDEgcHJvZC1uYW1lICAgIFBJQyBYKDMwKS4KMDEgcHJvZC1wcmljZSAgIFBJQyA5KDcpVjk5LgoKUFJPQ0VEVVJFIERJVklTSU9OLgogICAgRVhFQyBTUUwKICAgICAgICBERUNMQVJFIHByb2R1Y3RfY3Vyc29yIENVUlNPUiBGT1IKICAgICAgICBTRUxFQ1QgcHJvZHVjdF9pZCwgcHJvZHVjdF9uYW1lLCBwcm9kdWN0X3ByaWNlCiAgICAgICAgRlJPTSBwcm9kdWN0cwogICAgICAgIFdIRVJFIHByb2R1Y3RfcHJpY2UgPiAxMDAKICAgIEVORC1FWEVDLgoKICAgIEVYRUMgU1FMCiAgICAgICAgT1BFTiBwcm9kdWN0X2N1cnNvcgogICAgRU5ELUVYRUMuCgogICAgUEVSRk9STSBVTlRJTCBTUUxDT0RFIE5PVCA9IDAKICAgICAgICBFWEVDIFNRTAogICAgICAgICAgICBGRVRDSCBwcm9kdWN0X2N1cnNvciBJTlRPIDpwcm9kLWlkLCA6cHJvZC1uYW1lLCA6cHJvZC1wcmljZQogICAgICAgIEVORC1FWEVDCgogICAgICAgIElGIFNRTENPREUgPSAwCiAgICAgICAgICAgIERJU1BMQVkgJ1Byb2R1Y3QgSUQ6ICcgcHJvZC1pZAogICAgICAgICAgICBESVNQTEFZICdQcm9kdWN0IE5hbWU6ICcgcHJvZC1uYW1lCiAgICAgICAgICAgIERJU1BMQVkgJ1Byb2R1Y3QgUHJpY2U6ICcgcHJvZC1wcmljZQogICAgICAgIEVORC1JRgogICAgRU5ELVBFUkZPUk0uCgogICAgRVhFQyBTUUwKICAgICAgICBDTE9TRSBwcm9kdWN0X2N1cnNvcgogICAgRU5ELUVYRUMuCgogICAgU1RPUCBSVU4u"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. ProductCursorExample.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 prod-id      PIC 9(5).
01 prod-name    PIC X(30).
01 prod-price   PIC 9(7)V99.

PROCEDURE DIVISION.
    EXEC SQL
        DECLARE product_cursor CURSOR FOR
        SELECT product_id, product_name, product_price
        FROM products
        WHERE product_price &gt; 100
    END-EXEC.

    EXEC SQL
        OPEN product_cursor
    END-EXEC.

    PERFORM UNTIL SQLCODE NOT = 0
        EXEC SQL
            FETCH product_cursor INTO :prod-id, :prod-name, :prod-price
        END-EXEC

        IF SQLCODE = 0
            DISPLAY 'Product ID: ' prod-id
            DISPLAY 'Product Name: ' prod-name
            DISPLAY 'Product Price: ' prod-price
        END-IF
    END-PERFORM.

    EXEC SQL
        CLOSE product_cursor
    END-EXEC.

    STOP RUN.</pre></div><div class='content'></div><h1>Resum</h1>
<div class='content'><p>En aquesta secció, hem après què són els cursors i com utilitzar-los en COBOL per gestionar conjunts de resultats de consultes SQL. Hem vist com declarar, obrir, extreure files i tancar un cursor, i hem practicat amb un exemple complet i un exercici pràctic. La gestió de cursors és una habilitat essencial per treballar amb bases de dades en COBOL, i dominar-la us permetrà crear aplicacions més eficients i robustes.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-03-database-operations' title="Operacions de Base de Dades">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-01-object-oriented-cobol' title="COBOL Orientat a Objectes">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Publicitat</h1>
<p>Aquest espai està destinat a publicitat.</p>
<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Gràcies per col·laborar!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			









		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
