<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    <title>SQL Inserit en COBOL</title>

    <link rel="alternate" href="https://campusempresa.com/mod/cobol/08-02-embedded-sql-cobol" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/cobol/08-02-embedded-sql-cobol" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/cobol/08-02-embedded-sql-cobol" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/mod/cobol/08-02-embedded-sql-cobol" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/cobol/08-02-embedded-sql-cobol" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Tot el coneixement al teu abast</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Contingut del curs
	</a>

			</div>
		</div>
	</div>
</div>

<!--  
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Contingut del curs
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>
 -->				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-01-introduction-cobol-db2' title="Introducció al COBOL-DB2">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">SQL Inserit en COBOL</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-03-database-operations' title="Operacions de Base de Dades">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>El SQL inserit en COBOL permet als programes COBOL interactuar directament amb bases de dades relacionals. Aquesta capacitat és crucial per a aplicacions empresarials que necessiten gestionar grans volums de dades de manera eficient. En aquest tema, aprendrem com utilitzar SQL dins de programes COBOL per realitzar operacions de base de dades com ara consultes, insercions, actualitzacions i eliminacions.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ol>
<li><strong>SQL Inserit</strong>: És la incorporació de sentències SQL dins del codi COBOL.</li>
<li><strong>Precompilador</strong>: Una eina que processa el codi COBOL amb SQL inserit abans de la compilació.</li>
<li><strong>Host Variables</strong>: Variables COBOL utilitzades per emmagatzemar resultats de consultes SQL o per passar valors a sentències SQL.</li>
</ol>
</div><h1>Estructura Bàsica</h1>
<div class='content'></div><h2>Declaració de la Secció SQL</h2>
<div class='content'><p>Abans d'utilitzar SQL en un programa COBOL, cal declarar una secció especial per a SQL. Aquesta secció es declara dins de la <strong>DATA DIVISION</strong>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCkVYRUMgU1FMCiAgICBJTkNMVURFIFNRTENBCkVORC1FWEVDLg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DATA DIVISION.
WORKING-STORAGE SECTION.
EXEC SQL
    INCLUDE SQLCA
END-EXEC.</pre></div><div class='content'></div><h2>Exemple de Codi</h2>
<div class='content'><p>A continuació, es mostra un exemple bàsic d'un programa COBOL que utilitza SQL inserit per seleccionar dades d'una taula de base de dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEV4YW1wbGVTUUwuCgpEQVRBIERJVklTSU9OLgpXT1JLSU5HLVNUT1JBR0UgU0VDVElPTi4KRVhFQyBTUUwKICAgIElOQ0xVREUgU1FMQ0EKRU5ELUVYRUMuCgowMSBFTVBMT1lFRS1JRCBQSUMgOSg1KS4KMDEgRU1QTE9ZRUUtTkFNRSBQSUMgWCgzMCkuCgpQUk9DRURVUkUgRElWSVNJT04uCk1BSU4tTE9HSUMuCiAgICBFWEVDIFNRTAogICAgICAgIFNFTEVDVCBFTVBfSUQsIEVNUF9OQU1FCiAgICAgICAgSU5UTyA6RU1QTE9ZRUUtSUQsIDpFTVBMT1lFRS1OQU1FCiAgICAgICAgRlJPTSBFTVBMT1lFRVMKICAgICAgICBXSEVSRSBFTVBfSUQgPSAxMDAxCiAgICBFTkQtRVhFQy4KCiAgICBESVNQTEFZICdFbXBsb3llZSBJRDogJyBFTVBMT1lFRS1JRC4KICAgIERJU1BMQVkgJ0VtcGxveWVlIE5hbWU6ICcgRU1QTE9ZRUUtTkFNRS4KCiAgICBTVE9QIFJVTi4="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. ExampleSQL.

DATA DIVISION.
WORKING-STORAGE SECTION.
EXEC SQL
    INCLUDE SQLCA
END-EXEC.

01 EMPLOYEE-ID PIC 9(5).
01 EMPLOYEE-NAME PIC X(30).

PROCEDURE DIVISION.
MAIN-LOGIC.
    EXEC SQL
        SELECT EMP_ID, EMP_NAME
        INTO :EMPLOYEE-ID, :EMPLOYEE-NAME
        FROM EMPLOYEES
        WHERE EMP_ID = 1001
    END-EXEC.

    DISPLAY 'Employee ID: ' EMPLOYEE-ID.
    DISPLAY 'Employee Name: ' EMPLOYEE-NAME.

    STOP RUN.</pre></div><div class='content'></div><h2>Explicació del Codi</h2>
<div class='content'><ol>
<li><strong>IDENTIFICATION DIVISION</strong>: Defineix el nom del programa.</li>
<li><strong>DATA DIVISION</strong>: Conté la secció de treball (WORKING-STORAGE SECTION) on es declaren les variables i la secció SQL.</li>
<li><strong>EXEC SQL INCLUDE SQLCA END-EXEC</strong>: Inclou l'àrea de comunicació SQL (SQLCA) necessària per gestionar errors i altres informacions de l'execució SQL.</li>
<li><strong>Host Variables</strong>: <code>EMPLOYEE-ID</code> i <code>EMPLOYEE-NAME</code> són variables COBOL que emmagatzemaran els resultats de la consulta SQL.</li>
<li><strong>EXEC SQL ... END-EXEC</strong>: Conté la sentència SQL per seleccionar dades de la taula <code>EMPLOYEES</code>.</li>
<li><strong>DISPLAY</strong>: Mostra els resultats de la consulta.</li>
</ol>
</div><h1>Exercicis Pràctics</h1>
<div class='content'></div><h2>Exercici 1: Selecció de Dades</h2>
<div class='content'><p>Escriu un programa COBOL que seleccioni el nom i el salari d'un empleat amb un ID específic de la taula <code>EMPLOYEES</code>.</p>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFNlbGVjdEVtcGxveWVlLgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCkVYRUMgU1FMCiAgICBJTkNMVURFIFNRTENBCkVORC1FWEVDLgoKMDEgRU1QTE9ZRUUtSUQgUElDIDkoNSkgVkFMVUUgMTAwMi4KMDEgRU1QTE9ZRUUtTkFNRSBQSUMgWCgzMCkuCjAxIEVNUExPWUVFLVNBTEFSWSBQSUMgOSg3KVY5OS4KClBST0NFRFVSRSBESVZJU0lPTi4KTUFJTi1MT0dJQy4KICAgIEVYRUMgU1FMCiAgICAgICAgU0VMRUNUIEVNUF9OQU1FLCBFTVBfU0FMQVJZCiAgICAgICAgSU5UTyA6RU1QTE9ZRUUtTkFNRSwgOkVNUExPWUVFLVNBTEFSWQogICAgICAgIEZST00gRU1QTE9ZRUVTCiAgICAgICAgV0hFUkUgRU1QX0lEID0gOkVNUExPWUVFLUlECiAgICBFTkQtRVhFQy4KCiAgICBESVNQTEFZICdFbXBsb3llZSBOYW1lOiAnIEVNUExPWUVFLU5BTUUuCiAgICBESVNQTEFZICdFbXBsb3llZSBTYWxhcnk6ICcgRU1QTE9ZRUUtU0FMQVJZLgoKICAgIFNUT1AgUlVOLg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. SelectEmployee.

DATA DIVISION.
WORKING-STORAGE SECTION.
EXEC SQL
    INCLUDE SQLCA
END-EXEC.

01 EMPLOYEE-ID PIC 9(5) VALUE 1002.
01 EMPLOYEE-NAME PIC X(30).
01 EMPLOYEE-SALARY PIC 9(7)V99.

PROCEDURE DIVISION.
MAIN-LOGIC.
    EXEC SQL
        SELECT EMP_NAME, EMP_SALARY
        INTO :EMPLOYEE-NAME, :EMPLOYEE-SALARY
        FROM EMPLOYEES
        WHERE EMP_ID = :EMPLOYEE-ID
    END-EXEC.

    DISPLAY 'Employee Name: ' EMPLOYEE-NAME.
    DISPLAY 'Employee Salary: ' EMPLOYEE-SALARY.

    STOP RUN.</pre></div><div class='content'></div><h2>Exercici 2: Inserció de Dades</h2>
<div class='content'><p>Escriu un programa COBOL que insereixi un nou registre a la taula <code>EMPLOYEES</code>.</p>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEluc2VydEVtcGxveWVlLgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCkVYRUMgU1FMCiAgICBJTkNMVURFIFNRTENBCkVORC1FWEVDLgoKMDEgTkVXLUVNUExPWUVFLUlEIFBJQyA5KDUpIFZBTFVFIDEwMDMuCjAxIE5FVy1FTVBMT1lFRS1OQU1FIFBJQyBYKDMwKSBWQUxVRSAnSm9obiBEb2UnLgowMSBORVctRU1QTE9ZRUUtU0FMQVJZIFBJQyA5KDcpVjk5IFZBTFVFIDUwMDAwLjAwLgoKUFJPQ0VEVVJFIERJVklTSU9OLgpNQUlOLUxPR0lDLgogICAgRVhFQyBTUUwKICAgICAgICBJTlNFUlQgSU5UTyBFTVBMT1lFRVMgKEVNUF9JRCwgRU1QX05BTUUsIEVNUF9TQUxBUlkpCiAgICAgICAgVkFMVUVTICg6TkVXLUVNUExPWUVFLUlELCA6TkVXLUVNUExPWUVFLU5BTUUsIDpORVctRU1QTE9ZRUUtU0FMQVJZKQogICAgRU5ELUVYRUMuCgogICAgRElTUExBWSAnTmV3IGVtcGxveWVlIGluc2VydGVkIHN1Y2Nlc3NmdWxseS4nLgoKICAgIFNUT1AgUlVOLg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. InsertEmployee.

DATA DIVISION.
WORKING-STORAGE SECTION.
EXEC SQL
    INCLUDE SQLCA
END-EXEC.

01 NEW-EMPLOYEE-ID PIC 9(5) VALUE 1003.
01 NEW-EMPLOYEE-NAME PIC X(30) VALUE 'John Doe'.
01 NEW-EMPLOYEE-SALARY PIC 9(7)V99 VALUE 50000.00.

PROCEDURE DIVISION.
MAIN-LOGIC.
    EXEC SQL
        INSERT INTO EMPLOYEES (EMP_ID, EMP_NAME, EMP_SALARY)
        VALUES (:NEW-EMPLOYEE-ID, :NEW-EMPLOYEE-NAME, :NEW-EMPLOYEE-SALARY)
    END-EXEC.

    DISPLAY 'New employee inserted successfully.'.

    STOP RUN.</pre></div><div class='content'></div><h1>Errors Comuns i Solucions</h1>
<div class='content'><ol>
<li><strong>Error de Sintaxi SQL</strong>: Assegura't que les sentències SQL estan correctament formades.</li>
<li><strong>Variables No Declarades</strong>: Verifica que totes les variables utilitzades en les sentències SQL estan declarades en la secció de treball.</li>
<li><strong>Problemes de Connexió</strong>: Assegura't que la connexió a la base de dades està configurada correctament.</li>
</ol>
</div><h1>Resum</h1>
<div class='content'><p>En aquesta secció, hem après com utilitzar SQL inserit en programes COBOL per interactuar amb bases de dades relacionals. Hem vist exemples pràctics de selecció i inserció de dades, i hem discutit alguns errors comuns i les seves solucions. Amb aquests coneixements, estàs preparat per començar a integrar operacions de base de dades en els teus programes COBOL.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-01-introduction-cobol-db2' title="Introducció al COBOL-DB2">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-03-database-operations' title="Operacions de Base de Dades">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<!-- 
	<h1>Publicitat</h1>
	<p>Aquest espai està destinat a publicitat.</p>
	<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
	<p>Gràcies per col·laborar!</p>
	 -->
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curs de Programació COBOL</h1>
<h2>Mòdul 1: Introducció al COBOL</h2>
<ul>
<li><a href="01-01-what-is-cobol">Què és el COBOL?</a></li>
<li><a href="01-02-history-of-cobol">Història del COBOL</a></li>
<li><a href="01-03-setting-up-cobol-environment">Configuració de l'Entorn COBOL</a></li>
<li><a href="01-04-basic-structure-cobol-program">Estructura Bàsica d'un Programa COBOL</a></li>
</ul>
<h2>Mòdul 2: Sintaxi Bàsica del COBOL i Tipus de Dades</h2>
<ul>
<li><a href="02-01-cobol-syntax">Sintaxi del COBOL</a></li>
<li><a href="02-02-data-types-cobol">Tipus de Dades en COBOL</a></li>
<li><a href="02-03-variables-constants">Variables i Constants</a></li>
<li><a href="02-04-arithmetic-operations">Operacions Aritmètiques</a></li>
</ul>
<h2>Mòdul 3: Estructures de Control</h2>
<ul>
<li><a href="03-01-conditional-statements">Sentències Condicionals</a></li>
<li><a href="03-02-looping-constructs">Construccions de Bucle</a></li>
<li><a href="03-03-nested-control-structures">Estructures de Control Imbricades</a></li>
</ul>
<h2>Mòdul 4: Treballant amb Dades</h2>
<ul>
<li><a href="04-01-file-handling-cobol">Gestió d'Arxius en COBOL</a></li>
<li><a href="04-02-sequential-file-processing">Processament d'Arxius Seqüencials</a></li>
<li><a href="04-03-indexed-file-processing">Processament d'Arxius Indexats</a></li>
<li><a href="04-04-relative-file-processing">Processament d'Arxius Relatius</a></li>
</ul>
<h2>Mòdul 5: Gestió Avançada de Dades</h2>
<ul>
<li><a href="05-01-tables-arrays">Taules i Arrays</a></li>
<li><a href="05-02-multi-dimensional-arrays">Arrays Multidimensionals</a></li>
<li><a href="05-03-string-handling">Gestió de Cadenes</a></li>
<li><a href="05-04-sorting-merging-data">Ordenació i Fusió de Dades</a></li>
</ul>
<h2>Mòdul 6: Subprogrames i Programació Modular</h2>
<ul>
<li><a href="06-01-introduction-subprograms">Introducció als Subprogrames</a></li>
<li><a href="06-02-call-statement">Sentència CALL</a></li>
<li><a href="06-03-passing-parameters">Passant Paràmetres</a></li>
<li><a href="06-04-modular-programming-techniques">Tècniques de Programació Modular</a></li>
</ul>
<h2>Mòdul 7: Gestió d'Errors i Depuració</h2>
<ul>
<li><a href="07-01-error-handling-techniques">Tècniques de Gestió d'Errors</a></li>
<li><a href="07-02-debugging-cobol-programs">Depuració de Programes COBOL</a></li>
<li><a href="07-03-common-errors-solutions">Errors Comuns i Solucions</a></li>
</ul>
<h2>Mòdul 8: COBOL i Bases de Dades</h2>
<ul>
<li><a href="08-01-introduction-cobol-db2">Introducció al COBOL-DB2</a></li>
<li><a href="08-02-embedded-sql-cobol">SQL Inserit en COBOL</a></li>
<li><a href="08-03-database-operations">Operacions de Base de Dades</a></li>
<li><a href="08-04-handling-cursors">Gestió de Cursors</a></li>
</ul>
<h2>Mòdul 9: Temes Avançats</h2>
<ul>
<li><a href="09-01-object-oriented-cobol">COBOL Orientat a Objectes</a></li>
<li><a href="09-02-cobol-web-services">COBOL i Serveis Web</a></li>
<li><a href="09-03-performance-tuning">Optimització del Rendiment</a></li>
<li><a href="09-04-best-practices-cobol">Millors Pràctiques en Programació COBOL</a></li>
</ul>
<h2>Mòdul 10: Projecte i Estudis de Cas</h2>
<ul>
<li><a href="10-01-real-world-cobol-projects">Projectes COBOL del Món Real</a></li>
<li><a href="10-02-case-study-banking-system">Estudi de Cas 1: Sistema Bancari</a></li>
<li><a href="10-03-case-study-inventory-management">Estudi de Cas 2: Gestió d'Inventari</a></li>
<li><a href="10-04-final-project-guidelines">Directrius del Projecte Final</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
