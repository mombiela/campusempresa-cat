<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projecte Personalitzat</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pytorch/07-04-custom-project" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pytorch/07-04-custom-project" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pytorch/07-04-custom-project" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/pytorch/07-04-custom-project" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/pytorch/07-04-custom-project" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-time-series-forecasting-project' title="Projecte de Predicció de Sèries Temporals">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Projecte Personalitzat</h2></a>
			</div>
	<div class='col-2 text-end'>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En aquest mòdul, tindràs l'oportunitat de crear el teu propi projecte personalitzat utilitzant PyTorch. Aquest projecte et permetrà aplicar tots els coneixements adquirits al llarg del curs i desenvolupar una solució a un problema que t'interessi. El projecte personalitzat és una excel·lent manera de consolidar els teus coneixements i demostrar les teves habilitats en PyTorch.</p>
</div><h1>Passos per Desenvolupar el Projecte</h1>
<div class='content'></div><h2>1. Definició del Problema</h2>
<div class='content'><p>El primer pas és definir clarament el problema que vols resoldre. Això pot incloure:</p>
<ul>
<li><strong>Tipus de problema</strong>: Classificació, regressió, detecció d'objectes, segmentació d'imatges, etc.</li>
<li><strong>Dades</strong>: Quines dades necessites? On les pots obtenir?</li>
<li><strong>Objectiu</strong>: Què esperes aconseguir amb el teu model?</li>
</ul>
</div><h2>2. Recopilació i Preparació de Dades</h2>
<div class='content'><p>Un cop definit el problema, necessitaràs recopilar i preparar les dades. Això pot incloure:</p>
<ul>
<li><strong>Recopilació de dades</strong>: Descarregar datasets públics, recollir dades pròpies, etc.</li>
<li><strong>Preprocessament de dades</strong>: Neteja de dades, normalització, augmentació de dades, etc.</li>
</ul>
</div><h2>3. Construcció del Model</h2>
<div class='content'><p>Ara és el moment de construir el teu model. Això inclou:</p>
<ul>
<li><strong>Selecció del tipus de model</strong>: Xarxa neuronal simple, CNN, RNN, etc.</li>
<li><strong>Definició de l'arquitectura</strong>: Nombre de capes, tipus de capes, funcions d'activació, etc.</li>
<li><strong>Inicialització del model</strong>: Escriure el codi per definir el model en PyTorch.</li>
</ul>
</div><h2>4. Entrenament del Model</h2>
<div class='content'><p>Amb el model definit, pots procedir a entrenar-lo. Això inclou:</p>
<ul>
<li><strong>Definició de la funció de pèrdua</strong>: MSE, Cross-Entropy, etc.</li>
<li><strong>Selecció de l'optimitzador</strong>: SGD, Adam, etc.</li>
<li><strong>Bucle d'entrenament</strong>: Escriure el codi per entrenar el model amb les dades.</li>
</ul>
</div><h2>5. Validació i Avaluació</h2>
<div class='content'><p>Després de l'entrenament, necessitaràs validar i avaluar el teu model. Això inclou:</p>
<ul>
<li><strong>Divisió de les dades</strong>: Conjunt d'entrenament, validació i prova.</li>
<li><strong>Mètriques d'avaluació</strong>: Accuracy, Precision, Recall, F1-Score, etc.</li>
<li><strong>Ajust del model</strong>: Realitzar ajustos basats en els resultats de la validació.</li>
</ul>
</div><h2>6. Desament i Càrrega del Model</h2>
<div class='content'><p>Un cop estiguis satisfet amb el teu model, pots desar-lo per a ús futur. Això inclou:</p>
<ul>
<li><strong>Desament del model</strong>: Utilitzar <code>torch.save</code> per desar el model.</li>
<li><strong>Càrrega del model</strong>: Utilitzar <code>torch.load</code> per carregar el model desat.</li>
</ul>
</div><h2>7. Desplegament del Model</h2>
<div class='content'><p>Finalment, pots desplegar el teu model per a ús en producció. Això pot incloure:</p>
<ul>
<li><strong>API</strong>: Crear una API per servir el model.</li>
<li><strong>Aplicació web</strong>: Integrar el model en una aplicació web.</li>
<li><strong>Optimització</strong>: Optimitzar el model per a un millor rendiment en producció.</li>
</ul>
</div><h1>Exemple de Projecte Personalitzat</h1>
<div class='content'></div><h2>Definició del Problema</h2>
<div class='content'><p><strong>Problema</strong>: Classificació d'imatges de flors en diferents categories.</p>
<p><strong>Dades</strong>: Utilitzarem el dataset &quot;Flowers Recognition&quot; disponible a Kaggle.</p>
<p><strong>Objectiu</strong>: Construir un model que pugui classificar imatges de flors en 5 categories diferents.</p>
</div><h2>Recopilació i Preparació de Dades</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmZyb20gdG9yY2h2aXNpb24gaW1wb3J0IGRhdGFzZXRzLCB0cmFuc2Zvcm1zCgojIERlZmluaW0gbGVzIHRyYW5zZm9ybWFjaW9ucyBwZXIgYSBsZXMgZGFkZXMgZCdlbnRyZW5hbWVudCBpIHZhbGlkYWNpw7MKdHJhbnNmb3JtID0gdHJhbnNmb3Jtcy5Db21wb3NlKFsKICAgIHRyYW5zZm9ybXMuUmVzaXplKCgxMjgsIDEyOCkpLAogICAgdHJhbnNmb3Jtcy5Ub1RlbnNvcigpLAogICAgdHJhbnNmb3Jtcy5Ob3JtYWxpemUoKDAuNSwgMC41LCAwLjUpLCAoMC41LCAwLjUsIDAuNSkpCl0pCgojIENhcnJlZ3VlbSBsZXMgZGFkZXMgZCdlbnRyZW5hbWVudCBpIHZhbGlkYWNpw7MKdHJhaW5fZGF0YSA9IGRhdGFzZXRzLkltYWdlRm9sZGVyKCdwYXRoL3RvL3RyYWluX2RhdGEnLCB0cmFuc2Zvcm09dHJhbnNmb3JtKQp2YWxfZGF0YSA9IGRhdGFzZXRzLkltYWdlRm9sZGVyKCdwYXRoL3RvL3ZhbF9kYXRhJywgdHJhbnNmb3JtPXRyYW5zZm9ybSkKCnRyYWluX2xvYWRlciA9IHRvcmNoLnV0aWxzLmRhdGEuRGF0YUxvYWRlcih0cmFpbl9kYXRhLCBiYXRjaF9zaXplPTMyLCBzaHVmZmxlPVRydWUpCnZhbF9sb2FkZXIgPSB0b3JjaC51dGlscy5kYXRhLkRhdGFMb2FkZXIodmFsX2RhdGEsIGJhdGNoX3NpemU9MzIsIHNodWZmbGU9RmFsc2Up"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
from torchvision import datasets, transforms

# Definim les transformacions per a les dades d'entrenament i validaci&oacute;
transform = transforms.Compose([
    transforms.Resize((128, 128)),
    transforms.ToTensor(),
    transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))
])

# Carreguem les dades d'entrenament i validaci&oacute;
train_data = datasets.ImageFolder('path/to/train_data', transform=transform)
val_data = datasets.ImageFolder('path/to/val_data', transform=transform)

train_loader = torch.utils.data.DataLoader(train_data, batch_size=32, shuffle=True)
val_loader = torch.utils.data.DataLoader(val_data, batch_size=32, shuffle=False)</pre></div><div class='content'></div><h2>Construcció del Model</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoLm5uIGFzIG5uCmltcG9ydCB0b3JjaC5ubi5mdW5jdGlvbmFsIGFzIEYKCmNsYXNzIFNpbXBsZUNOTihubi5Nb2R1bGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKFNpbXBsZUNOTiwgc2VsZikuX19pbml0X18oKQogICAgICAgIHNlbGYuY29udjEgPSBubi5Db252MmQoMywgMTYsIDMsIDEpCiAgICAgICAgc2VsZi5jb252MiA9IG5uLkNvbnYyZCgxNiwgMzIsIDMsIDEpCiAgICAgICAgc2VsZi5mYzEgPSBubi5MaW5lYXIoMzIgKiAzMCAqIDMwLCAxMjgpCiAgICAgICAgc2VsZi5mYzIgPSBubi5MaW5lYXIoMTI4LCA1KQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIHggPSBGLnJlbHUoc2VsZi5jb252MSh4KSkKICAgICAgICB4ID0gRi5tYXhfcG9vbDJkKHgsIDIsIDIpCiAgICAgICAgeCA9IEYucmVsdShzZWxmLmNvbnYyKHgpKQogICAgICAgIHggPSBGLm1heF9wb29sMmQoeCwgMiwgMikKICAgICAgICB4ID0geC52aWV3KC0xLCAzMiAqIDMwICogMzApCiAgICAgICAgeCA9IEYucmVsdShzZWxmLmZjMSh4KSkKICAgICAgICB4ID0gc2VsZi5mYzIoeCkKICAgICAgICByZXR1cm4geAoKbW9kZWwgPSBTaW1wbGVDTk4oKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch.nn as nn
import torch.nn.functional as F

class SimpleCNN(nn.Module):
    def __init__(self):
        super(SimpleCNN, self).__init__()
        self.conv1 = nn.Conv2d(3, 16, 3, 1)
        self.conv2 = nn.Conv2d(16, 32, 3, 1)
        self.fc1 = nn.Linear(32 * 30 * 30, 128)
        self.fc2 = nn.Linear(128, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        x = F.max_pool2d(x, 2, 2)
        x = F.relu(self.conv2(x))
        x = F.max_pool2d(x, 2, 2)
        x = x.view(-1, 32 * 30 * 30)
        x = F.relu(self.fc1(x))
        x = self.fc2(x)
        return x

model = SimpleCNN()</pre></div><div class='content'></div><h2>Entrenament del Model</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoLm9wdGltIGFzIG9wdGltCgpjcml0ZXJpb24gPSBubi5Dcm9zc0VudHJvcHlMb3NzKCkKb3B0aW1pemVyID0gb3B0aW0uQWRhbShtb2RlbC5wYXJhbWV0ZXJzKCksIGxyPTAuMDAxKQoKZm9yIGVwb2NoIGluIHJhbmdlKDEwKToKICAgIG1vZGVsLnRyYWluKCkKICAgIHJ1bm5pbmdfbG9zcyA9IDAuMAogICAgZm9yIGltYWdlcywgbGFiZWxzIGluIHRyYWluX2xvYWRlcjoKICAgICAgICBvcHRpbWl6ZXIuemVyb19ncmFkKCkKICAgICAgICBvdXRwdXRzID0gbW9kZWwoaW1hZ2VzKQogICAgICAgIGxvc3MgPSBjcml0ZXJpb24ob3V0cHV0cywgbGFiZWxzKQogICAgICAgIGxvc3MuYmFja3dhcmQoKQogICAgICAgIG9wdGltaXplci5zdGVwKCkKICAgICAgICBydW5uaW5nX2xvc3MgKz0gbG9zcy5pdGVtKCkKICAgIHByaW50KGYiRXBvY2gge2Vwb2NoKzF9LCBMb3NzOiB7cnVubmluZ19sb3NzL2xlbih0cmFpbl9sb2FkZXIpfSIp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch.optim as optim

criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=0.001)

for epoch in range(10):
    model.train()
    running_loss = 0.0
    for images, labels in train_loader:
        optimizer.zero_grad()
        outputs = model(images)
        loss = criterion(outputs, labels)
        loss.backward()
        optimizer.step()
        running_loss += loss.item()
    print(f&quot;Epoch {epoch+1}, Loss: {running_loss/len(train_loader)}&quot;)</pre></div><div class='content'></div><h2>Validació i Avaluació</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwuZXZhbCgpCmNvcnJlY3QgPSAwCnRvdGFsID0gMAp3aXRoIHRvcmNoLm5vX2dyYWQoKToKICAgIGZvciBpbWFnZXMsIGxhYmVscyBpbiB2YWxfbG9hZGVyOgogICAgICAgIG91dHB1dHMgPSBtb2RlbChpbWFnZXMpCiAgICAgICAgXywgcHJlZGljdGVkID0gdG9yY2gubWF4KG91dHB1dHMuZGF0YSwgMSkKICAgICAgICB0b3RhbCArPSBsYWJlbHMuc2l6ZSgwKQogICAgICAgIGNvcnJlY3QgKz0gKHByZWRpY3RlZCA9PSBsYWJlbHMpLnN1bSgpLml0ZW0oKQoKcHJpbnQoZiJBY2N1cmFjeTogezEwMCAqIGNvcnJlY3QgLyB0b3RhbH0lIik="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model.eval()
correct = 0
total = 0
with torch.no_grad():
    for images, labels in val_loader:
        outputs = model(images)
        _, predicted = torch.max(outputs.data, 1)
        total += labels.size(0)
        correct += (predicted == labels).sum().item()

print(f&quot;Accuracy: {100 * correct / total}%&quot;)</pre></div><div class='content'></div><h2>Desament i Càrrega del Model</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZXNhbWVudCBkZWwgbW9kZWwKdG9yY2guc2F2ZShtb2RlbC5zdGF0ZV9kaWN0KCksICdmbG93ZXJfY2xhc3NpZmljYXRpb25fbW9kZWwucHRoJykKCiMgQ8OgcnJlZ2EgZGVsIG1vZGVsCm1vZGVsID0gU2ltcGxlQ05OKCkKbW9kZWwubG9hZF9zdGF0ZV9kaWN0KHRvcmNoLmxvYWQoJ2Zsb3dlcl9jbGFzc2lmaWNhdGlvbl9tb2RlbC5wdGgnKSk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Desament del model
torch.save(model.state_dict(), 'flower_classification_model.pth')

# C&agrave;rrega del model
model = SimpleCNN()
model.load_state_dict(torch.load('flower_classification_model.pth'))</pre></div><div class='content'></div><h2>Desplegament del Model</h2>
<div class='content'><p>Per desplegar el model, pots crear una API utilitzant frameworks com Flask o Django, o integrar-lo en una aplicació web.</p>
</div><h1>Conclusió</h1>
<div class='content'><p>El projecte personalitzat és una oportunitat per aplicar tot el que has après en aquest curs. Seguint els passos descrits, podràs desenvolupar un projecte complet utilitzant PyTorch, des de la definició del problema fins al desplegament del model. Recorda que la clau és practicar i experimentar amb diferents tipus de models i tècniques per millorar les teves habilitats. Bona sort!</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-time-series-forecasting-project' title="Projecte de Predicció de Sèries Temporals">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
