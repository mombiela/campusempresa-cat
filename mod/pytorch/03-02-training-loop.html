<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    <title>Bucle d'Entrenament</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pytorch/03-02-training-loop" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pytorch/03-02-training-loop" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pytorch/03-02-training-loop" hreflang="en" />
    
	<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"> -->
	<link href="/css/bootstrap/bootstrap.css?v=1" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<!-- 
  	<style type="text/css">
  		img {
  			visibility:hidden;
  		}
  	</style>
  	 -->
  	<script>
  		var LANG = "ca";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "pytorch";
  		var TEMA_NAME = "03-02";
  		var TYPE = "mod";
  		var PATH = "mod/pytorch/03-02-training-loop";
  		var IS_INDEX = false;
  		var DEVELOP = sessionStorage.getItem("DEVELOP") == "true";
  		  		var ALL_PAGES_MOD = ["01-01-what-is-pytorch","01-02-setting-up-environment","01-03-basic-tensor-operations","01-04-autograd","02-01-introduction-to-neural-networks","02-02-creating-simple-neural-network","02-03-activation-functions","02-04-loss-functions-optimization","03-01-data-loading-preprocessing","03-02-training-loop","03-03-validation-testing","03-04-saving-loading-models","04-01-introduction-to-cnns","04-02-building-cnn-from-scratch","04-03-transfer-learning","04-04-fine-tuning-cnns","05-01-introduction-to-rnns","05-02-building-rnn-from-scratch","05-03-lstm-networks","05-04-gru-networks","06-01-gans","06-02-reinforcement-learning","06-03-deploying-models","06-04-optimizing-performance","07-01-image-classification-project","07-02-nlp-project","07-03-time-series-forecasting-project","07-04-custom-project"];
  		  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
  	<script type="module" src="/js/app.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
</head>

<body class="">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/mod/pytorch/03-02-training-loop" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/pytorch/03-02-training-loop" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Tot el coneixement al teu abast</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my_modules" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Els meus cursos</b></i>
</a>
<a href="/end_modules" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalitzats             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" style="display:none;" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0">
	<div class="col-6 p-0" data-mod="pytorch">
		<a  href="#" class="text-secondary d-none" data-read-mod="pytorch" data-read-unit="03-02" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar com a llegit
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="pytorch" data-unread-unit="03-02" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar com a no llegit
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contingut del curs
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2'>
					<a href='03-01-data-loading-preprocessing' title="Càrrega i Preprocessament de Dades" class="py-2 px-3 btn btn-primary d-none d-md-inline">
				<i class="bi bi-caret-left-square-fill"></i> Anterior 
			</a>
			<a href='03-01-data-loading-preprocessing' title="Càrrega i Preprocessament de Dades" class="py-2 px-3 btn btn-primary d-md-none">
				<i class="bi bi-caret-left-square-fill"></i>
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">Bucle d'Entrenament</h2>
			</div>
	<div class='col-2 text-end'>
					<a href='03-03-validation-testing' title="Validació i Prova" class="py-2 px-3 d-none d-md-inline btn btn-primary"
				data-read-mod="pytorch" data-read-unit="03-02">
				Següent <i class="bi bi-caret-right-square-fill"></i>
			</a>
			<a href='03-03-validation-testing' title="Validació i Prova" class="py-2 px-3 d-md-none btn btn-primary" 
				data-read-mod="pytorch" data-read-unit="03-02">
				<i class="bi bi-caret-right-square-fill"></i>
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem com crear un bucle d'entrenament per a una xarxa neuronal utilitzant PyTorch. El bucle d'entrenament és una part fonamental del procés d'aprenentatge automàtic, ja que és on la xarxa neuronal ajusta els seus pesos per minimitzar la funció de pèrdua.</p>
</div><h1>Objectius</h1>
<div class='content'><ul>
<li>Entendre la importància del bucle d'entrenament.</li>
<li>Aprendre a implementar un bucle d'entrenament bàsic en PyTorch.</li>
<li>Comprendre com monitoritzar el rendiment del model durant l'entrenament.</li>
</ul>
</div><h1>Conceptes Clau</h1>
<div class='content'><ol>
<li><strong>Dades d'Entrenament</strong>: Les dades utilitzades per entrenar el model.</li>
<li><strong>Funció de Pèrdua</strong>: Una mesura de com de bé el model està fent les seves prediccions.</li>
<li><strong>Optimitzador</strong>: Un algoritme que ajusta els pesos del model per minimitzar la funció de pèrdua.</li>
<li><strong>Època</strong>: Una passada completa per tot el conjunt de dades d'entrenament.</li>
<li><strong>Batch</strong>: Un subconjunt de les dades d'entrenament utilitzat per actualitzar els pesos del model en cada iteració.</li>
</ol>
</div><h1>Implementació del Bucle d'Entrenament</h1>
<div class='content'></div><h2>Pas 1: Preparar les Dades</h2>
<div class='content'><p>Abans de començar l'entrenament, necessitem carregar i preprocessar les dades. Utilitzarem el conjunt de dades MNIST com a exemple.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmZyb20gdG9yY2gudXRpbHMuZGF0YSBpbXBvcnQgRGF0YUxvYWRlcgpmcm9tIHRvcmNodmlzaW9uIGltcG9ydCBkYXRhc2V0cywgdHJhbnNmb3JtcwoKIyBUcmFuc2Zvcm1hY2lvbnMgcGVyIG5vcm1hbGl0emFyIGxlcyBkYWRlcwp0cmFuc2Zvcm0gPSB0cmFuc2Zvcm1zLkNvbXBvc2UoW3RyYW5zZm9ybXMuVG9UZW5zb3IoKSwgdHJhbnNmb3Jtcy5Ob3JtYWxpemUoKDAuNSwpLCAoMC41LCkpXSkKCiMgQ2FycmVnYXIgZWwgY29uanVudCBkZSBkYWRlcyBNTklTVAp0cmFpbl9kYXRhc2V0ID0gZGF0YXNldHMuTU5JU1Qocm9vdD0nLi9kYXRhJywgdHJhaW49VHJ1ZSwgZG93bmxvYWQ9VHJ1ZSwgdHJhbnNmb3JtPXRyYW5zZm9ybSkKdHJhaW5fbG9hZGVyID0gRGF0YUxvYWRlcihkYXRhc2V0PXRyYWluX2RhdGFzZXQsIGJhdGNoX3NpemU9NjQsIHNodWZmbGU9VHJ1ZSk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
from torch.utils.data import DataLoader
from torchvision import datasets, transforms

# Transformacions per normalitzar les dades
transform = transforms.Compose([transforms.ToTensor(), transforms.Normalize((0.5,), (0.5,))])

# Carregar el conjunt de dades MNIST
train_dataset = datasets.MNIST(root='./data', train=True, download=True, transform=transform)
train_loader = DataLoader(dataset=train_dataset, batch_size=64, shuffle=True)</pre></div><div class='content'></div><h2>Pas 2: Definir el Model</h2>
<div class='content'><p>Definim una xarxa neuronal simple per a la classificació de dígits.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoLm5uIGFzIG5uCmltcG9ydCB0b3JjaC5ubi5mdW5jdGlvbmFsIGFzIEYKCmNsYXNzIFNpbXBsZU5OKG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoU2ltcGxlTk4sIHNlbGYpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmZjMSA9IG5uLkxpbmVhcigyOCoyOCwgMTI4KQogICAgICAgIHNlbGYuZmMyID0gbm4uTGluZWFyKDEyOCwgNjQpCiAgICAgICAgc2VsZi5mYzMgPSBubi5MaW5lYXIoNjQsIDEwKQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIHggPSB4LnZpZXcoLTEsIDI4KjI4KQogICAgICAgIHggPSBGLnJlbHUoc2VsZi5mYzEoeCkpCiAgICAgICAgeCA9IEYucmVsdShzZWxmLmZjMih4KSkKICAgICAgICB4ID0gc2VsZi5mYzMoeCkKICAgICAgICByZXR1cm4geAoKbW9kZWwgPSBTaW1wbGVOTigp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch.nn as nn
import torch.nn.functional as F

class SimpleNN(nn.Module):
    def __init__(self):
        super(SimpleNN, self).__init__()
        self.fc1 = nn.Linear(28*28, 128)
        self.fc2 = nn.Linear(128, 64)
        self.fc3 = nn.Linear(64, 10)

    def forward(self, x):
        x = x.view(-1, 28*28)
        x = F.relu(self.fc1(x))
        x = F.relu(self.fc2(x))
        x = self.fc3(x)
        return x

model = SimpleNN()</pre></div><div class='content'></div><h2>Pas 3: Definir la Funció de Pèrdua i l'Optimitzador</h2>
<div class='content'><p>Utilitzarem la funció de pèrdua <code>CrossEntropyLoss</code> i l'optimitzador <code>Adam</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y3JpdGVyaW9uID0gbm4uQ3Jvc3NFbnRyb3B5TG9zcygpCm9wdGltaXplciA9IHRvcmNoLm9wdGltLkFkYW0obW9kZWwucGFyYW1ldGVycygpLCBscj0wLjAwMSk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>criterion = nn.CrossEntropyLoss()
optimizer = torch.optim.Adam(model.parameters(), lr=0.001)</pre></div><div class='content'></div><h2>Pas 4: Implementar el Bucle d'Entrenament</h2>
<div class='content'><p>Ara implementem el bucle d'entrenament. En cada època, passarem per totes les dades d'entrenament, calcularem la pèrdua, farem la retropropagació i actualitzarem els pesos del model.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnVtX2Vwb2NocyA9IDUKCmZvciBlcG9jaCBpbiByYW5nZShudW1fZXBvY2hzKToKICAgIHJ1bm5pbmdfbG9zcyA9IDAuMAogICAgZm9yIGltYWdlcywgbGFiZWxzIGluIHRyYWluX2xvYWRlcjoKICAgICAgICAjIFplcm8gdGhlIHBhcmFtZXRlciBncmFkaWVudHMKICAgICAgICBvcHRpbWl6ZXIuemVyb19ncmFkKCkKICAgICAgICAKICAgICAgICAjIEZvcndhcmQgcGFzcwogICAgICAgIG91dHB1dHMgPSBtb2RlbChpbWFnZXMpCiAgICAgICAgbG9zcyA9IGNyaXRlcmlvbihvdXRwdXRzLCBsYWJlbHMpCiAgICAgICAgCiAgICAgICAgIyBCYWNrd2FyZCBwYXNzIGFuZCBvcHRpbWl6YXRpb24KICAgICAgICBsb3NzLmJhY2t3YXJkKCkKICAgICAgICBvcHRpbWl6ZXIuc3RlcCgpCiAgICAgICAgCiAgICAgICAgcnVubmluZ19sb3NzICs9IGxvc3MuaXRlbSgpCiAgICAKICAgIHByaW50KGYnRXBvY2ggW3tlcG9jaCsxfS97bnVtX2Vwb2Noc31dLCBMb3NzOiB7cnVubmluZ19sb3NzL2xlbih0cmFpbl9sb2FkZXIpOi40Zn0nKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>num_epochs = 5

for epoch in range(num_epochs):
    running_loss = 0.0
    for images, labels in train_loader:
        # Zero the parameter gradients
        optimizer.zero_grad()
        
        # Forward pass
        outputs = model(images)
        loss = criterion(outputs, labels)
        
        # Backward pass and optimization
        loss.backward()
        optimizer.step()
        
        running_loss += loss.item()
    
    print(f'Epoch [{epoch+1}/{num_epochs}], Loss: {running_loss/len(train_loader):.4f}')</pre></div><div class='content'></div><h2>Explicació del Codi</h2>
<div class='content'><ol>
<li><strong>Zero the parameter gradients</strong>: Abans de cada pas d'optimització, cal posar a zero els gradients acumulats dels paràmetres del model.</li>
<li><strong>Forward pass</strong>: Passar les dades d'entrada a través del model per obtenir les prediccions.</li>
<li><strong>Loss calculation</strong>: Calcular la pèrdua comparant les prediccions amb les etiquetes reals.</li>
<li><strong>Backward pass</strong>: Calcular els gradients de la pèrdua respecte als paràmetres del model.</li>
<li><strong>Optimizer step</strong>: Actualitzar els paràmetres del model utilitzant els gradients calculats.</li>
</ol>
</div><h1>Exercici Pràctic</h1>
<div class='content'><p>Implementa un bucle d'entrenament per a una xarxa neuronal que classifiqui imatges del conjunt de dades CIFAR-10. Utilitza una xarxa neuronal convolucional (CNN) i monitoritza la pèrdua durant l'entrenament.</p>
</div><h2>Solució</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgppbXBvcnQgdG9yY2gubm4uZnVuY3Rpb25hbCBhcyBGCmltcG9ydCB0b3JjaC5vcHRpbSBhcyBvcHRpbQpmcm9tIHRvcmNodmlzaW9uIGltcG9ydCBkYXRhc2V0cywgdHJhbnNmb3JtcwoKIyBUcmFuc2Zvcm1hY2lvbnMgcGVyIG5vcm1hbGl0emFyIGxlcyBkYWRlcwp0cmFuc2Zvcm0gPSB0cmFuc2Zvcm1zLkNvbXBvc2UoW3RyYW5zZm9ybXMuVG9UZW5zb3IoKSwgdHJhbnNmb3Jtcy5Ob3JtYWxpemUoKDAuNSwgMC41LCAwLjUpLCAoMC41LCAwLjUsIDAuNSkpXSkKCiMgQ2FycmVnYXIgZWwgY29uanVudCBkZSBkYWRlcyBDSUZBUi0xMAp0cmFpbl9kYXRhc2V0ID0gZGF0YXNldHMuQ0lGQVIxMChyb290PScuL2RhdGEnLCB0cmFpbj1UcnVlLCBkb3dubG9hZD1UcnVlLCB0cmFuc2Zvcm09dHJhbnNmb3JtKQp0cmFpbl9sb2FkZXIgPSBEYXRhTG9hZGVyKGRhdGFzZXQ9dHJhaW5fZGF0YXNldCwgYmF0Y2hfc2l6ZT02NCwgc2h1ZmZsZT1UcnVlKQoKIyBEZWZpbmlyIGxhIHhhcnhhIG5ldXJvbmFsIGNvbnZvbHVjaW9uYWwKY2xhc3MgU2ltcGxlQ05OKG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoU2ltcGxlQ05OLCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5jb252MSA9IG5uLkNvbnYyZCgzLCAxNiwgMywgMSkKICAgICAgICBzZWxmLmNvbnYyID0gbm4uQ29udjJkKDE2LCAzMiwgMywgMSkKICAgICAgICBzZWxmLmZjMSA9IG5uLkxpbmVhcigzMio2KjYsIDEyOCkKICAgICAgICBzZWxmLmZjMiA9IG5uLkxpbmVhcigxMjgsIDEwKQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIHggPSBGLnJlbHUoc2VsZi5jb252MSh4KSkKICAgICAgICB4ID0gRi5tYXhfcG9vbDJkKHgsIDIsIDIpCiAgICAgICAgeCA9IEYucmVsdShzZWxmLmNvbnYyKHgpKQogICAgICAgIHggPSBGLm1heF9wb29sMmQoeCwgMiwgMikKICAgICAgICB4ID0geC52aWV3KC0xLCAzMio2KjYpCiAgICAgICAgeCA9IEYucmVsdShzZWxmLmZjMSh4KSkKICAgICAgICB4ID0gc2VsZi5mYzIoeCkKICAgICAgICByZXR1cm4geAoKbW9kZWwgPSBTaW1wbGVDTk4oKQoKIyBEZWZpbmlyIGxhIGZ1bmNpw7MgZGUgcMOocmR1YSBpIGwnb3B0aW1pdHphZG9yCmNyaXRlcmlvbiA9IG5uLkNyb3NzRW50cm9weUxvc3MoKQpvcHRpbWl6ZXIgPSBvcHRpbS5BZGFtKG1vZGVsLnBhcmFtZXRlcnMoKSwgbHI9MC4wMDEpCgojIEJ1Y2xlIGQnZW50cmVuYW1lbnQKbnVtX2Vwb2NocyA9IDEwCgpmb3IgZXBvY2ggaW4gcmFuZ2UobnVtX2Vwb2Nocyk6CiAgICBydW5uaW5nX2xvc3MgPSAwLjAKICAgIGZvciBpbWFnZXMsIGxhYmVscyBpbiB0cmFpbl9sb2FkZXI6CiAgICAgICAgb3B0aW1pemVyLnplcm9fZ3JhZCgpCiAgICAgICAgb3V0cHV0cyA9IG1vZGVsKGltYWdlcykKICAgICAgICBsb3NzID0gY3JpdGVyaW9uKG91dHB1dHMsIGxhYmVscykKICAgICAgICBsb3NzLmJhY2t3YXJkKCkKICAgICAgICBvcHRpbWl6ZXIuc3RlcCgpCiAgICAgICAgcnVubmluZ19sb3NzICs9IGxvc3MuaXRlbSgpCiAgICAKICAgIHByaW50KGYnRXBvY2ggW3tlcG9jaCsxfS97bnVtX2Vwb2Noc31dLCBMb3NzOiB7cnVubmluZ19sb3NzL2xlbih0cmFpbl9sb2FkZXIpOi40Zn0nKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
import torch.nn as nn
import torch.nn.functional as F
import torch.optim as optim
from torchvision import datasets, transforms

# Transformacions per normalitzar les dades
transform = transforms.Compose([transforms.ToTensor(), transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))])

# Carregar el conjunt de dades CIFAR-10
train_dataset = datasets.CIFAR10(root='./data', train=True, download=True, transform=transform)
train_loader = DataLoader(dataset=train_dataset, batch_size=64, shuffle=True)

# Definir la xarxa neuronal convolucional
class SimpleCNN(nn.Module):
    def __init__(self):
        super(SimpleCNN, self).__init__()
        self.conv1 = nn.Conv2d(3, 16, 3, 1)
        self.conv2 = nn.Conv2d(16, 32, 3, 1)
        self.fc1 = nn.Linear(32*6*6, 128)
        self.fc2 = nn.Linear(128, 10)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        x = F.max_pool2d(x, 2, 2)
        x = F.relu(self.conv2(x))
        x = F.max_pool2d(x, 2, 2)
        x = x.view(-1, 32*6*6)
        x = F.relu(self.fc1(x))
        x = self.fc2(x)
        return x

model = SimpleCNN()

# Definir la funci&oacute; de p&egrave;rdua i l'optimitzador
criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=0.001)

# Bucle d'entrenament
num_epochs = 10

for epoch in range(num_epochs):
    running_loss = 0.0
    for images, labels in train_loader:
        optimizer.zero_grad()
        outputs = model(images)
        loss = criterion(outputs, labels)
        loss.backward()
        optimizer.step()
        running_loss += loss.item()
    
    print(f'Epoch [{epoch+1}/{num_epochs}], Loss: {running_loss/len(train_loader):.4f}')</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>En aquesta secció, hem après a implementar un bucle d'entrenament bàsic en PyTorch. Hem vist com carregar i preprocessar les dades, definir un model, una funció de pèrdua i un optimitzador, i com utilitzar-los per entrenar el model. Aquest és un pas fonamental en el desenvolupament de models d'aprenentatge automàtic i és important comprendre bé cada part del procés. En el següent tema, explorarem com validar i provar el nostre model per assegurar-nos que generalitza bé a dades no vistes.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='03-01-data-loading-preprocessing' title="Càrrega i Preprocessament de Dades" class="py-2 px-3 btn btn-primary d-none d-md-inline">
				<i class="bi bi-caret-left-square-fill"></i> Anterior 
			</a>
			<a href='03-01-data-loading-preprocessing' title="Càrrega i Preprocessament de Dades" class="py-2 px-3 btn btn-primary d-md-none">
				<i class="bi bi-caret-left-square-fill"></i>
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-03-validation-testing' title="Validació i Prova" class="py-2 px-3 d-none d-md-inline btn btn-primary"
				data-read-mod="pytorch" data-read-unit="03-02">
				Següent <i class="bi bi-caret-right-square-fill"></i>
			</a>
			<a href='03-03-validation-testing' title="Validació i Prova" class="py-2 px-3 d-md-none btn btn-primary" 
				data-read-mod="pytorch" data-read-unit="03-02">
				<i class="bi bi-caret-right-square-fill"></i>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

			
	<div class="container mt-2 d-none d-md-block index">
		<h1>PyTorch: De Principiant a Avançat</h1>
<h2>Mòdul 1: Introducció a PyTorch</h2>
<ul>
<li><a href="01-01-what-is-pytorch">Què és PyTorch?</a></li>
<li><a href="01-02-setting-up-environment">Configuració de l'Entorn</a></li>
<li><a href="01-03-basic-tensor-operations">Operacions Bàsiques amb Tensor</a></li>
<li><a href="01-04-autograd">Autograd: Diferenciació Automàtica</a></li>
</ul>
<h2>Mòdul 2: Construcció de Xarxes Neuronals</h2>
<ul>
<li><a href="02-01-introduction-to-neural-networks">Introducció a les Xarxes Neuronals</a></li>
<li><a href="02-02-creating-simple-neural-network">Creació d'una Xarxa Neuronal Simple</a></li>
<li><a href="02-03-activation-functions">Funcions d'Activació</a></li>
<li><a href="02-04-loss-functions-optimization">Funcions de Pèrdua i Optimització</a></li>
</ul>
<h2>Mòdul 3: Entrenament de Xarxes Neuronals</h2>
<ul>
<li><a href="03-01-data-loading-preprocessing">Càrrega i Preprocessament de Dades</a></li>
<li><a href="03-02-training-loop">Bucle d'Entrenament</a></li>
<li><a href="03-03-validation-testing">Validació i Prova</a></li>
<li><a href="03-04-saving-loading-models">Desament i Càrrega de Models</a></li>
</ul>
<h2>Mòdul 4: Xarxes Neuronals Convolucionals (CNNs)</h2>
<ul>
<li><a href="04-01-introduction-to-cnns">Introducció a les CNNs</a></li>
<li><a href="04-02-building-cnn-from-scratch">Construcció d'una CNN des de Zero</a></li>
<li><a href="04-03-transfer-learning">Aprenentatge per Transferència amb Models Preentrenats</a></li>
<li><a href="04-04-fine-tuning-cnns">Ajust Fi de les CNNs</a></li>
</ul>
<h2>Mòdul 5: Xarxes Neuronals Recurrents (RNNs)</h2>
<ul>
<li><a href="05-01-introduction-to-rnns">Introducció a les RNNs</a></li>
<li><a href="05-02-building-rnn-from-scratch">Construcció d'una RNN des de Zero</a></li>
<li><a href="05-03-lstm-networks">Xarxes de Memòria a Llarg i Curt Termini (LSTM)</a></li>
<li><a href="05-04-gru-networks">Unitats Recurrents Gated (GRUs)</a></li>
</ul>
<h2>Mòdul 6: Temes Avançats</h2>
<ul>
<li><a href="06-01-gans">Xarxes Generatives Adversàries (GANs)</a></li>
<li><a href="06-02-reinforcement-learning">Aprenentatge per Reforç amb PyTorch</a></li>
<li><a href="06-03-deploying-models">Desplegament de Models PyTorch</a></li>
<li><a href="06-04-optimizing-performance">Optimització del Rendiment</a></li>
</ul>
<h2>Mòdul 7: Estudis de Cas i Projectes</h2>
<ul>
<li><a href="07-01-image-classification-project">Projecte de Classificació d'Imatges</a></li>
<li><a href="07-02-nlp-project">Projecte de Processament del Llenguatge Natural</a></li>
<li><a href="07-03-time-series-forecasting-project">Projecte de Predicció de Sèries Temporals</a></li>
<li><a href="07-04-custom-project">Projecte Personalitzat</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuari no autentificat</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<p id="loginModalEmail"></p>
            	<div id="mensaje" class="error"></div>
            	<div id="mensaje_info" class="text-success"></div>
            	
				<div class="mt-4 d-none" id="forgotPasswordSection">
					<div class="mb-3">
    <label for="recovery-email" class="form-label">Correu electrònic</label>
    <input type="email" required class="form-control" id="recovery-email" placeholder="Introdueix el teu correu electrònic">
</div>
<button class="btn btn-primary" id="btnRecover">Enviar enllaç de recuperació</button>

				</div>
								
				<div class="mt-4 d-none" id="deleteUserSection">	
					<div class="mb-3 alert alert-danger">
	Atenció! Estàs a punt d'eliminar totes les dades de registre i progrés.<br><b>Aquesta acció no es pot desfer.</b>
</div>
<div class="mb-3">
    <input type="password" required class="form-control" id="delete-user-pwd" placeholder="Introdueix la teva contrasenya">
</div>
<button class="btn btn-primary" id="btnDeleteUser">Eliminar usuari</button>

				</div>
				
				<div class="mt-4 d-none" id="changePassordSection">
					<div class="mb-3 row">
	<div class="col col-12 my-2">
	    <input type="password" required class="form-control" id="change-pwd-actual" placeholder="Introdueix la contrasenya actual">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-1" placeholder="Introdueix la nova contrasenya">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-2" placeholder="Repeteix la nova contrasenya">
	</div>
</div>
<button class="btn btn-primary" id="btnChangePassword">Canviar la contrasenya</button>

				</div>
				
				<div class="mt-4 d-none alert alert-warning" id="verifyPasswordSection">
					<p><b>Falta verificar correu</b></p>
					<a id="btnVerifyEmail" href="#">Enviar enllaç de verificació</a>

				</div>
				
				<div class="mt-4 d-none" id="disconnectUserSection">
					<div class="mb-3">
    <button id="btnDisconnect" class="btn btn-primary">Desconnectar</button>
</div>

<hr>

<div class="mt-3">
    <button class="btn btn-outline-secondary" id="change-password-link">Canviar la contrasenya</button>
</div>

<div class="mt-3">
    <a href="#" id="delete-user-link">Eliminar usuari</a>
</div>

				</div>
            
            	<div class="mt-4 d-none" id="modalTabsSection">
            		<ul class="nav nav-tabs" id="authTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login" type="button" role="tab" aria-controls="login" aria-selected="true">
        	Iniciar sessió
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="register-tab" data-bs-toggle="tab" data-bs-target="#register" type="button" role="tab" aria-controls="register" aria-selected="false">
        	Registrar-se
        </button>
    </li>
</ul>

<div class="tab-content mt-3" id="authTabsContent">
    <div class="tab-pane fade show active" id="login" role="tabpanel" aria-labelledby="login-tab">
    	<div class="mb-3">
    <label for="login-username" class="form-label">Correu electrònic</label>
    <input type="email" required class="form-control" id="login-username" placeholder="Introdueix el teu correu electrònic">
</div>
<div class="mb-3">
    <label for="login-password" class="form-label">Contrasenya</label>
    <input type="password"  required class="form-control" id="login-password" placeholder="Introdueix la teva contrasenya">
</div>
<button class="btn btn-primary" id="btnLogin">Iniciar sessió</button>
<div class="mt-3">
    <a href="#" id="forgot-password-link">Has oblidat la teva contrasenya?</a>
</div>
    </div>

    <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
    	<div class="mb-3">
    <label for="register-email" class="form-label">Correu electrònic</label>
    <input type="email" class="form-control" id="register-email" required placeholder="Introdueix el teu correu electrònic">
</div>

<div class="mb-3">
    <label for="register-password" class="form-label">Contrasenya</label>
    <input type="password" class="form-control"  required id="register-password" placeholder="Introdueix la teva contrasenya">
</div>

<div class="mb-3">
    <label for="register-name" class="form-label">Nom</label>
    <input type="text" class="form-control"  required id="register-name" placeholder="Introdueix el teu nom">
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-conditions-reg">
    <label for="accept-conditions-reg" class="form-check-label">
        He llegit i accepto la <a href="/privacity" target="blank">Política de Privacitat</a> i els <a href="/licence" target="blank">Termes i Condicions d'Ús</a>.
    </label>
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-allow_comunications">
    <label for="accept-allow_comunications" class="form-check-label">
        Vull rebre notícies i actualitzacions sobre els cursos (opcional).
    </label>
</div>

<button id="btnRegister" class="btn btn-primary">Registrar-se</button>
    </div>
</div>
            	</div>
            </div>
        </div>
    </div>
</div>

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
