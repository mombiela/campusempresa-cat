<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fitxers d'estat</title>

    <link rel="alternate" href="https://campusempresa.com/mod/terraform/03-02-state-files" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/terraform/03-02-state-files" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/terraform/03-02-state-files" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/terraform/03-02-state-files" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/terraform/03-02-state-files" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Contingut del curs</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Competències tècniques</a>
				<a href="/all/conocimientos">Coneixements</a>
				<a href="/all/soft_skills">Competències socials</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-01-understanding-state' title="Comprendre l'estat">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Fitxers d'estat</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-03-remote-state' title="Estat remot">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Els fitxers d'estat són una part fonamental de Terraform. Aquests fitxers emmagatzemen informació sobre la infraestructura gestionada per Terraform, permetent que Terraform conegui l'estat actual dels recursos. En aquesta secció, explorarem en profunditat els fitxers d'estat, la seva importància, com es gestionen i les millors pràctiques per treballar amb ells.</p>
</div><h1><p>Què és un fitxer d'estat?</p>
</h1>
<div class='content'><p>Un fitxer d'estat és un fitxer que conté un registre de tots els recursos que Terraform ha creat i està gestionant. Aquest fitxer permet a Terraform saber quins recursos existeixen, quins canvis s'han fet i quins canvis cal aplicar.</p>
</div><h2><p>Importància dels fitxers d'estat</p>
</h2>
<div class='content'><ul>
<li><strong>Seguiment de recursos</strong>: Els fitxers d'estat permeten a Terraform mantenir un registre dels recursos que ha creat, modificat o eliminat.</li>
<li><strong>Optimització de canvis</strong>: Amb l'estat actual dels recursos, Terraform pot calcular de manera eficient els canvis necessaris per portar la infraestructura a l'estat desitjat.</li>
<li><strong>Col·laboració</strong>: Els fitxers d'estat permeten que múltiples usuaris treballin en la mateixa infraestructura de manera coordinada.</li>
</ul>
</div><h1><p>Estructura d'un fitxer d'estat</p>
</h1>
<div class='content'><p>Els fitxers d'estat estan en format JSON i contenen diverses seccions clau:</p>
<ul>
<li><strong>Version</strong>: La versió del fitxer d'estat.</li>
<li><strong>Terraform_version</strong>: La versió de Terraform utilitzada per crear o modificar l'estat.</li>
<li><strong>Resources</strong>: Una llista de tots els recursos gestionats per Terraform, incloent-hi els seus atributs i metadades.</li>
</ul>
</div><h2><p>Exemple d'un fitxer d'estat</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJ2ZXJzaW9uIjogNCwKICAidGVycmFmb3JtX3ZlcnNpb24iOiAiMS4wLjAiLAogICJyZXNvdXJjZXMiOiBbCiAgICB7CiAgICAgICJtb2R1bGUiOiAibW9kdWxlLnZwYyIsCiAgICAgICJtb2RlIjogIm1hbmFnZWQiLAogICAgICAidHlwZSI6ICJhd3NfdnBjIiwKICAgICAgIm5hbWUiOiAibWFpbiIsCiAgICAgICJwcm92aWRlciI6ICJwcm92aWRlcltcInJlZ2lzdHJ5LnRlcnJhZm9ybS5pby9oYXNoaWNvcnAvYXdzXCJdIiwKICAgICAgImluc3RhbmNlcyI6IFsKICAgICAgICB7CiAgICAgICAgICAic2NoZW1hX3ZlcnNpb24iOiAwLAogICAgICAgICAgImF0dHJpYnV0ZXMiOiB7CiAgICAgICAgICAgICJpZCI6ICJ2cGMtMTIzNDU2NzgiLAogICAgICAgICAgICAiY2lkcl9ibG9jayI6ICIxMC4wLjAuMC8xNiIsCiAgICAgICAgICAgICJ0YWdzIjogewogICAgICAgICAgICAgICJOYW1lIjogIm1haW4tdnBjIgogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICBdCiAgICB9CiAgXQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;version&quot;: 4,
  &quot;terraform_version&quot;: &quot;1.0.0&quot;,
  &quot;resources&quot;: [
    {
      &quot;module&quot;: &quot;module.vpc&quot;,
      &quot;mode&quot;: &quot;managed&quot;,
      &quot;type&quot;: &quot;aws_vpc&quot;,
      &quot;name&quot;: &quot;main&quot;,
      &quot;provider&quot;: &quot;provider[\&quot;registry.terraform.io/hashicorp/aws\&quot;]&quot;,
      &quot;instances&quot;: [
        {
          &quot;schema_version&quot;: 0,
          &quot;attributes&quot;: {
            &quot;id&quot;: &quot;vpc-12345678&quot;,
            &quot;cidr_block&quot;: &quot;10.0.0.0/16&quot;,
            &quot;tags&quot;: {
              &quot;Name&quot;: &quot;main-vpc&quot;
            }
          }
        }
      ]
    }
  ]
}</pre></div><div class='content'></div><h1><p>Gestió dels fitxers d'estat</p>
</h1>
<div class='content'></div><h2><p>Ubicació del fitxer d'estat</p>
</h2>
<div class='content'><p>Per defecte, Terraform emmagatzema el fitxer d'estat en el directori de treball actual amb el nom <code>terraform.tfstate</code>. També es crea un fitxer de còpia de seguretat anomenat <code>terraform.tfstate.backup</code>.</p>
</div><h2><p>Comandes relacionades amb l'estat</p>
</h2>
<div class='content'><ul>
<li><strong><code>terraform init</code></strong>: Inicialitza una configuració de treball de Terraform.</li>
<li><strong><code>terraform plan</code></strong>: Compara l'estat actual amb la configuració desitjada i genera un pla d'execució.</li>
<li><strong><code>terraform apply</code></strong>: Aplica els canvis necessaris per portar la infraestructura a l'estat desitjat.</li>
<li><strong><code>terraform refresh</code></strong>: Actualitza l'estat actual amb la informació més recent dels proveïdors de recursos.</li>
<li><strong><code>terraform state</code></strong>: Proporciona diverses subcomandes per gestionar l'estat, com ara <code>list</code>, <code>show</code>, <code>mv</code>, <code>rm</code>, etc.</li>
</ul>
</div><h2><p>Millors pràctiques per gestionar els fitxers d'estat</p>
</h2>
<div class='content'><ul>
<li><strong>Control de versions</strong>: No incloure els fitxers d'estat en el control de versions. Utilitzar un emmagatzematge remot per compartir l'estat entre equips.</li>
<li><strong>Seguretat</strong>: Protegir els fitxers d'estat, ja que poden contenir informació sensible.</li>
<li><strong>Còpies de seguretat</strong>: Mantenir còpies de seguretat regulars dels fitxers d'estat per evitar pèrdues de dades.</li>
</ul>
</div><h1><p>Exercici pràctic</p>
</h1>
<div class='content'></div><h2><p>Objectiu</p>
</h2>
<div class='content'><p>Crear una configuració simple de Terraform que defineixi un recurs i observar com es crea i actualitza el fitxer d'estat.</p>
</div><h2><p>Passos</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Crear un fitxer de configuració de Terraform</strong>:</p>
<pre><code class="language-hcl">provider &quot;aws&quot; {
  region = &quot;us-west-2&quot;
}

resource &quot;aws_s3_bucket&quot; &quot;example&quot; {
  bucket = &quot;my-unique-bucket-name&quot;
  acl    = &quot;private&quot;
}
</code></pre>
</li>
<li>
<p><strong>Inicialitzar la configuració</strong>:</p>
<pre><code class="language-bash">terraform init
</code></pre>
</li>
<li>
<p><strong>Aplicar la configuració</strong>:</p>
<pre><code class="language-bash">terraform apply
</code></pre>
</li>
<li>
<p><strong>Observar el fitxer d'estat</strong>:</p>
<p>Després d'executar <code>terraform apply</code>, obrir el fitxer <code>terraform.tfstate</code> i revisar el contingut per veure com s'ha registrat el recurs S3.</p>
</li>
</ol>
</div><h2><p>Solució</p>
</h2>
<div class='content'><p>Després d'executar els passos anteriors, el fitxer <code>terraform.tfstate</code> hauria de contenir informació sobre el bucket S3 creat, similar a l'exemple de fitxer d'estat proporcionat anteriorment.</p>
</div><h1><p>Conclusió</p>
</h1>
<div class='content'><p>Els fitxers d'estat són essencials per al funcionament de Terraform, ja que permeten mantenir un registre dels recursos gestionats i optimitzar els canvis necessaris. És important gestionar aquests fitxers amb cura, seguint les millors pràctiques per garantir la seguretat i la col·laboració eficient entre equips.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-01-understanding-state' title="Comprendre l'estat">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-03-remote-state' title="Estat remot">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
