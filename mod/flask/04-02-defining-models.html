<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Definició de Models</title>

    <link rel="alternate" href="https://campusempresa.com/mod/flask/04-02-defining-models" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/flask/04-02-defining-models" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/flask/04-02-defining-models" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/flask/04-02-defining-models" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/flask/04-02-defining-models" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Contingut del curs</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Competències tècniques</a>
				<a href="/all/conocimientos">Coneixements</a>
				<a href="/all/soft_skills">Competències socials</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-01-intro-flask-sqlalchemy' title="Introducció a Flask-SQLAlchemy">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Definició de Models</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-03-crud-operations' title="Realització d'Operacions CRUD">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem a definir models de dades utilitzant Flask-SQLAlchemy, una extensió de Flask que facilita la interacció amb bases de dades SQL. Els models són una representació de les taules de la base de dades en forma de classes Python, i cada instància d'una classe representa una fila de la taula.</p>
</div><h1><p>Objectius</p>
</h1>
<div class='content'><ul>
<li>Entendre què és un model en el context de Flask-SQLAlchemy.</li>
<li>Aprendre a definir models de dades.</li>
<li>Comprendre com es mapegen les classes Python a les taules de la base de dades.</li>
<li>Crear relacions entre models.</li>
</ul>
</div><h1><p>Conceptes Clau</p>
</h1>
<div class='content'></div><h2><p>Què és un Model?</p>
</h2>
<div class='content'><p>Un model és una classe Python que defineix l'estructura d'una taula de la base de dades. Cada atribut de la classe representa una columna de la taula.</p>
</div><h2><p>Instal·lació de Flask-SQLAlchemy</p>
</h2>
<div class='content'><p>Abans de començar, assegura't que tens Flask-SQLAlchemy instal·lat. Pots instal·lar-lo utilitzant pip:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgZmxhc2stc3FsYWxjaGVteQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install flask-sqlalchemy</pre></div><div class='content'></div><h2><p>Configuració de Flask-SQLAlchemy</p>
</h2>
<div class='content'><p>Primer, hem de configurar Flask-SQLAlchemy en la nostra aplicació Flask. Afegirem la configuració necessària al nostre fitxer principal de l'aplicació.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2sKZnJvbSBmbGFza19zcWxhbGNoZW15IGltcG9ydCBTUUxBbGNoZW15CgphcHAgPSBGbGFzayhfX25hbWVfXykKYXBwLmNvbmZpZ1snU1FMQUxDSEVNWV9EQVRBQkFTRV9VUkknXSA9ICdzcWxpdGU6Ly8vbXlkYXRhYmFzZS5kYicKYXBwLmNvbmZpZ1snU1FMQUxDSEVNWV9UUkFDS19NT0RJRklDQVRJT05TJ10gPSBGYWxzZQoKZGIgPSBTUUxBbGNoZW15KGFwcCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///mydatabase.db'
app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False

db = SQLAlchemy(app)</pre></div><div class='content'></div><h2><p>Definint un Model Bàsic</p>
</h2>
<div class='content'><p>A continuació, definirem un model bàsic per a una taula <code>User</code> amb els camps <code>id</code>, <code>username</code>, i <code>email</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgVXNlcihkYi5Nb2RlbCk6CiAgICBpZCA9IGRiLkNvbHVtbihkYi5JbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlKQogICAgdXNlcm5hbWUgPSBkYi5Db2x1bW4oZGIuU3RyaW5nKDgwKSwgdW5pcXVlPVRydWUsIG51bGxhYmxlPUZhbHNlKQogICAgZW1haWwgPSBkYi5Db2x1bW4oZGIuU3RyaW5nKDEyMCksIHVuaXF1ZT1UcnVlLCBudWxsYWJsZT1GYWxzZSkKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGYnPFVzZXIge3NlbGYudXNlcm5hbWV9Pic="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)

    def __repr__(self):
        return f'&lt;User {self.username}&gt;'</pre></div><div class='content'></div><h2><p>Explicació del Codi</p>
</h2>
<div class='content'><ul>
<li><code>db.Model</code>: La classe base de la qual hereten tots els models.</li>
<li><code>db.Column</code>: Defineix una columna en la taula.</li>
<li><code>db.Integer</code>, <code>db.String</code>: Tipus de dades de la columna.</li>
<li><code>primary_key=True</code>: Indica que aquesta columna és la clau primària.</li>
<li><code>unique=True</code>: Indica que els valors en aquesta columna han de ser únics.</li>
<li><code>nullable=False</code>: Indica que aquesta columna no pot ser nul·la.</li>
</ul>
</div><h2><p>Creant la Base de Dades</p>
</h2>
<div class='content'><p>Després de definir els models, hem de crear la base de dades i les taules. Això es fa executant el següent codi en un context de l'aplicació.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("d2l0aCBhcHAuYXBwX2NvbnRleHQoKToKICAgIGRiLmNyZWF0ZV9hbGwoKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>with app.app_context():
    db.create_all()</pre></div><div class='content'></div><h2><p>Relacions entre Models</p>
</h2>
<div class='content'><p>Flask-SQLAlchemy també permet definir relacions entre models. Per exemple, podem definir una relació un-a-molts entre <code>User</code> i <code>Post</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgUG9zdChkYi5Nb2RlbCk6CiAgICBpZCA9IGRiLkNvbHVtbihkYi5JbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlKQogICAgdGl0bGUgPSBkYi5Db2x1bW4oZGIuU3RyaW5nKDEyMCksIG51bGxhYmxlPUZhbHNlKQogICAgYm9keSA9IGRiLkNvbHVtbihkYi5UZXh0LCBudWxsYWJsZT1GYWxzZSkKICAgIHVzZXJfaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlciwgZGIuRm9yZWlnbktleSgndXNlci5pZCcpLCBudWxsYWJsZT1GYWxzZSkKCiAgICB1c2VyID0gZGIucmVsYXRpb25zaGlwKCdVc2VyJywgYmFja19wb3B1bGF0ZXM9J3Bvc3RzJykKCmNsYXNzIFVzZXIoZGIuTW9kZWwpOgogICAgaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlciwgcHJpbWFyeV9rZXk9VHJ1ZSkKICAgIHVzZXJuYW1lID0gZGIuQ29sdW1uKGRiLlN0cmluZyg4MCksIHVuaXF1ZT1UcnVlLCBudWxsYWJsZT1GYWxzZSkKICAgIGVtYWlsID0gZGIuQ29sdW1uKGRiLlN0cmluZygxMjApLCB1bmlxdWU9VHJ1ZSwgbnVsbGFibGU9RmFsc2UpCiAgICBwb3N0cyA9IGRiLnJlbGF0aW9uc2hpcCgnUG9zdCcsIGJhY2tfcG9wdWxhdGVzPSd1c2VyJykKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGYnPFVzZXIge3NlbGYudXNlcm5hbWV9Pic="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Post(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    title = db.Column(db.String(120), nullable=False)
    body = db.Column(db.Text, nullable=False)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)

    user = db.relationship('User', back_populates='posts')

class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)
    posts = db.relationship('Post', back_populates='user')

    def __repr__(self):
        return f'&lt;User {self.username}&gt;'</pre></div><div class='content'></div><h2><p>Explicació del Codi</p>
</h2>
<div class='content'><ul>
<li><code>db.ForeignKey('user.id')</code>: Defineix una clau forana que enllaça amb la columna <code>id</code> de la taula <code>user</code>.</li>
<li><code>db.relationship('User', back_populates='posts')</code>: Defineix una relació entre <code>Post</code> i <code>User</code>.</li>
</ul>
</div><h1><p>Exercicis Pràctics</p>
</h1>
<div class='content'></div><h2><p>Exercici 1: Crear un Model de Producte</p>
</h2>
<div class='content'><p>Defineix un model <code>Product</code> amb els següents camps: <code>id</code>, <code>name</code>, <code>price</code>, i <code>description</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgUHJvZHVjdChkYi5Nb2RlbCk6CiAgICBpZCA9IGRiLkNvbHVtbihkYi5JbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlKQogICAgbmFtZSA9IGRiLkNvbHVtbihkYi5TdHJpbmcoMTAwKSwgbnVsbGFibGU9RmFsc2UpCiAgICBwcmljZSA9IGRiLkNvbHVtbihkYi5GbG9hdCwgbnVsbGFibGU9RmFsc2UpCiAgICBkZXNjcmlwdGlvbiA9IGRiLkNvbHVtbihkYi5UZXh0LCBudWxsYWJsZT1UcnVlKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZic8UHJvZHVjdCB7c2VsZi5uYW1lfT4n"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Product(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(100), nullable=False)
    price = db.Column(db.Float, nullable=False)
    description = db.Column(db.Text, nullable=True)

    def __repr__(self):
        return f'&lt;Product {self.name}&gt;'</pre></div><div class='content'></div><h2><p>Exercici 2: Crear una Relació un-a-molts</p>
</h2>
<div class='content'><p>Defineix una relació un-a-molts entre <code>Category</code> i <code>Product</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgQ2F0ZWdvcnkoZGIuTW9kZWwpOgogICAgaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlciwgcHJpbWFyeV9rZXk9VHJ1ZSkKICAgIG5hbWUgPSBkYi5Db2x1bW4oZGIuU3RyaW5nKDUwKSwgdW5pcXVlPVRydWUsIG51bGxhYmxlPUZhbHNlKQogICAgcHJvZHVjdHMgPSBkYi5yZWxhdGlvbnNoaXAoJ1Byb2R1Y3QnLCBiYWNrX3BvcHVsYXRlcz0nY2F0ZWdvcnknKQoKY2xhc3MgUHJvZHVjdChkYi5Nb2RlbCk6CiAgICBpZCA9IGRiLkNvbHVtbihkYi5JbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlKQogICAgbmFtZSA9IGRiLkNvbHVtbihkYi5TdHJpbmcoMTAwKSwgbnVsbGFibGU9RmFsc2UpCiAgICBwcmljZSA9IGRiLkNvbHVtbihkYi5GbG9hdCwgbnVsbGFibGU9RmFsc2UpCiAgICBkZXNjcmlwdGlvbiA9IGRiLkNvbHVtbihkYi5UZXh0LCBudWxsYWJsZT1UcnVlKQogICAgY2F0ZWdvcnlfaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlciwgZGIuRm9yZWlnbktleSgnY2F0ZWdvcnkuaWQnKSwgbnVsbGFibGU9RmFsc2UpCgogICAgY2F0ZWdvcnkgPSBkYi5yZWxhdGlvbnNoaXAoJ0NhdGVnb3J5JywgYmFja19wb3B1bGF0ZXM9J3Byb2R1Y3RzJykKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGYnPFByb2R1Y3Qge3NlbGYubmFtZX0+Jw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Category(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(50), unique=True, nullable=False)
    products = db.relationship('Product', back_populates='category')

class Product(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(100), nullable=False)
    price = db.Column(db.Float, nullable=False)
    description = db.Column(db.Text, nullable=True)
    category_id = db.Column(db.Integer, db.ForeignKey('category.id'), nullable=False)

    category = db.relationship('Category', back_populates='products')

    def __repr__(self):
        return f'&lt;Product {self.name}&gt;'</pre></div><div class='content'></div><h1><p>Conclusió</p>
</h1>
<div class='content'><p>En aquest tema, hem après a definir models de dades utilitzant Flask-SQLAlchemy, a crear relacions entre models i a configurar la nostra aplicació Flask per utilitzar una base de dades. Aquests conceptes són fonamentals per a qualsevol aplicació web que necessiti emmagatzemar i gestionar dades de manera eficient. En el següent tema, explorarem com realitzar operacions CRUD (Crear, Llegir, Actualitzar, Esborrar) amb els nostres models.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-01-intro-flask-sqlalchemy' title="Introducció a Flask-SQLAlchemy">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-03-crud-operations' title="Realització d'Operacions CRUD">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
