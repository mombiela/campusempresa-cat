<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ús d'Objectes de Matriu de Vèrtexs (VAOs)</title>

    <link rel="alternate" href="https://campusempresa.com/mod/open_gl/05-02-using-vaos" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/open_gl/05-02-using-vaos" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/open_gl/05-02-using-vaos" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/open_gl/05-02-using-vaos" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/open_gl/05-02-using-vaos" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-01-optimizing-code' title="Optimitzar el Codi OpenGL">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Ús d'Objectes de Matriu de Vèrtexs (VAOs)</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-03-memory-management' title="Gestió Eficient de la Memòria">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>Els Objectes de Matriu de Vèrtexs (Vertex Array Objects, VAOs) són una eina fonamental en OpenGL per gestionar l'estat de les dades de vèrtexs. Els VAOs permeten agrupar múltiples configuracions de vèrtexs en un sol objecte, facilitant la gestió i optimitzant el rendiment de les aplicacions gràfiques.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>VAO (Vertex Array Object)</strong>: Un objecte que encapsula l'estat de les dades de vèrtexs.</li>
<li><strong>VBO (Vertex Buffer Object)</strong>: Un buffer que emmagatzema les dades de vèrtexs.</li>
<li><strong>EBO (Element Buffer Object)</strong>: Un buffer que emmagatzema els índexs dels vèrtexs per a la renderització.</li>
</ul>
</div><h1>Creació i Ús de VAOs</h1>
<div class='content'></div><h2>Passos per Utilitzar un VAO</h2>
<div class='content'><ol>
<li><strong>Crear un VAO</strong>: Generar un VAO utilitzant <code>glGenVertexArrays</code>.</li>
<li><strong>Lligar el VAO</strong>: Lligar el VAO amb <code>glBindVertexArray</code>.</li>
<li><strong>Configurar els VBOs i EBOs</strong>: Lligar i configurar els VBOs i EBOs mentre el VAO està lligat.</li>
<li><strong>Deslligar el VAO</strong>: Deslligar el VAO amb <code>glBindVertexArray(0)</code>.</li>
</ol>
</div><h2>Exemple Pràctic</h2>
<div class='content'><p>A continuació, es mostra un exemple pràctic de com crear i utilitzar un VAO en OpenGL:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gSW5jbG91cmUgbGVzIGxsaWJyZXJpZXMgbmVjZXNzw6ByaWVzCiNpbmNsdWRlIDxHTC9nbGV3Lmg+CiNpbmNsdWRlIDxHTEZXL2dsZnczLmg+CgovLyBEYWRlcyBkZSB2w6hydGV4cwpHTGZsb2F0IHZlcnRpY2VzW10gPSB7CiAgICAvLyBQb3NpY2lvbnMgICAgICAgIC8vIENvbG9ycwogICAgMC41ZiwgIDAuNWYsIDAuMGYsICAxLjBmLCAwLjBmLCAwLjBmLCAgLy8gVsOocnRleCBzdXBlcmlvciBkcmV0CiAgICAwLjVmLCAtMC41ZiwgMC4wZiwgIDAuMGYsIDEuMGYsIDAuMGYsICAvLyBWw6hydGV4IGluZmVyaW9yIGRyZXQKICAgLTAuNWYsIC0wLjVmLCAwLjBmLCAgMC4wZiwgMC4wZiwgMS4wZiwgIC8vIFbDqHJ0ZXggaW5mZXJpb3IgZXNxdWVycmUKICAgLTAuNWYsICAwLjVmLCAwLjBmLCAgMS4wZiwgMS4wZiwgMC4wZiAgIC8vIFbDqHJ0ZXggc3VwZXJpb3IgZXNxdWVycmUKfTsKCkdMdWludCBpbmRpY2VzW10gPSB7CiAgICAwLCAxLCAzLCAgLy8gUHJpbWVyIHRyaWFuZ2xlCiAgICAxLCAyLCAzICAgLy8gU2Vnb24gdHJpYW5nbGUKfTsKCmludCBtYWluKCkgewogICAgLy8gSW5pY2lhbGl0emFyIEdMRlcKICAgIGlmICghZ2xmd0luaXQoKSkgewogICAgICAgIHJldHVybiAtMTsKICAgIH0KCiAgICAvLyBDcmVhciB1bmEgZmluZXN0cmEKICAgIEdMRld3aW5kb3cqIHdpbmRvdyA9IGdsZndDcmVhdGVXaW5kb3coODAwLCA2MDAsICJPcGVuR0wgVkFPIEV4YW1wbGUiLCBOVUxMLCBOVUxMKTsKICAgIGlmICghd2luZG93KSB7CiAgICAgICAgZ2xmd1Rlcm1pbmF0ZSgpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KCiAgICAvLyBGZXIgcXVlIGVsIGNvbnRleHQgZGUgbGEgZmluZXN0cmEgc2lndWkgZWwgY29udGV4dCBhY3R1YWwKICAgIGdsZndNYWtlQ29udGV4dEN1cnJlbnQod2luZG93KTsKCiAgICAvLyBJbmljaWFsaXR6YXIgR0xFVwogICAgaWYgKGdsZXdJbml0KCkgIT0gR0xFV19PSykgewogICAgICAgIHJldHVybiAtMTsKICAgIH0KCiAgICAvLyBDcmVhciBpIGxsaWdhciBlbCBWQU8KICAgIEdMdWludCBWQU87CiAgICBnbEdlblZlcnRleEFycmF5cygxLCAmVkFPKTsKICAgIGdsQmluZFZlcnRleEFycmF5KFZBTyk7CgogICAgLy8gQ3JlYXIgaSBsbGlnYXIgZWwgVkJPCiAgICBHTHVpbnQgVkJPOwogICAgZ2xHZW5CdWZmZXJzKDEsICZWQk8pOwogICAgZ2xCaW5kQnVmZmVyKEdMX0FSUkFZX0JVRkZFUiwgVkJPKTsKICAgIGdsQnVmZmVyRGF0YShHTF9BUlJBWV9CVUZGRVIsIHNpemVvZih2ZXJ0aWNlcyksIHZlcnRpY2VzLCBHTF9TVEFUSUNfRFJBVyk7CgogICAgLy8gQ3JlYXIgaSBsbGlnYXIgbCdFQk8KICAgIEdMdWludCBFQk87CiAgICBnbEdlbkJ1ZmZlcnMoMSwgJkVCTyk7CiAgICBnbEJpbmRCdWZmZXIoR0xfRUxFTUVOVF9BUlJBWV9CVUZGRVIsIEVCTyk7CiAgICBnbEJ1ZmZlckRhdGEoR0xfRUxFTUVOVF9BUlJBWV9CVUZGRVIsIHNpemVvZihpbmRpY2VzKSwgaW5kaWNlcywgR0xfU1RBVElDX0RSQVcpOwoKICAgIC8vIENvbmZpZ3VyYXIgZWxzIGF0cmlidXRzIGRlIHbDqHJ0ZXhzCiAgICBnbFZlcnRleEF0dHJpYlBvaW50ZXIoMCwgMywgR0xfRkxPQVQsIEdMX0ZBTFNFLCA2ICogc2l6ZW9mKEdMZmxvYXQpLCAoR0x2b2lkKikwKTsKICAgIGdsRW5hYmxlVmVydGV4QXR0cmliQXJyYXkoMCk7CiAgICBnbFZlcnRleEF0dHJpYlBvaW50ZXIoMSwgMywgR0xfRkxPQVQsIEdMX0ZBTFNFLCA2ICogc2l6ZW9mKEdMZmxvYXQpLCAoR0x2b2lkKikoMyAqIHNpemVvZihHTGZsb2F0KSkpOwogICAgZ2xFbmFibGVWZXJ0ZXhBdHRyaWJBcnJheSgxKTsKCiAgICAvLyBEZXNsbGlnYXIgZWwgVkFPCiAgICBnbEJpbmRWZXJ0ZXhBcnJheSgwKTsKCiAgICAvLyBCdWNsZSBkZSByZW5kZXJpdHphY2nDswogICAgd2hpbGUgKCFnbGZ3V2luZG93U2hvdWxkQ2xvc2Uod2luZG93KSkgewogICAgICAgIC8vIEVzYm9ycmFyIGVsIGJ1ZmZlciBkZSBjb2xvcgogICAgICAgIGdsQ2xlYXIoR0xfQ09MT1JfQlVGRkVSX0JJVCk7CgogICAgICAgIC8vIExsaWdhciBlbCBWQU8gaSBkaWJ1aXhhcgogICAgICAgIGdsQmluZFZlcnRleEFycmF5KFZBTyk7CiAgICAgICAgZ2xEcmF3RWxlbWVudHMoR0xfVFJJQU5HTEVTLCA2LCBHTF9VTlNJR05FRF9JTlQsIDApOwogICAgICAgIGdsQmluZFZlcnRleEFycmF5KDApOwoKICAgICAgICAvLyBJbnRlcmNhbnZpYXIgZWxzIGJ1ZmZlcnMKICAgICAgICBnbGZ3U3dhcEJ1ZmZlcnMod2luZG93KTsKCiAgICAgICAgLy8gUHJvY2Vzc2FyIGVscyBlc2RldmVuaW1lbnRzCiAgICAgICAgZ2xmd1BvbGxFdmVudHMoKTsKICAgIH0KCiAgICAvLyBBbGxpYmVyYXIgZWxzIHJlY3Vyc29zCiAgICBnbERlbGV0ZVZlcnRleEFycmF5cygxLCAmVkFPKTsKICAgIGdsRGVsZXRlQnVmZmVycygxLCAmVkJPKTsKICAgIGdsRGVsZXRlQnVmZmVycygxLCAmRUJPKTsKCiAgICAvLyBUZXJtaW5hciBHTEZXCiAgICBnbGZ3VGVybWluYXRlKCk7CgogICAgcmV0dXJuIDA7Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Incloure les llibreries necess&agrave;ries
#include &lt;GL/glew.h&gt;
#include &lt;GLFW/glfw3.h&gt;

// Dades de v&egrave;rtexs
GLfloat vertices[] = {
    // Posicions        // Colors
    0.5f,  0.5f, 0.0f,  1.0f, 0.0f, 0.0f,  // V&egrave;rtex superior dret
    0.5f, -0.5f, 0.0f,  0.0f, 1.0f, 0.0f,  // V&egrave;rtex inferior dret
   -0.5f, -0.5f, 0.0f,  0.0f, 0.0f, 1.0f,  // V&egrave;rtex inferior esquerre
   -0.5f,  0.5f, 0.0f,  1.0f, 1.0f, 0.0f   // V&egrave;rtex superior esquerre
};

GLuint indices[] = {
    0, 1, 3,  // Primer triangle
    1, 2, 3   // Segon triangle
};

int main() {
    // Inicialitzar GLFW
    if (!glfwInit()) {
        return -1;
    }

    // Crear una finestra
    GLFWwindow* window = glfwCreateWindow(800, 600, &quot;OpenGL VAO Example&quot;, NULL, NULL);
    if (!window) {
        glfwTerminate();
        return -1;
    }

    // Fer que el context de la finestra sigui el context actual
    glfwMakeContextCurrent(window);

    // Inicialitzar GLEW
    if (glewInit() != GLEW_OK) {
        return -1;
    }

    // Crear i lligar el VAO
    GLuint VAO;
    glGenVertexArrays(1, &amp;VAO);
    glBindVertexArray(VAO);

    // Crear i lligar el VBO
    GLuint VBO;
    glGenBuffers(1, &amp;VBO);
    glBindBuffer(GL_ARRAY_BUFFER, VBO);
    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);

    // Crear i lligar l'EBO
    GLuint EBO;
    glGenBuffers(1, &amp;EBO);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);

    // Configurar els atributs de v&egrave;rtexs
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 6 * sizeof(GLfloat), (GLvoid*)0);
    glEnableVertexAttribArray(0);
    glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 6 * sizeof(GLfloat), (GLvoid*)(3 * sizeof(GLfloat)));
    glEnableVertexAttribArray(1);

    // Deslligar el VAO
    glBindVertexArray(0);

    // Bucle de renderitzaci&oacute;
    while (!glfwWindowShouldClose(window)) {
        // Esborrar el buffer de color
        glClear(GL_COLOR_BUFFER_BIT);

        // Lligar el VAO i dibuixar
        glBindVertexArray(VAO);
        glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0);
        glBindVertexArray(0);

        // Intercanviar els buffers
        glfwSwapBuffers(window);

        // Processar els esdeveniments
        glfwPollEvents();
    }

    // Alliberar els recursos
    glDeleteVertexArrays(1, &amp;VAO);
    glDeleteBuffers(1, &amp;VBO);
    glDeleteBuffers(1, &amp;EBO);

    // Terminar GLFW
    glfwTerminate();

    return 0;
}</pre></div><div class='content'></div><h2>Explicació del Codi</h2>
<div class='content'><ol>
<li><strong>Inicialització de GLFW i GLEW</strong>: Es crea una finestra i es fa que el context de la finestra sigui el context actual.</li>
<li><strong>Creació del VAO</strong>: Es genera un VAO i es lliga.</li>
<li><strong>Creació del VBO i EBO</strong>: Es generen i lliguen els buffers de vèrtexs i índexs, i es carreguen les dades.</li>
<li><strong>Configuració dels Atributs de Vèrtexs</strong>: Es defineixen els atributs de vèrtexs (posicions i colors) i s'habiliten.</li>
<li><strong>Deslligar el VAO</strong>: Es deslliga el VAO per evitar modificacions accidentals.</li>
<li><strong>Bucle de Renderització</strong>: Es lliguen el VAO i es dibuixen els elements en cada iteració del bucle.</li>
<li><strong>Alliberament de Recursos</strong>: Es destrueixen els VAOs, VBOs i EBOs, i es termina GLFW.</li>
</ol>
</div><h1>Exercicis Pràctics</h1>
<div class='content'></div><h2>Exercici 1: Crear un VAO per a un Triangle</h2>
<div class='content'><p>Crea un VAO per a un triangle amb els següents vèrtexs i colors:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R0xmbG9hdCB2ZXJ0aWNlc1tdID0gewogICAgLy8gUG9zaWNpb25zICAgICAgICAvLyBDb2xvcnMKICAgIDAuMGYsICAwLjVmLCAwLjBmLCAgMS4wZiwgMC4wZiwgMC4wZiwgIC8vIFbDqHJ0ZXggc3VwZXJpb3IKICAgIDAuNWYsIC0wLjVmLCAwLjBmLCAgMC4wZiwgMS4wZiwgMC4wZiwgIC8vIFbDqHJ0ZXggaW5mZXJpb3IgZHJldAogICAtMC41ZiwgLTAuNWYsIDAuMGYsICAwLjBmLCAwLjBmLCAxLjBmICAgLy8gVsOocnRleCBpbmZlcmlvciBlc3F1ZXJyZQp9Ow=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>GLfloat vertices[] = {
    // Posicions        // Colors
    0.0f,  0.5f, 0.0f,  1.0f, 0.0f, 0.0f,  // V&egrave;rtex superior
    0.5f, -0.5f, 0.0f,  0.0f, 1.0f, 0.0f,  // V&egrave;rtex inferior dret
   -0.5f, -0.5f, 0.0f,  0.0f, 0.0f, 1.0f   // V&egrave;rtex inferior esquerre
};</pre></div><div class='content'></div><h2>Solució</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ3JlYXIgaSBsbGlnYXIgZWwgVkFPCkdMdWludCBWQU87CmdsR2VuVmVydGV4QXJyYXlzKDEsICZWQU8pOwpnbEJpbmRWZXJ0ZXhBcnJheShWQU8pOwoKLy8gQ3JlYXIgaSBsbGlnYXIgZWwgVkJPCkdMdWludCBWQk87CmdsR2VuQnVmZmVycygxLCAmVkJPKTsKZ2xCaW5kQnVmZmVyKEdMX0FSUkFZX0JVRkZFUiwgVkJPKTsKZ2xCdWZmZXJEYXRhKEdMX0FSUkFZX0JVRkZFUiwgc2l6ZW9mKHZlcnRpY2VzKSwgdmVydGljZXMsIEdMX1NUQVRJQ19EUkFXKTsKCi8vIENvbmZpZ3VyYXIgZWxzIGF0cmlidXRzIGRlIHbDqHJ0ZXhzCmdsVmVydGV4QXR0cmliUG9pbnRlcigwLCAzLCBHTF9GTE9BVCwgR0xfRkFMU0UsIDYgKiBzaXplb2YoR0xmbG9hdCksIChHTHZvaWQqKTApOwpnbEVuYWJsZVZlcnRleEF0dHJpYkFycmF5KDApOwpnbFZlcnRleEF0dHJpYlBvaW50ZXIoMSwgMywgR0xfRkxPQVQsIEdMX0ZBTFNFLCA2ICogc2l6ZW9mKEdMZmxvYXQpLCAoR0x2b2lkKikoMyAqIHNpemVvZihHTGZsb2F0KSkpOwpnbEVuYWJsZVZlcnRleEF0dHJpYkFycmF5KDEpOwoKLy8gRGVzbGxpZ2FyIGVsIFZBTwpnbEJpbmRWZXJ0ZXhBcnJheSgwKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Crear i lligar el VAO
GLuint VAO;
glGenVertexArrays(1, &amp;VAO);
glBindVertexArray(VAO);

// Crear i lligar el VBO
GLuint VBO;
glGenBuffers(1, &amp;VBO);
glBindBuffer(GL_ARRAY_BUFFER, VBO);
glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);

// Configurar els atributs de v&egrave;rtexs
glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 6 * sizeof(GLfloat), (GLvoid*)0);
glEnableVertexAttribArray(0);
glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 6 * sizeof(GLfloat), (GLvoid*)(3 * sizeof(GLfloat)));
glEnableVertexAttribArray(1);

// Deslligar el VAO
glBindVertexArray(0);</pre></div><div class='content'></div><h1>Resum</h1>
<div class='content'><p>En aquesta secció, hem après què són els Objectes de Matriu de Vèrtexs (VAOs) i com utilitzar-los per gestionar l'estat de les dades de vèrtexs en OpenGL. Hem vist un exemple pràctic de com crear i utilitzar un VAO, i hem practicat amb un exercici per reforçar els conceptes apresos. Els VAOs són una eina poderosa per optimitzar i organitzar el codi de renderització, i són essencials per a qualsevol desenvolupador que treballi amb OpenGL.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-01-optimizing-code' title="Optimitzar el Codi OpenGL">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-03-memory-management' title="Gestió Eficient de la Memòria">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
