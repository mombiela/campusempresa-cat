<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obtenir dades amb Fetch API</title>

    <link rel="alternate" href="https://campusempresa.com/mod/reactnative/05-01-fetching-data-fetch-api" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/reactnative/05-01-fetching-data-fetch-api" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/reactnative/05-01-fetching-data-fetch-api" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/reactnative/05-01-fetching-data-fetch-api" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/reactnative/05-01-fetching-data-fetch-api" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-05-passing-parameters-routes' title="Passar paràmetres a les rutes">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Obtenir dades amb Fetch API</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-02-using-axios-http-requests' title="Utilitzar Axios per a sol·licituds HTTP">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem a obtenir dades d'una API externa utilitzant la Fetch API en React Native. La Fetch API és una interfície moderna que permet fer sol·licituds de xarxa de manera senzilla i eficient.</p>
</div><h1><p>Objectius</p>
</h1>
<div class='content'><ul>
<li>Comprendre com funciona la Fetch API.</li>
<li>Aprendre a fer sol·licituds GET i POST.</li>
<li>Gestionar les respostes de les sol·licituds.</li>
<li>Manejar errors de xarxa.</li>
</ul>
</div><h1><ol>
<li>Introducció a la Fetch API</li>
</ol>
</h1>
<div class='content'><p>La Fetch API proporciona una manera fàcil i lògica de fer sol·licituds de xarxa asíncrones. És una alternativa moderna a l'antic <code>XMLHttpRequest</code>.</p>
</div><h2><p>Característiques clau:</p>
</h2>
<div class='content'><ul>
<li>Basada en promeses.</li>
<li>Suporta sol·licituds GET, POST, PUT, DELETE, etc.</li>
<li>Permet gestionar respostes en format JSON, text, blob, etc.</li>
</ul>
</div><h1><ol start="2">
<li>Sol·licitud GET amb Fetch API</li>
</ol>
</h1>
<div class='content'></div><h2><p>Exemple bàsic</p>
</h2>
<div class='content'><p>A continuació, es mostra un exemple bàsic de com fer una sol·licitud GET per obtenir dades d'una API:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7CmltcG9ydCB7IFZpZXcsIFRleHQsIEFjdGl2aXR5SW5kaWNhdG9yLCBTdHlsZVNoZWV0IH0gZnJvbSAncmVhY3QtbmF0aXZlJzsKCmNvbnN0IEZldGNoRXhhbXBsZSA9ICgpID0+IHsKICBjb25zdCBbZGF0YSwgc2V0RGF0YV0gPSB1c2VTdGF0ZShudWxsKTsKICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKTsKICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlKG51bGwpOwoKICB1c2VFZmZlY3QoKCkgPT4gewogICAgZmV0Y2goJ2h0dHBzOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS9wb3N0cy8xJykKICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOZXR3b3JrIHJlc3BvbnNlIHdhcyBub3Qgb2snKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgICAgfSkKICAgICAgLnRoZW4oKGRhdGEpID0+IHsKICAgICAgICBzZXREYXRhKGRhdGEpOwogICAgICAgIHNldExvYWRpbmcoZmFsc2UpOwogICAgICB9KQogICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgc2V0RXJyb3IoZXJyb3IpOwogICAgICAgIHNldExvYWRpbmcoZmFsc2UpOwogICAgICB9KTsKICB9LCBbXSk7CgogIGlmIChsb2FkaW5nKSB7CiAgICByZXR1cm4gPEFjdGl2aXR5SW5kaWNhdG9yIHNpemU9ImxhcmdlIiBjb2xvcj0iIzAwMDBmZiIgLz47CiAgfQoKICBpZiAoZXJyb3IpIHsKICAgIHJldHVybiAoCiAgICAgIDxWaWV3IHN0eWxlPXtzdHlsZXMuY29udGFpbmVyfT4KICAgICAgICA8VGV4dD5FcnJvcjoge2Vycm9yLm1lc3NhZ2V9PC9UZXh0PgogICAgICA8L1ZpZXc+CiAgICApOwogIH0KCiAgcmV0dXJuICgKICAgIDxWaWV3IHN0eWxlPXtzdHlsZXMuY29udGFpbmVyfT4KICAgICAgPFRleHQ+e2RhdGEudGl0bGV9PC9UZXh0PgogICAgICA8VGV4dD57ZGF0YS5ib2R5fTwvVGV4dD4KICAgIDwvVmlldz4KICApOwp9OwoKY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoewogIGNvbnRhaW5lcjogewogICAgZmxleDogMSwKICAgIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJywKICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLAogIH0sCn0pOwoKZXhwb3J0IGRlZmF1bHQgRmV0Y2hFeGFtcGxlOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import React, { useEffect, useState } from 'react';
import { View, Text, ActivityIndicator, StyleSheet } from 'react-native';

const FetchExample = () =&gt; {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() =&gt; {
    fetch('https://jsonplaceholder.typicode.com/posts/1')
      .then((response) =&gt; {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json();
      })
      .then((data) =&gt; {
        setData(data);
        setLoading(false);
      })
      .catch((error) =&gt; {
        setError(error);
        setLoading(false);
      });
  }, []);

  if (loading) {
    return &lt;ActivityIndicator size=&quot;large&quot; color=&quot;#0000ff&quot; /&gt;;
  }

  if (error) {
    return (
      &lt;View style={styles.container}&gt;
        &lt;Text&gt;Error: {error.message}&lt;/Text&gt;
      &lt;/View&gt;
    );
  }

  return (
    &lt;View style={styles.container}&gt;
      &lt;Text&gt;{data.title}&lt;/Text&gt;
      &lt;Text&gt;{data.body}&lt;/Text&gt;
    &lt;/View&gt;
  );
};

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
  },
});

export default FetchExample;</pre></div><div class='content'></div><h2><p>Explicació del codi</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Importacions i estat inicial</strong>:</p>
<ul>
<li>Importem els components necessaris de React i React Native.</li>
<li>Definim tres estats: <code>data</code> per emmagatzemar les dades obtingudes, <code>loading</code> per gestionar l'estat de càrrega i <code>error</code> per gestionar els errors.</li>
</ul>
</li>
<li>
<p><strong>useEffect</strong>:</p>
<ul>
<li>Utilitzem <code>useEffect</code> per fer la sol·licitud GET quan el component es munta.</li>
<li><code>fetch</code> fa la sol·licitud a l'URL especificada.</li>
<li>Si la resposta no és correcta (<code>response.ok</code>), es llança un error.</li>
<li>Si la resposta és correcta, es converteix a JSON i es guarda a l'estat <code>data</code>.</li>
<li>Si hi ha un error, es guarda a l'estat <code>error</code>.</li>
</ul>
</li>
<li>
<p><strong>Renderització condicional</strong>:</p>
<ul>
<li>Si <code>loading</code> és cert, es mostra un indicador de càrrega.</li>
<li>Si hi ha un <code>error</code>, es mostra un missatge d'error.</li>
<li>Si les dades s'han carregat correctament, es mostren les dades.</li>
</ul>
</li>
</ol>
</div><h1><ol start="3">
<li>Sol·licitud POST amb Fetch API</li>
</ol>
</h1>
<div class='content'></div><h2><p>Exemple bàsic</p>
</h2>
<div class='content'><p>A continuació, es mostra un exemple de com fer una sol·licitud POST per enviar dades a una API:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnOwppbXBvcnQgeyBWaWV3LCBUZXh0LCBCdXR0b24sIFN0eWxlU2hlZXQgfSBmcm9tICdyZWFjdC1uYXRpdmUnOwoKY29uc3QgUG9zdEV4YW1wbGUgPSAoKSA9PiB7CiAgY29uc3QgW3Jlc3BvbnNlLCBzZXRSZXNwb25zZV0gPSB1c2VTdGF0ZShudWxsKTsKCiAgY29uc3QgcG9zdERhdGEgPSAoKSA9PiB7CiAgICBmZXRjaCgnaHR0cHM6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3Bvc3RzJywgewogICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgaGVhZGVyczogewogICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgIH0sCiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICB0aXRsZTogJ2ZvbycsCiAgICAgICAgYm9keTogJ2JhcicsCiAgICAgICAgdXNlcklkOiAxLAogICAgICB9KSwKICAgIH0pCiAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gcmVzcG9uc2UuanNvbigpKQogICAgICAudGhlbigoZGF0YSkgPT4gewogICAgICAgIHNldFJlc3BvbnNlKGRhdGEpOwogICAgICB9KQogICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3I6JywgZXJyb3IpOwogICAgICB9KTsKICB9OwoKICByZXR1cm4gKAogICAgPFZpZXcgc3R5bGU9e3N0eWxlcy5jb250YWluZXJ9PgogICAgICA8QnV0dG9uIHRpdGxlPSJFbnZpYXIgZGFkZXMiIG9uUHJlc3M9e3Bvc3REYXRhfSAvPgogICAgICB7cmVzcG9uc2UgJiYgKAogICAgICAgIDxWaWV3PgogICAgICAgICAgPFRleHQ+SUQ6IHtyZXNwb25zZS5pZH08L1RleHQ+CiAgICAgICAgICA8VGV4dD5UaXRsZToge3Jlc3BvbnNlLnRpdGxlfTwvVGV4dD4KICAgICAgICAgIDxUZXh0PkJvZHk6IHtyZXNwb25zZS5ib2R5fTwvVGV4dD4KICAgICAgICA8L1ZpZXc+CiAgICAgICl9CiAgICA8L1ZpZXc+CiAgKTsKfTsKCmNvbnN0IHN0eWxlcyA9IFN0eWxlU2hlZXQuY3JlYXRlKHsKICBjb250YWluZXI6IHsKICAgIGZsZXg6IDEsCiAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsCiAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJywKICB9LAp9KTsKCmV4cG9ydCBkZWZhdWx0IFBvc3RFeGFtcGxlOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import React, { useState } from 'react';
import { View, Text, Button, StyleSheet } from 'react-native';

const PostExample = () =&gt; {
  const [response, setResponse] = useState(null);

  const postData = () =&gt; {
    fetch('https://jsonplaceholder.typicode.com/posts', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        title: 'foo',
        body: 'bar',
        userId: 1,
      }),
    })
      .then((response) =&gt; response.json())
      .then((data) =&gt; {
        setResponse(data);
      })
      .catch((error) =&gt; {
        console.error('Error:', error);
      });
  };

  return (
    &lt;View style={styles.container}&gt;
      &lt;Button title=&quot;Enviar dades&quot; onPress={postData} /&gt;
      {response &amp;&amp; (
        &lt;View&gt;
          &lt;Text&gt;ID: {response.id}&lt;/Text&gt;
          &lt;Text&gt;Title: {response.title}&lt;/Text&gt;
          &lt;Text&gt;Body: {response.body}&lt;/Text&gt;
        &lt;/View&gt;
      )}
    &lt;/View&gt;
  );
};

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
  },
});

export default PostExample;</pre></div><div class='content'></div><h2><p>Explicació del codi</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Importacions i estat inicial</strong>:</p>
<ul>
<li>Importem els components necessaris de React i React Native.</li>
<li>Definim un estat <code>response</code> per emmagatzemar la resposta de la sol·licitud POST.</li>
</ul>
</li>
<li>
<p><strong>postData</strong>:</p>
<ul>
<li>Definim la funció <code>postData</code> que es crida quan es prem el botó.</li>
<li><code>fetch</code> fa la sol·licitud POST a l'URL especificada.</li>
<li>Es defineixen els <code>headers</code> i el <code>body</code> de la sol·licitud.</li>
<li>Si la sol·licitud és correcta, es converteix a JSON i es guarda a l'estat <code>response</code>.</li>
<li>Si hi ha un error, es mostra a la consola.</li>
</ul>
</li>
<li>
<p><strong>Renderització</strong>:</p>
<ul>
<li>Es mostra un botó que crida la funció <code>postData</code> quan es prem.</li>
<li>Si hi ha una resposta, es mostren les dades de la resposta.</li>
</ul>
</li>
</ol>
</div><h1><ol start="4">
<li>Gestió d'errors de xarxa</li>
</ol>
</h1>
<div class='content'><p>És important gestionar els errors de xarxa per proporcionar una millor experiència d'usuari. A continuació, es mostra com gestionar errors en una sol·licitud GET:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNlRWZmZWN0KCgpID0+IHsKICBmZXRjaCgnaHR0cHM6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3Bvc3RzLzEnKQogICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgIGlmICghcmVzcG9uc2Uub2spIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05ldHdvcmsgcmVzcG9uc2Ugd2FzIG5vdCBvaycpOwogICAgICB9CiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgICB9KQogICAgLnRoZW4oKGRhdGEpID0+IHsKICAgICAgc2V0RGF0YShkYXRhKTsKICAgICAgc2V0TG9hZGluZyhmYWxzZSk7CiAgICB9KQogICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICBzZXRFcnJvcihlcnJvcik7CiAgICAgIHNldExvYWRpbmcoZmFsc2UpOwogICAgfSk7Cn0sIFtdKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>useEffect(() =&gt; {
  fetch('https://jsonplaceholder.typicode.com/posts/1')
    .then((response) =&gt; {
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      return response.json();
    })
    .then((data) =&gt; {
      setData(data);
      setLoading(false);
    })
    .catch((error) =&gt; {
      setError(error);
      setLoading(false);
    });
}, []);</pre></div><div class='content'></div><h2><p>Consells per gestionar errors:</p>
</h2>
<div class='content'><ul>
<li>Utilitza <code>try...catch</code> per gestionar errors de manera més clara.</li>
<li>Proporciona missatges d'error útils per a l'usuari.</li>
<li>Considera la possibilitat de tornar a intentar la sol·licitud en cas d'error.</li>
</ul>
</div><h1><p>Exercici pràctic</p>
</h1>
<div class='content'></div><h2><p>Exercici</p>
</h2>
<div class='content'><p>Crea una aplicació que faci una sol·licitud GET a l'API <code>https://jsonplaceholder.typicode.com/users</code> i mostri una llista de noms d'usuaris.</p>
</div><h2><p>Solució</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7CmltcG9ydCB7IFZpZXcsIFRleHQsIEZsYXRMaXN0LCBBY3Rpdml0eUluZGljYXRvciwgU3R5bGVTaGVldCB9IGZyb20gJ3JlYWN0LW5hdGl2ZSc7Cgpjb25zdCBVc2Vyc0xpc3QgPSAoKSA9PiB7CiAgY29uc3QgW3VzZXJzLCBzZXRVc2Vyc10gPSB1c2VTdGF0ZShbXSk7CiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSk7CiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZShudWxsKTsKCiAgdXNlRWZmZWN0KCgpID0+IHsKICAgIGZldGNoKCdodHRwczovL2pzb25wbGFjZWhvbGRlci50eXBpY29kZS5jb20vdXNlcnMnKQogICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05ldHdvcmsgcmVzcG9uc2Ugd2FzIG5vdCBvaycpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogICAgICB9KQogICAgICAudGhlbigoZGF0YSkgPT4gewogICAgICAgIHNldFVzZXJzKGRhdGEpOwogICAgICAgIHNldExvYWRpbmcoZmFsc2UpOwogICAgICB9KQogICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgc2V0RXJyb3IoZXJyb3IpOwogICAgICAgIHNldExvYWRpbmcoZmFsc2UpOwogICAgICB9KTsKICB9LCBbXSk7CgogIGlmIChsb2FkaW5nKSB7CiAgICByZXR1cm4gPEFjdGl2aXR5SW5kaWNhdG9yIHNpemU9ImxhcmdlIiBjb2xvcj0iIzAwMDBmZiIgLz47CiAgfQoKICBpZiAoZXJyb3IpIHsKICAgIHJldHVybiAoCiAgICAgIDxWaWV3IHN0eWxlPXtzdHlsZXMuY29udGFpbmVyfT4KICAgICAgICA8VGV4dD5FcnJvcjoge2Vycm9yLm1lc3NhZ2V9PC9UZXh0PgogICAgICA8L1ZpZXc+CiAgICApOwogIH0KCiAgcmV0dXJuICgKICAgIDxWaWV3IHN0eWxlPXtzdHlsZXMuY29udGFpbmVyfT4KICAgICAgPEZsYXRMaXN0CiAgICAgICAgZGF0YT17dXNlcnN9CiAgICAgICAga2V5RXh0cmFjdG9yPXsoaXRlbSkgPT4gaXRlbS5pZC50b1N0cmluZygpfQogICAgICAgIHJlbmRlckl0ZW09eyh7IGl0ZW0gfSkgPT4gPFRleHQ+e2l0ZW0ubmFtZX08L1RleHQ+fQogICAgICAvPgogICAgPC9WaWV3PgogICk7Cn07Cgpjb25zdCBzdHlsZXMgPSBTdHlsZVNoZWV0LmNyZWF0ZSh7CiAgY29udGFpbmVyOiB7CiAgICBmbGV4OiAxLAogICAganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLAogICAgYWxpZ25JdGVtczogJ2NlbnRlcicsCiAgfSwKfSk7CgpleHBvcnQgZGVmYXVsdCBVc2Vyc0xpc3Q7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import React, { useEffect, useState } from 'react';
import { View, Text, FlatList, ActivityIndicator, StyleSheet } from 'react-native';

const UsersList = () =&gt; {
  const [users, setUsers] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() =&gt; {
    fetch('https://jsonplaceholder.typicode.com/users')
      .then((response) =&gt; {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json();
      })
      .then((data) =&gt; {
        setUsers(data);
        setLoading(false);
      })
      .catch((error) =&gt; {
        setError(error);
        setLoading(false);
      });
  }, []);

  if (loading) {
    return &lt;ActivityIndicator size=&quot;large&quot; color=&quot;#0000ff&quot; /&gt;;
  }

  if (error) {
    return (
      &lt;View style={styles.container}&gt;
        &lt;Text&gt;Error: {error.message}&lt;/Text&gt;
      &lt;/View&gt;
    );
  }

  return (
    &lt;View style={styles.container}&gt;
      &lt;FlatList
        data={users}
        keyExtractor={(item) =&gt; item.id.toString()}
        renderItem={({ item }) =&gt; &lt;Text&gt;{item.name}&lt;/Text&gt;}
      /&gt;
    &lt;/View&gt;
  );
};

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
  },
});

export default UsersList;</pre></div><div class='content'></div><h2><p>Explicació de la solució</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Importacions i estat inicial</strong>:</p>
<ul>
<li>Importem els components necessaris de React i React Native.</li>
<li>Definim tres estats: <code>users</code> per emmagatzemar la llista d'usuaris, <code>loading</code> per gestionar l'estat de càrrega i <code>error</code> per gestionar els errors.</li>
</ul>
</li>
<li>
<p><strong>useEffect</strong>:</p>
<ul>
<li>Utilitzem <code>useEffect</code> per fer la sol·licitud GET quan el component es munta.</li>
<li><code>fetch</code> fa la sol·licitud a l'URL especificada.</li>
<li>Si la resposta no és correcta (<code>response.ok</code>), es llança un error.</li>
<li>Si la resposta és correcta, es converteix a JSON i es guarda a l'estat <code>users</code>.</li>
<li>Si hi ha un error, es guarda a l'estat <code>error</code>.</li>
</ul>
</li>
<li>
<p><strong>Renderització condicional</strong>:</p>
<ul>
<li>Si <code>loading</code> és cert, es mostra un indicador de càrrega.</li>
<li>Si hi ha un <code>error</code>, es mostra un missatge d'error.</li>
<li>Si les dades s'han carregat correctament, es mostra una llista d'usuaris utilitzant <code>FlatList</code>.</li>
</ul>
</li>
</ol>
</div><h1><p>Conclusió</p>
</h1>
<div class='content'><p>En aquest tema, hem après a utilitzar la Fetch API per obtenir dades d'una API externa en React Native. Hem vist com fer sol·licituds GET i POST, gestionar respostes i errors de xarxa. També hem practicat aquests conceptes amb un exercici pràctic. Ara estem preparats per avançar cap a la gestió d'errors de xarxa en més profunditat i altres tècniques de sol·licitud de dades.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-05-passing-parameters-routes' title="Passar paràmetres a les rutes">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-02-using-axios-http-requests' title="Utilitzar Axios per a sol·licituds HTTP">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
