<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metadades de fitxers i seguretat</title>

    <link rel="alternate" href="https://campusempresa.com/mod/firebase/05-04-file-metadata-and-security" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/firebase/05-04-file-metadata-and-security" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/firebase/05-04-file-metadata-and-security" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/firebase/05-04-file-metadata-and-security" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/firebase/05-04-file-metadata-and-security" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-03-downloading-files' title="Descarregar fitxers">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Metadades de fitxers i seguretat</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-01-introduction-to-cloud-messaging' title="Introducció a la missatgeria en el núvol">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En aquest tema, explorarem com gestionar les metadades dels fitxers emmagatzemats a Firebase Storage i com assegurar aquests fitxers utilitzant regles de seguretat. Les metadades són informació addicional sobre els fitxers, com ara el tipus de fitxer, la mida, la data de creació, etc. Les regles de seguretat permeten controlar qui pot accedir i modificar els fitxers emmagatzemats.</p>
</div><h1>Metadades de fitxers</h1>
<div class='content'></div><h2>Què són les metadades?</h2>
<div class='content'><p>Les metadades són informació addicional que es pot associar amb un fitxer. Algunes metadades comunes inclouen:</p>
<ul>
<li><strong>Content-Type</strong>: El tipus MIME del fitxer (per exemple, <code>image/jpeg</code>).</li>
<li><strong>Size</strong>: La mida del fitxer en bytes.</li>
<li><strong>Creation Time</strong>: La data i hora en què es va crear el fitxer.</li>
<li><strong>Custom Metadata</strong>: Metadades definides per l'usuari, com ara etiquetes personalitzades.</li>
</ul>
</div><h2>Exemple de codi: Afegir metadades a un fitxer</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gT2J0ZW5pbSB1bmEgcmVmZXLDqG5jaWEgYSBsJ2VtbWFnYXR6ZW1hdGdlCnZhciBzdG9yYWdlUmVmID0gZmlyZWJhc2Uuc3RvcmFnZSgpLnJlZigpOwoKLy8gQ3JlZW0gdW5hIHJlZmVyw6huY2lhIGFsIGZpdHhlcgp2YXIgZmlsZVJlZiA9IHN0b3JhZ2VSZWYuY2hpbGQoJ2ltYWdlcy9teUltYWdlLmpwZycpOwoKLy8gRGVmaW5pbSBsZXMgbWV0YWRhZGVzCnZhciBtZXRhZGF0YSA9IHsKICBjb250ZW50VHlwZTogJ2ltYWdlL2pwZWcnLAogIGN1c3RvbU1ldGFkYXRhOiB7CiAgICAndXBsb2FkZWRCeSc6ICd1c2VyMTIzJywKICAgICdkZXNjcmlwdGlvbic6ICdGb3RvIGRlIHZhY2FuY2VzJwogIH0KfTsKCi8vIENhcnJlZ3VlbSBlbCBmaXR4ZXIgYW1iIGxlcyBtZXRhZGFkZXMKZmlsZVJlZi5wdXQoZmlsZSwgbWV0YWRhdGEpLnRoZW4oKHNuYXBzaG90KSA9PiB7CiAgY29uc29sZS5sb2coJ0ZpdHhlciBjYXJyZWdhdCBhbWIgw6h4aXQgYW1iIG1ldGFkYWRlcyEnKTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Obtenim una refer&egrave;ncia a l'emmagatzematge
var storageRef = firebase.storage().ref();

// Creem una refer&egrave;ncia al fitxer
var fileRef = storageRef.child('images/myImage.jpg');

// Definim les metadades
var metadata = {
  contentType: 'image/jpeg',
  customMetadata: {
    'uploadedBy': 'user123',
    'description': 'Foto de vacances'
  }
};

// Carreguem el fitxer amb les metadades
fileRef.put(file, metadata).then((snapshot) =&gt; {
  console.log('Fitxer carregat amb &egrave;xit amb metadades!');
});</pre></div><div class='content'></div><h2>Exemple de codi: Obtenir metadades d'un fitxer</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gT2J0ZW5pbSB1bmEgcmVmZXLDqG5jaWEgYSBsJ2VtbWFnYXR6ZW1hdGdlCnZhciBzdG9yYWdlUmVmID0gZmlyZWJhc2Uuc3RvcmFnZSgpLnJlZigpOwoKLy8gQ3JlZW0gdW5hIHJlZmVyw6huY2lhIGFsIGZpdHhlcgp2YXIgZmlsZVJlZiA9IHN0b3JhZ2VSZWYuY2hpbGQoJ2ltYWdlcy9teUltYWdlLmpwZycpOwoKLy8gT2J0ZW5pbSBsZXMgbWV0YWRhZGVzCmZpbGVSZWYuZ2V0TWV0YWRhdGEoKS50aGVuKChtZXRhZGF0YSkgPT4gewogIGNvbnNvbGUubG9nKCdNZXRhZGFkZXMgZGVsIGZpdHhlcjonLCBtZXRhZGF0YSk7Cn0pLmNhdGNoKChlcnJvcikgPT4gewogIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGVuIG9idGVuaXIgbGVzIG1ldGFkYWRlczonLCBlcnJvcik7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Obtenim una refer&egrave;ncia a l'emmagatzematge
var storageRef = firebase.storage().ref();

// Creem una refer&egrave;ncia al fitxer
var fileRef = storageRef.child('images/myImage.jpg');

// Obtenim les metadades
fileRef.getMetadata().then((metadata) =&gt; {
  console.log('Metadades del fitxer:', metadata);
}).catch((error) =&gt; {
  console.error('Error en obtenir les metadades:', error);
});</pre></div><div class='content'></div><h1>Seguretat</h1>
<div class='content'></div><h2>Regles de seguretat</h2>
<div class='content'><p>Les regles de seguretat de Firebase Storage permeten definir qui pot llegir i escriure fitxers en l'emmagatzematge. Aquestes regles es defineixen en un fitxer JSON i es poden configurar des de la consola de Firebase.</p>
</div><h2>Exemple de regles de seguretat</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VydmljZSBmaXJlYmFzZS5zdG9yYWdlIHsKICBtYXRjaCAvYi97YnVja2V0fS9vIHsKICAgIG1hdGNoIC97YWxsUGF0aHM9Kip9IHsKICAgICAgLy8gUGVybWV0IGwnYWNjw6lzIGRlIGxlY3R1cmEgYSB0b3RzIGVscyB1c3VhcmlzIGF1dGVudGljYXRzCiAgICAgIGFsbG93IHJlYWQ6IGlmIHJlcXVlc3QuYXV0aCAhPSBudWxsOwogICAgICAKICAgICAgLy8gUGVybWV0IGwnYWNjw6lzIGQnZXNjcmlwdHVyYSBub23DqXMgYSBsJ3VzdWFyaSBxdWUgaGEgY2FycmVnYXQgZWwgZml0eGVyCiAgICAgIGFsbG93IHdyaXRlOiBpZiByZXF1ZXN0LmF1dGggIT0gbnVsbCAmJiByZXF1ZXN0LmF1dGgudWlkID09IHJlc291cmNlLm1ldGFkYXRhLnVwbG9hZGVkQnk7CiAgICB9CiAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>service firebase.storage {
  match /b/{bucket}/o {
    match /{allPaths=**} {
      // Permet l'acc&eacute;s de lectura a tots els usuaris autenticats
      allow read: if request.auth != null;
      
      // Permet l'acc&eacute;s d'escriptura nom&eacute;s a l'usuari que ha carregat el fitxer
      allow write: if request.auth != null &amp;&amp; request.auth.uid == resource.metadata.uploadedBy;
    }
  }
}</pre></div><div class='content'></div><h2>Explicació de les regles</h2>
<div class='content'><ul>
<li><code>allow read: if request.auth != null;</code>: Permet l'accés de lectura a tots els usuaris autenticats.</li>
<li><code>allow write: if request.auth != null &amp;&amp; request.auth.uid == resource.metadata.uploadedBy;</code>: Permet l'accés d'escriptura només a l'usuari que ha carregat el fitxer. Això es basa en una metadada personalitzada <code>uploadedBy</code> que conté l'ID de l'usuari que ha carregat el fitxer.</li>
</ul>
</div><h1>Exercicis pràctics</h1>
<div class='content'></div><h2>Exercici 1: Carregar un fitxer amb metadades personalitzades</h2>
<div class='content'><ol>
<li>Carrega un fitxer a Firebase Storage amb les següents metadades personalitzades:
<ul>
<li><code>uploadedBy</code>: El teu ID d'usuari.</li>
<li><code>description</code>: Una descripció del fitxer.</li>
</ul>
</li>
</ol>
</div><h2>Solució de l'exercici 1</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gT2J0ZW5pbSB1bmEgcmVmZXLDqG5jaWEgYSBsJ2VtbWFnYXR6ZW1hdGdlCnZhciBzdG9yYWdlUmVmID0gZmlyZWJhc2Uuc3RvcmFnZSgpLnJlZigpOwoKLy8gQ3JlZW0gdW5hIHJlZmVyw6huY2lhIGFsIGZpdHhlcgp2YXIgZmlsZVJlZiA9IHN0b3JhZ2VSZWYuY2hpbGQoJ2RvY3VtZW50cy9teURvY3VtZW50LnBkZicpOwoKLy8gRGVmaW5pbSBsZXMgbWV0YWRhZGVzCnZhciBtZXRhZGF0YSA9IHsKICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL3BkZicsCiAgY3VzdG9tTWV0YWRhdGE6IHsKICAgICd1cGxvYWRlZEJ5JzogJ3VzZXIxMjMnLAogICAgJ2Rlc2NyaXB0aW9uJzogJ0RvY3VtZW50IGltcG9ydGFudCcKICB9Cn07CgovLyBDYXJyZWd1ZW0gZWwgZml0eGVyIGFtYiBsZXMgbWV0YWRhZGVzCmZpbGVSZWYucHV0KGZpbGUsIG1ldGFkYXRhKS50aGVuKChzbmFwc2hvdCkgPT4gewogIGNvbnNvbGUubG9nKCdGaXR4ZXIgY2FycmVnYXQgYW1iIMOoeGl0IGFtYiBtZXRhZGFkZXMhJyk7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Obtenim una refer&egrave;ncia a l'emmagatzematge
var storageRef = firebase.storage().ref();

// Creem una refer&egrave;ncia al fitxer
var fileRef = storageRef.child('documents/myDocument.pdf');

// Definim les metadades
var metadata = {
  contentType: 'application/pdf',
  customMetadata: {
    'uploadedBy': 'user123',
    'description': 'Document important'
  }
};

// Carreguem el fitxer amb les metadades
fileRef.put(file, metadata).then((snapshot) =&gt; {
  console.log('Fitxer carregat amb &egrave;xit amb metadades!');
});</pre></div><div class='content'></div><h2>Exercici 2: Configurar regles de seguretat</h2>
<div class='content'><ol>
<li>Defineix regles de seguretat que permetin l'accés de lectura a tots els usuaris autenticats i l'accés d'escriptura només a l'usuari que ha carregat el fitxer.</li>
</ol>
</div><h2>Solució de l'exercici 2</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VydmljZSBmaXJlYmFzZS5zdG9yYWdlIHsKICBtYXRjaCAvYi97YnVja2V0fS9vIHsKICAgIG1hdGNoIC97YWxsUGF0aHM9Kip9IHsKICAgICAgLy8gUGVybWV0IGwnYWNjw6lzIGRlIGxlY3R1cmEgYSB0b3RzIGVscyB1c3VhcmlzIGF1dGVudGljYXRzCiAgICAgIGFsbG93IHJlYWQ6IGlmIHJlcXVlc3QuYXV0aCAhPSBudWxsOwogICAgICAKICAgICAgLy8gUGVybWV0IGwnYWNjw6lzIGQnZXNjcmlwdHVyYSBub23DqXMgYSBsJ3VzdWFyaSBxdWUgaGEgY2FycmVnYXQgZWwgZml0eGVyCiAgICAgIGFsbG93IHdyaXRlOiBpZiByZXF1ZXN0LmF1dGggIT0gbnVsbCAmJiByZXF1ZXN0LmF1dGgudWlkID09IHJlc291cmNlLm1ldGFkYXRhLnVwbG9hZGVkQnk7CiAgICB9CiAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>service firebase.storage {
  match /b/{bucket}/o {
    match /{allPaths=**} {
      // Permet l'acc&eacute;s de lectura a tots els usuaris autenticats
      allow read: if request.auth != null;
      
      // Permet l'acc&eacute;s d'escriptura nom&eacute;s a l'usuari que ha carregat el fitxer
      allow write: if request.auth != null &amp;&amp; request.auth.uid == resource.metadata.uploadedBy;
    }
  }
}</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>En aquest tema, hem après com gestionar les metadades dels fitxers emmagatzemats a Firebase Storage i com assegurar aquests fitxers utilitzant regles de seguretat. Les metadades ens permeten afegir informació addicional als fitxers, mentre que les regles de seguretat ens ajuden a controlar l'accés als fitxers. Aquests conceptes són fonamentals per gestionar de manera eficient i segura els fitxers en una aplicació basada en Firebase.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-03-downloading-files' title="Descarregar fitxers">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-01-introduction-to-cloud-messaging' title="Introducció a la missatgeria en el núvol">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
