<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    <title>Subconsultes</title>

    <link rel="alternate" href="https://campusempresa.com/mod/postgresql/03-02-subqueries" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/postgresql/03-02-subqueries" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/postgresql/03-02-subqueries" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.ea63f62b9e.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "ca";
  		var CATEGORY = "languages";
  		var MOD_NAME = "postgresql";
  		var TEMA_NAME = "3-2";
  		var TYPE = "mod";
  		var PATH = "mod/postgresql/03-02-subqueries";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.86da6c742a.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/mod/postgresql/03-02-subqueries" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/postgresql/03-02-subqueries" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Tot el coneixement al teu abast</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my_modules" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Els meus cursos</b></i>
</a>
<a href="/end_modules" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalitzats             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="postgresql">
		<a  href="#" class="text-secondary d-none" data-read-mod="postgresql" data-read-unit="3-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar com a llegit
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="postgresql" data-unread-unit="3-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar com a no llegit
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contingut del curs
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-01-joins' title="Unions" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-01-joins' title="Unions" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">Subconsultes</h2>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-03-aggregate-functions' title="Funcions agregades" class="py-2 px-3 btn btn-primary"
				data-read-mod="postgresql" data-read-unit="3-2">
				Següent &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-03-aggregate-functions' title="Funcions agregades" class="py-2 px-3 btn btn-primary" 
				data-read-mod="postgresql" data-read-unit="3-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>Les subconsultes són una eina poderosa en SQL que permeten realitzar consultes dins d'altres consultes. Aquestes poden ser utilitzades en diverses parts d'una instrucció SQL, com en les claus <code>SELECT</code>, <code>FROM</code>, <code>WHERE</code>, i altres. En aquest tema, explorarem què són les subconsultes, com utilitzar-les i veurem exemples pràctics per entendre millor el seu funcionament.</p>
</div><h1>Què és una Subconsulta?</h1>
<div class='content'><p>Una subconsulta és una consulta SQL que es troba dins d'una altra consulta SQL. La subconsulta es pot utilitzar per retornar dades que seran utilitzades per la consulta principal. Les subconsultes poden ser utilitzades en diverses parts d'una instrucció SQL, com ara:</p>
<ul>
<li>En la clàusula <code>SELECT</code> per retornar valors calculats.</li>
<li>En la clàusula <code>FROM</code> per crear una taula temporal.</li>
<li>En la clàusula <code>WHERE</code> per filtrar resultats basats en una condició.</li>
</ul>
</div><h1>Tipus de Subconsultes</h1>
<div class='content'><p>Hi ha dos tipus principals de subconsultes:</p>
<ol>
<li><strong>Subconsultes Escalares</strong>: Retornen un sol valor.</li>
<li><strong>Subconsultes de Taula</strong>: Retornen un conjunt de files.</li>
</ol>
</div><h1>Exemples de Subconsultes</h1>
<div class='content'></div><h2>Subconsulta en la Clàusula <code>SELECT</code></h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgcHJvZHVjdF9pZCwgCiAgICBwcm9kdWN0X25hbWUsIAogICAgKFNFTEVDVCBBVkcocHJpY2UpIEZST00gcHJvZHVjdHMpIEFTIGF2ZXJhZ2VfcHJpY2UKRlJPTSAKICAgIHByb2R1Y3RzOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    product_id, 
    product_name, 
    (SELECT AVG(price) FROM products) AS average_price
FROM 
    products;</pre></div><div class='content'><p>En aquest exemple, la subconsulta <code>(SELECT AVG(price) FROM products)</code> calcula el preu mitjà de tots els productes i el retorna com a <code>average_price</code> per a cada fila de la consulta principal.</p>
</div><h2>Subconsulta en la Clàusula <code>FROM</code></h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgc3ViLnByb2R1Y3RfaWQsIAogICAgc3ViLnRvdGFsX3NhbGVzCkZST00gCiAgICAoU0VMRUNUIAogICAgICAgIHByb2R1Y3RfaWQsIAogICAgICAgIFNVTShxdWFudGl0eSkgQVMgdG90YWxfc2FsZXMgCiAgICAgRlJPTSAKICAgICAgICBzYWxlcyAKICAgICBHUk9VUCBCWSAKICAgICAgICBwcm9kdWN0X2lkKSBBUyBzdWI7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    sub.product_id, 
    sub.total_sales
FROM 
    (SELECT 
        product_id, 
        SUM(quantity) AS total_sales 
     FROM 
        sales 
     GROUP BY 
        product_id) AS sub;</pre></div><div class='content'><p>En aquest exemple, la subconsulta dins de la clàusula <code>FROM</code> crea una taula temporal <code>sub</code> que conté el total de vendes per a cada producte. La consulta principal després selecciona dades d'aquesta taula temporal.</p>
</div><h2>Subconsulta en la Clàusula <code>WHERE</code></h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgcHJvZHVjdF9pZCwgCiAgICBwcm9kdWN0X25hbWUKRlJPTSAKICAgIHByb2R1Y3RzCldIRVJFIAogICAgcHJpY2UgPiAoU0VMRUNUIEFWRyhwcmljZSkgRlJPTSBwcm9kdWN0cyk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    product_id, 
    product_name
FROM 
    products
WHERE 
    price &gt; (SELECT AVG(price) FROM products);</pre></div><div class='content'><p>En aquest exemple, la subconsulta <code>(SELECT AVG(price) FROM products)</code> calcula el preu mitjà de tots els productes. La consulta principal després selecciona tots els productes que tenen un preu superior al preu mitjà.</p>
</div><h1>Exercicis Pràctics</h1>
<div class='content'></div><h2>Exercici 1: Subconsulta en la Clàusula <code>SELECT</code></h2>
<div class='content'><p><strong>Enunciat</strong>: Escriu una consulta que mostri el <code>product_id</code>, <code>product_name</code> i el preu mitjà de tots els productes com a <code>average_price</code>.</p>
<p><strong>Solució</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgcHJvZHVjdF9pZCwgCiAgICBwcm9kdWN0X25hbWUsIAogICAgKFNFTEVDVCBBVkcocHJpY2UpIEZST00gcHJvZHVjdHMpIEFTIGF2ZXJhZ2VfcHJpY2UKRlJPTSAKICAgIHByb2R1Y3RzOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    product_id, 
    product_name, 
    (SELECT AVG(price) FROM products) AS average_price
FROM 
    products;</pre></div><div class='content'></div><h2>Exercici 2: Subconsulta en la Clàusula <code>FROM</code></h2>
<div class='content'><p><strong>Enunciat</strong>: Escriu una consulta que mostri el <code>product_id</code> i el total de vendes (<code>total_sales</code>) per a cada producte.</p>
<p><strong>Solució</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgc3ViLnByb2R1Y3RfaWQsIAogICAgc3ViLnRvdGFsX3NhbGVzCkZST00gCiAgICAoU0VMRUNUIAogICAgICAgIHByb2R1Y3RfaWQsIAogICAgICAgIFNVTShxdWFudGl0eSkgQVMgdG90YWxfc2FsZXMgCiAgICAgRlJPTSAKICAgICAgICBzYWxlcyAKICAgICBHUk9VUCBCWSAKICAgICAgICBwcm9kdWN0X2lkKSBBUyBzdWI7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    sub.product_id, 
    sub.total_sales
FROM 
    (SELECT 
        product_id, 
        SUM(quantity) AS total_sales 
     FROM 
        sales 
     GROUP BY 
        product_id) AS sub;</pre></div><div class='content'></div><h2>Exercici 3: Subconsulta en la Clàusula <code>WHERE</code></h2>
<div class='content'><p><strong>Enunciat</strong>: Escriu una consulta que mostri el <code>product_id</code> i <code>product_name</code> de tots els productes que tenen un preu superior al preu mitjà de tots els productes.</p>
<p><strong>Solució</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgcHJvZHVjdF9pZCwgCiAgICBwcm9kdWN0X25hbWUKRlJPTSAKICAgIHByb2R1Y3RzCldIRVJFIAogICAgcHJpY2UgPiAoU0VMRUNUIEFWRyhwcmljZSkgRlJPTSBwcm9kdWN0cyk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    product_id, 
    product_name
FROM 
    products
WHERE 
    price &gt; (SELECT AVG(price) FROM products);</pre></div><div class='content'></div><h1>Errors Comuns i Consells</h1>
<div class='content'><ul>
<li>
<p><strong>Error Comú</strong>: Utilitzar una subconsulta que retorna múltiples files en una clàusula que espera un sol valor.</p>
<ul>
<li><strong>Solució</strong>: Assegura't que la subconsulta retorni un sol valor quan s'utilitza en contextos escalares.</li>
</ul>
</li>
<li>
<p><strong>Error Comú</strong>: No aliasar la subconsulta en la clàusula <code>FROM</code>.</p>
<ul>
<li><strong>Solució</strong>: Sempre proporciona un àlies a la subconsulta per poder referenciar-la correctament en la consulta principal.</li>
</ul>
</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Les subconsultes són una eina essencial en SQL que permeten realitzar consultes complexes de manera eficient. Hem vist com utilitzar subconsultes en diverses parts d'una instrucció SQL i hem practicat amb exemples concrets. Amb aquesta base, estàs preparat per aplicar subconsultes en les teves pròpies consultes SQL i resoldre problemes més avançats.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-01-joins' title="Unions" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-01-joins' title="Unions" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-03-aggregate-functions' title="Funcions agregades" class="py-2 px-3 btn btn-primary"
				data-read-mod="postgresql" data-read-unit="3-2">
				Següent &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-03-aggregate-functions' title="Funcions agregades" class="py-2 px-3 btn btn-primary" 
				data-read-mod="postgresql" data-read-unit="3-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curs de PostgreSQL</h1>
<h2>Mòdul 1: Introducció a PostgreSQL</h2>
<ul>
<li><a href="01-01-what-is-postgresql">Què és PostgreSQL?</a></li>
<li><a href="01-02-installing-postgresql">Instal·lant PostgreSQL</a></li>
<li><a href="01-03-basic-sql-concepts">Conceptes bàsics de SQL</a></li>
<li><a href="01-04-connecting-to-postgresql">Connectant-se a PostgreSQL</a></li>
</ul>
<h2>Mòdul 2: Operacions bàsiques de SQL</h2>
<ul>
<li><a href="02-01-creating-databases-and-tables">Creant bases de dades i taules</a></li>
<li><a href="02-02-inserting-data">Inserint dades</a></li>
<li><a href="02-03-querying-data">Consultant dades</a></li>
<li><a href="02-04-updating-data">Actualitzant dades</a></li>
<li><a href="02-05-deleting-data">Eliminant dades</a></li>
</ul>
<h2>Mòdul 3: Consultes SQL avançades</h2>
<ul>
<li><a href="03-01-joins">Unions</a></li>
<li><a href="03-02-subqueries">Subconsultes</a></li>
<li><a href="03-03-aggregate-functions">Funcions agregades</a></li>
<li><a href="03-04-window-functions">Funcions de finestra</a></li>
<li><a href="03-05-common-table-expressions">Expressions de taula comunes (CTEs)</a></li>
</ul>
<h2>Mòdul 4: Disseny de bases de dades i normalització</h2>
<ul>
<li><a href="04-01-database-design-principles">Principis de disseny de bases de dades</a></li>
<li><a href="04-02-normalization">Normalització</a></li>
<li><a href="04-03-primary-and-foreign-keys">Claus primàries i estrangeres</a></li>
<li><a href="04-04-indexes">Índexs</a></li>
</ul>
<h2>Mòdul 5: Funcionalitats avançades de PostgreSQL</h2>
<ul>
<li><a href="05-01-views">Vistes</a></li>
<li><a href="05-02-triggers">Triggers</a></li>
<li><a href="05-03-stored-procedures-and-functions">Procediments i funcions emmagatzemades</a></li>
<li><a href="05-04-transactions-and-concurrency">Transaccions i concurrència</a></li>
</ul>
<h2>Mòdul 6: Optimització i millora del rendiment</h2>
<ul>
<li><a href="06-01-query-optimization">Optimització de consultes</a></li>
<li><a href="06-02-indexing-strategies">Estratègies d'indexació</a></li>
<li><a href="06-03-analyzing-query-performance">Analitzant el rendiment de les consultes</a></li>
<li><a href="06-04-vacuuming-and-maintenance">Vacuuming i manteniment</a></li>
</ul>
<h2>Mòdul 7: Seguretat i gestió d'usuaris</h2>
<ul>
<li><a href="07-01-user-roles-and-permissions">Rols d'usuari i permisos</a></li>
<li><a href="07-02-authentication-methods">Mètodes d'autenticació</a></li>
<li><a href="07-03-data-encryption">Encriptació de dades</a></li>
<li><a href="07-04-backup-and-restore">Còpia de seguretat i restauració</a></li>
</ul>
<h2>Mòdul 8: Treballant amb JSON i funcionalitats NoSQL</h2>
<ul>
<li><a href="08-01-json-data-types">Tipus de dades JSON</a></li>
<li><a href="08-02-json-functions-and-operators">Funcions i operadors JSON</a></li>
<li><a href="08-03-using-postgresql-as-nosql">Utilitzant PostgreSQL com a base de dades NoSQL</a></li>
</ul>
<h2>Mòdul 9: Extensions i eines avançades</h2>
<ul>
<li><a href="09-01-postgis-for-geospatial-data">PostGIS per a dades geoespacials</a></li>
<li><a href="09-02-full-text-search">Cerca de text complet</a></li>
<li><a href="09-03-foreign-data-wrappers">Wrappers de dades externes</a></li>
<li><a href="09-04-plpgsql-and-other-procedural-languages">PL/pgSQL i altres llenguatges procedimentals</a></li>
</ul>
<h2>Mòdul 10: Estudis de cas i aplicacions del món real</h2>
<ul>
<li><a href="10-01-e-commerce-database-design">Disseny de bases de dades per a comerç electrònic</a></li>
<li><a href="10-02-data-warehousing-with-postgresql">Magatzem de dades amb PostgreSQL</a></li>
<li><a href="10-03-handling-big-data">Gestionant grans volums de dades</a></li>
<li><a href="10-04-postgresql-in-microservices-architecture">PostgreSQL en arquitectura de microserveis</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuari no autentificat</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<p id="loginModalEmail"></p>
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
