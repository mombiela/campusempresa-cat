<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tractant amb Repositoris Corruptes</title>

    <link rel="alternate" href="https://campusempresa.com/mod/git/09-04-dealing-with-corrupted-repositories" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/git/09-04-dealing-with-corrupted-repositories" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/git/09-04-dealing-with-corrupted-repositories" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/git/09-04-dealing-with-corrupted-repositories" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/git/09-04-dealing-with-corrupted-repositories" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='09-03-recovering-lost-commits' title="Recuperant Commits Perduts">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Tractant amb Repositoris Corruptes</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='09-05-advanced-debugging-techniques' title="Tècniques Avançades de Depuració">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem com identificar i solucionar problemes amb repositoris corruptes. Un repositori Git pot corrompre's per diverses raons, com ara errors de disc, interrupcions durant operacions de Git, o fins i tot errors humans. A continuació, es detallen els passos per diagnosticar i reparar un repositori corrupte.</p>
</div><h1><ol>
<li>Identificant un Repositori Corrupt</li>
</ol>
</h1>
<div class='content'></div><h2><p>Símptomes Comuns</p>
</h2>
<div class='content'><ul>
<li>Errors durant operacions de Git (per exemple, <code>git status</code>, <code>git commit</code>, etc.).</li>
<li>Missatges d'error que indiquen problemes amb objectes o referències.</li>
<li>Inconsistències en l'historial de commits.</li>
</ul>
</div><h2><p>Comprovant la Integritat del Repositori</p>
</h2>
<div class='content'><p>Git proporciona una eina integrada per comprovar la integritat del repositori:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2l0IGZzY2s="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>git fsck</pre></div><div class='content'><p>Aquest comandament examina el repositori per trobar objectes corruptes o referències trencades. Un exemple de sortida podria ser:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZXJyb3I6IG9iamVjdCBmaWxlIC5naXQvb2JqZWN0cy9hYi9jZGVmMTIzNC4uLiBpcyBlbXB0eQplcnJvcjogb2JqZWN0IGZpbGUgLmdpdC9vYmplY3RzL2FiL2NkZWYxMjM0Li4uIGlzIGNvcnJ1cHQKbWlzc2luZyBibG9iIGFiY2QxMjM0Li4u"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>error: object file .git/objects/ab/cdef1234... is empty
error: object file .git/objects/ab/cdef1234... is corrupt
missing blob abcd1234...</pre></div><div class='content'></div><h1><ol start="2">
<li>Reparant Objectes Corruptes</li>
</ol>
</h1>
<div class='content'></div><h2><p>Recuperant Objectes des d'un Repositori Remot</p>
</h2>
<div class='content'><p>Si el repositori local està corrupte però el remot està intacte, pots intentar recuperar els objectes des del remot:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2l0IGZldGNoIC0tYWxsCmdpdCByZXNldCAtLWhhcmQgb3JpZ2luL21haW4="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>git fetch --all
git reset --hard origin/main</pre></div><div class='content'><p>Aquestes comandes descarregaran tots els objectes del remot i restabliran el teu repositori local a l'estat del remot.</p>
</div><h2><p>Utilitzant un Backup</p>
</h2>
<div class='content'><p>Si tens un backup del teu repositori, pots restaurar-lo. Això pot implicar copiar els fitxers de backup al teu directori de treball o utilitzar eines de backup específiques.</p>
</div><h2><p>Reparant Manualment Objectes Corruptes</p>
</h2>
<div class='content'><p>En alguns casos, pots reparar manualment els objectes corruptes. Per exemple, si un objecte està buit, pots intentar eliminar-lo i tornar a descarregar-lo:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cm0gLmdpdC9vYmplY3RzL2FiL2NkZWYxMjM0Li4uCmdpdCBmZXRjaCAtLWFsbA=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>rm .git/objects/ab/cdef1234...
git fetch --all</pre></div><div class='content'></div><h1><ol start="3">
<li>Resolent Problemes amb Referències</li>
</ol>
</h1>
<div class='content'></div><h2><p>Comprovant i Reparant Referències</p>
</h2>
<div class='content'><p>Les referències (branches, tags) poden corrompre's. Pots comprovar les referències amb:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2l0IHNob3ctcmVm"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>git show-ref</pre></div><div class='content'><p>Si trobes referències trencades, pots intentar eliminar-les i tornar-les a crear:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2l0IHVwZGF0ZS1yZWYgLWQgcmVmcy9oZWFkcy9icmFuY2gtbmFtZQpnaXQgZmV0Y2ggb3JpZ2luIGJyYW5jaC1uYW1lOnJlZnMvaGVhZHMvYnJhbmNoLW5hbWU="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>git update-ref -d refs/heads/branch-name
git fetch origin branch-name:refs/heads/branch-name</pre></div><div class='content'></div><h1><ol start="4">
<li>Utilitzant eines de Git per a la Reparació</li>
</ol>
</h1>
<div class='content'></div><h2><p>git-repair</p>
</h2>
<div class='content'><p>Hi ha eines de tercers com <code>git-repair</code> que poden ajudar a automatitzar la reparació de repositoris corruptes. Pots instal·lar <code>git-repair</code> i utilitzar-lo així:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2l0LXJlcGFpcg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>git-repair</pre></div><div class='content'><p>Aquesta eina intentarà reparar automàticament el teu repositori.</p>
</div><h1><ol start="5">
<li>Prevenir la Corrupció de Repositoris</li>
</ol>
</h1>
<div class='content'></div><h2><p>Bones Pràctiques</p>
</h2>
<div class='content'><ul>
<li><strong>Realitza backups regulars</strong>: Mantenir còpies de seguretat del teu repositori pot salvar-te en cas de corrupció.</li>
<li><strong>Utilitza sistemes de fitxers fiables</strong>: Assegura't que el teu sistema de fitxers és robust i no té errors.</li>
<li><strong>Evita interrupcions durant operacions de Git</strong>: No interrompis operacions de Git com commits, fetch, o push.</li>
</ul>
</div><h2><p>Configuració de Git</p>
</h2>
<div class='content'><p>Configura Git per a una millor integritat de dades:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2l0IGNvbmZpZyAtLWdsb2JhbCB0cmFuc2Zlci5mc2Nrb2JqZWN0cyB0cnVlCmdpdCBjb25maWcgLS1nbG9iYWwgZmV0Y2guZnNja29iamVjdHMgdHJ1ZQpnaXQgY29uZmlnIC0tZ2xvYmFsIHJlY2VpdmUuZnNja29iamVjdHMgdHJ1ZQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>git config --global transfer.fsckobjects true
git config --global fetch.fsckobjects true
git config --global receive.fsckobjects true</pre></div><div class='content'><p>Aquestes configuracions faran que Git comprovi la integritat dels objectes durant les operacions de transferència, fetch, i receive.</p>
</div><h1><p>Exercici Pràctic</p>
</h1>
<div class='content'></div><h2><p>Exercici 1: Diagnosticar i Reparar un Repositori Corrupt</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Simula un Repositori Corrupt</strong>:</p>
<ul>
<li>Crea un nou repositori.</li>
<li>Elimina manualment un fitxer d'objecte dins <code>.git/objects</code>.</li>
</ul>
</li>
<li>
<p><strong>Diagnostica la Corrupció</strong>:</p>
<ul>
<li>Executa <code>git fsck</code> i identifica l'objecte corrupte.</li>
</ul>
</li>
<li>
<p><strong>Repara el Repositori</strong>:</p>
<ul>
<li>Utilitza <code>git fetch --all</code> per recuperar l'objecte des del remot.</li>
<li>Verifica que el repositori està reparat amb <code>git fsck</code>.</li>
</ul>
</li>
</ol>
</div><h2><p>Solució</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQYXMgMTogQ3JlYXIgdW4gbm91IHJlcG9zaXRvcmkKZ2l0IGluaXQgbXktcmVwbwpjZCBteS1yZXBvCmVjaG8gIkhlbGxvLCBXb3JsZCEiID4gZmlsZS50eHQKZ2l0IGFkZCBmaWxlLnR4dApnaXQgY29tbWl0IC1tICJJbml0aWFsIGNvbW1pdCIKCiMgU2ltdWxhciBjb3JydXBjacOzCnJtIC5naXQvb2JqZWN0cy8kKGxzIC5naXQvb2JqZWN0cy8gfCBoZWFkIC1uIDEpLyQobHMgLmdpdC9vYmplY3RzLyQobHMgLmdpdC9vYmplY3RzLyB8IGhlYWQgLW4gMSkgfCBoZWFkIC1uIDEpCgojIFBhcyAyOiBEaWFnbm9zdGljYXIgbGEgY29ycnVwY2nDswpnaXQgZnNjawoKIyBQYXMgMzogUmVwYXJhciBlbCByZXBvc2l0b3JpCmdpdCBmZXRjaCAtLWFsbApnaXQgcmVzZXQgLS1oYXJkIG9yaWdpbi9tYWluCgojIFZlcmlmaWNhciBsYSByZXBhcmFjacOzCmdpdCBmc2Nr"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Pas 1: Crear un nou repositori
git init my-repo
cd my-repo
echo &quot;Hello, World!&quot; &gt; file.txt
git add file.txt
git commit -m &quot;Initial commit&quot;

# Simular corrupci&oacute;
rm .git/objects/$(ls .git/objects/ | head -n 1)/$(ls .git/objects/$(ls .git/objects/ | head -n 1) | head -n 1)

# Pas 2: Diagnosticar la corrupci&oacute;
git fsck

# Pas 3: Reparar el repositori
git fetch --all
git reset --hard origin/main

# Verificar la reparaci&oacute;
git fsck</pre></div><div class='content'></div><h1><p>Conclusió</p>
</h1>
<div class='content'><p>Tractar amb repositoris corruptes pot ser un desafiament, però amb les eines i tècniques adequades, pots diagnosticar i reparar la majoria dels problemes. Recorda sempre mantenir backups regulars i seguir bones pràctiques per minimitzar el risc de corrupció. Amb aquesta base, estaràs preparat per gestionar qualsevol problema de corrupció que pugui sorgir en els teus projectes Git.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='09-03-recovering-lost-commits' title="Recuperant Commits Perduts">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='09-05-advanced-debugging-techniques' title="Tècniques Avançades de Depuració">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
