<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Migracions de Bases de Dades</title>

    <link rel="alternate" href="https://campusempresa.com/mod/go/08-04-database-migrations" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/go/08-04-database-migrations" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/go/08-04-database-migrations" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<a href="https://enterprisecampus.net/mod/go/08-04-database-migrations" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/go/08-04-database-migrations" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</span>
			<span class="d-none d-md-inline"><br><cite>Tot el coneixement al teu abast</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					 				<a href="/"><i class="bi bi-house-fill"></i> HOME</a>
											</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-03-using-orm' title="Ús d'ORM">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Migracions de Bases de Dades</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-01-building-and-deploying-go-applications' title="Construcció i Desplegament d'Aplicacions Go">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Les migracions de bases de dades són una part essencial del desenvolupament d'aplicacions modernes. Permeten gestionar els canvis en l'esquema de la base de dades de manera controlada i repetible. En aquest tema, aprendrem com utilitzar eines de migració en Go per gestionar aquests canvis.</p>
</div><h1>Objectius d'Aprenentatge</h1>
<div class='content'><p>Al final d'aquest tema, hauràs après:</p>
<ul>
<li>Què són les migracions de bases de dades i per què són importants.</li>
<li>Com utilitzar una eina de migració popular en Go.</li>
<li>Com crear, aplicar i revertir migracions.</li>
</ul>
</div><h1>Què són les Migracions de Bases de Dades?</h1>
<div class='content'><p>Les migracions de bases de dades són scripts que modifiquen l'esquema de la base de dades. Aquestes modificacions poden incloure la creació de taules, l'alteració de columnes, l'eliminació de taules, etc. Les migracions permeten:</p>
<ul>
<li>Mantenir l'esquema de la base de dades sincronitzat amb el codi de l'aplicació.</li>
<li>Facilitar la col·laboració entre desenvolupadors.</li>
<li>Assegurar que els canvis en l'esquema es poden aplicar de manera controlada i repetible.</li>
</ul>
</div><h1>Eina de Migració: <code>golang-migrate</code></h1>
<div class='content'><p>Una de les eines més populars per gestionar migracions en Go és <code>golang-migrate</code>. Aquesta eina permet crear, aplicar i revertir migracions de manera senzilla.</p>
</div><h2>Instal·lació de <code>golang-migrate</code></h2>
<div class='content'><p>Per instal·lar <code>golang-migrate</code>, pots utilitzar <code>go get</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z28gZ2V0IC11IC1kIGdpdGh1Yi5jb20vZ29sYW5nLW1pZ3JhdGUvbWlncmF0ZS9jbWQvbWlncmF0ZQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>go get -u -d github.com/golang-migrate/migrate/cmd/migrate</pre></div><div class='content'></div><h2>Creació d'una Migració</h2>
<div class='content'><p>Per crear una nova migració, utilitza la següent comanda:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWlncmF0ZSBjcmVhdGUgLWV4dCBzcWwgLWRpciBkYi9taWdyYXRpb25zIC1zZXEgY3JlYXRlX3VzZXJzX3RhYmxl"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>migrate create -ext sql -dir db/migrations -seq create_users_table</pre></div><div class='content'><p>Aquesta comanda crearà dos fitxers SQL a la carpeta <code>db/migrations</code>:</p>
<ul>
<li><code>000001_create_users_table.up.sql</code></li>
<li><code>000001_create_users_table.down.sql</code></li>
</ul>
</div><h2>Exemple de Migració</h2>
<div class='content'><p>Suposem que volem crear una taula d'usuaris. El fitxer <code>000001_create_users_table.up.sql</code> podria contenir:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFRBQkxFIHVzZXJzICgKICAgIGlkIFNFUklBTCBQUklNQVJZIEtFWSwKICAgIG5hbWUgVkFSQ0hBUigxMDApIE5PVCBOVUxMLAogICAgZW1haWwgVkFSQ0hBUigxMDApIFVOSVFVRSBOT1QgTlVMTCwKICAgIGNyZWF0ZWRfYXQgVElNRVNUQU1QIFdJVEggVElNRSBaT05FIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAKKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);</pre></div><div class='content'><p>El fitxer <code>000001_create_users_table.down.sql</code> podria contenir:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RFJPUCBUQUJMRSB1c2Vyczs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DROP TABLE users;</pre></div><div class='content'></div><h2>Aplicació de Migracions</h2>
<div class='content'><p>Per aplicar les migracions, utilitza la següent comanda:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWlncmF0ZSAtcGF0aCBkYi9taWdyYXRpb25zIC1kYXRhYmFzZSBwb3N0Z3JlczovL3VzZXI6cGFzc3dvcmRAbG9jYWxob3N0OjU0MzIvbXlkYj9zc2xtb2RlPWRpc2FibGUgdXA="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>migrate -path db/migrations -database postgres://user:password@localhost:5432/mydb?sslmode=disable up</pre></div><div class='content'></div><h2>Revertir Migracions</h2>
<div class='content'><p>Per revertir l'última migració aplicada, utilitza la següent comanda:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWlncmF0ZSAtcGF0aCBkYi9taWdyYXRpb25zIC1kYXRhYmFzZSBwb3N0Z3JlczovL3VzZXI6cGFzc3dvcmRAbG9jYWxob3N0OjU0MzIvbXlkYj9zc2xtb2RlPWRpc2FibGUgZG93biAx"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>migrate -path db/migrations -database postgres://user:password@localhost:5432/mydb?sslmode=disable down 1</pre></div><div class='content'></div><h1>Exercici Pràctic</h1>
<div class='content'></div><h2>Exercici 1: Creació d'una Taula de Productes</h2>
<div class='content'><ol>
<li>Crea una nova migració per a una taula de productes.</li>
<li>Defineix l'esquema de la taula amb les següents columnes: <code>id</code>, <code>name</code>, <code>description</code>, <code>price</code>, <code>created_at</code>.</li>
<li>Aplica la migració a la teva base de dades local.</li>
<li>Reverteix la migració.</li>
</ol>
<h4>Solució</h4>
<ol>
<li>Crear la migració:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWlncmF0ZSBjcmVhdGUgLWV4dCBzcWwgLWRpciBkYi9taWdyYXRpb25zIC1zZXEgY3JlYXRlX3Byb2R1Y3RzX3RhYmxl"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>migrate create -ext sql -dir db/migrations -seq create_products_table</pre></div><div class='content'><ol start="2">
<li>Definir l'esquema de la taula en <code>000002_create_products_table.up.sql</code>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFRBQkxFIHByb2R1Y3RzICgKICAgIGlkIFNFUklBTCBQUklNQVJZIEtFWSwKICAgIG5hbWUgVkFSQ0hBUigxMDApIE5PVCBOVUxMLAogICAgZGVzY3JpcHRpb24gVEVYVCwKICAgIHByaWNlIE5VTUVSSUMoMTAsIDIpIE5PVCBOVUxMLAogICAgY3JlYXRlZF9hdCBUSU1FU1RBTVAgV0lUSCBUSU1FIFpPTkUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUAopOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    price NUMERIC(10, 2) NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);</pre></div><div class='content'><ol start="3">
<li>Definir la reversió en <code>000002_create_products_table.down.sql</code>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RFJPUCBUQUJMRSBwcm9kdWN0czs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DROP TABLE products;</pre></div><div class='content'><ol start="4">
<li>Aplicar la migració:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWlncmF0ZSAtcGF0aCBkYi9taWdyYXRpb25zIC1kYXRhYmFzZSBwb3N0Z3JlczovL3VzZXI6cGFzc3dvcmRAbG9jYWxob3N0OjU0MzIvbXlkYj9zc2xtb2RlPWRpc2FibGUgdXA="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>migrate -path db/migrations -database postgres://user:password@localhost:5432/mydb?sslmode=disable up</pre></div><div class='content'><ol start="5">
<li>Revertir la migració:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWlncmF0ZSAtcGF0aCBkYi9taWdyYXRpb25zIC1kYXRhYmFzZSBwb3N0Z3JlczovL3VzZXI6cGFzc3dvcmRAbG9jYWxob3N0OjU0MzIvbXlkYj9zc2xtb2RlPWRpc2FibGUgZG93biAx"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>migrate -path db/migrations -database postgres://user:password@localhost:5432/mydb?sslmode=disable down 1</pre></div><div class='content'></div><h1>Resum</h1>
<div class='content'><p>En aquest tema, hem après què són les migracions de bases de dades i com utilitzar l'eina <code>golang-migrate</code> per gestionar-les en Go. Hem vist com crear, aplicar i revertir migracions amb exemples pràctics. Les migracions són una eina poderosa per mantenir l'esquema de la base de dades sincronitzat amb el codi de l'aplicació i facilitar la col·laboració entre desenvolupadors.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-03-using-orm' title="Ús d'ORM">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-01-building-and-deploying-go-applications' title="Construcció i Desplegament d'Aplicacions Go">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<!-- 
	<h1>Publicitat</h1>
	<p>Aquest espai està destinat a publicitat.</p>
	<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
	<p>Gràcies per col·laborar!</p>
	 -->
			









		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
