<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ús d'ORM</title>

    <link rel="alternate" href="https://campusempresa.com/mod/go/08-03-using-orm" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/go/08-03-using-orm" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/go/08-03-using-orm" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=2" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<a href="https://enterprisecampus.net/mod/go/08-03-using-orm" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/go/08-03-using-orm" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
<br>
			<cite>Construint la societat d'avui i del demà</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Llenguatges de Programació</a>
				 					<a href="/categ/frameworks">Frameworks i Llibreries</a>
				 					<a href="/categ/tech-tools">Eines Tècniques</a>
				 					<a href="/categ/foundations">Fonaments Teòrics</a>
				 					<a href="/categ/soft-skills">Habilitats Socials</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-02-crud-operations' title="Operacions CRUD">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Ús d'ORM</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-04-database-migrations' title="Migracions de Bases de Dades">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem a utilitzar un ORM (Object-Relational Mapping) en Go per interactuar amb bases de dades de manera més eficient i amb menys codi repetitiu. Un ORM ens permet treballar amb bases de dades utilitzant objectes en lloc de sentències SQL directes, facilitant així la gestió de dades.</p>
</div><h1><p>Objectius del Tema</p>
</h1>
<div class='content'><ul>
<li>Entendre què és un ORM i els seus avantatges.</li>
<li>Configurar un ORM popular en Go.</li>
<li>Realitzar operacions bàsiques de CRUD (Create, Read, Update, Delete) utilitzant l'ORM.</li>
</ul>
</div><h1><p>Què és un ORM?</p>
</h1>
<div class='content'><p>Un ORM (Object-Relational Mapping) és una tècnica de programació que permet convertir dades entre sistemes de tipus incompatibles utilitzant llenguatges de programació orientats a objectes. En termes simples, un ORM ens permet interactuar amb una base de dades utilitzant objectes en lloc de sentències SQL.</p>
</div><h2><p>Avantatges d'Utilitzar un ORM</p>
</h2>
<div class='content'><ul>
<li><strong>Abstracció de la Base de Dades</strong>: No cal escriure SQL manualment.</li>
<li><strong>Mantenibilitat</strong>: El codi és més net i fàcil de mantenir.</li>
<li><strong>Portabilitat</strong>: Facilita el canvi de bases de dades sense canviar el codi de l'aplicació.</li>
<li><strong>Seguretat</strong>: Redueix el risc d'injeccions SQL.</li>
</ul>
</div><h1><p>Configuració de GORM</p>
</h1>
<div class='content'><p>GORM és un dels ORMs més populars per a Go. A continuació, veurem com configurar-lo i utilitzar-lo per realitzar operacions bàsiques.</p>
</div><h2><p>Instal·lació de GORM</p>
</h2>
<div class='content'><p>Per instal·lar GORM, utilitzarem el gestor de paquets <code>go get</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z28gZ2V0IC11IGdvcm0uaW8vZ29ybQpnbyBnZXQgLXUgZ29ybS5pby9kcml2ZXIvc3FsaXRl"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>go get -u gorm.io/gorm
go get -u gorm.io/driver/sqlite</pre></div><div class='content'></div><h2><p>Configuració Bàsica</p>
</h2>
<div class='content'><p>A continuació, configurarem GORM per utilitzar una base de dades SQLite. Crearem una estructura per representar una taula de la base de dades i veurem com inicialitzar la connexió.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGFja2FnZSBtYWluCgppbXBvcnQgKAogICAgImdvcm0uaW8vZHJpdmVyL3NxbGl0ZSIKICAgICJnb3JtLmlvL2dvcm0iCiAgICAibG9nIgopCgovLyBEZWZpbmltIHVuYSBlc3RydWN0dXJhIHF1ZSByZXByZXNlbnRhIHVuYSB0YXVsYSBkZSBsYSBiYXNlIGRlIGRhZGVzCnR5cGUgUHJvZHVjdCBzdHJ1Y3QgewogICAgSUQgICAgdWludCAgIGBnb3JtOiJwcmltYXJ5S2V5ImAKICAgIENvZGUgIHN0cmluZyBgZ29ybToidW5pcXVlImAKICAgIFByaWNlIHVpbnQKfQoKZnVuYyBtYWluKCkgewogICAgLy8gSW5pY2lhbGl0emVtIGxhIGNvbm5leGnDsyBhIGxhIGJhc2UgZGUgZGFkZXMKICAgIGRiLCBlcnIgOj0gZ29ybS5PcGVuKHNxbGl0ZS5PcGVuKCJ0ZXN0LmRiIiksICZnb3JtLkNvbmZpZ3t9KQogICAgaWYgZXJyICE9IG5pbCB7CiAgICAgICAgbG9nLkZhdGFsKCJmYWlsZWQgdG8gY29ubmVjdCBkYXRhYmFzZSIpCiAgICB9CgogICAgLy8gTWlncmFyIGwnZXNxdWVtYQogICAgZGIuQXV0b01pZ3JhdGUoJlByb2R1Y3R7fSkKCiAgICAvLyBDcmVhciB1biBub3UgcHJvZHVjdGUKICAgIGRiLkNyZWF0ZSgmUHJvZHVjdHtDb2RlOiAiRDQyIiwgUHJpY2U6IDEwMH0pCgogICAgLy8gTGxlZ2lyIGVsIHByb2R1Y3RlCiAgICB2YXIgcHJvZHVjdCBQcm9kdWN0CiAgICBkYi5GaXJzdCgmcHJvZHVjdCwgMSkgLy8gVHJvYmFyIHByb2R1Y3RlIGFtYiBJRCAxCiAgICBkYi5GaXJzdCgmcHJvZHVjdCwgImNvZGUgPSA/IiwgIkQ0MiIpIC8vIFRyb2JhciBwcm9kdWN0ZSBhbWIgY29kaSBENDIKCiAgICAvLyBBY3R1YWxpdHphciBlbCBwcm9kdWN0ZQogICAgZGIuTW9kZWwoJnByb2R1Y3QpLlVwZGF0ZSgiUHJpY2UiLCAyMDApCgogICAgLy8gRXNib3JyYXIgZWwgcHJvZHVjdGUKICAgIGRiLkRlbGV0ZSgmcHJvZHVjdCwgMSkKfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>package main

import (
    &quot;gorm.io/driver/sqlite&quot;
    &quot;gorm.io/gorm&quot;
    &quot;log&quot;
)

// Definim una estructura que representa una taula de la base de dades
type Product struct {
    ID    uint   `gorm:&quot;primaryKey&quot;`
    Code  string `gorm:&quot;unique&quot;`
    Price uint
}

func main() {
    // Inicialitzem la connexi&oacute; a la base de dades
    db, err := gorm.Open(sqlite.Open(&quot;test.db&quot;), &amp;gorm.Config{})
    if err != nil {
        log.Fatal(&quot;failed to connect database&quot;)
    }

    // Migrar l'esquema
    db.AutoMigrate(&amp;Product{})

    // Crear un nou producte
    db.Create(&amp;Product{Code: &quot;D42&quot;, Price: 100})

    // Llegir el producte
    var product Product
    db.First(&amp;product, 1) // Trobar producte amb ID 1
    db.First(&amp;product, &quot;code = ?&quot;, &quot;D42&quot;) // Trobar producte amb codi D42

    // Actualitzar el producte
    db.Model(&amp;product).Update(&quot;Price&quot;, 200)

    // Esborrar el producte
    db.Delete(&amp;product, 1)
}</pre></div><div class='content'></div><h2><p>Explicació del Codi</p>
</h2>
<div class='content'><ol>
<li><strong>Definició de l'Estructura</strong>: Definim una estructura <code>Product</code> que representa una taula de la base de dades. Utilitzem etiquetes per especificar claus primàries i únics.</li>
<li><strong>Inicialització de la Connexió</strong>: Utilitzem <code>gorm.Open</code> per connectar-nos a una base de dades SQLite.</li>
<li><strong>Migració de l'Esquema</strong>: <code>db.AutoMigrate</code> crea la taula <code>products</code> basada en l'estructura <code>Product</code>.</li>
<li><strong>Operacions CRUD</strong>:
<ul>
<li><strong>Crear</strong>: <code>db.Create</code> afegeix un nou registre a la taula.</li>
<li><strong>Llegir</strong>: <code>db.First</code> recupera un registre de la taula.</li>
<li><strong>Actualitzar</strong>: <code>db.Model(&amp;product).Update</code> actualitza un camp del registre.</li>
<li><strong>Esborrar</strong>: <code>db.Delete</code> elimina un registre de la taula.</li>
</ul>
</li>
</ol>
</div><h1><p>Exercicis Pràctics</p>
</h1>
<div class='content'></div><h2><p>Exercici 1: Crear una Taula d'Usuaris</p>
</h2>
<div class='content'><ol>
<li>Defineix una estructura <code>User</code> amb els camps <code>ID</code>, <code>Name</code>, i <code>Email</code>.</li>
<li>Utilitza GORM per crear la taula <code>users</code> i afegeix alguns registres.</li>
</ol>
</div><h2><p>Solució</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGFja2FnZSBtYWluCgppbXBvcnQgKAogICAgImdvcm0uaW8vZHJpdmVyL3NxbGl0ZSIKICAgICJnb3JtLmlvL2dvcm0iCiAgICAibG9nIgopCgp0eXBlIFVzZXIgc3RydWN0IHsKICAgIElEICAgIHVpbnQgICBgZ29ybToicHJpbWFyeUtleSJgCiAgICBOYW1lICBzdHJpbmcKICAgIEVtYWlsIHN0cmluZyBgZ29ybToidW5pcXVlImAKfQoKZnVuYyBtYWluKCkgewogICAgZGIsIGVyciA6PSBnb3JtLk9wZW4oc3FsaXRlLk9wZW4oInRlc3QuZGIiKSwgJmdvcm0uQ29uZmlne30pCiAgICBpZiBlcnIgIT0gbmlsIHsKICAgICAgICBsb2cuRmF0YWwoImZhaWxlZCB0byBjb25uZWN0IGRhdGFiYXNlIikKICAgIH0KCiAgICBkYi5BdXRvTWlncmF0ZSgmVXNlcnt9KQoKICAgIGRiLkNyZWF0ZSgmVXNlcntOYW1lOiAiSm9obiBEb2UiLCBFbWFpbDogImpvaG5AZXhhbXBsZS5jb20ifSkKICAgIGRiLkNyZWF0ZSgmVXNlcntOYW1lOiAiSmFuZSBEb2UiLCBFbWFpbDogImphbmVAZXhhbXBsZS5jb20ifSkKfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>package main

import (
    &quot;gorm.io/driver/sqlite&quot;
    &quot;gorm.io/gorm&quot;
    &quot;log&quot;
)

type User struct {
    ID    uint   `gorm:&quot;primaryKey&quot;`
    Name  string
    Email string `gorm:&quot;unique&quot;`
}

func main() {
    db, err := gorm.Open(sqlite.Open(&quot;test.db&quot;), &amp;gorm.Config{})
    if err != nil {
        log.Fatal(&quot;failed to connect database&quot;)
    }

    db.AutoMigrate(&amp;User{})

    db.Create(&amp;User{Name: &quot;John Doe&quot;, Email: &quot;john@example.com&quot;})
    db.Create(&amp;User{Name: &quot;Jane Doe&quot;, Email: &quot;jane@example.com&quot;})
}</pre></div><div class='content'></div><h2><p>Exercici 2: Actualitzar i Esborrar Usuaris</p>
</h2>
<div class='content'><ol>
<li>Actualitza el nom d'un usuari amb un correu electrònic específic.</li>
<li>Esborra un usuari amb un ID específic.</li>
</ol>
</div><h2><p>Solució</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGFja2FnZSBtYWluCgppbXBvcnQgKAogICAgImdvcm0uaW8vZHJpdmVyL3NxbGl0ZSIKICAgICJnb3JtLmlvL2dvcm0iCiAgICAibG9nIgopCgp0eXBlIFVzZXIgc3RydWN0IHsKICAgIElEICAgIHVpbnQgICBgZ29ybToicHJpbWFyeUtleSJgCiAgICBOYW1lICBzdHJpbmcKICAgIEVtYWlsIHN0cmluZyBgZ29ybToidW5pcXVlImAKfQoKZnVuYyBtYWluKCkgewogICAgZGIsIGVyciA6PSBnb3JtLk9wZW4oc3FsaXRlLk9wZW4oInRlc3QuZGIiKSwgJmdvcm0uQ29uZmlne30pCiAgICBpZiBlcnIgIT0gbmlsIHsKICAgICAgICBsb2cuRmF0YWwoImZhaWxlZCB0byBjb25uZWN0IGRhdGFiYXNlIikKICAgIH0KCiAgICBkYi5BdXRvTWlncmF0ZSgmVXNlcnt9KQoKICAgIC8vIEFjdHVhbGl0emFyIGVsIG5vbSBkJ3VuIHVzdWFyaQogICAgdmFyIHVzZXIgVXNlcgogICAgZGIuRmlyc3QoJnVzZXIsICJlbWFpbCA9ID8iLCAiam9obkBleGFtcGxlLmNvbSIpCiAgICBkYi5Nb2RlbCgmdXNlcikuVXBkYXRlKCJOYW1lIiwgIkpvaG4gU21pdGgiKQoKICAgIC8vIEVzYm9ycmFyIHVuIHVzdWFyaQogICAgZGIuRGVsZXRlKCZ1c2VyLCB1c2VyLklEKQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>package main

import (
    &quot;gorm.io/driver/sqlite&quot;
    &quot;gorm.io/gorm&quot;
    &quot;log&quot;
)

type User struct {
    ID    uint   `gorm:&quot;primaryKey&quot;`
    Name  string
    Email string `gorm:&quot;unique&quot;`
}

func main() {
    db, err := gorm.Open(sqlite.Open(&quot;test.db&quot;), &amp;gorm.Config{})
    if err != nil {
        log.Fatal(&quot;failed to connect database&quot;)
    }

    db.AutoMigrate(&amp;User{})

    // Actualitzar el nom d'un usuari
    var user User
    db.First(&amp;user, &quot;email = ?&quot;, &quot;john@example.com&quot;)
    db.Model(&amp;user).Update(&quot;Name&quot;, &quot;John Smith&quot;)

    // Esborrar un usuari
    db.Delete(&amp;user, user.ID)
}</pre></div><div class='content'></div><h1><p>Conclusió</p>
</h1>
<div class='content'><p>En aquest tema, hem après què és un ORM i com utilitzar GORM per realitzar operacions bàsiques de CRUD en una base de dades SQLite. Hem vist com definir estructures que representen taules de la base de dades, com inicialitzar la connexió a la base de dades i com realitzar operacions de creació, lectura, actualització i esborrat de registres.</p>
<p>En el proper tema, explorarem com realitzar migracions de bases de dades per gestionar canvis en l'esquema de manera eficient.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-02-crud-operations' title="Operacions CRUD">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-04-database-migrations' title="Migracions de Bases de Dades">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Publicitat</h1>
<p>Aquest espai està destinat a publicitat.</p>
<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Gràcies per col·laborar!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
