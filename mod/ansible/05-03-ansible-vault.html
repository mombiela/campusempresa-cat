<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ansible Vault</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ansible/05-03-ansible-vault" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ansible/05-03-ansible-vault" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ansible/05-03-ansible-vault" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/ansible/05-03-ansible-vault" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/ansible/05-03-ansible-vault" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-templates' title="Plantilles">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Ansible Vault</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-error-handling' title="Gestió d'Errors">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1><p>Introducció a Ansible Vault</p>
</h1>
<div class='content'><p>Ansible Vault és una eina que permet xifrar dades sensibles, com ara contrasenyes o claus SSH, dins dels fitxers de configuració d'Ansible. Això és especialment útil per mantenir la seguretat i la integritat de la informació confidencial quan es treballa en entorns col·laboratius o es comparteixen playbooks.</p>
</div><h2><p>Conceptes Clau</p>
</h2>
<div class='content'><ul>
<li><strong>Xifratge</strong>: Ansible Vault utilitza AES (Advanced Encryption Standard) per xifrar i desxifrar dades.</li>
<li><strong>Fitxers Vault</strong>: Fitxers que contenen dades xifrades.</li>
<li><strong>Paraula de pas (password)</strong>: Utilitzada per xifrar i desxifrar els fitxers Vault.</li>
</ul>
</div><h1><p>Creant un Fitxer Vault</p>
</h1>
<div class='content'><p>Per crear un fitxer Vault, utilitzem la comanda <code>ansible-vault create</code>. Aquesta comanda obrirà un editor de text on podem introduir les dades que volem xifrar.</p>
</div><h2><p>Exemple</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCBjcmVhdGUgc2VjcmV0LnltbA=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault create secret.yml</pre></div><div class='content'><p>Després d'executar aquesta comanda, se'ns demanarà una paraula de pas per xifrar el fitxer. Un cop introduïda, s'obrirà l'editor de text per afegir el contingut.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBzZWNyZXQueW1sCmRiX3Bhc3N3b3JkOiAibXlfc2VjcmV0X3Bhc3N3b3JkIg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># secret.yml
db_password: &quot;my_secret_password&quot;</pre></div><div class='content'></div><h1><p>Editant un Fitxer Vault</p>
</h1>
<div class='content'><p>Per editar un fitxer Vault existent, utilitzem la comanda <code>ansible-vault edit</code>.</p>
</div><h2><p>Exemple</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCBlZGl0IHNlY3JldC55bWw="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault edit secret.yml</pre></div><div class='content'><p>Se'ns demanarà la paraula de pas per desxifrar el fitxer i, a continuació, s'obrirà l'editor de text per fer les modificacions necessàries.</p>
</div><h1><p>Xifrant Fitxers Existents</p>
</h1>
<div class='content'><p>Si ja tenim un fitxer que volem xifrar, podem utilitzar la comanda <code>ansible-vault encrypt</code>.</p>
</div><h2><p>Exemple</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCBlbmNyeXB0IGV4aXN0aW5nX2ZpbGUueW1s"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault encrypt existing_file.yml</pre></div><div class='content'><p>Després d'executar aquesta comanda, se'ns demanarà una paraula de pas per xifrar el fitxer.</p>
</div><h1><p>Desxifrant Fitxers</p>
</h1>
<div class='content'><p>Per desxifrar un fitxer Vault, utilitzem la comanda <code>ansible-vault decrypt</code>.</p>
</div><h2><p>Exemple</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCBkZWNyeXB0IHNlY3JldC55bWw="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault decrypt secret.yml</pre></div><div class='content'><p>Se'ns demanarà la paraula de pas per desxifrar el fitxer, i el contingut es desxifrarà i es guardarà en text pla.</p>
</div><h1><p>Utilitzant Fitxers Vault en Playbooks</p>
</h1>
<div class='content'><p>Podem utilitzar fitxers Vault en els nostres playbooks de la mateixa manera que utilitzem qualsevol altre fitxer de variables. Ansible gestionarà automàticament el desxifratge quan s'executi el playbook.</p>
</div><h2><p>Exemple de Playbook</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogRXhlbXBsZSBkJ8O6cyBkZSBWYXVsdAogIGhvc3RzOiBsb2NhbGhvc3QKICB2YXJzX2ZpbGVzOgogICAgLSBzZWNyZXQueW1sCiAgdGFza3M6CiAgICAtIG5hbWU6IE1vc3RyYSBsYSBjb250cmFzZW55YSBkZSBsYSBiYXNlIGRlIGRhZGVzCiAgICAgIGRlYnVnOgogICAgICAgIG1zZzogIkxhIGNvbnRyYXNlbnlhIGRlIGxhIGJhc2UgZGUgZGFkZXMgw6lzIHt7IGRiX3Bhc3N3b3JkIH19Ig=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Exemple d'&uacute;s de Vault
  hosts: localhost
  vars_files:
    - secret.yml
  tasks:
    - name: Mostra la contrasenya de la base de dades
      debug:
        msg: &quot;La contrasenya de la base de dades &eacute;s {{ db_password }}&quot;</pre></div><div class='content'></div><h1><p>Canviant la Paraula de Pas</p>
</h1>
<div class='content'><p>Si necessitem canviar la paraula de pas d'un fitxer Vault, utilitzem la comanda <code>ansible-vault rekey</code>.</p>
</div><h2><p>Exemple</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCByZWtleSBzZWNyZXQueW1s"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault rekey secret.yml</pre></div><div class='content'><p>Se'ns demanarà la paraula de pas actual i, a continuació, la nova paraula de pas.</p>
</div><h1><p>Exercicis Pràctics</p>
</h1>
<div class='content'></div><h2><p>Exercici 1: Creació i Ús d'un Fitxer Vault</p>
</h2>
<div class='content'><ol>
<li>Crea un fitxer Vault anomenat <code>credentials.yml</code> que contingui una variable <code>api_key</code> amb un valor fictici.</li>
<li>Escriu un playbook que utilitzi aquest fitxer Vault i mostri el valor de <code>api_key</code> utilitzant el mòdul <code>debug</code>.</li>
</ol>
<h4>Solució</h4>
<ol>
<li>Crear el fitxer Vault:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCBjcmVhdGUgY3JlZGVudGlhbHMueW1s"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault create credentials.yml</pre></div><div class='content'><p>Contingut del fitxer:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBjcmVkZW50aWFscy55bWwKYXBpX2tleTogIm15X3NlY3JldF9hcGlfa2V5Ig=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># credentials.yml
api_key: &quot;my_secret_api_key&quot;</pre></div><div class='content'><ol start="2">
<li>Escriure el playbook:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogRXhlbXBsZSBkJ8O6cyBkZSBWYXVsdAogIGhvc3RzOiBsb2NhbGhvc3QKICB2YXJzX2ZpbGVzOgogICAgLSBjcmVkZW50aWFscy55bWwKICB0YXNrczoKICAgIC0gbmFtZTogTW9zdHJhIGwnQVBJIEtleQogICAgICBkZWJ1ZzoKICAgICAgICBtc2c6ICJMJ0FQSSBLZXkgw6lzIHt7IGFwaV9rZXkgfX0i"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Exemple d'&uacute;s de Vault
  hosts: localhost
  vars_files:
    - credentials.yml
  tasks:
    - name: Mostra l'API Key
      debug:
        msg: &quot;L'API Key &eacute;s {{ api_key }}&quot;</pre></div><div class='content'></div><h2><p>Exercici 2: Xifrar un Fitxer Existents</p>
</h2>
<div class='content'><ol>
<li>Crea un fitxer anomenat <code>config.yml</code> amb una variable <code>db_user</code> i un valor fictici.</li>
<li>Xifra el fitxer utilitzant Ansible Vault.</li>
</ol>
<h4>Solució</h4>
<ol>
<li>Crear el fitxer <code>config.yml</code>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBjb25maWcueW1sCmRiX3VzZXI6ICJteV9kYl91c2VyIg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># config.yml
db_user: &quot;my_db_user&quot;</pre></div><div class='content'><ol start="2">
<li>Xifrar el fitxer:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCBlbmNyeXB0IGNvbmZpZy55bWw="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault encrypt config.yml</pre></div><div class='content'></div><h1><p>Resum</p>
</h1>
<div class='content'><p>En aquesta secció hem après a utilitzar Ansible Vault per xifrar i gestionar dades sensibles dins dels nostres playbooks. Hem vist com crear, editar, xifrar i desxifrar fitxers Vault, així com utilitzar-los en els nostres playbooks. També hem practicat aquests conceptes amb exercicis pràctics per reforçar l'aprenentatge.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-templates' title="Plantilles">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-error-handling' title="Gestió d'Errors">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
