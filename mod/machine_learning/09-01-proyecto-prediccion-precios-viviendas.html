<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projecte 1: Predicció de preus d'habitatges</title>

    <link rel="alternate" href="https://campusempresa.com/mod/machine_learning/09-01-proyecto-prediccion-precios-viviendas" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/machine_learning/09-01-proyecto-prediccion-precios-viviendas" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/machine_learning/09-01-project-housing-price-prediction" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/machine_learning/09-01-project-housing-price-prediction" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/machine_learning/09-01-proyecto-prediccion-precios-viviendas" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='08-04-etica-privacidad' title="Consideracions ètiques i de privacitat">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Projecte 1: Predicció de preus d'habitatges</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='09-02-proyecto-clasificacion-imagenes' title="Projecte 2: Classificació d'imatges">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1><p>Introducció</p>
</h1>
<div class='content'><p>En aquest projecte, aplicarem els coneixements adquirits al llarg del curs per desenvolupar un model de Machine Learning capaç de predir els preus d'habitatges. Aquest tipus de projecte és molt comú en el camp de l'anàlisi de dades i és una excel·lent manera de posar en pràctica tècniques de regressió, preprocessament de dades i avaluació de models.</p>
</div><h1><p>Objectius del Projecte</p>
</h1>
<div class='content'><ol>
<li><strong>Preprocessar les dades</strong>: Netejar, transformar i preparar les dades per al model.</li>
<li><strong>Desenvolupar un model de regressió</strong>: Utilitzar algoritmes de regressió per predir els preus.</li>
<li><strong>Avaluar el model</strong>: Utilitzar mètriques d'avaluació per mesurar el rendiment del model.</li>
<li><strong>Optimitzar el model</strong>: Ajustar hiperparàmetres per millorar el rendiment.</li>
</ol>
</div><h1><p>Passos del Projecte</p>
</h1>
<div class='content'></div><h2><ol>
<li>Importació de Llibreries i Dades</li>
</ol>
</h2>
<div class='content'><p>Comencem per importar les llibreries necessàries i carregar el conjunt de dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHBhbmRhcyBhcyBwZAppbXBvcnQgbnVtcHkgYXMgbnAKaW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAppbXBvcnQgc2VhYm9ybiBhcyBzbnMKZnJvbSBza2xlYXJuLm1vZGVsX3NlbGVjdGlvbiBpbXBvcnQgdHJhaW5fdGVzdF9zcGxpdApmcm9tIHNrbGVhcm4ubGluZWFyX21vZGVsIGltcG9ydCBMaW5lYXJSZWdyZXNzaW9uCmZyb20gc2tsZWFybi5tZXRyaWNzIGltcG9ydCBtZWFuX3NxdWFyZWRfZXJyb3IsIHIyX3Njb3JlCgojIENhcnJlZ2FyIGVsIGNvbmp1bnQgZGUgZGFkZXMKZGF0YSA9IHBkLnJlYWRfY3N2KCdob3VzaW5nX2RhdGEuY3N2Jyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score

# Carregar el conjunt de dades
data = pd.read_csv('housing_data.csv')</pre></div><div class='content'></div><h2><ol start="2">
<li>Exploració i Neteja de Dades</li>
</ol>
</h2>
<div class='content'><p>Explorem les dades per entendre la seva estructura i netejar qualsevol valor mancant o anòmal.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBNb3N0cmFyIGxlcyBwcmltZXJlcyBmaWxlcyBkZWwgY29uanVudCBkZSBkYWRlcwpwcmludChkYXRhLmhlYWQoKSkKCiMgSW5mb3JtYWNpw7Mgc29icmUgZWwgY29uanVudCBkZSBkYWRlcwpwcmludChkYXRhLmluZm8oKSkKCiMgRGVzY3JpcGNpw7MgZXN0YWTDrXN0aWNhCnByaW50KGRhdGEuZGVzY3JpYmUoKSkKCiMgQ29tcHJvdmFyIHZhbG9ycyBtYW5jYW50cwpwcmludChkYXRhLmlzbnVsbCgpLnN1bSgpKQoKIyBFbGltaW5hciBvIGltcHV0YXIgdmFsb3JzIG1hbmNhbnRzCmRhdGEgPSBkYXRhLmRyb3BuYSgpICAjIE9wY2nDsyBzaW1wbGU6IGVsaW1pbmFyIGZpbGVzIGFtYiB2YWxvcnMgbWFuY2FudHM="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Mostrar les primeres files del conjunt de dades
print(data.head())

# Informaci&oacute; sobre el conjunt de dades
print(data.info())

# Descripci&oacute; estad&iacute;stica
print(data.describe())

# Comprovar valors mancants
print(data.isnull().sum())

# Eliminar o imputar valors mancants
data = data.dropna()  # Opci&oacute; simple: eliminar files amb valors mancants</pre></div><div class='content'></div><h2><ol start="3">
<li>Anàlisi Exploratori de Dades (EDA)</li>
</ol>
</h2>
<div class='content'><p>Visualitzem les dades per identificar relacions i patrons.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBIaXN0b2dyYW1hIGRlbHMgcHJldXMgZCdoYWJpdGF0Z2VzCnNucy5oaXN0cGxvdChkYXRhWydwcmljZSddLCBiaW5zPTMwKQpwbHQudGl0bGUoJ0Rpc3RyaWJ1Y2nDsyBkZWxzIFByZXVzIGRcJ0hhYml0YXRnZXMnKQpwbHQueGxhYmVsKCdQcmV1JykKcGx0LnlsYWJlbCgnRnJlccO8w6huY2lhJykKcGx0LnNob3coKQoKIyBNYXRyaXUgZGUgY29ycmVsYWNpw7MKY29ycmVsYXRpb25fbWF0cml4ID0gZGF0YS5jb3JyKCkKc25zLmhlYXRtYXAoY29ycmVsYXRpb25fbWF0cml4LCBhbm5vdD1UcnVlLCBjbWFwPSdjb29sd2FybScpCnBsdC50aXRsZSgnTWF0cml1IGRlIENvcnJlbGFjacOzJykKcGx0LnNob3coKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Histograma dels preus d'habitatges
sns.histplot(data['price'], bins=30)
plt.title('Distribuci&oacute; dels Preus d\'Habitatges')
plt.xlabel('Preu')
plt.ylabel('Freq&uuml;&egrave;ncia')
plt.show()

# Matriu de correlaci&oacute;
correlation_matrix = data.corr()
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm')
plt.title('Matriu de Correlaci&oacute;')
plt.show()</pre></div><div class='content'></div><h2><ol start="4">
<li>Preprocessament de Dades</li>
</ol>
</h2>
<div class='content'><p>Preparem les dades per al model, incloent la normalització i la divisió en conjunts d'entrenament i prova.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTZWxlY2Npb25hciBsZXMgY2FyYWN0ZXLDrXN0aXF1ZXMgKGZlYXR1cmVzKSBpIGxhIHZhcmlhYmxlIG9iamVjdGl1ICh0YXJnZXQpClggPSBkYXRhLmRyb3AoJ3ByaWNlJywgYXhpcz0xKQp5ID0gZGF0YVsncHJpY2UnXQoKIyBEaXZpZGlyIGxlcyBkYWRlcyBlbiBjb25qdW50cyBkJ2VudHJlbmFtZW50IGkgcHJvdmEKWF90cmFpbiwgWF90ZXN0LCB5X3RyYWluLCB5X3Rlc3QgPSB0cmFpbl90ZXN0X3NwbGl0KFgsIHksIHRlc3Rfc2l6ZT0wLjIsIHJhbmRvbV9zdGF0ZT00MikKCiMgTm9ybWFsaXR6YXIgbGVzIGRhZGVzIChvcGNpb25hbCkKZnJvbSBza2xlYXJuLnByZXByb2Nlc3NpbmcgaW1wb3J0IFN0YW5kYXJkU2NhbGVyCnNjYWxlciA9IFN0YW5kYXJkU2NhbGVyKCkKWF90cmFpbiA9IHNjYWxlci5maXRfdHJhbnNmb3JtKFhfdHJhaW4pClhfdGVzdCA9IHNjYWxlci50cmFuc2Zvcm0oWF90ZXN0KQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Seleccionar les caracter&iacute;stiques (features) i la variable objectiu (target)
X = data.drop('price', axis=1)
y = data['price']

# Dividir les dades en conjunts d'entrenament i prova
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Normalitzar les dades (opcional)
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)</pre></div><div class='content'></div><h2><ol start="5">
<li>Desenvolupament del Model</li>
</ol>
</h2>
<div class='content'><p>Utilitzem la regressió lineal per desenvolupar el model de predicció.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhciBlbCBtb2RlbCBkZSByZWdyZXNzacOzIGxpbmVhbAptb2RlbCA9IExpbmVhclJlZ3Jlc3Npb24oKQoKIyBFbnRyZW5hciBlbCBtb2RlbAptb2RlbC5maXQoWF90cmFpbiwgeV90cmFpbikKCiMgUHJlZGlyIGVscyBwcmV1cyBlbiBlbCBjb25qdW50IGRlIHByb3ZhCnlfcHJlZCA9IG1vZGVsLnByZWRpY3QoWF90ZXN0KQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Crear el model de regressi&oacute; lineal
model = LinearRegression()

# Entrenar el model
model.fit(X_train, y_train)

# Predir els preus en el conjunt de prova
y_pred = model.predict(X_test)</pre></div><div class='content'></div><h2><ol start="6">
<li>Avaluació del Model</li>
</ol>
</h2>
<div class='content'><p>Utilitzem mètriques com el MSE i el R² per avaluar el rendiment del model.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYWxjdWxhciBlbCBNZWFuIFNxdWFyZWQgRXJyb3IgKE1TRSkKbXNlID0gbWVhbl9zcXVhcmVkX2Vycm9yKHlfdGVzdCwgeV9wcmVkKQpwcmludChmJ01lYW4gU3F1YXJlZCBFcnJvcjoge21zZX0nKQoKIyBDYWxjdWxhciBlbCBjb2VmaWNpZW50IGRlIGRldGVybWluYWNpw7MgUsKyCnIyID0gcjJfc2NvcmUoeV90ZXN0LCB5X3ByZWQpCnByaW50KGYnUsKyOiB7cjJ9Jyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Calcular el Mean Squared Error (MSE)
mse = mean_squared_error(y_test, y_pred)
print(f'Mean Squared Error: {mse}')

# Calcular el coeficient de determinaci&oacute; R&sup2;
r2 = r2_score(y_test, y_pred)
print(f'R&sup2;: {r2}')</pre></div><div class='content'></div><h2><ol start="7">
<li>Optimització del Model</li>
</ol>
</h2>
<div class='content'><p>Podem provar altres algoritmes de regressió o ajustar hiperparàmetres per millorar el rendiment.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGVtcGxlOiBVdGlsaXR6YXIgUmlkZ2UgUmVncmVzc2lvbgpmcm9tIHNrbGVhcm4ubGluZWFyX21vZGVsIGltcG9ydCBSaWRnZQoKcmlkZ2VfbW9kZWwgPSBSaWRnZShhbHBoYT0xLjApCnJpZGdlX21vZGVsLmZpdChYX3RyYWluLCB5X3RyYWluKQp5X3ByZWRfcmlkZ2UgPSByaWRnZV9tb2RlbC5wcmVkaWN0KFhfdGVzdCkKCiMgQXZhbHVhciBlbCBtb2RlbCBSaWRnZQptc2VfcmlkZ2UgPSBtZWFuX3NxdWFyZWRfZXJyb3IoeV90ZXN0LCB5X3ByZWRfcmlkZ2UpCnIyX3JpZGdlID0gcjJfc2NvcmUoeV90ZXN0LCB5X3ByZWRfcmlkZ2UpCnByaW50KGYnUmlkZ2UgUmVncmVzc2lvbiAtIE1lYW4gU3F1YXJlZCBFcnJvcjoge21zZV9yaWRnZX0nKQpwcmludChmJ1JpZGdlIFJlZ3Jlc3Npb24gLSBSwrI6IHtyMl9yaWRnZX0nKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Exemple: Utilitzar Ridge Regression
from sklearn.linear_model import Ridge

ridge_model = Ridge(alpha=1.0)
ridge_model.fit(X_train, y_train)
y_pred_ridge = ridge_model.predict(X_test)

# Avaluar el model Ridge
mse_ridge = mean_squared_error(y_test, y_pred_ridge)
r2_ridge = r2_score(y_test, y_pred_ridge)
print(f'Ridge Regression - Mean Squared Error: {mse_ridge}')
print(f'Ridge Regression - R&sup2;: {r2_ridge}')</pre></div><div class='content'></div><h1><p>Conclusió</p>
</h1>
<div class='content'><p>En aquest projecte, hem desenvolupat un model de Machine Learning per predir els preus d'habitatges. Hem seguit un procés estructurat que inclou la importació i neteja de dades, l'anàlisi exploratori, el preprocessament, el desenvolupament del model, l'avaluació i l'optimització. Aquest enfocament es pot aplicar a una àmplia varietat de problemes de predicció en el món real.</p>
</div><h2><p>Exercicis Pràctics</p>
</h2>
<div class='content'><ol>
<li><strong>Prova amb altres algoritmes de regressió</strong>: Intenta utilitzar altres algoritmes com la Regressió Lasso o la Regressió Polinòmica i compara els resultats.</li>
<li><strong>Ajust d'hiperparàmetres</strong>: Experimenta amb diferents valors d'hiperparàmetres per al model Ridge i observa com afecta el rendiment.</li>
<li><strong>Enginyeria de característiques</strong>: Crea noves característiques a partir de les dades existents i avalua si milloren el rendiment del model.</li>
</ol>
</div><h2><p>Solucions als Exercicis</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Regressió Lasso</strong>:</p>
<pre><code class="language-python">from sklearn.linear_model import Lasso

lasso_model = Lasso(alpha=0.1)
lasso_model.fit(X_train, y_train)
y_pred_lasso = lasso_model.predict(X_test)

mse_lasso = mean_squared_error(y_test, y_pred_lasso)
r2_lasso = r2_score(y_test, y_pred_lasso)
print(f'Lasso Regression - Mean Squared Error: {mse_lasso}')
print(f'Lasso Regression - R²: {r2_lasso}')
</code></pre>
</li>
<li>
<p><strong>Ajust d'hiperparàmetres per a Ridge Regression</strong>:</p>
<pre><code class="language-python">ridge_model = Ridge(alpha=10.0)
ridge_model.fit(X_train, y_train)
y_pred_ridge = ridge_model.predict(X_test)

mse_ridge = mean_squared_error(y_test, y_pred_ridge)
r2_ridge = r2_score(y_test, y_pred_ridge)
print(f'Ridge Regression (alpha=10.0) - Mean Squared Error: {mse_ridge}')
print(f'Ridge Regression (alpha=10.0) - R²: {r2_ridge}')
</code></pre>
</li>
<li>
<p><strong>Enginyeria de característiques</strong>:</p>
<pre><code class="language-python"># Exemple: Crear una nova característica basada en la relació entre dues existents
data['new_feature'] = data['feature1'] / data['feature2']

# Repetir el procés de divisió, entrenament i avaluació amb la nova característica
X = data.drop('price', axis=1)
y = data['price']
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)

model.fit(X_train, y_train)
y_pred = model.predict(X_test)

mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)
print(f'New Feature - Mean Squared Error: {mse}')
print(f'New Feature - R²: {r2}')
</code></pre>
</li>
</ol>
<p>Aquest projecte proporciona una base sòlida per a la predicció de preus d'habitatges i pot ser ampliat amb tècniques més avançades i dades addicionals per millorar la precisió i la robustesa del model.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='08-04-etica-privacidad' title="Consideracions ètiques i de privacitat">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='09-02-proyecto-clasificacion-imagenes' title="Projecte 2: Classificació d'imatges">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
