<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overfitting i Underfitting</title>

    <link rel="alternate" href="https://campusempresa.com/mod/machine_learning/06-04-overfitting-underfitting" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/machine_learning/06-04-overfitting-underfitting" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/machine_learning/06-04-overfitting-underfitting" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/machine_learning/06-04-overfitting-underfitting" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/machine_learning/06-04-overfitting-underfitting" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-03-curva-roc-auc' title="Corba ROC i AUC">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Overfitting i Underfitting</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-01-ensemble-learning' title="Ensemble Learning">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En el camp del Machine Learning, un dels reptes més comuns és trobar l'equilibri adequat entre l'overfitting i l'underfitting. Aquests dos conceptes descriuen problemes que poden sorgir quan un model aprèn a partir de dades d'entrenament.</p>
<ul>
<li><strong>Overfitting</strong>: Succeeix quan un model aprèn massa bé els detalls i el soroll de les dades d'entrenament, fins al punt que el seu rendiment es deteriora en dades noves.</li>
<li><strong>Underfitting</strong>: Succeeix quan un model és massa simple per capturar les relacions subjacents en les dades d'entrenament, resultant en un rendiment pobre tant en les dades d'entrenament com en les dades noves.</li>
</ul>
</div><h1>Conceptes Clau</h1>
<div class='content'></div><h2>Overfitting</h2>
<div class='content'><ul>
<li><strong>Definició</strong>: L'overfitting es produeix quan un model s'ajusta massa bé a les dades d'entrenament, incloent-hi el soroll i les anomalies. Això fa que el model tingui un rendiment excel·lent en les dades d'entrenament però pobre en les dades de validació o test.</li>
<li><strong>Símptomes</strong>:
<ul>
<li>Alta precisió en les dades d'entrenament.</li>
<li>Baixa precisió en les dades de validació o test.</li>
</ul>
</li>
<li><strong>Causes</strong>:
<ul>
<li>Model massa complex (massa paràmetres).</li>
<li>Dades d'entrenament insuficients.</li>
<li>Soroll en les dades d'entrenament.</li>
</ul>
</li>
</ul>
</div><h2>Underfitting</h2>
<div class='content'><ul>
<li><strong>Definició</strong>: L'underfitting es produeix quan un model és massa simple per capturar les relacions subjacents en les dades d'entrenament. Això fa que el model tingui un rendiment pobre tant en les dades d'entrenament com en les dades de validació o test.</li>
<li><strong>Símptomes</strong>:
<ul>
<li>Baixa precisió en les dades d'entrenament.</li>
<li>Baixa precisió en les dades de validació o test.</li>
</ul>
</li>
<li><strong>Causes</strong>:
<ul>
<li>Model massa simple (pocs paràmetres).</li>
<li>Dades d'entrenament insuficients.</li>
<li>Dades d'entrenament no representatives.</li>
</ul>
</li>
</ul>
</div><h1>Exemples Pràctics</h1>
<div class='content'></div><h2>Exemple d'Overfitting</h2>
<div class='content'><p>Considerem un conjunt de dades amb una relació lineal simple, però amb soroll afegit. Si ajustem un model polinòmic de grau alt, podem obtenir un model que s'ajusta perfectament a les dades d'entrenament però que no generalitza bé a noves dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHQKZnJvbSBza2xlYXJuLnByZXByb2Nlc3NpbmcgaW1wb3J0IFBvbHlub21pYWxGZWF0dXJlcwpmcm9tIHNrbGVhcm4ubGluZWFyX21vZGVsIGltcG9ydCBMaW5lYXJSZWdyZXNzaW9uCmZyb20gc2tsZWFybi5tZXRyaWNzIGltcG9ydCBtZWFuX3NxdWFyZWRfZXJyb3IKCiMgR2VuZXJhciBkYWRlcwpucC5yYW5kb20uc2VlZCgwKQpYID0gMiAtIDMgKiBucC5yYW5kb20ubm9ybWFsKDAsIDEsIDIwKQp5ID0gWCAtIDIgKiAoWCAqKiAyKSArIG5wLnJhbmRvbS5ub3JtYWwoLTMsIDMsIDIwKQoKIyBBanVzdGFyIG1vZGVsIHBvbGluw7JtaWMgZGUgZ3JhdSA5IChvdmVyZml0dGluZykKcG9seW5vbWlhbF9mZWF0dXJlcyA9IFBvbHlub21pYWxGZWF0dXJlcyhkZWdyZWU9OSkKWF9wb2x5ID0gcG9seW5vbWlhbF9mZWF0dXJlcy5maXRfdHJhbnNmb3JtKFgucmVzaGFwZSgtMSwgMSkpCm1vZGVsID0gTGluZWFyUmVncmVzc2lvbigpCm1vZGVsLmZpdChYX3BvbHksIHkpCnlfcG9seV9wcmVkID0gbW9kZWwucHJlZGljdChYX3BvbHkpCgojIFZpc3VhbGl0emFyCnBsdC5zY2F0dGVyKFgsIHksIHM9MTApCnBsdC5wbG90KG5wLnNvcnQoWCksIHlfcG9seV9wcmVkW25wLmFyZ3NvcnQoWCldLCBjb2xvcj0nbScpCnBsdC50aXRsZSgnRXhlbXBsZSBkXCdPdmVyZml0dGluZycpCnBsdC5zaG93KCkKCiMgRXJyb3IgcXVhZHLDoHRpYyBtaXRqw6AKbXNlID0gbWVhbl9zcXVhcmVkX2Vycm9yKHksIHlfcG9seV9wcmVkKQpwcmludChmJ0Vycm9yIHF1YWRyw6B0aWMgbWl0asOgOiB7bXNlfScp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np
import matplotlib.pyplot as plt
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error

# Generar dades
np.random.seed(0)
X = 2 - 3 * np.random.normal(0, 1, 20)
y = X - 2 * (X ** 2) + np.random.normal(-3, 3, 20)

# Ajustar model polin&ograve;mic de grau 9 (overfitting)
polynomial_features = PolynomialFeatures(degree=9)
X_poly = polynomial_features.fit_transform(X.reshape(-1, 1))
model = LinearRegression()
model.fit(X_poly, y)
y_poly_pred = model.predict(X_poly)

# Visualitzar
plt.scatter(X, y, s=10)
plt.plot(np.sort(X), y_poly_pred[np.argsort(X)], color='m')
plt.title('Exemple d\'Overfitting')
plt.show()

# Error quadr&agrave;tic mitj&agrave;
mse = mean_squared_error(y, y_poly_pred)
print(f'Error quadr&agrave;tic mitj&agrave;: {mse}')</pre></div><div class='content'></div><h2>Exemple d'Underfitting</h2>
<div class='content'><p>Considerem el mateix conjunt de dades, però ajustem un model lineal simple. El model no serà capaç de capturar la relació quadràtica subjacents en les dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBBanVzdGFyIG1vZGVsIGxpbmVhbCAodW5kZXJmaXR0aW5nKQptb2RlbCA9IExpbmVhclJlZ3Jlc3Npb24oKQptb2RlbC5maXQoWC5yZXNoYXBlKC0xLCAxKSwgeSkKeV9wcmVkID0gbW9kZWwucHJlZGljdChYLnJlc2hhcGUoLTEsIDEpKQoKIyBWaXN1YWxpdHphcgpwbHQuc2NhdHRlcihYLCB5LCBzPTEwKQpwbHQucGxvdChYLCB5X3ByZWQsIGNvbG9yPSdyJykKcGx0LnRpdGxlKCdFeGVtcGxlIGRcJ1VuZGVyZml0dGluZycpCnBsdC5zaG93KCkKCiMgRXJyb3IgcXVhZHLDoHRpYyBtaXRqw6AKbXNlID0gbWVhbl9zcXVhcmVkX2Vycm9yKHksIHlfcHJlZCkKcHJpbnQoZidFcnJvciBxdWFkcsOgdGljIG1pdGrDoDoge21zZX0nKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Ajustar model lineal (underfitting)
model = LinearRegression()
model.fit(X.reshape(-1, 1), y)
y_pred = model.predict(X.reshape(-1, 1))

# Visualitzar
plt.scatter(X, y, s=10)
plt.plot(X, y_pred, color='r')
plt.title('Exemple d\'Underfitting')
plt.show()

# Error quadr&agrave;tic mitj&agrave;
mse = mean_squared_error(y, y_pred)
print(f'Error quadr&agrave;tic mitj&agrave;: {mse}')</pre></div><div class='content'></div><h1>Estratègies per Evitar Overfitting i Underfitting</h1>
<div class='content'></div><h2>Evitar Overfitting</h2>
<div class='content'><ul>
<li><strong>Regularització</strong>: Utilitzar tècniques com Ridge, Lasso o Elastic Net per penalitzar la complexitat del model.</li>
<li><strong>Validació Creuada</strong>: Utilitzar validació creuada per avaluar el rendiment del model en diferents subconjunts de les dades.</li>
<li><strong>Pruning</strong>: En models com arbres de decisió, utilitzar tècniques de pruning per eliminar branques que no aporten valor.</li>
<li><strong>Early Stopping</strong>: En xarxes neuronals, utilitzar early stopping per aturar l'entrenament quan el rendiment en les dades de validació comença a deteriorar-se.</li>
</ul>
</div><h2>Evitar Underfitting</h2>
<div class='content'><ul>
<li><strong>Augmentar la Complexitat del Model</strong>: Utilitzar models més complexos que puguin capturar millor les relacions subjacents en les dades.</li>
<li><strong>Feature Engineering</strong>: Crear noves característiques que puguin ajudar el model a capturar millor les relacions subjacents.</li>
<li><strong>Augmentar les Dades d'Entrenament</strong>: Recollir més dades d'entrenament per proporcionar més informació al model.</li>
</ul>
</div><h1>Exercici Pràctic</h1>
<div class='content'></div><h2>Exercici</h2>
<div class='content'><ol>
<li>Genera un conjunt de dades sintètic amb una relació quadràtica i soroll afegit.</li>
<li>Ajusta un model lineal i un model polinòmic de grau 5 a les dades.</li>
<li>Compara el rendiment dels dos models utilitzant l'error quadràtic mitjà (MSE) en les dades d'entrenament i de validació.</li>
</ol>
</div><h2>Solució</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBHZW5lcmFyIGRhZGVzIHNpbnTDqHRpcXVlcwpucC5yYW5kb20uc2VlZCgwKQpYID0gMiAtIDMgKiBucC5yYW5kb20ubm9ybWFsKDAsIDEsIDEwMCkKeSA9IFggLSAyICogKFggKiogMikgKyBucC5yYW5kb20ubm9ybWFsKC0zLCAzLCAxMDApCgojIERpdmlkaXIgZW4gZGFkZXMgZCdlbnRyZW5hbWVudCBpIHZhbGlkYWNpw7MKZnJvbSBza2xlYXJuLm1vZGVsX3NlbGVjdGlvbiBpbXBvcnQgdHJhaW5fdGVzdF9zcGxpdApYX3RyYWluLCBYX3ZhbCwgeV90cmFpbiwgeV92YWwgPSB0cmFpbl90ZXN0X3NwbGl0KFgsIHksIHRlc3Rfc2l6ZT0wLjIsIHJhbmRvbV9zdGF0ZT0wKQoKIyBBanVzdGFyIG1vZGVsIGxpbmVhbAptb2RlbF9saW5lYXIgPSBMaW5lYXJSZWdyZXNzaW9uKCkKbW9kZWxfbGluZWFyLmZpdChYX3RyYWluLnJlc2hhcGUoLTEsIDEpLCB5X3RyYWluKQp5X3RyYWluX3ByZWRfbGluZWFyID0gbW9kZWxfbGluZWFyLnByZWRpY3QoWF90cmFpbi5yZXNoYXBlKC0xLCAxKSkKeV92YWxfcHJlZF9saW5lYXIgPSBtb2RlbF9saW5lYXIucHJlZGljdChYX3ZhbC5yZXNoYXBlKC0xLCAxKSkKCiMgQWp1c3RhciBtb2RlbCBwb2xpbsOybWljIGRlIGdyYXUgNQpwb2x5bm9taWFsX2ZlYXR1cmVzID0gUG9seW5vbWlhbEZlYXR1cmVzKGRlZ3JlZT01KQpYX3RyYWluX3BvbHkgPSBwb2x5bm9taWFsX2ZlYXR1cmVzLmZpdF90cmFuc2Zvcm0oWF90cmFpbi5yZXNoYXBlKC0xLCAxKSkKWF92YWxfcG9seSA9IHBvbHlub21pYWxfZmVhdHVyZXMudHJhbnNmb3JtKFhfdmFsLnJlc2hhcGUoLTEsIDEpKQptb2RlbF9wb2x5ID0gTGluZWFyUmVncmVzc2lvbigpCm1vZGVsX3BvbHkuZml0KFhfdHJhaW5fcG9seSwgeV90cmFpbikKeV90cmFpbl9wcmVkX3BvbHkgPSBtb2RlbF9wb2x5LnByZWRpY3QoWF90cmFpbl9wb2x5KQp5X3ZhbF9wcmVkX3BvbHkgPSBtb2RlbF9wb2x5LnByZWRpY3QoWF92YWxfcG9seSkKCiMgQ2FsY3VsYXIgTVNFCm1zZV90cmFpbl9saW5lYXIgPSBtZWFuX3NxdWFyZWRfZXJyb3IoeV90cmFpbiwgeV90cmFpbl9wcmVkX2xpbmVhcikKbXNlX3ZhbF9saW5lYXIgPSBtZWFuX3NxdWFyZWRfZXJyb3IoeV92YWwsIHlfdmFsX3ByZWRfbGluZWFyKQptc2VfdHJhaW5fcG9seSA9IG1lYW5fc3F1YXJlZF9lcnJvcih5X3RyYWluLCB5X3RyYWluX3ByZWRfcG9seSkKbXNlX3ZhbF9wb2x5ID0gbWVhbl9zcXVhcmVkX2Vycm9yKHlfdmFsLCB5X3ZhbF9wcmVkX3BvbHkpCgpwcmludChmJ01TRSBlbnRyZW5hbWVudCAobGluZWFsKToge21zZV90cmFpbl9saW5lYXJ9JykKcHJpbnQoZidNU0UgdmFsaWRhY2nDsyAobGluZWFsKToge21zZV92YWxfbGluZWFyfScpCnByaW50KGYnTVNFIGVudHJlbmFtZW50IChwb2xpbsOybWljKToge21zZV90cmFpbl9wb2x5fScpCnByaW50KGYnTVNFIHZhbGlkYWNpw7MgKHBvbGluw7JtaWMpOiB7bXNlX3ZhbF9wb2x5fScp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Generar dades sint&egrave;tiques
np.random.seed(0)
X = 2 - 3 * np.random.normal(0, 1, 100)
y = X - 2 * (X ** 2) + np.random.normal(-3, 3, 100)

# Dividir en dades d'entrenament i validaci&oacute;
from sklearn.model_selection import train_test_split
X_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.2, random_state=0)

# Ajustar model lineal
model_linear = LinearRegression()
model_linear.fit(X_train.reshape(-1, 1), y_train)
y_train_pred_linear = model_linear.predict(X_train.reshape(-1, 1))
y_val_pred_linear = model_linear.predict(X_val.reshape(-1, 1))

# Ajustar model polin&ograve;mic de grau 5
polynomial_features = PolynomialFeatures(degree=5)
X_train_poly = polynomial_features.fit_transform(X_train.reshape(-1, 1))
X_val_poly = polynomial_features.transform(X_val.reshape(-1, 1))
model_poly = LinearRegression()
model_poly.fit(X_train_poly, y_train)
y_train_pred_poly = model_poly.predict(X_train_poly)
y_val_pred_poly = model_poly.predict(X_val_poly)

# Calcular MSE
mse_train_linear = mean_squared_error(y_train, y_train_pred_linear)
mse_val_linear = mean_squared_error(y_val, y_val_pred_linear)
mse_train_poly = mean_squared_error(y_train, y_train_pred_poly)
mse_val_poly = mean_squared_error(y_val, y_val_pred_poly)

print(f'MSE entrenament (lineal): {mse_train_linear}')
print(f'MSE validaci&oacute; (lineal): {mse_val_linear}')
print(f'MSE entrenament (polin&ograve;mic): {mse_train_poly}')
print(f'MSE validaci&oacute; (polin&ograve;mic): {mse_val_poly}')</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>L'overfitting i l'underfitting són problemes comuns en el desenvolupament de models de Machine Learning. És crucial trobar un equilibri adequat entre la complexitat del model i la quantitat de dades d'entrenament per assegurar que el model generalitzi bé a noves dades. Utilitzant tècniques com la regularització, la validació creuada i el feature engineering, podem millorar el rendiment dels nostres models i evitar aquests problemes.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-03-curva-roc-auc' title="Corba ROC i AUC">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-01-ensemble-learning' title="Ensemble Learning">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
