<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mètriques d'avaluació</title>

    <link rel="alternate" href="https://campusempresa.com/mod/machine_learning/06-01-metricas-evaluacion" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/machine_learning/06-01-metricas-evaluacion" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/machine_learning/06-01-evaluation-metrics" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/machine_learning/06-01-metricas-evaluacion" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/machine_learning/06-01-metricas-evaluacion" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-04-dbscan' title="Anàlisi d'agrupament DBSCAN">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Mètriques d'avaluació</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-02-validacion-cruzada' title="Validació creuada">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En aquest tema, explorarem les diferents mètriques utilitzades per avaluar el rendiment dels models de Machine Learning. Les mètriques d'avaluació són essencials per comprendre com de bé (o malament) està funcionant un model i per comparar diferents models entre si.</p>
</div><h1>Objectius d'aprenentatge</h1>
<div class='content'><p>Al final d'aquest tema, hauràs de ser capaç de:</p>
<ol>
<li>Comprendre les mètriques d'avaluació més comunes per a models de classificació i regressió.</li>
<li>Aplicar aquestes mètriques per avaluar el rendiment dels teus models.</li>
<li>Interpretar els resultats de les mètriques per prendre decisions informades sobre la millora dels models.</li>
</ol>
</div><h1>1. Mètriques per a Models de Classificació</h1>
<div class='content'></div><h2>1.1. Matriu de Confusió</h2>
<div class='content'><p>La matriu de confusió és una eina que permet visualitzar el rendiment d'un algorisme de classificació. Es tracta d'una taula que mostra les prediccions correctes i incorrectes fetes pel model comparades amb les classificacions reals.</p>
<table>
<thead>
<tr>
<th>Actual/Predicció</th>
<th>Positiu (P)</th>
<th>Negatiu (N)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Positiu (P)</td>
<td>TP (True Positive)</td>
<td>FN (False Negative)</td>
</tr>
<tr>
<td>Negatiu (N)</td>
<td>FP (False Positive)</td>
<td>TN (True Negative)</td>
</tr>
</tbody>
</table>
</div><h2>1.2. Precisió, Sensibilitat i Especificitat</h2>
<div class='content'><ul>
<li>
<p><strong>Precisió (Accuracy)</strong>: Proporció de prediccions correctes (tant positives com negatives) respecte al total de casos.
\[
\text{Precisió} = \frac{TP + TN}{TP + TN + FP + FN}
\]</p>
</li>
<li>
<p><strong>Sensibilitat (Recall o True Positive Rate)</strong>: Proporció de positius reals correctament identificats.
\[
\text{Sensibilitat} = \frac{TP}{TP + FN}
\]</p>
</li>
<li>
<p><strong>Especificitat (True Negative Rate)</strong>: Proporció de negatius reals correctament identificats.
\[
\text{Especificitat} = \frac{TN}{TN + FP}
\]</p>
</li>
</ul>
</div><h2>1.3. Precisió i Exhaustivitat</h2>
<div class='content'><ul>
<li>
<p><strong>Precisió (Precision)</strong>: Proporció de prediccions positives correctes respecte al total de prediccions positives.
\[
\text{Precisió} = \frac{TP}{TP + FP}
\]</p>
</li>
<li>
<p><strong>Exhaustivitat (Recall)</strong>: Ja definit anteriorment com a Sensibilitat.</p>
</li>
</ul>
</div><h2>1.4. F1-Score</h2>
<div class='content'><p>L'F1-Score és la mitjana harmònica de la Precisió i l'Exhaustivitat. És útil quan es vol un equilibri entre aquestes dues mètriques.
\[
F1 = 2 \cdot \frac{\text{Precisió} \cdot \text{Exhaustivitat}}{\text{Precisió} + \text{Exhaustivitat}}
\]</p>
</div><h2>Exemple de Codi</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLm1ldHJpY3MgaW1wb3J0IGNvbmZ1c2lvbl9tYXRyaXgsIGFjY3VyYWN5X3Njb3JlLCBwcmVjaXNpb25fc2NvcmUsIHJlY2FsbF9zY29yZSwgZjFfc2NvcmUKCiMgU3Vwb3NlbSBxdWUgdGVuaW0gbGVzIHNlZ8O8ZW50cyBldGlxdWV0ZXMgcmVhbHMgaSBwcmVkaWNjaW9ucwp5X3RydWUgPSBbMSwgMCwgMSwgMSwgMCwgMSwgMCwgMCwgMSwgMF0KeV9wcmVkID0gWzEsIDAsIDEsIDAsIDAsIDEsIDAsIDAsIDEsIDFdCgojIE1hdHJpdSBkZSBjb25mdXNpw7MKY20gPSBjb25mdXNpb25fbWF0cml4KHlfdHJ1ZSwgeV9wcmVkKQpwcmludCgiTWF0cml1IGRlIENvbmZ1c2nDszpcbiIsIGNtKQoKIyBQcmVjaXNpw7MKYWNjdXJhY3kgPSBhY2N1cmFjeV9zY29yZSh5X3RydWUsIHlfcHJlZCkKcHJpbnQoIlByZWNpc2nDszoiLCBhY2N1cmFjeSkKCiMgUHJlY2lzacOzIChQcmVjaXNpb24pCnByZWNpc2lvbiA9IHByZWNpc2lvbl9zY29yZSh5X3RydWUsIHlfcHJlZCkKcHJpbnQoIlByZWNpc2nDsyAoUHJlY2lzaW9uKToiLCBwcmVjaXNpb24pCgojIEV4aGF1c3Rpdml0YXQgKFJlY2FsbCkKcmVjYWxsID0gcmVjYWxsX3Njb3JlKHlfdHJ1ZSwgeV9wcmVkKQpwcmludCgiRXhoYXVzdGl2aXRhdCAoUmVjYWxsKToiLCByZWNhbGwpCgojIEYxLVNjb3JlCmYxID0gZjFfc2NvcmUoeV90cnVlLCB5X3ByZWQpCnByaW50KCJGMS1TY29yZToiLCBmMSk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.metrics import confusion_matrix, accuracy_score, precision_score, recall_score, f1_score

# Suposem que tenim les seg&uuml;ents etiquetes reals i prediccions
y_true = [1, 0, 1, 1, 0, 1, 0, 0, 1, 0]
y_pred = [1, 0, 1, 0, 0, 1, 0, 0, 1, 1]

# Matriu de confusi&oacute;
cm = confusion_matrix(y_true, y_pred)
print(&quot;Matriu de Confusi&oacute;:\n&quot;, cm)

# Precisi&oacute;
accuracy = accuracy_score(y_true, y_pred)
print(&quot;Precisi&oacute;:&quot;, accuracy)

# Precisi&oacute; (Precision)
precision = precision_score(y_true, y_pred)
print(&quot;Precisi&oacute; (Precision):&quot;, precision)

# Exhaustivitat (Recall)
recall = recall_score(y_true, y_pred)
print(&quot;Exhaustivitat (Recall):&quot;, recall)

# F1-Score
f1 = f1_score(y_true, y_pred)
print(&quot;F1-Score:&quot;, f1)</pre></div><div class='content'></div><h1>2. Mètriques per a Models de Regressió</h1>
<div class='content'></div><h2>2.1. Error Quadràtic Mitjà (MSE)</h2>
<div class='content'><p>L'Error Quadràtic Mitjà (Mean Squared Error) mesura la mitjana dels quadrats dels errors, és a dir, la diferència entre els valors predits i els valors reals.
\[
MSE = \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2
\]</p>
</div><h2>2.2. Error Absolut Mitjà (MAE)</h2>
<div class='content'><p>L'Error Absolut Mitjà (Mean Absolute Error) mesura la mitjana dels valors absoluts dels errors.
\[
MAE = \frac{1}{n} \sum_{i=1}^{n} |y_i - \hat{y}_i|
\]</p>
</div><h2>2.3. R² (Coeficient de Determinació)</h2>
<div class='content'><p>El coeficient de determinació (R²) mesura la proporció de la variància en la variable dependent que és predictible a partir de la variable independent.
\[
R^2 = 1 - \frac{\sum_{i=1}^{n} (y_i - \hat{y}<em>i)^2}{\sum</em>{i=1}^{n} (y_i - \bar{y})^2}
\]</p>
</div><h2>Exemple de Codi</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLm1ldHJpY3MgaW1wb3J0IG1lYW5fc3F1YXJlZF9lcnJvciwgbWVhbl9hYnNvbHV0ZV9lcnJvciwgcjJfc2NvcmUKCiMgU3Vwb3NlbSBxdWUgdGVuaW0gbGVzIHNlZ8O8ZW50cyBldGlxdWV0ZXMgcmVhbHMgaSBwcmVkaWNjaW9ucwp5X3RydWUgPSBbMy4wLCAtMC41LCAyLjAsIDcuMF0KeV9wcmVkID0gWzIuNSwgMC4wLCAyLjAsIDguMF0KCiMgTVNFCm1zZSA9IG1lYW5fc3F1YXJlZF9lcnJvcih5X3RydWUsIHlfcHJlZCkKcHJpbnQoIk1TRToiLCBtc2UpCgojIE1BRQptYWUgPSBtZWFuX2Fic29sdXRlX2Vycm9yKHlfdHJ1ZSwgeV9wcmVkKQpwcmludCgiTUFFOiIsIG1hZSkKCiMgUsKyCnIyID0gcjJfc2NvcmUoeV90cnVlLCB5X3ByZWQpCnByaW50KCJSwrI6IiwgcjIp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score

# Suposem que tenim les seg&uuml;ents etiquetes reals i prediccions
y_true = [3.0, -0.5, 2.0, 7.0]
y_pred = [2.5, 0.0, 2.0, 8.0]

# MSE
mse = mean_squared_error(y_true, y_pred)
print(&quot;MSE:&quot;, mse)

# MAE
mae = mean_absolute_error(y_true, y_pred)
print(&quot;MAE:&quot;, mae)

# R&sup2;
r2 = r2_score(y_true, y_pred)
print(&quot;R&sup2;:&quot;, r2)</pre></div><div class='content'></div><h1>Exercicis Pràctics</h1>
<div class='content'></div><h2>Exercici 1: Classificació</h2>
<div class='content'><ol>
<li>Utilitza el conjunt de dades <code>Iris</code> de <code>sklearn.datasets</code> per entrenar un model de classificació.</li>
<li>Calcula la matriu de confusió, la precisió, l'exhaustivitat i l'F1-Score del model.</li>
</ol>
</div><h2>Exercici 2: Regressió</h2>
<div class='content'><ol>
<li>Utilitza el conjunt de dades <code>Boston</code> de <code>sklearn.datasets</code> per entrenar un model de regressió.</li>
<li>Calcula el MSE, el MAE i el R² del model.</li>
</ol>
</div><h1>Solucions</h1>
<div class='content'></div><h2>Solució Exercici 1</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLmRhdGFzZXRzIGltcG9ydCBsb2FkX2lyaXMKZnJvbSBza2xlYXJuLm1vZGVsX3NlbGVjdGlvbiBpbXBvcnQgdHJhaW5fdGVzdF9zcGxpdApmcm9tIHNrbGVhcm4uZW5zZW1ibGUgaW1wb3J0IFJhbmRvbUZvcmVzdENsYXNzaWZpZXIKZnJvbSBza2xlYXJuLm1ldHJpY3MgaW1wb3J0IGNvbmZ1c2lvbl9tYXRyaXgsIHByZWNpc2lvbl9zY29yZSwgcmVjYWxsX3Njb3JlLCBmMV9zY29yZQoKIyBDYXJyZWdhciBkYWRlcwppcmlzID0gbG9hZF9pcmlzKCkKWCA9IGlyaXMuZGF0YQp5ID0gaXJpcy50YXJnZXQKCiMgRGl2aWRpciBkYWRlcwpYX3RyYWluLCBYX3Rlc3QsIHlfdHJhaW4sIHlfdGVzdCA9IHRyYWluX3Rlc3Rfc3BsaXQoWCwgeSwgdGVzdF9zaXplPTAuMywgcmFuZG9tX3N0YXRlPTQyKQoKIyBFbnRyZW5hciBtb2RlbAptb2RlbCA9IFJhbmRvbUZvcmVzdENsYXNzaWZpZXIoKQptb2RlbC5maXQoWF90cmFpbiwgeV90cmFpbikKCiMgUHJlZGljY2lvbnMKeV9wcmVkID0gbW9kZWwucHJlZGljdChYX3Rlc3QpCgojIE3DqHRyaXF1ZXMKY20gPSBjb25mdXNpb25fbWF0cml4KHlfdGVzdCwgeV9wcmVkKQpwcmVjaXNpb24gPSBwcmVjaXNpb25fc2NvcmUoeV90ZXN0LCB5X3ByZWQsIGF2ZXJhZ2U9J21hY3JvJykKcmVjYWxsID0gcmVjYWxsX3Njb3JlKHlfdGVzdCwgeV9wcmVkLCBhdmVyYWdlPSdtYWNybycpCmYxID0gZjFfc2NvcmUoeV90ZXN0LCB5X3ByZWQsIGF2ZXJhZ2U9J21hY3JvJykKCnByaW50KCJNYXRyaXUgZGUgQ29uZnVzacOzOlxuIiwgY20pCnByaW50KCJQcmVjaXNpw7MgKFByZWNpc2lvbik6IiwgcHJlY2lzaW9uKQpwcmludCgiRXhoYXVzdGl2aXRhdCAoUmVjYWxsKToiLCByZWNhbGwpCnByaW50KCJGMS1TY29yZToiLCBmMSk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import confusion_matrix, precision_score, recall_score, f1_score

# Carregar dades
iris = load_iris()
X = iris.data
y = iris.target

# Dividir dades
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# Entrenar model
model = RandomForestClassifier()
model.fit(X_train, y_train)

# Prediccions
y_pred = model.predict(X_test)

# M&egrave;triques
cm = confusion_matrix(y_test, y_pred)
precision = precision_score(y_test, y_pred, average='macro')
recall = recall_score(y_test, y_pred, average='macro')
f1 = f1_score(y_test, y_pred, average='macro')

print(&quot;Matriu de Confusi&oacute;:\n&quot;, cm)
print(&quot;Precisi&oacute; (Precision):&quot;, precision)
print(&quot;Exhaustivitat (Recall):&quot;, recall)
print(&quot;F1-Score:&quot;, f1)</pre></div><div class='content'></div><h2>Solució Exercici 2</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLmRhdGFzZXRzIGltcG9ydCBsb2FkX2Jvc3Rvbgpmcm9tIHNrbGVhcm4ubW9kZWxfc2VsZWN0aW9uIGltcG9ydCB0cmFpbl90ZXN0X3NwbGl0CmZyb20gc2tsZWFybi5saW5lYXJfbW9kZWwgaW1wb3J0IExpbmVhclJlZ3Jlc3Npb24KZnJvbSBza2xlYXJuLm1ldHJpY3MgaW1wb3J0IG1lYW5fc3F1YXJlZF9lcnJvciwgbWVhbl9hYnNvbHV0ZV9lcnJvciwgcjJfc2NvcmUKCiMgQ2FycmVnYXIgZGFkZXMKYm9zdG9uID0gbG9hZF9ib3N0b24oKQpYID0gYm9zdG9uLmRhdGEKeSA9IGJvc3Rvbi50YXJnZXQKCiMgRGl2aWRpciBkYWRlcwpYX3RyYWluLCBYX3Rlc3QsIHlfdHJhaW4sIHlfdGVzdCA9IHRyYWluX3Rlc3Rfc3BsaXQoWCwgeSwgdGVzdF9zaXplPTAuMywgcmFuZG9tX3N0YXRlPTQyKQoKIyBFbnRyZW5hciBtb2RlbAptb2RlbCA9IExpbmVhclJlZ3Jlc3Npb24oKQptb2RlbC5maXQoWF90cmFpbiwgeV90cmFpbikKCiMgUHJlZGljY2lvbnMKeV9wcmVkID0gbW9kZWwucHJlZGljdChYX3Rlc3QpCgojIE3DqHRyaXF1ZXMKbXNlID0gbWVhbl9zcXVhcmVkX2Vycm9yKHlfdGVzdCwgeV9wcmVkKQptYWUgPSBtZWFuX2Fic29sdXRlX2Vycm9yKHlfdGVzdCwgeV9wcmVkKQpyMiA9IHIyX3Njb3JlKHlfdGVzdCwgeV9wcmVkKQoKcHJpbnQoIk1TRToiLCBtc2UpCnByaW50KCJNQUU6IiwgbWFlKQpwcmludCgiUsKyOiIsIHIyKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.datasets import load_boston
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score

# Carregar dades
boston = load_boston()
X = boston.data
y = boston.target

# Dividir dades
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# Entrenar model
model = LinearRegression()
model.fit(X_train, y_train)

# Prediccions
y_pred = model.predict(X_test)

# M&egrave;triques
mse = mean_squared_error(y_test, y_pred)
mae = mean_absolute_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(&quot;MSE:&quot;, mse)
print(&quot;MAE:&quot;, mae)
print(&quot;R&sup2;:&quot;, r2)</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>En aquesta secció, hem après sobre les diferents mètriques d'avaluació per a models de classificació i regressió. Hem vist com calcular aquestes mètriques i com interpretar els seus resultats per avaluar el rendiment dels nostres models. Aquestes mètriques són fonamentals per comprendre la qualitat dels models i per prendre decisions informades sobre com millorar-los.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-04-dbscan' title="Anàlisi d'agrupament DBSCAN">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-02-validacion-cruzada' title="Validació creuada">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
