<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Routing</title>

    <link rel="alternate" href="https://campusempresa.com/mod/nodejs/04-04-routing" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/nodejs/04-04-routing" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/nodejs/04-04-routing" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/nodejs/04-04-routing" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/nodejs/04-04-routing" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-03-serving-static-files' title="Servir Fitxers Estàtics">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Routing</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-introduction-to-npm' title="Introducció a NPM">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem com gestionar les rutes en un servidor HTTP creat amb Node.js. El routing és una part fonamental de qualsevol aplicació web, ja que permet definir com es gestionen les diferents peticions que arriben al servidor.</p>
</div><h1>Objectius</h1>
<div class='content'><ul>
<li>Entendre què és el routing i per què és important.</li>
<li>Aprendre a definir rutes bàsiques en Node.js.</li>
<li>Gestionar paràmetres de ruta i consultes.</li>
<li>Implementar rutes dinàmiques.</li>
</ul>
</div><h1>Què és el Routing?</h1>
<div class='content'><p>El routing és el procés de definir com el servidor respon a les diferents peticions HTTP que arriben a diferents URL. Cada ruta pot estar associada a una funció que s'executa quan es rep una petició a aquesta URL específica.</p>
</div><h1>Definint Rutes Bàsiques</h1>
<div class='content'><p>Comencem per crear un servidor HTTP simple i definir algunes rutes bàsiques.</p>
</div><h2>Exemple de Codi</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgaHR0cCA9IHJlcXVpcmUoJ2h0dHAnKTsKCmNvbnN0IHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKChyZXEsIHJlcykgPT4gewogIGlmIChyZXEudXJsID09PSAnLycgJiYgcmVxLm1ldGhvZCA9PT0gJ0dFVCcpIHsKICAgIHJlcy53cml0ZUhlYWQoMjAwLCB7ICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbicgfSk7CiAgICByZXMuZW5kKCdCZW52aW5ndXQgYSBsYSBww6BnaW5hIHByaW5jaXBhbCEnKTsKICB9IGVsc2UgaWYgKHJlcS51cmwgPT09ICcvYWJvdXQnICYmIHJlcS5tZXRob2QgPT09ICdHRVQnKSB7CiAgICByZXMud3JpdGVIZWFkKDIwMCwgeyAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nIH0pOwogICAgcmVzLmVuZCgnQXF1ZXN0YSDDqXMgbGEgcMOgZ2luYSBzb2JyZSBub3NhbHRyZXMuJyk7CiAgfSBlbHNlIHsKICAgIHJlcy53cml0ZUhlYWQoNDA0LCB7ICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbicgfSk7CiAgICByZXMuZW5kKCdQw6BnaW5hIG5vIHRyb2JhZGEnKTsKICB9Cn0pOwoKc2VydmVyLmxpc3RlbigzMDAwLCAoKSA9PiB7CiAgY29uc29sZS5sb2coJ1NlcnZpZG9yIGVzY29sdGFudCBhbCBwb3J0IDMwMDAnKTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const http = require('http');

const server = http.createServer((req, res) =&gt; {
  if (req.url === '/' &amp;&amp; req.method === 'GET') {
    res.writeHead(200, { 'Content-Type': 'text/plain' });
    res.end('Benvingut a la p&agrave;gina principal!');
  } else if (req.url === '/about' &amp;&amp; req.method === 'GET') {
    res.writeHead(200, { 'Content-Type': 'text/plain' });
    res.end('Aquesta &eacute;s la p&agrave;gina sobre nosaltres.');
  } else {
    res.writeHead(404, { 'Content-Type': 'text/plain' });
    res.end('P&agrave;gina no trobada');
  }
});

server.listen(3000, () =&gt; {
  console.log('Servidor escoltant al port 3000');
});</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ol>
<li><strong>Importar el mòdul <code>http</code></strong>: Utilitzem el mòdul <code>http</code> per crear el servidor.</li>
<li><strong>Crear el servidor</strong>: Utilitzem <code>http.createServer</code> per crear el servidor i definir una funció de callback que gestiona les peticions.</li>
<li><strong>Definir rutes</strong>: Utilitzem <code>req.url</code> i <code>req.method</code> per determinar quina ruta s'ha sol·licitat i quin mètode HTTP s'ha utilitzat.</li>
<li><strong>Enviar respostes</strong>: Utilitzem <code>res.writeHead</code> per establir el codi d'estat i el tipus de contingut, i <code>res.end</code> per enviar la resposta.</li>
</ol>
</div><h1>Gestionar Paràmetres de Ruta i Consultes</h1>
<div class='content'><p>Les rutes poden incloure paràmetres i consultes que permeten passar informació addicional a la petició.</p>
</div><h2>Exemple de Codi</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgdXJsID0gcmVxdWlyZSgndXJsJyk7Cgpjb25zdCBzZXJ2ZXIgPSBodHRwLmNyZWF0ZVNlcnZlcigocmVxLCByZXMpID0+IHsKICBjb25zdCBwYXJzZWRVcmwgPSB1cmwucGFyc2UocmVxLnVybCwgdHJ1ZSk7CiAgY29uc3QgcGF0aG5hbWUgPSBwYXJzZWRVcmwucGF0aG5hbWU7CiAgY29uc3QgcXVlcnkgPSBwYXJzZWRVcmwucXVlcnk7CgogIGlmIChwYXRobmFtZSA9PT0gJy91c2VyJyAmJiByZXEubWV0aG9kID09PSAnR0VUJykgewogICAgY29uc3QgdXNlcklkID0gcXVlcnkuaWQ7CiAgICByZXMud3JpdGVIZWFkKDIwMCwgeyAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nIH0pOwogICAgcmVzLmVuZChgSW5mb3JtYWNpw7MgZGUgbCd1c3VhcmkgYW1iIElEOiAke3VzZXJJZH1gKTsKICB9IGVsc2UgewogICAgcmVzLndyaXRlSGVhZCg0MDQsIHsgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3BsYWluJyB9KTsKICAgIHJlcy5lbmQoJ1DDoGdpbmEgbm8gdHJvYmFkYScpOwogIH0KfSk7CgpzZXJ2ZXIubGlzdGVuKDMwMDAsICgpID0+IHsKICBjb25zb2xlLmxvZygnU2Vydmlkb3IgZXNjb2x0YW50IGFsIHBvcnQgMzAwMCcpOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const url = require('url');

const server = http.createServer((req, res) =&gt; {
  const parsedUrl = url.parse(req.url, true);
  const pathname = parsedUrl.pathname;
  const query = parsedUrl.query;

  if (pathname === '/user' &amp;&amp; req.method === 'GET') {
    const userId = query.id;
    res.writeHead(200, { 'Content-Type': 'text/plain' });
    res.end(`Informaci&oacute; de l'usuari amb ID: ${userId}`);
  } else {
    res.writeHead(404, { 'Content-Type': 'text/plain' });
    res.end('P&agrave;gina no trobada');
  }
});

server.listen(3000, () =&gt; {
  console.log('Servidor escoltant al port 3000');
});</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ol>
<li><strong>Importar el mòdul <code>url</code></strong>: Utilitzem el mòdul <code>url</code> per analitzar la URL de la petició.</li>
<li><strong>Analitzar la URL</strong>: Utilitzem <code>url.parse</code> per obtenir el pathname i els paràmetres de consulta.</li>
<li><strong>Gestionar paràmetres de consulta</strong>: Utilitzem <code>parsedUrl.query</code> per accedir als paràmetres de consulta i utilitzar-los en la resposta.</li>
</ol>
</div><h1>Implementar Rutes Dinàmiques</h1>
<div class='content'><p>Les rutes dinàmiques permeten definir rutes que poden canviar en funció de la informació proporcionada a la URL.</p>
</div><h2>Exemple de Codi</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3Qgc2VydmVyID0gaHR0cC5jcmVhdGVTZXJ2ZXIoKHJlcSwgcmVzKSA9PiB7CiAgY29uc3QgcGFyc2VkVXJsID0gdXJsLnBhcnNlKHJlcS51cmwsIHRydWUpOwogIGNvbnN0IHBhdGhuYW1lID0gcGFyc2VkVXJsLnBhdGhuYW1lOwoKICBjb25zdCB1c2VySWRNYXRjaCA9IHBhdGhuYW1lLm1hdGNoKC9eXC91c2VyXC8oXGQrKSQvKTsKCiAgaWYgKHVzZXJJZE1hdGNoICYmIHJlcS5tZXRob2QgPT09ICdHRVQnKSB7CiAgICBjb25zdCB1c2VySWQgPSB1c2VySWRNYXRjaFsxXTsKICAgIHJlcy53cml0ZUhlYWQoMjAwLCB7ICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbicgfSk7CiAgICByZXMuZW5kKGBJbmZvcm1hY2nDsyBkZSBsJ3VzdWFyaSBhbWIgSUQ6ICR7dXNlcklkfWApOwogIH0gZWxzZSB7CiAgICByZXMud3JpdGVIZWFkKDQwNCwgeyAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nIH0pOwogICAgcmVzLmVuZCgnUMOgZ2luYSBubyB0cm9iYWRhJyk7CiAgfQp9KTsKCnNlcnZlci5saXN0ZW4oMzAwMCwgKCkgPT4gewogIGNvbnNvbGUubG9nKCdTZXJ2aWRvciBlc2NvbHRhbnQgYWwgcG9ydCAzMDAwJyk7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const server = http.createServer((req, res) =&gt; {
  const parsedUrl = url.parse(req.url, true);
  const pathname = parsedUrl.pathname;

  const userIdMatch = pathname.match(/^\/user\/(\d+)$/);

  if (userIdMatch &amp;&amp; req.method === 'GET') {
    const userId = userIdMatch[1];
    res.writeHead(200, { 'Content-Type': 'text/plain' });
    res.end(`Informaci&oacute; de l'usuari amb ID: ${userId}`);
  } else {
    res.writeHead(404, { 'Content-Type': 'text/plain' });
    res.end('P&agrave;gina no trobada');
  }
});

server.listen(3000, () =&gt; {
  console.log('Servidor escoltant al port 3000');
});</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ol>
<li><strong>Utilitzar expressions regulars</strong>: Utilitzem expressions regulars per identificar rutes dinàmiques.</li>
<li><strong>Capturar paràmetres de ruta</strong>: Utilitzem <code>pathname.match</code> per capturar els paràmetres de la ruta i utilitzar-los en la resposta.</li>
</ol>
</div><h1>Exercicis Pràctics</h1>
<div class='content'></div><h2>Exercici 1</h2>
<div class='content'><p>Crea un servidor HTTP que gestioni les següents rutes:</p>
<ul>
<li><code>GET /</code>: Retorna &quot;Pàgina principal&quot;.</li>
<li><code>GET /contact</code>: Retorna &quot;Pàgina de contacte&quot;.</li>
<li><code>GET /product/:id</code>: Retorna &quot;Informació del producte amb ID: :id&quot;.</li>
</ul>
</div><h2>Solució</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgaHR0cCA9IHJlcXVpcmUoJ2h0dHAnKTsKY29uc3QgdXJsID0gcmVxdWlyZSgndXJsJyk7Cgpjb25zdCBzZXJ2ZXIgPSBodHRwLmNyZWF0ZVNlcnZlcigocmVxLCByZXMpID0+IHsKICBjb25zdCBwYXJzZWRVcmwgPSB1cmwucGFyc2UocmVxLnVybCwgdHJ1ZSk7CiAgY29uc3QgcGF0aG5hbWUgPSBwYXJzZWRVcmwucGF0aG5hbWU7CgogIGlmIChwYXRobmFtZSA9PT0gJy8nICYmIHJlcS5tZXRob2QgPT09ICdHRVQnKSB7CiAgICByZXMud3JpdGVIZWFkKDIwMCwgeyAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nIH0pOwogICAgcmVzLmVuZCgnUMOgZ2luYSBwcmluY2lwYWwnKTsKICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2NvbnRhY3QnICYmIHJlcS5tZXRob2QgPT09ICdHRVQnKSB7CiAgICByZXMud3JpdGVIZWFkKDIwMCwgeyAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nIH0pOwogICAgcmVzLmVuZCgnUMOgZ2luYSBkZSBjb250YWN0ZScpOwogIH0gZWxzZSB7CiAgICBjb25zdCBwcm9kdWN0TWF0Y2ggPSBwYXRobmFtZS5tYXRjaCgvXlwvcHJvZHVjdFwvKFxkKykkLyk7CiAgICBpZiAocHJvZHVjdE1hdGNoICYmIHJlcS5tZXRob2QgPT09ICdHRVQnKSB7CiAgICAgIGNvbnN0IHByb2R1Y3RJZCA9IHByb2R1Y3RNYXRjaFsxXTsKICAgICAgcmVzLndyaXRlSGVhZCgyMDAsIHsgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3BsYWluJyB9KTsKICAgICAgcmVzLmVuZChgSW5mb3JtYWNpw7MgZGVsIHByb2R1Y3RlIGFtYiBJRDogJHtwcm9kdWN0SWR9YCk7CiAgICB9IGVsc2UgewogICAgICByZXMud3JpdGVIZWFkKDQwNCwgeyAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nIH0pOwogICAgICByZXMuZW5kKCdQw6BnaW5hIG5vIHRyb2JhZGEnKTsKICAgIH0KICB9Cn0pOwoKc2VydmVyLmxpc3RlbigzMDAwLCAoKSA9PiB7CiAgY29uc29sZS5sb2coJ1NlcnZpZG9yIGVzY29sdGFudCBhbCBwb3J0IDMwMDAnKTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const http = require('http');
const url = require('url');

const server = http.createServer((req, res) =&gt; {
  const parsedUrl = url.parse(req.url, true);
  const pathname = parsedUrl.pathname;

  if (pathname === '/' &amp;&amp; req.method === 'GET') {
    res.writeHead(200, { 'Content-Type': 'text/plain' });
    res.end('P&agrave;gina principal');
  } else if (pathname === '/contact' &amp;&amp; req.method === 'GET') {
    res.writeHead(200, { 'Content-Type': 'text/plain' });
    res.end('P&agrave;gina de contacte');
  } else {
    const productMatch = pathname.match(/^\/product\/(\d+)$/);
    if (productMatch &amp;&amp; req.method === 'GET') {
      const productId = productMatch[1];
      res.writeHead(200, { 'Content-Type': 'text/plain' });
      res.end(`Informaci&oacute; del producte amb ID: ${productId}`);
    } else {
      res.writeHead(404, { 'Content-Type': 'text/plain' });
      res.end('P&agrave;gina no trobada');
    }
  }
});

server.listen(3000, () =&gt; {
  console.log('Servidor escoltant al port 3000');
});</pre></div><div class='content'></div><h1>Resum</h1>
<div class='content'><p>En aquest tema, hem après què és el routing i com definir rutes bàsiques en un servidor HTTP creat amb Node.js. Hem vist com gestionar paràmetres de ruta i consultes, així com implementar rutes dinàmiques. Aquests conceptes són fonamentals per construir aplicacions web robustes i escalables. En el proper mòdul, explorarem com utilitzar NPM per gestionar paquets en les nostres aplicacions Node.js.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-03-serving-static-files' title="Servir Fitxers Estàtics">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-introduction-to-npm' title="Introducció a NPM">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
