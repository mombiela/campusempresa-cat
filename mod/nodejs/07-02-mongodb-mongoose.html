<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Utilitzar MongoDB amb Mongoose</title>

    <link rel="alternate" href="https://campusempresa.com/mod/nodejs/07-02-mongodb-mongoose" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/nodejs/07-02-mongodb-mongoose" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/nodejs/07-02-mongodb-mongoose" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<a href="https://enterprisecampus.net/mod/nodejs/07-02-mongodb-mongoose" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/mod/nodejs/07-02-mongodb-mongoose" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
<br>
			<cite>Construint la societat d'avui i del demà</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Projecte</a> | 
<a href="/about">Sobre nosaltres</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donacions</a> | 
<a href="/licence">Llicència</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
									<a href="./">Contingut del curs</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Competències tècniques</a>
				<a href="/all/conocimientos">Coneixements</a>
				<a href="/all/soft_skills">Competències socials</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-01-introduction-databases' title="Introducció a les Bases de Dades">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Utilitzar MongoDB amb Mongoose</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-03-sql-sequelize' title="Utilitzar Bases de Dades SQL amb Sequelize">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem a utilitzar MongoDB, una base de dades NoSQL, amb Mongoose, una biblioteca de modelatge d'objectes per Node.js que proporciona una solució elegant per treballar amb MongoDB. Mongoose facilita la definició d'esquemes per als nostres documents MongoDB i proporciona una API per interactuar amb la base de dades.</p>
</div><h1><p>Continguts</p>
</h1>
<div class='content'><ol>
<li><a href="#introducció-a-mongodb-i-mongoose">Introducció a MongoDB i Mongoose</a></li>
<li><a href="#instal·lació-de-mongodb-i-mongoose">Instal·lació de MongoDB i Mongoose</a></li>
<li><a href="#connexió-a-mongodb">Connexió a MongoDB</a></li>
<li><a href="#definició-desquemes-i-models">Definició d'Esquemes i Models</a></li>
<li><a href="#operacions-crud-amb-mongoose">Operacions CRUD amb Mongoose</a></li>
<li><a href="#exercicis-pràctics">Exercicis Pràctics</a></li>
</ol>
</div><h1><p>Introducció a MongoDB i Mongoose</p>
</h1>
<div class='content'></div><h2><p>MongoDB</p>
</h2>
<div class='content'><p>MongoDB és una base de dades NoSQL orientada a documents que emmagatzema dades en documents BSON (una extensió binària de JSON). És coneguda per la seva escalabilitat i flexibilitat.</p>
</div><h2><p>Mongoose</p>
</h2>
<div class='content'><p>Mongoose és una biblioteca de Node.js que proporciona una solució basada en esquemes per modelar les dades de l'aplicació. Ofereix validació, càlculs, middleware i altres funcionalitats per facilitar el treball amb MongoDB.</p>
</div><h1><p>Instal·lació de MongoDB i Mongoose</p>
</h1>
<div class='content'></div><h2><p>Instal·lació de MongoDB</p>
</h2>
<div class='content'><p>Per instal·lar MongoDB, segueix les instruccions de la <a href="https://docs.mongodb.com/manual/installation/">documentació oficial de MongoDB</a>.</p>
</div><h2><p>Instal·lació de Mongoose</p>
</h2>
<div class='content'><p>Per instal·lar Mongoose, utilitza npm (Node Package Manager):</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluc3RhbGwgbW9uZ29vc2U="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm install mongoose</pre></div><div class='content'></div><h1><p>Connexió a MongoDB</p>
</h1>
<div class='content'><p>Per connectar-nos a una base de dades MongoDB amb Mongoose, primer hem de requerir el mòdul <code>mongoose</code> i després utilitzar el mètode <code>connect</code> per establir la connexió.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpOwoKbW9uZ29vc2UuY29ubmVjdCgnbW9uZ29kYjovL2xvY2FsaG9zdDoyNzAxNy9ub21icmVkYicsIHsKICB1c2VOZXdVcmxQYXJzZXI6IHRydWUsCiAgdXNlVW5pZmllZFRvcG9sb2d5OiB0cnVlCn0pLnRoZW4oKCkgPT4gewogIGNvbnNvbGUubG9nKCdDb25uZXhpw7MgYSBNb25nb0RCIGVzdGFibGVydGEnKTsKfSkuY2F0Y2goKGVycm9yKSA9PiB7CiAgY29uc29sZS5lcnJvcignRXJyb3IgY29ubmVjdGFudCBhIE1vbmdvREI6JywgZXJyb3IpOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const mongoose = require('mongoose');

mongoose.connect('mongodb://localhost:27017/nombredb', {
  useNewUrlParser: true,
  useUnifiedTopology: true
}).then(() =&gt; {
  console.log('Connexi&oacute; a MongoDB establerta');
}).catch((error) =&gt; {
  console.error('Error connectant a MongoDB:', error);
});</pre></div><div class='content'></div><h1><p>Definició d'Esquemes i Models</p>
</h1>
<div class='content'></div><h2><p>Esquema</p>
</h2>
<div class='content'><p>Un esquema en Mongoose defineix l'estructura dels documents dins d'una col·lecció, especificant els camps i els seus tipus.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hOwoKY29uc3QgdXN1YXJpU2NoZW1hID0gbmV3IFNjaGVtYSh7CiAgbm9tOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSwKICBlZGF0OiB7IHR5cGU6IE51bWJlciwgcmVxdWlyZWQ6IHRydWUgfSwKICBlbWFpbDogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlLCB1bmlxdWU6IHRydWUgfQp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const Schema = mongoose.Schema;

const usuariSchema = new Schema({
  nom: { type: String, required: true },
  edat: { type: Number, required: true },
  email: { type: String, required: true, unique: true }
});</pre></div><div class='content'></div><h2><p>Model</p>
</h2>
<div class='content'><p>Un model és una classe que ens permet interactuar amb els documents d'una col·lecció. Es crea a partir d'un esquema.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgVXN1YXJpID0gbW9uZ29vc2UubW9kZWwoJ1VzdWFyaScsIHVzdWFyaVNjaGVtYSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const Usuari = mongoose.model('Usuari', usuariSchema);</pre></div><div class='content'></div><h1><p>Operacions CRUD amb Mongoose</p>
</h1>
<div class='content'></div><h2><p>Crear</p>
</h2>
<div class='content'><p>Per crear un nou document, utilitzem el mètode <code>save</code> del model.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3Qgbm91VXN1YXJpID0gbmV3IFVzdWFyaSh7CiAgbm9tOiAnSm9hbicsCiAgZWRhdDogMzAsCiAgZW1haWw6ICdqb2FuQGV4YW1wbGUuY29tJwp9KTsKCm5vdVVzdWFyaS5zYXZlKCkudGhlbigocmVzdWx0YXQpID0+IHsKICBjb25zb2xlLmxvZygnVXN1YXJpIGNyZWF0OicsIHJlc3VsdGF0KTsKfSkuY2F0Y2goKGVycm9yKSA9PiB7CiAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYW50IHVzdWFyaTonLCBlcnJvcik7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const nouUsuari = new Usuari({
  nom: 'Joan',
  edat: 30,
  email: 'joan@example.com'
});

nouUsuari.save().then((resultat) =&gt; {
  console.log('Usuari creat:', resultat);
}).catch((error) =&gt; {
  console.error('Error creant usuari:', error);
});</pre></div><div class='content'></div><h2><p>Llegir</p>
</h2>
<div class='content'><p>Per llegir documents, utilitzem el mètode <code>find</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXN1YXJpLmZpbmQoKS50aGVuKCh1c3VhcmlzKSA9PiB7CiAgY29uc29sZS5sb2coJ1VzdWFyaXMgdHJvYmF0czonLCB1c3VhcmlzKTsKfSkuY2F0Y2goKGVycm9yKSA9PiB7CiAgY29uc29sZS5lcnJvcignRXJyb3IgbGxlZ2ludCB1c3VhcmlzOicsIGVycm9yKTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Usuari.find().then((usuaris) =&gt; {
  console.log('Usuaris trobats:', usuaris);
}).catch((error) =&gt; {
  console.error('Error llegint usuaris:', error);
});</pre></div><div class='content'></div><h2><p>Actualitzar</p>
</h2>
<div class='content'><p>Per actualitzar un document, utilitzem el mètode <code>findByIdAndUpdate</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXN1YXJpLmZpbmRCeUlkQW5kVXBkYXRlKCdpZF91c3VhcmknLCB7IGVkYXQ6IDMxIH0sIHsgbmV3OiB0cnVlIH0pLnRoZW4oKHVzdWFyaUFjdHVhbGl0emF0KSA9PiB7CiAgY29uc29sZS5sb2coJ1VzdWFyaSBhY3R1YWxpdHphdDonLCB1c3VhcmlBY3R1YWxpdHphdCk7Cn0pLmNhdGNoKChlcnJvcikgPT4gewogIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFjdHVhbGl0emFudCB1c3Vhcmk6JywgZXJyb3IpOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Usuari.findByIdAndUpdate('id_usuari', { edat: 31 }, { new: true }).then((usuariActualitzat) =&gt; {
  console.log('Usuari actualitzat:', usuariActualitzat);
}).catch((error) =&gt; {
  console.error('Error actualitzant usuari:', error);
});</pre></div><div class='content'></div><h2><p>Eliminar</p>
</h2>
<div class='content'><p>Per eliminar un document, utilitzem el mètode <code>findByIdAndDelete</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXN1YXJpLmZpbmRCeUlkQW5kRGVsZXRlKCdpZF91c3VhcmknKS50aGVuKCh1c3VhcmlFbGltaW5hdCkgPT4gewogIGNvbnNvbGUubG9nKCdVc3VhcmkgZWxpbWluYXQ6JywgdXN1YXJpRWxpbWluYXQpOwp9KS5jYXRjaCgoZXJyb3IpID0+IHsKICBjb25zb2xlLmVycm9yKCdFcnJvciBlbGltaW5hbnQgdXN1YXJpOicsIGVycm9yKTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Usuari.findByIdAndDelete('id_usuari').then((usuariEliminat) =&gt; {
  console.log('Usuari eliminat:', usuariEliminat);
}).catch((error) =&gt; {
  console.error('Error eliminant usuari:', error);
});</pre></div><div class='content'></div><h1><p>Exercicis Pràctics</p>
</h1>
<div class='content'></div><h2><p>Exercici 1: Crear un Model de Producte</p>
</h2>
<div class='content'><ol>
<li>Defineix un esquema per a un producte amb els següents camps: nom, preu, categoria.</li>
<li>Crea un model a partir de l'esquema.</li>
<li>Crea i desa un nou producte.</li>
</ol>
</div><h2><p>Exercici 2: Llegir i Actualitzar Productes</p>
</h2>
<div class='content'><ol>
<li>Llegeix tots els productes de la base de dades.</li>
<li>Actualitza el preu d'un producte específic.</li>
</ol>
</div><h2><p>Exercici 3: Eliminar Productes</p>
</h2>
<div class='content'><ol>
<li>Elimina un producte de la base de dades.</li>
</ol>
</div><h2><p>Solucions</p>
</h2>
<div class='content'><h4>Solució Exercici 1</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgcHJvZHVjdGVTY2hlbWEgPSBuZXcgU2NoZW1hKHsKICBub206IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LAogIHByZXU6IHsgdHlwZTogTnVtYmVyLCByZXF1aXJlZDogdHJ1ZSB9LAogIGNhdGVnb3JpYTogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0KfSk7Cgpjb25zdCBQcm9kdWN0ZSA9IG1vbmdvb3NlLm1vZGVsKCdQcm9kdWN0ZScsIHByb2R1Y3RlU2NoZW1hKTsKCmNvbnN0IG5vdVByb2R1Y3RlID0gbmV3IFByb2R1Y3RlKHsKICBub206ICdPcmRpbmFkb3InLAogIHByZXU6IDEwMDAsCiAgY2F0ZWdvcmlhOiAnRWxlY3Ryw7JuaWNhJwp9KTsKCm5vdVByb2R1Y3RlLnNhdmUoKS50aGVuKChyZXN1bHRhdCkgPT4gewogIGNvbnNvbGUubG9nKCdQcm9kdWN0ZSBjcmVhdDonLCByZXN1bHRhdCk7Cn0pLmNhdGNoKChlcnJvcikgPT4gewogIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWFudCBwcm9kdWN0ZTonLCBlcnJvcik7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const producteSchema = new Schema({
  nom: { type: String, required: true },
  preu: { type: Number, required: true },
  categoria: { type: String, required: true }
});

const Producte = mongoose.model('Producte', producteSchema);

const nouProducte = new Producte({
  nom: 'Ordinador',
  preu: 1000,
  categoria: 'Electr&ograve;nica'
});

nouProducte.save().then((resultat) =&gt; {
  console.log('Producte creat:', resultat);
}).catch((error) =&gt; {
  console.error('Error creant producte:', error);
});</pre></div><div class='content'><h4>Solució Exercici 2</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJvZHVjdGUuZmluZCgpLnRoZW4oKHByb2R1Y3RlcykgPT4gewogIGNvbnNvbGUubG9nKCdQcm9kdWN0ZXMgdHJvYmF0czonLCBwcm9kdWN0ZXMpOwp9KS5jYXRjaCgoZXJyb3IpID0+IHsKICBjb25zb2xlLmVycm9yKCdFcnJvciBsbGVnaW50IHByb2R1Y3RlczonLCBlcnJvcik7Cn0pOwoKUHJvZHVjdGUuZmluZEJ5SWRBbmRVcGRhdGUoJ2lkX3Byb2R1Y3RlJywgeyBwcmV1OiAxMjAwIH0sIHsgbmV3OiB0cnVlIH0pLnRoZW4oKHByb2R1Y3RlQWN0dWFsaXR6YXQpID0+IHsKICBjb25zb2xlLmxvZygnUHJvZHVjdGUgYWN0dWFsaXR6YXQ6JywgcHJvZHVjdGVBY3R1YWxpdHphdCk7Cn0pLmNhdGNoKChlcnJvcikgPT4gewogIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFjdHVhbGl0emFudCBwcm9kdWN0ZTonLCBlcnJvcik7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Producte.find().then((productes) =&gt; {
  console.log('Productes trobats:', productes);
}).catch((error) =&gt; {
  console.error('Error llegint productes:', error);
});

Producte.findByIdAndUpdate('id_producte', { preu: 1200 }, { new: true }).then((producteActualitzat) =&gt; {
  console.log('Producte actualitzat:', producteActualitzat);
}).catch((error) =&gt; {
  console.error('Error actualitzant producte:', error);
});</pre></div><div class='content'><h4>Solució Exercici 3</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJvZHVjdGUuZmluZEJ5SWRBbmREZWxldGUoJ2lkX3Byb2R1Y3RlJykudGhlbigocHJvZHVjdGVFbGltaW5hdCkgPT4gewogIGNvbnNvbGUubG9nKCdQcm9kdWN0ZSBlbGltaW5hdDonLCBwcm9kdWN0ZUVsaW1pbmF0KTsKfSkuY2F0Y2goKGVycm9yKSA9PiB7CiAgY29uc29sZS5lcnJvcignRXJyb3IgZWxpbWluYW50IHByb2R1Y3RlOicsIGVycm9yKTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Producte.findByIdAndDelete('id_producte').then((producteEliminat) =&gt; {
  console.log('Producte eliminat:', producteEliminat);
}).catch((error) =&gt; {
  console.error('Error eliminant producte:', error);
});</pre></div><div class='content'></div><h1><p>Conclusió</p>
</h1>
<div class='content'><p>En aquest tema, hem après a utilitzar MongoDB amb Mongoose per gestionar les nostres dades de manera eficient. Hem vist com connectar-nos a una base de dades, definir esquemes i models, i realitzar operacions CRUD. Amb aquests coneixements, estem preparats per treballar amb bases de dades NoSQL en les nostres aplicacions Node.js.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-01-introduction-databases' title="Introducció a les Bases de Dades">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-03-sql-sequelize' title="Utilitzar Bases de Dades SQL amb Sequelize">
				<span class="d-none d-md-inline">Següent &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
