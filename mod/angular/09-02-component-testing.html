<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proves de components</title>

    <link rel="alternate" href="https://campusempresa.com/mod/angular/09-02-component-testing" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/angular/09-02-component-testing" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/angular/09-02-component-testing" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/angular/09-02-component-testing" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/angular/09-02-component-testing" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='09-01-unit-testing' title="Proves unitàries">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Proves de components</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='09-03-service-testing' title="Proves de serveis">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Les proves de components són una part essencial del desenvolupament d'aplicacions Angular. Aquest tipus de proves asseguren que els components funcionin correctament de manera aïllada, sense dependre d'altres parts de l'aplicació. En aquesta secció, aprendrem com configurar i escriure proves per als components Angular utilitzant el framework de proves Jasmine i l'eina de test Karma.</p>
</div><h1>Objectius</h1>
<div class='content'><ul>
<li>Comprendre la importància de les proves de components.</li>
<li>Configurar l'entorn de proves per a components Angular.</li>
<li>Escriure proves unitàries per a components.</li>
<li>Utilitzar mocks i espies per aïllar les proves.</li>
<li>Executar i interpretar els resultats de les proves.</li>
</ul>
</div><h1>1. Configuració de l'entorn de proves</h1>
<div class='content'><p>Angular CLI ve amb una configuració predeterminada per a Karma i Jasmine, que facilita la creació i execució de proves. Quan creem un nou component amb Angular CLI, es genera automàticament un fitxer de proves amb l'extensió <code>.spec.ts</code>.</p>
</div><h2>Exemple de fitxer de proves generat</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHsgQ29tcG9uZW50Rml4dHVyZSwgVGVzdEJlZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUvdGVzdGluZyc7CmltcG9ydCB7IE15Q29tcG9uZW50IH0gZnJvbSAnLi9teS1jb21wb25lbnQuY29tcG9uZW50JzsKCmRlc2NyaWJlKCdNeUNvbXBvbmVudCcsICgpID0+IHsKICBsZXQgY29tcG9uZW50OiBNeUNvbXBvbmVudDsKICBsZXQgZml4dHVyZTogQ29tcG9uZW50Rml4dHVyZTxNeUNvbXBvbmVudD47CgogIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4gewogICAgYXdhaXQgVGVzdEJlZC5jb25maWd1cmVUZXN0aW5nTW9kdWxlKHsKICAgICAgZGVjbGFyYXRpb25zOiBbIE15Q29tcG9uZW50IF0KICAgIH0pCiAgICAuY29tcGlsZUNvbXBvbmVudHMoKTsKICB9KTsKCiAgYmVmb3JlRWFjaCgoKSA9PiB7CiAgICBmaXh0dXJlID0gVGVzdEJlZC5jcmVhdGVDb21wb25lbnQoTXlDb21wb25lbnQpOwogICAgY29tcG9uZW50ID0gZml4dHVyZS5jb21wb25lbnRJbnN0YW5jZTsKICAgIGZpeHR1cmUuZGV0ZWN0Q2hhbmdlcygpOwogIH0pOwoKICBpdCgnc2hvdWxkIGNyZWF0ZScsICgpID0+IHsKICAgIGV4cGVjdChjb21wb25lbnQpLnRvQmVUcnV0aHkoKTsKICB9KTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import { ComponentFixture, TestBed } from '@angular/core/testing';
import { MyComponent } from './my-component.component';

describe('MyComponent', () =&gt; {
  let component: MyComponent;
  let fixture: ComponentFixture&lt;MyComponent&gt;;

  beforeEach(async () =&gt; {
    await TestBed.configureTestingModule({
      declarations: [ MyComponent ]
    })
    .compileComponents();
  });

  beforeEach(() =&gt; {
    fixture = TestBed.createComponent(MyComponent);
    component = fixture.componentInstance;
    fixture.detectChanges();
  });

  it('should create', () =&gt; {
    expect(component).toBeTruthy();
  });
});</pre></div><div class='content'></div><h2>Explicació del codi</h2>
<div class='content'><ul>
<li><strong>Imports</strong>: Importem <code>ComponentFixture</code> i <code>TestBed</code> d'<code>@angular/core/testing</code> i el component que volem provar.</li>
<li><strong>Describe</strong>: Definim un bloc de proves per al component <code>MyComponent</code>.</li>
<li><strong>BeforeEach (async)</strong>: Configura el mòdul de proves amb el component que volem provar.</li>
<li><strong>BeforeEach</strong>: Crea una instància del component i la seva fixture.</li>
<li><strong>It</strong>: Defineix una prova que verifica si el component es crea correctament.</li>
</ul>
</div><h1>2. Escriure proves unitàries per a components</h1>
<div class='content'></div><h2>Prova de propietats del component</h2>
<div class='content'><p>Podem escriure proves per verificar les propietats del component.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aXQoJ3Nob3VsZCBoYXZlIGEgZGVmYXVsdCB0aXRsZScsICgpID0+IHsKICBleHBlY3QoY29tcG9uZW50LnRpdGxlKS50b0JlKCdkZWZhdWx0IHRpdGxlJyk7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>it('should have a default title', () =&gt; {
  expect(component.title).toBe('default title');
});</pre></div><div class='content'></div><h2>Prova de mètodes del component</h2>
<div class='content'><p>Podem provar els mètodes del component per assegurar-nos que funcionen correctament.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aXQoJ3Nob3VsZCBpbmNyZW1lbnQgdGhlIGNvdW50ZXInLCAoKSA9PiB7CiAgY29tcG9uZW50LmluY3JlbWVudCgpOwogIGV4cGVjdChjb21wb25lbnQuY291bnRlcikudG9CZSgxKTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>it('should increment the counter', () =&gt; {
  component.increment();
  expect(component.counter).toBe(1);
});</pre></div><div class='content'></div><h2>Prova de la plantilla del component</h2>
<div class='content'><p>Podem verificar que la plantilla del component es renderitza correctament.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aXQoJ3Nob3VsZCByZW5kZXIgdGl0bGUgaW4gYSBoMSB0YWcnLCAoKSA9PiB7CiAgY29uc3QgY29tcGlsZWQgPSBmaXh0dXJlLm5hdGl2ZUVsZW1lbnQ7CiAgZXhwZWN0KGNvbXBpbGVkLnF1ZXJ5U2VsZWN0b3IoJ2gxJykudGV4dENvbnRlbnQpLnRvQ29udGFpbignZGVmYXVsdCB0aXRsZScpOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>it('should render title in a h1 tag', () =&gt; {
  const compiled = fixture.nativeElement;
  expect(compiled.querySelector('h1').textContent).toContain('default title');
});</pre></div><div class='content'></div><h1>3. Utilitzar mocks i espies</h1>
<div class='content'></div><h2>Mock de serveis</h2>
<div class='content'><p>Podem utilitzar mocks per aïllar les proves del component dels serveis externs.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgTW9ja015U2VydmljZSB7CiAgZ2V0VmFsdWUoKSB7CiAgICByZXR1cm4gJ21vY2sgdmFsdWUnOwogIH0KfQoKYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7CiAgYXdhaXQgVGVzdEJlZC5jb25maWd1cmVUZXN0aW5nTW9kdWxlKHsKICAgIGRlY2xhcmF0aW9uczogWyBNeUNvbXBvbmVudCBdLAogICAgcHJvdmlkZXJzOiBbCiAgICAgIHsgcHJvdmlkZTogTXlTZXJ2aWNlLCB1c2VDbGFzczogTW9ja015U2VydmljZSB9CiAgICBdCiAgfSkKICAuY29tcGlsZUNvbXBvbmVudHMoKTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class MockMyService {
  getValue() {
    return 'mock value';
  }
}

beforeEach(async () =&gt; {
  await TestBed.configureTestingModule({
    declarations: [ MyComponent ],
    providers: [
      { provide: MyService, useClass: MockMyService }
    ]
  })
  .compileComponents();
});</pre></div><div class='content'></div><h2>Espies</h2>
<div class='content'><p>Podem utilitzar espies per verificar que els mètodes dels serveis es criden correctament.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aXQoJ3Nob3VsZCBjYWxsIGdldFZhbHVlIGZyb20gTXlTZXJ2aWNlJywgKCkgPT4gewogIGNvbnN0IG15U2VydmljZSA9IFRlc3RCZWQuaW5qZWN0KE15U2VydmljZSk7CiAgc3B5T24obXlTZXJ2aWNlLCAnZ2V0VmFsdWUnKS5hbmQucmV0dXJuVmFsdWUoJ21vY2sgdmFsdWUnKTsKICBjb21wb25lbnQubmdPbkluaXQoKTsKICBleHBlY3QobXlTZXJ2aWNlLmdldFZhbHVlKS50b0hhdmVCZWVuQ2FsbGVkKCk7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>it('should call getValue from MyService', () =&gt; {
  const myService = TestBed.inject(MyService);
  spyOn(myService, 'getValue').and.returnValue('mock value');
  component.ngOnInit();
  expect(myService.getValue).toHaveBeenCalled();
});</pre></div><div class='content'></div><h1>4. Executar i interpretar els resultats de les proves</h1>
<div class='content'><p>Per executar les proves, utilitzem el següent comandament:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bmcgdGVzdA=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ng test</pre></div><div class='content'><p>Aquest comandament executarà Karma, que correrà totes les proves i mostrarà els resultats en una finestra del navegador.</p>
</div><h2>Interpretació dels resultats</h2>
<div class='content'><ul>
<li><strong>Verd</strong>: La prova ha passat correctament.</li>
<li><strong>Vermell</strong>: La prova ha fallat. Karma mostrarà un missatge d'error amb informació sobre la causa del fall.</li>
</ul>
</div><h1>Resum</h1>
<div class='content'><p>En aquesta secció, hem après com configurar i escriure proves unitàries per a components Angular. Hem vist com utilitzar mocks i espies per aïllar les proves i com executar-les utilitzant Karma. Les proves de components són essencials per assegurar la qualitat i la fiabilitat de les nostres aplicacions Angular.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='09-01-unit-testing' title="Proves unitàries">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='09-03-service-testing' title="Proves de serveis">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
