<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA i Arbres de Comportament</title>

    <link rel="alternate" href="https://campusempresa.com/mod/unreal_engine/04-02-ai-and-behavior-trees" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/unreal_engine/04-02-ia-i-arbres-de-comportament" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/unreal_engine/04-02-ai-and-behavior-trees" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/unreal_engine/04-02-ai-and-behavior-trees" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/unreal_engine/04-02-ai-and-behavior-trees" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-01-scripting-amb-blueprints' title="Scripting amb Blueprints">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">IA i Arbres de Comportament</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='04-03-blueprints-d-animacio' title="Blueprints d'Animació">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1><p>Introducció</p>
</h1>
<div class='content'><p>En aquest tema, explorarem com crear intel·ligència artificial (IA) en Unreal Engine utilitzant arbres de comportament. Els arbres de comportament són una eina poderosa per definir el comportament dels personatges no jugadors (NPCs) de manera modular i escalable.</p>
</div><h1><p>Objectius</p>
</h1>
<div class='content'><ul>
<li>Entendre què són els arbres de comportament.</li>
<li>Aprendre a crear i configurar un arbre de comportament bàsic.</li>
<li>Implementar tasques, serveis i decoradors per definir el comportament de la IA.</li>
<li>Integrar l'arbre de comportament amb un personatge en el joc.</li>
</ul>
</div><h1><p>Què són els Arbres de Comportament?</p>
</h1>
<div class='content'><p>Els arbres de comportament són una estructura de dades que permet definir el comportament d'un agent de manera jeràrquica. Cada node de l'arbre representa una acció o una decisió que l'agent pot prendre.</p>
</div><h2><p>Components Principals</p>
</h2>
<div class='content'><ol>
<li><strong>Tasques (Tasks)</strong>: Accions que l'agent pot realitzar.</li>
<li><strong>Serveis (Services)</strong>: Funcions que s'executen periòdicament per actualitzar informació.</li>
<li><strong>Decoradors (Decorators)</strong>: Condicions que determinen si un node es pot executar.</li>
</ol>
</div><h1><p>Creant un Arbre de Comportament Bàsic</p>
</h1>
<div class='content'></div><h2><p>Pas 1: Crear un Arbre de Comportament</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Crear un nou Arbre de Comportament</strong>:</p>
<ul>
<li>A l'editor de contingut, feu clic amb el botó dret i seleccioneu <code>Blueprint Class</code>.</li>
<li>Trieu <code>Behavior Tree</code> com a tipus de classe.</li>
<li>Doneu-li un nom, per exemple, <code>BT_NPCBehavior</code>.</li>
</ul>
</li>
<li>
<p><strong>Obrir l'Arbre de Comportament</strong>:</p>
<ul>
<li>Feu doble clic sobre el nou arbre de comportament per obrir l'editor d'arbres de comportament.</li>
</ul>
</li>
</ol>
</div><h2><p>Pas 2: Afegir un Selector i una Tasca</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Afegir un Selector</strong>:</p>
<ul>
<li>Arrossegueu un node <code>Selector</code> des del panell de nodes i col·loqueu-lo com a node arrel.</li>
</ul>
</li>
<li>
<p><strong>Afegir una Tasca</strong>:</p>
<ul>
<li>Arrossegueu un node <code>Task</code> i connecteu-lo al <code>Selector</code>.</li>
<li>Seleccioneu la tasca i, a la finestra de detalls, trieu una tasca predefinida o creeu-ne una de nova.</li>
</ul>
</li>
</ol>
</div><h2><p>Exemple de Codi: Tasca Personalitzada</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gTXlUYXNrLmNwcAojaW5jbHVkZSAiTXlUYXNrLmgiCiNpbmNsdWRlICJBSUNvbnRyb2xsZXIuaCIKI2luY2x1ZGUgIkdhbWVGcmFtZXdvcmsvQWN0b3IuaCIKClVNeVRhc2s6OlVNeVRhc2soKQp7CiAgICBOb2RlTmFtZSA9ICJNb3ZlIFRvIFRhcmdldCI7Cn0KCkVCVE5vZGVSZXN1bHQ6OlR5cGUgVU15VGFzazo6RXhlY3V0ZVRhc2soVUJlaGF2aW9yVHJlZUNvbXBvbmVudCYgT3duZXJDb21wLCB1aW50OCogTm9kZU1lbW9yeSkKewogICAgQUFJQ29udHJvbGxlciogQUlDb24gPSBPd25lckNvbXAuR2V0QUlPd25lcigpOwogICAgaWYgKEFJQ29uKQogICAgewogICAgICAgIEFBY3RvciogVGFyZ2V0QWN0b3IgPSBDYXN0PEFBY3Rvcj4oT3duZXJDb21wLkdldEJsYWNrYm9hcmRDb21wb25lbnQoKS0+R2V0VmFsdWVBc09iamVjdCgiVGFyZ2V0QWN0b3IiKSk7CiAgICAgICAgaWYgKFRhcmdldEFjdG9yKQogICAgICAgIHsKICAgICAgICAgICAgQUlDb24tPk1vdmVUb0FjdG9yKFRhcmdldEFjdG9yKTsKICAgICAgICAgICAgcmV0dXJuIEVCVE5vZGVSZXN1bHQ6OlN1Y2NlZWRlZDsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gRUJUTm9kZVJlc3VsdDo6RmFpbGVkOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// MyTask.cpp
#include &quot;MyTask.h&quot;
#include &quot;AIController.h&quot;
#include &quot;GameFramework/Actor.h&quot;

UMyTask::UMyTask()
{
    NodeName = &quot;Move To Target&quot;;
}

EBTNodeResult::Type UMyTask::ExecuteTask(UBehaviorTreeComponent&amp; OwnerComp, uint8* NodeMemory)
{
    AAIController* AICon = OwnerComp.GetAIOwner();
    if (AICon)
    {
        AActor* TargetActor = Cast&lt;AActor&gt;(OwnerComp.GetBlackboardComponent()-&gt;GetValueAsObject(&quot;TargetActor&quot;));
        if (TargetActor)
        {
            AICon-&gt;MoveToActor(TargetActor);
            return EBTNodeResult::Succeeded;
        }
    }
    return EBTNodeResult::Failed;
}</pre></div><div class='content'></div><h2><p>Pas 3: Configurar el Blackboard</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Crear un Blackboard</strong>:</p>
<ul>
<li>A l'editor de contingut, feu clic amb el botó dret i seleccioneu <code>Blueprint Class</code>.</li>
<li>Trieu <code>Blackboard</code> com a tipus de classe.</li>
<li>Doneu-li un nom, per exemple, <code>BB_NPCBlackboard</code>.</li>
</ul>
</li>
<li>
<p><strong>Afegir Clau de Blackboard</strong>:</p>
<ul>
<li>Obriu el <code>Blackboard</code> i afegiu una nova clau de tipus <code>Object</code> anomenada <code>TargetActor</code>.</li>
</ul>
</li>
</ol>
</div><h2><p>Pas 4: Integrar l'Arbre de Comportament amb el Personatge</p>
</h2>
<div class='content'><ol>
<li><strong>Assignar l'Arbre de Comportament i el Blackboard</strong>:
<ul>
<li>A l'editor de personatges, seleccioneu el component <code>AIController</code>.</li>
<li>A la finestra de detalls, assignar l'arbre de comportament i el blackboard creats anteriorment.</li>
</ul>
</li>
</ol>
</div><h1><p>Exercici Pràctic</p>
</h1>
<div class='content'></div><h2><p>Objectiu</p>
</h2>
<div class='content'><p>Crear un NPC que es mogui cap a un objectiu especificat.</p>
</div><h2><p>Passos</p>
</h2>
<div class='content'><ol>
<li><strong>Crear un nou Arbre de Comportament i Blackboard</strong>.</li>
<li><strong>Afegir un Selector i una Tasca per moure's cap a l'objectiu</strong>.</li>
<li><strong>Configurar el Blackboard amb una clau <code>TargetActor</code></strong>.</li>
<li><strong>Assignar l'Arbre de Comportament i el Blackboard al NPC</strong>.</li>
</ol>
</div><h2><p>Solució</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gTXlUYXNrLmNwcAojaW5jbHVkZSAiTXlUYXNrLmgiCiNpbmNsdWRlICJBSUNvbnRyb2xsZXIuaCIKI2luY2x1ZGUgIkdhbWVGcmFtZXdvcmsvQWN0b3IuaCIKClVNeVRhc2s6OlVNeVRhc2soKQp7CiAgICBOb2RlTmFtZSA9ICJNb3ZlIFRvIFRhcmdldCI7Cn0KCkVCVE5vZGVSZXN1bHQ6OlR5cGUgVU15VGFzazo6RXhlY3V0ZVRhc2soVUJlaGF2aW9yVHJlZUNvbXBvbmVudCYgT3duZXJDb21wLCB1aW50OCogTm9kZU1lbW9yeSkKewogICAgQUFJQ29udHJvbGxlciogQUlDb24gPSBPd25lckNvbXAuR2V0QUlPd25lcigpOwogICAgaWYgKEFJQ29uKQogICAgewogICAgICAgIEFBY3RvciogVGFyZ2V0QWN0b3IgPSBDYXN0PEFBY3Rvcj4oT3duZXJDb21wLkdldEJsYWNrYm9hcmRDb21wb25lbnQoKS0+R2V0VmFsdWVBc09iamVjdCgiVGFyZ2V0QWN0b3IiKSk7CiAgICAgICAgaWYgKFRhcmdldEFjdG9yKQogICAgICAgIHsKICAgICAgICAgICAgQUlDb24tPk1vdmVUb0FjdG9yKFRhcmdldEFjdG9yKTsKICAgICAgICAgICAgcmV0dXJuIEVCVE5vZGVSZXN1bHQ6OlN1Y2NlZWRlZDsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gRUJUTm9kZVJlc3VsdDo6RmFpbGVkOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// MyTask.cpp
#include &quot;MyTask.h&quot;
#include &quot;AIController.h&quot;
#include &quot;GameFramework/Actor.h&quot;

UMyTask::UMyTask()
{
    NodeName = &quot;Move To Target&quot;;
}

EBTNodeResult::Type UMyTask::ExecuteTask(UBehaviorTreeComponent&amp; OwnerComp, uint8* NodeMemory)
{
    AAIController* AICon = OwnerComp.GetAIOwner();
    if (AICon)
    {
        AActor* TargetActor = Cast&lt;AActor&gt;(OwnerComp.GetBlackboardComponent()-&gt;GetValueAsObject(&quot;TargetActor&quot;));
        if (TargetActor)
        {
            AICon-&gt;MoveToActor(TargetActor);
            return EBTNodeResult::Succeeded;
        }
    }
    return EBTNodeResult::Failed;
}</pre></div><div class='content'></div><h1><p>Errors Comuns i Consells</p>
</h1>
<div class='content'><ul>
<li>
<p><strong>Error: L'NPC no es mou</strong>:</p>
<ul>
<li>Assegureu-vos que el <code>TargetActor</code> està configurat correctament al <code>Blackboard</code>.</li>
<li>Verifiqueu que l'AIController està assignat correctament al personatge.</li>
</ul>
</li>
<li>
<p><strong>Consell</strong>:</p>
<ul>
<li>Utilitzeu serveis per actualitzar periòdicament la informació del <code>Blackboard</code>.</li>
<li>Utilitzeu decoradors per controlar la lògica de decisió de manera més eficient.</li>
</ul>
</li>
</ul>
</div><h1><p>Conclusió</p>
</h1>
<div class='content'><p>En aquesta secció, hem après a crear i configurar un arbre de comportament bàsic per a la IA en Unreal Engine. Hem vist com utilitzar tasques, serveis i decoradors per definir el comportament dels NPCs i com integrar l'arbre de comportament amb un personatge en el joc. Amb aquests coneixements, podeu començar a crear comportaments més complexos i realistes per als vostres personatges no jugadors.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-01-scripting-amb-blueprints' title="Scripting amb Blueprints">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='04-03-blueprints-d-animacio' title="Blueprints d'Animació">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
