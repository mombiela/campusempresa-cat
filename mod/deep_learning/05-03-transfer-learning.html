<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transfer Learning</title>

    <link rel="alternate" href="https://campusempresa.com/mod/deep_learning/05-03-transfer-learning" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/deep_learning/05-03-transfer-learning" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/deep_learning/05-03-transfer-learning" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/deep_learning/05-03-transfer-learning" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/deep_learning/05-03-transfer-learning" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-autoencoders' title="Autoencoders">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Transfer Learning</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-regularizacion-tecnicas-mejora' title="Regularització i tècniques de millora">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1><p>Introducció a Transfer Learning</p>
</h1>
<div class='content'><p>Transfer Learning és una tècnica en Deep Learning on un model desenvolupat per a una tasca inicial es reutilitza com a punt de partida per a un model en una tasca diferent però relacionada. Aquesta tècnica és especialment útil quan no es disposa d'una gran quantitat de dades per entrenar un model des de zero.</p>
</div><h2><p>Conceptes Clau</p>
</h2>
<div class='content'><ol>
<li><strong>Model Preentrenat</strong>: Un model que ha estat entrenat en una gran base de dades per a una tasca específica, com ara la classificació d'imatges.</li>
<li><strong>Fine-Tuning</strong>: Ajustar els pesos d'un model preentrenat a una nova tasca amb un conjunt de dades més petit.</li>
<li><strong>Feature Extraction</strong>: Utilitzar les capes inicials d'un model preentrenat per extreure característiques i només entrenar les capes finals per a la nova tasca.</li>
</ol>
</div><h2><p>Avantatges del Transfer Learning</p>
</h2>
<div class='content'><ul>
<li><strong>Reducció del temps d'entrenament</strong>: Comença amb un model que ja ha après característiques útils.</li>
<li><strong>Millora del rendiment</strong>: Els models preentrenats solen tenir millor rendiment que els models entrenats des de zero amb petites quantitats de dades.</li>
<li><strong>Menor necessitat de dades</strong>: Permet utilitzar menys dades per obtenir bons resultats.</li>
</ul>
</div><h1><p>Exemples de Transfer Learning</p>
</h1>
<div class='content'></div><h2><p>Exemple 1: Transfer Learning amb Keras</p>
</h2>
<div class='content'><p>A continuació, es mostra un exemple pràctic de Transfer Learning utilitzant Keras amb un model preentrenat com VGG16 per a la classificació d'imatges.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmFwcGxpY2F0aW9ucyBpbXBvcnQgVkdHMTYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLm1vZGVscyBpbXBvcnQgTW9kZWwKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmxheWVycyBpbXBvcnQgRGVuc2UsIEZsYXR0ZW4KZnJvbSB0ZW5zb3JmbG93LmtlcmFzLnByZXByb2Nlc3NpbmcuaW1hZ2UgaW1wb3J0IEltYWdlRGF0YUdlbmVyYXRvcgoKIyBDYXJyZWdhciBlbCBtb2RlbCBWR0cxNiBwcmVlbnRyZW5hdCBzZW5zZSBsZXMgY2FwZXMgZGUgY2xhc3NpZmljYWNpw7MKYmFzZV9tb2RlbCA9IFZHRzE2KHdlaWdodHM9J2ltYWdlbmV0JywgaW5jbHVkZV90b3A9RmFsc2UsIGlucHV0X3NoYXBlPSgyMjQsIDIyNCwgMykpCgojIENvbmdlbGFyIGxlcyBjYXBlcyBkZWwgbW9kZWwgYmFzZQpmb3IgbGF5ZXIgaW4gYmFzZV9tb2RlbC5sYXllcnM6CiAgICBsYXllci50cmFpbmFibGUgPSBGYWxzZQoKIyBBZmVnaXIgbm92ZXMgY2FwZXMgZGUgY2xhc3NpZmljYWNpw7MKeCA9IGJhc2VfbW9kZWwub3V0cHV0CnggPSBGbGF0dGVuKCkoeCkKeCA9IERlbnNlKDEwMjQsIGFjdGl2YXRpb249J3JlbHUnKSh4KQpwcmVkaWN0aW9ucyA9IERlbnNlKDEwLCBhY3RpdmF0aW9uPSdzb2Z0bWF4JykoeCkKCiMgQ3JlYXIgZWwgbm91IG1vZGVsCm1vZGVsID0gTW9kZWwoaW5wdXRzPWJhc2VfbW9kZWwuaW5wdXQsIG91dHB1dHM9cHJlZGljdGlvbnMpCgojIENvbXBpbGFyIGVsIG1vZGVsCm1vZGVsLmNvbXBpbGUob3B0aW1pemVyPSdhZGFtJywgbG9zcz0nY2F0ZWdvcmljYWxfY3Jvc3NlbnRyb3B5JywgbWV0cmljcz1bJ2FjY3VyYWN5J10pCgojIFByZXBhcmFyIGxlcyBkYWRlcwp0cmFpbl9kYXRhZ2VuID0gSW1hZ2VEYXRhR2VuZXJhdG9yKHJlc2NhbGU9MS4vMjU1KQp0cmFpbl9nZW5lcmF0b3IgPSB0cmFpbl9kYXRhZ2VuLmZsb3dfZnJvbV9kaXJlY3RvcnkoCiAgICAnZGF0YS90cmFpbicsCiAgICB0YXJnZXRfc2l6ZT0oMjI0LCAyMjQpLAogICAgYmF0Y2hfc2l6ZT0zMiwKICAgIGNsYXNzX21vZGU9J2NhdGVnb3JpY2FsJwopCgojIEVudHJlbmFyIGVsIG1vZGVsCm1vZGVsLmZpdCh0cmFpbl9nZW5lcmF0b3IsIGVwb2Nocz0xMCwgc3RlcHNfcGVyX2Vwb2NoPTEwMCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.applications import VGG16
from tensorflow.keras.models import Model
from tensorflow.keras.layers import Dense, Flatten
from tensorflow.keras.preprocessing.image import ImageDataGenerator

# Carregar el model VGG16 preentrenat sense les capes de classificaci&oacute;
base_model = VGG16(weights='imagenet', include_top=False, input_shape=(224, 224, 3))

# Congelar les capes del model base
for layer in base_model.layers:
    layer.trainable = False

# Afegir noves capes de classificaci&oacute;
x = base_model.output
x = Flatten()(x)
x = Dense(1024, activation='relu')(x)
predictions = Dense(10, activation='softmax')(x)

# Crear el nou model
model = Model(inputs=base_model.input, outputs=predictions)

# Compilar el model
model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])

# Preparar les dades
train_datagen = ImageDataGenerator(rescale=1./255)
train_generator = train_datagen.flow_from_directory(
    'data/train',
    target_size=(224, 224),
    batch_size=32,
    class_mode='categorical'
)

# Entrenar el model
model.fit(train_generator, epochs=10, steps_per_epoch=100)</pre></div><div class='content'></div><h2><p>Exemple 2: Transfer Learning amb PyTorch</p>
</h2>
<div class='content'><p>A continuació, es mostra un exemple pràctic de Transfer Learning utilitzant PyTorch amb un model preentrenat com ResNet50 per a la classificació d'imatges.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgppbXBvcnQgdG9yY2gub3B0aW0gYXMgb3B0aW0KZnJvbSB0b3JjaHZpc2lvbiBpbXBvcnQgZGF0YXNldHMsIG1vZGVscywgdHJhbnNmb3JtcwoKIyBEZWZpbmlyIGxlcyB0cmFuc2Zvcm1hY2lvbnMgcGVyIGEgbGVzIGRhZGVzIGQnZW50cmVuYW1lbnQKZGF0YV90cmFuc2Zvcm1zID0gdHJhbnNmb3Jtcy5Db21wb3NlKFsKICAgIHRyYW5zZm9ybXMuUmVzaXplKCgyMjQsIDIyNCkpLAogICAgdHJhbnNmb3Jtcy5Ub1RlbnNvcigpLApdKQoKIyBDYXJyZWdhciBsZXMgZGFkZXMgZCdlbnRyZW5hbWVudAp0cmFpbl9kYXRhc2V0ID0gZGF0YXNldHMuSW1hZ2VGb2xkZXIoJ2RhdGEvdHJhaW4nLCB0cmFuc2Zvcm09ZGF0YV90cmFuc2Zvcm1zKQp0cmFpbl9sb2FkZXIgPSB0b3JjaC51dGlscy5kYXRhLkRhdGFMb2FkZXIodHJhaW5fZGF0YXNldCwgYmF0Y2hfc2l6ZT0zMiwgc2h1ZmZsZT1UcnVlKQoKIyBDYXJyZWdhciBlbCBtb2RlbCBSZXNOZXQ1MCBwcmVlbnRyZW5hdAptb2RlbCA9IG1vZGVscy5yZXNuZXQ1MChwcmV0cmFpbmVkPVRydWUpCgojIENvbmdlbGFyIGxlcyBjYXBlcyBkZWwgbW9kZWwgYmFzZQpmb3IgcGFyYW0gaW4gbW9kZWwucGFyYW1ldGVycygpOgogICAgcGFyYW0ucmVxdWlyZXNfZ3JhZCA9IEZhbHNlCgojIEFmZWdpciBub3ZlcyBjYXBlcyBkZSBjbGFzc2lmaWNhY2nDswpudW1fZnRycyA9IG1vZGVsLmZjLmluX2ZlYXR1cmVzCm1vZGVsLmZjID0gbm4uU2VxdWVudGlhbCgKICAgIG5uLkxpbmVhcihudW1fZnRycywgMTAyNCksCiAgICBubi5SZUxVKCksCiAgICBubi5MaW5lYXIoMTAyNCwgMTApLAogICAgbm4uU29mdG1heChkaW09MSkKKQoKIyBEZWZpbmlyIGxhIGZ1bmNpw7MgZGUgcMOocmR1YSBpIGwnb3B0aW1pdHphZG9yCmNyaXRlcmlvbiA9IG5uLkNyb3NzRW50cm9weUxvc3MoKQpvcHRpbWl6ZXIgPSBvcHRpbS5BZGFtKG1vZGVsLmZjLnBhcmFtZXRlcnMoKSwgbHI9MC4wMDEpCgojIEVudHJlbmFyIGVsIG1vZGVsCm1vZGVsLnRyYWluKCkKZm9yIGVwb2NoIGluIHJhbmdlKDEwKToKICAgIHJ1bm5pbmdfbG9zcyA9IDAuMAogICAgZm9yIGlucHV0cywgbGFiZWxzIGluIHRyYWluX2xvYWRlcjoKICAgICAgICBvcHRpbWl6ZXIuemVyb19ncmFkKCkKICAgICAgICBvdXRwdXRzID0gbW9kZWwoaW5wdXRzKQogICAgICAgIGxvc3MgPSBjcml0ZXJpb24ob3V0cHV0cywgbGFiZWxzKQogICAgICAgIGxvc3MuYmFja3dhcmQoKQogICAgICAgIG9wdGltaXplci5zdGVwKCkKICAgICAgICBydW5uaW5nX2xvc3MgKz0gbG9zcy5pdGVtKCkKICAgIHByaW50KGYnRXBvY2gge2Vwb2NoKzF9LCBMb3NzOiB7cnVubmluZ19sb3NzL2xlbih0cmFpbl9sb2FkZXIpfScp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
import torch.nn as nn
import torch.optim as optim
from torchvision import datasets, models, transforms

# Definir les transformacions per a les dades d'entrenament
data_transforms = transforms.Compose([
    transforms.Resize((224, 224)),
    transforms.ToTensor(),
])

# Carregar les dades d'entrenament
train_dataset = datasets.ImageFolder('data/train', transform=data_transforms)
train_loader = torch.utils.data.DataLoader(train_dataset, batch_size=32, shuffle=True)

# Carregar el model ResNet50 preentrenat
model = models.resnet50(pretrained=True)

# Congelar les capes del model base
for param in model.parameters():
    param.requires_grad = False

# Afegir noves capes de classificaci&oacute;
num_ftrs = model.fc.in_features
model.fc = nn.Sequential(
    nn.Linear(num_ftrs, 1024),
    nn.ReLU(),
    nn.Linear(1024, 10),
    nn.Softmax(dim=1)
)

# Definir la funci&oacute; de p&egrave;rdua i l'optimitzador
criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.fc.parameters(), lr=0.001)

# Entrenar el model
model.train()
for epoch in range(10):
    running_loss = 0.0
    for inputs, labels in train_loader:
        optimizer.zero_grad()
        outputs = model(inputs)
        loss = criterion(outputs, labels)
        loss.backward()
        optimizer.step()
        running_loss += loss.item()
    print(f'Epoch {epoch+1}, Loss: {running_loss/len(train_loader)}')</pre></div><div class='content'></div><h1><p>Exercici Pràctic</p>
</h1>
<div class='content'></div><h2><p>Exercici: Transfer Learning amb MobileNetV2</p>
</h2>
<div class='content'><ol>
<li>Carrega el model MobileNetV2 preentrenat utilitzant Keras.</li>
<li>Congela les capes del model base.</li>
<li>Afegiu noves capes de classificació per a una tasca de classificació amb 5 classes.</li>
<li>Entrena el model amb un conjunt de dades d'imatges.</li>
</ol>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmFwcGxpY2F0aW9ucyBpbXBvcnQgTW9iaWxlTmV0VjIKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLm1vZGVscyBpbXBvcnQgTW9kZWwKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmxheWVycyBpbXBvcnQgRGVuc2UsIEZsYXR0ZW4KZnJvbSB0ZW5zb3JmbG93LmtlcmFzLnByZXByb2Nlc3NpbmcuaW1hZ2UgaW1wb3J0IEltYWdlRGF0YUdlbmVyYXRvcgoKIyBDYXJyZWdhciBlbCBtb2RlbCBNb2JpbGVOZXRWMiBwcmVlbnRyZW5hdCBzZW5zZSBsZXMgY2FwZXMgZGUgY2xhc3NpZmljYWNpw7MKYmFzZV9tb2RlbCA9IE1vYmlsZU5ldFYyKHdlaWdodHM9J2ltYWdlbmV0JywgaW5jbHVkZV90b3A9RmFsc2UsIGlucHV0X3NoYXBlPSgyMjQsIDIyNCwgMykpCgojIENvbmdlbGFyIGxlcyBjYXBlcyBkZWwgbW9kZWwgYmFzZQpmb3IgbGF5ZXIgaW4gYmFzZV9tb2RlbC5sYXllcnM6CiAgICBsYXllci50cmFpbmFibGUgPSBGYWxzZQoKIyBBZmVnaXIgbm92ZXMgY2FwZXMgZGUgY2xhc3NpZmljYWNpw7MKeCA9IGJhc2VfbW9kZWwub3V0cHV0CnggPSBGbGF0dGVuKCkoeCkKeCA9IERlbnNlKDUxMiwgYWN0aXZhdGlvbj0ncmVsdScpKHgpCnByZWRpY3Rpb25zID0gRGVuc2UoNSwgYWN0aXZhdGlvbj0nc29mdG1heCcpKHgpCgojIENyZWFyIGVsIG5vdSBtb2RlbAptb2RlbCA9IE1vZGVsKGlucHV0cz1iYXNlX21vZGVsLmlucHV0LCBvdXRwdXRzPXByZWRpY3Rpb25zKQoKIyBDb21waWxhciBlbCBtb2RlbAptb2RlbC5jb21waWxlKG9wdGltaXplcj0nYWRhbScsIGxvc3M9J2NhdGVnb3JpY2FsX2Nyb3NzZW50cm9weScsIG1ldHJpY3M9WydhY2N1cmFjeSddKQoKIyBQcmVwYXJhciBsZXMgZGFkZXMKdHJhaW5fZGF0YWdlbiA9IEltYWdlRGF0YUdlbmVyYXRvcihyZXNjYWxlPTEuLzI1NSkKdHJhaW5fZ2VuZXJhdG9yID0gdHJhaW5fZGF0YWdlbi5mbG93X2Zyb21fZGlyZWN0b3J5KAogICAgJ2RhdGEvdHJhaW4nLAogICAgdGFyZ2V0X3NpemU9KDIyNCwgMjI0KSwKICAgIGJhdGNoX3NpemU9MzIsCiAgICBjbGFzc19tb2RlPSdjYXRlZ29yaWNhbCcKKQoKIyBFbnRyZW5hciBlbCBtb2RlbAptb2RlbC5maXQodHJhaW5fZ2VuZXJhdG9yLCBlcG9jaHM9MTAsIHN0ZXBzX3Blcl9lcG9jaD0xMDAp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.applications import MobileNetV2
from tensorflow.keras.models import Model
from tensorflow.keras.layers import Dense, Flatten
from tensorflow.keras.preprocessing.image import ImageDataGenerator

# Carregar el model MobileNetV2 preentrenat sense les capes de classificaci&oacute;
base_model = MobileNetV2(weights='imagenet', include_top=False, input_shape=(224, 224, 3))

# Congelar les capes del model base
for layer in base_model.layers:
    layer.trainable = False

# Afegir noves capes de classificaci&oacute;
x = base_model.output
x = Flatten()(x)
x = Dense(512, activation='relu')(x)
predictions = Dense(5, activation='softmax')(x)

# Crear el nou model
model = Model(inputs=base_model.input, outputs=predictions)

# Compilar el model
model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])

# Preparar les dades
train_datagen = ImageDataGenerator(rescale=1./255)
train_generator = train_datagen.flow_from_directory(
    'data/train',
    target_size=(224, 224),
    batch_size=32,
    class_mode='categorical'
)

# Entrenar el model
model.fit(train_generator, epochs=10, steps_per_epoch=100)</pre></div><div class='content'></div><h1><p>Resum</p>
</h1>
<div class='content'><p>En aquesta secció, hem après què és el Transfer Learning, els seus avantatges i com implementar-lo utilitzant Keras i PyTorch. També hem vist exemples pràctics i hem realitzat un exercici per consolidar els coneixements adquirits. Transfer Learning és una eina poderosa que pot millorar significativament el rendiment dels models de Deep Learning, especialment quan es disposa de dades limitades.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-autoencoders' title="Autoencoders">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-regularizacion-tecnicas-mejora' title="Regularització i tècniques de millora">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
