<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MapReduce i Hadoop</title>

    <link rel="alternate" href="https://campusempresa.com/mod/big_data/03-01-mapreduce-hadoop" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/big_data/03-01-mapreduce-hadoop" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/big_data/03-01-mapreduce-hadoop" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
							<a href="https://enterprisecampus.net/mod/big_data/03-01-mapreduce-hadoop" class="px-2">EN</a></b>
				|
				<a href="https://campusempresa.com/mod/big_data/03-01-mapreduce-hadoop" class="px-2">ES</a></b>
				|
				<b class="px-2">CA</b>
											</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Projecte</a>
				<a href="/about">Sobre nosaltres</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donacions</a>
				<a href="/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='02-03-data-lakes' title="Data Lakes">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">MapReduce i Hadoop</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-apache-spark' title="Apache Spark">Següent &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1><p>Introducció</p>
</h1>
<div class='content'><p>En aquest tema, explorarem MapReduce i Hadoop, dues tecnologies fonamentals per al processament de grans volums de dades. MapReduce és un model de programació que permet el processament paral·lel de grans conjunts de dades, mentre que Hadoop és un marc de treball que implementa aquest model i proporciona una infraestructura robusta per al processament distribuït.</p>
</div><h1><p>Objectius</p>
</h1>
<div class='content'><ul>
<li>Entendre el concepte de MapReduce i com funciona.</li>
<li>Aprendre sobre l'arquitectura de Hadoop i els seus components principals.</li>
<li>Implementar un exemple pràctic de MapReduce utilitzant Hadoop.</li>
</ul>
</div><h1><p>Conceptes Clau</p>
</h1>
<div class='content'></div><h2><p>MapReduce</p>
</h2>
<div class='content'><p>MapReduce és un model de programació desenvolupat per Google per processar grans conjunts de dades de manera paral·lela. Consta de dues fases principals:</p>
<ol>
<li>
<p><strong>Map</strong>: Aquesta fase pren un conjunt de dades d'entrada i el divideix en parelles clau-valor. Cada parella és processada per una funció de map que genera una llista intermèdia de parelles clau-valor.</p>
</li>
<li>
<p><strong>Reduce</strong>: Aquesta fase pren la llista intermèdia generada per la fase de map i combina les parelles clau-valor amb la mateixa clau per produir el resultat final.</p>
</li>
</ol>
</div><h2><p>Hadoop</p>
</h2>
<div class='content'><p>Hadoop és un marc de treball de codi obert que implementa el model de MapReduce i proporciona una infraestructura per al processament distribuït de grans volums de dades. Els components principals de Hadoop són:</p>
<ul>
<li><strong>Hadoop Distributed File System (HDFS)</strong>: Un sistema de fitxers distribuït que emmagatzema les dades en múltiples màquines.</li>
<li><strong>YARN (Yet Another Resource Negotiator)</strong>: Un sistema de gestió de recursos que coordina l'execució de les aplicacions.</li>
<li><strong>MapReduce</strong>: El motor de processament que executa les tasques de MapReduce.</li>
</ul>
</div><h1><p>Arquitectura de Hadoop</p>
</h1>
<div class='content'><p>A continuació es mostra una taula que resumeix els components principals de Hadoop i les seves funcions:</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Funció</th>
</tr>
</thead>
<tbody>
<tr>
<td>HDFS</td>
<td>Emmagatzematge distribuït de dades</td>
</tr>
<tr>
<td>YARN</td>
<td>Gestió de recursos i planificació de tasques</td>
</tr>
<tr>
<td>MapReduce</td>
<td>Processament de dades en paral·lel</td>
</tr>
</tbody>
</table>
</div><h1><p>Exemple Pràctic de MapReduce amb Hadoop</p>
</h1>
<div class='content'></div><h2><p>Pas 1: Instal·lació de Hadoop</p>
</h2>
<div class='content'><p>Abans de començar, assegura't de tenir Hadoop instal·lat i configurat al teu sistema. Pots seguir la <a href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html">guia oficial d'instal·lació de Hadoop</a>.</p>
</div><h2><p>Pas 2: Escriptura del Codi MapReduce</p>
</h2>
<div class='content'><p>A continuació es mostra un exemple de codi MapReduce en Java per comptar la freqüència de paraules en un conjunt de dades:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuaGFkb29wLmNvbmYuQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGFkb29wLmZzLlBhdGg7CmltcG9ydCBvcmcuYXBhY2hlLmhhZG9vcC5pby5JbnRXcml0YWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGFkb29wLmlvLlRleHQ7CmltcG9ydCBvcmcuYXBhY2hlLmhhZG9vcC5tYXByZWR1Y2UuSm9iOwppbXBvcnQgb3JnLmFwYWNoZS5oYWRvb3AubWFwcmVkdWNlLk1hcHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGFkb29wLm1hcHJlZHVjZS5SZWR1Y2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oYWRvb3AubWFwcmVkdWNlLmxpYi5pbnB1dC5GaWxlSW5wdXRGb3JtYXQ7CmltcG9ydCBvcmcuYXBhY2hlLmhhZG9vcC5tYXByZWR1Y2UubGliLm91dHB1dC5GaWxlT3V0cHV0Rm9ybWF0OwoKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuU3RyaW5nVG9rZW5pemVyOwoKcHVibGljIGNsYXNzIFdvcmRDb3VudCB7CgogICAgcHVibGljIHN0YXRpYyBjbGFzcyBUb2tlbml6ZXJNYXBwZXIgZXh0ZW5kcyBNYXBwZXI8T2JqZWN0LCBUZXh0LCBUZXh0LCBJbnRXcml0YWJsZT4gewoKICAgICAgICBwcml2YXRlIGZpbmFsIHN0YXRpYyBJbnRXcml0YWJsZSBvbmUgPSBuZXcgSW50V3JpdGFibGUoMSk7CiAgICAgICAgcHJpdmF0ZSBUZXh0IHdvcmQgPSBuZXcgVGV4dCgpOwoKICAgICAgICBwdWJsaWMgdm9pZCBtYXAoT2JqZWN0IGtleSwgVGV4dCB2YWx1ZSwgQ29udGV4dCBjb250ZXh0KSB0aHJvd3MgSU9FeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAgICAgICAgICAgU3RyaW5nVG9rZW5pemVyIGl0ciA9IG5ldyBTdHJpbmdUb2tlbml6ZXIodmFsdWUudG9TdHJpbmcoKSk7CiAgICAgICAgICAgIHdoaWxlIChpdHIuaGFzTW9yZVRva2VucygpKSB7CiAgICAgICAgICAgICAgICB3b3JkLnNldChpdHIubmV4dFRva2VuKCkpOwogICAgICAgICAgICAgICAgY29udGV4dC53cml0ZSh3b3JkLCBvbmUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgSW50U3VtUmVkdWNlciBleHRlbmRzIFJlZHVjZXI8VGV4dCwgSW50V3JpdGFibGUsIFRleHQsIEludFdyaXRhYmxlPiB7CiAgICAgICAgcHJpdmF0ZSBJbnRXcml0YWJsZSByZXN1bHQgPSBuZXcgSW50V3JpdGFibGUoKTsKCiAgICAgICAgcHVibGljIHZvaWQgcmVkdWNlKFRleHQga2V5LCBJdGVyYWJsZTxJbnRXcml0YWJsZT4gdmFsdWVzLCBDb250ZXh0IGNvbnRleHQpIHRocm93cyBJT0V4Y2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgICAgICBpbnQgc3VtID0gMDsKICAgICAgICAgICAgZm9yIChJbnRXcml0YWJsZSB2YWwgOiB2YWx1ZXMpIHsKICAgICAgICAgICAgICAgIHN1bSArPSB2YWwuZ2V0KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVzdWx0LnNldChzdW0pOwogICAgICAgICAgICBjb250ZXh0LndyaXRlKGtleSwgcmVzdWx0KTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBKb2Igam9iID0gSm9iLmdldEluc3RhbmNlKGNvbmYsICJ3b3JkIGNvdW50Iik7CiAgICAgICAgam9iLnNldEphckJ5Q2xhc3MoV29yZENvdW50LmNsYXNzKTsKICAgICAgICBqb2Iuc2V0TWFwcGVyQ2xhc3MoVG9rZW5pemVyTWFwcGVyLmNsYXNzKTsKICAgICAgICBqb2Iuc2V0Q29tYmluZXJDbGFzcyhJbnRTdW1SZWR1Y2VyLmNsYXNzKTsKICAgICAgICBqb2Iuc2V0UmVkdWNlckNsYXNzKEludFN1bVJlZHVjZXIuY2xhc3MpOwogICAgICAgIGpvYi5zZXRPdXRwdXRLZXlDbGFzcyhUZXh0LmNsYXNzKTsKICAgICAgICBqb2Iuc2V0T3V0cHV0VmFsdWVDbGFzcyhJbnRXcml0YWJsZS5jbGFzcyk7CiAgICAgICAgRmlsZUlucHV0Rm9ybWF0LmFkZElucHV0UGF0aChqb2IsIG5ldyBQYXRoKGFyZ3NbMF0pKTsKICAgICAgICBGaWxlT3V0cHV0Rm9ybWF0LnNldE91dHB1dFBhdGgoam9iLCBuZXcgUGF0aChhcmdzWzFdKSk7CiAgICAgICAgU3lzdGVtLmV4aXQoam9iLndhaXRGb3JDb21wbGV0aW9uKHRydWUpID8gMCA6IDEpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Job;
import org.apache.hadoop.mapreduce.Mapper;
import org.apache.hadoop.mapreduce.Reducer;
import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;

import java.io.IOException;
import java.util.StringTokenizer;

public class WordCount {

    public static class TokenizerMapper extends Mapper&lt;Object, Text, Text, IntWritable&gt; {

        private final static IntWritable one = new IntWritable(1);
        private Text word = new Text();

        public void map(Object key, Text value, Context context) throws IOException, InterruptedException {
            StringTokenizer itr = new StringTokenizer(value.toString());
            while (itr.hasMoreTokens()) {
                word.set(itr.nextToken());
                context.write(word, one);
            }
        }
    }

    public static class IntSumReducer extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {
        private IntWritable result = new IntWritable();

        public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException {
            int sum = 0;
            for (IntWritable val : values) {
                sum += val.get();
            }
            result.set(sum);
            context.write(key, result);
        }
    }

    public static void main(String[] args) throws Exception {
        Configuration conf = new Configuration();
        Job job = Job.getInstance(conf, &quot;word count&quot;);
        job.setJarByClass(WordCount.class);
        job.setMapperClass(TokenizerMapper.class);
        job.setCombinerClass(IntSumReducer.class);
        job.setReducerClass(IntSumReducer.class);
        job.setOutputKeyClass(Text.class);
        job.setOutputValueClass(IntWritable.class);
        FileInputFormat.addInputPath(job, new Path(args[0]));
        FileOutputFormat.setOutputPath(job, new Path(args[1]));
        System.exit(job.waitForCompletion(true) ? 0 : 1);
    }
}</pre></div><div class='content'></div><h2><p>Pas 3: Execució del Codi MapReduce</p>
</h2>
<div class='content'><ol>
<li>Compila el codi Java:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("amF2YWMgLWNsYXNzcGF0aCBgaGFkb29wIGNsYXNzcGF0aGAgLWQgd29yZGNvdW50X2NsYXNzZXMgV29yZENvdW50LmphdmEKamFyIC1jdmYgd29yZGNvdW50LmphciAtQyB3b3JkY291bnRfY2xhc3Nlcy8gLg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>javac -classpath `hadoop classpath` -d wordcount_classes WordCount.java
jar -cvf wordcount.jar -C wordcount_classes/ .</pre></div><div class='content'><ol start="2">
<li>Executa el treball MapReduce:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aGFkb29wIGphciB3b3JkY291bnQuamFyIFdvcmRDb3VudCAvcnV0YS9kYWRlcy9lbnRyYWRhIC9ydXRhL2RhZGVzL3NvcnRpZGE="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>hadoop jar wordcount.jar WordCount /ruta/dades/entrada /ruta/dades/sortida</pre></div><div class='content'></div><h1><p>Exercicis Pràctics</p>
</h1>
<div class='content'></div><h2><p>Exercici 1: Comptar la Freqüència de Paraules</p>
</h2>
<div class='content'><p>Modifica el codi de l'exemple per comptar la freqüència de paraules en un conjunt de dades diferent. Prova amb un text més gran i observa com Hadoop maneja el processament distribuït.</p>
</div><h2><p>Exercici 2: Anàlisi de Logs</p>
</h2>
<div class='content'><p>Implementa un treball MapReduce per analitzar logs de servidor web i comptar el nombre de visites per cada adreça IP.</p>
</div><h2><p>Solucions</p>
</h2>
<div class='content'><h4>Solució a l'Exercici 1</h4>
<p>Segueix els mateixos passos que en l'exemple pràctic, però utilitza un fitxer de text diferent com a entrada.</p>
<h4>Solució a l'Exercici 2</h4>
<ol>
<li>Escriu un Mapper que extregui l'adreça IP de cada línia de log.</li>
<li>Escriu un Reducer que compti el nombre de visites per cada adreça IP.</li>
<li>Compila i executa el treball MapReduce de manera similar a l'exemple pràctic.</li>
</ol>
</div><h1><p>Resum</p>
</h1>
<div class='content'><p>En aquest tema, hem après sobre el model de programació MapReduce i el marc de treball Hadoop. Hem explorat la seva arquitectura i components principals, i hem implementat un exemple pràctic de MapReduce utilitzant Hadoop. A més, hem proposat exercicis pràctics per reforçar els conceptes apresos. En el proper tema, explorarem Apache Spark, una altra tecnologia clau per al processament de Big Data.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='02-03-data-lakes' title="Data Lakes">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-apache-spark' title="Apache Spark">Següent &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
