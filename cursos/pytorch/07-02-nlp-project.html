<!DOCTYPE html>
<html lang="ca">
<head>
    <title> Projecte de Processament del Llenguatge Natural </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/pytorch/07-02-nlp-project" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/pytorch/07-02-nlp-project" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/pytorch/07-02-nlp-project" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.188a386f47.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "ca";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "pytorch";
  		var TEMA_NAME = "7-2";
  		var TYPE = "mod";
  		var PATH = "mod/pytorch/07-02-nlp-project";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo_header.png" alt="Logo Campus Empresa"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/courses/pytorch/07-02-nlp-project" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/cursos/pytorch/07-02-nlp-project" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Tot el coneixement al teu abast</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objectiu" rel="nofollow">El Projecte</a> | 
<a href="/sobre-nosaltres" rel="nofollow">Sobre nosaltres</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donacions</a> | 
<a href="/llicencia" rel="nofollow">Llicència</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/els-meus-cursos" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Els meus cursos</b></i>
</a>
<a href="/cursos-finalitzats" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalitzats             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="pytorch">
		<a  href="#" class="text-secondary d-none" data-read-mod="pytorch" data-read-unit="7-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar com a llegit
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="pytorch" data-unread-unit="7-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar com a no llegit
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contingut del curs
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='07-01-image-classification-project' title="Projecte de Classificació d'Imatges" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='07-01-image-classification-project' title="Projecte de Classificació d'Imatges" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Projecte de Processament del Llenguatge Natural</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-03-time-series-forecasting-project' title="Projecte de Predicció de Sèries Temporals" class="py-2 px-3 btn btn-primary"
				data-read-mod="pytorch" data-read-unit="7-2">
				Següent &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-03-time-series-forecasting-project' title="Projecte de Predicció de Sèries Temporals" class="py-2 px-3 btn btn-primary" 
				data-read-mod="pytorch" data-read-unit="7-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>En aquest projecte, aplicarem els coneixements adquirits al llarg del curs per construir un model de Processament del Llenguatge Natural (NLP) utilitzant PyTorch. El nostre objectiu serà crear un model de classificació de text que pugui categoritzar comentaris de clients com a positius o negatius.</p>
</div><h2>Objectius del Projecte</h2>
<div class='content'><ol>
<li><strong>Càrrega i Preprocessament de Dades</strong>: Aprendrem a carregar i preprocessar dades textuals.</li>
<li><strong>Construcció del Model</strong>: Crearem una xarxa neuronal per a la classificació de text.</li>
<li><strong>Entrenament del Model</strong>: Entrenarem el model amb les dades preprocessades.</li>
<li><strong>Avaluació del Model</strong>: Avaluarem el rendiment del model utilitzant mètriques adequades.</li>
<li><strong>Desament i Càrrega del Model</strong>: Desarem el model entrenat i aprendrem a carregar-lo per a futures prediccions.</li>
</ol>
</div><h2><ol>
<li>Càrrega i Preprocessament de Dades</li>
</ol></h2>
<div class='content'></div><h3>1.1. Importació de Llibreries Necessàries</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgppbXBvcnQgdG9yY2gub3B0aW0gYXMgb3B0aW0KZnJvbSB0b3JjaC51dGlscy5kYXRhIGltcG9ydCBEYXRhTG9hZGVyLCBEYXRhc2V0CmZyb20gc2tsZWFybi5tb2RlbF9zZWxlY3Rpb24gaW1wb3J0IHRyYWluX3Rlc3Rfc3BsaXQKZnJvbSBza2xlYXJuLm1ldHJpY3MgaW1wb3J0IGFjY3VyYWN5X3Njb3JlCmltcG9ydCBwYW5kYXMgYXMgcGQKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCByZQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
import torch.nn as nn
import torch.optim as optim
from torch.utils.data import DataLoader, Dataset
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
import pandas as pd
import numpy as np
import re</pre></div><div class='content'></div><h3>1.2. Càrrega de Dades</h3>
<div class='content'><p>Per a aquest projecte, utilitzarem un conjunt de dades de comentaris de clients. Suposem que tenim un fitxer CSV amb dues columnes: <code>text</code> (el comentari) i <code>label</code> (0 per negatiu, 1 per positiu).</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGF0YSA9IHBkLnJlYWRfY3N2KCdjdXN0b21lcl9yZXZpZXdzLmNzdicpCnByaW50KGRhdGEuaGVhZCgpKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>data = pd.read_csv('customer_reviews.csv')
print(data.head())</pre></div><div class='content'></div><h3>1.3. Preprocessament de Text</h3>
<div class='content'><p>El preprocessament inclou la neteja del text, la tokenització i la conversió a índexs.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIHByZXByb2Nlc3NfdGV4dCh0ZXh0KToKICAgIHRleHQgPSB0ZXh0Lmxvd2VyKCkKICAgIHRleHQgPSByZS5zdWIocidbXmEtekEtWlxzXScsICcnLCB0ZXh0KQogICAgcmV0dXJuIHRleHQKCmRhdGFbJ3RleHQnXSA9IGRhdGFbJ3RleHQnXS5hcHBseShwcmVwcm9jZXNzX3RleHQp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def preprocess_text(text):
    text = text.lower()
    text = re.sub(r'[^a-zA-Z\s]', '', text)
    return text

data['text'] = data['text'].apply(preprocess_text)</pre></div><div class='content'></div><h3>1.4. Tokenització i Creació del Vocabulari</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgQ291bnRlcgoKZGVmIHRva2VuaXplKHRleHQpOgogICAgcmV0dXJuIHRleHQuc3BsaXQoKQoKZGF0YVsndG9rZW5zJ10gPSBkYXRhWyd0ZXh0J10uYXBwbHkodG9rZW5pemUpCgphbGxfdG9rZW5zID0gW3Rva2VuIGZvciB0b2tlbnMgaW4gZGF0YVsndG9rZW5zJ10gZm9yIHRva2VuIGluIHRva2Vuc10Kdm9jYWIgPSBDb3VudGVyKGFsbF90b2tlbnMpCnZvY2FiID0ge3dvcmQ6IGlkeCArIDEgZm9yIGlkeCwgKHdvcmQsIF8pIGluIGVudW1lcmF0ZSh2b2NhYi5pdGVtcygpKX0KCmRlZiBlbmNvZGVfdG9rZW5zKHRva2Vucyk6CiAgICByZXR1cm4gW3ZvY2FiW3Rva2VuXSBmb3IgdG9rZW4gaW4gdG9rZW5zXQoKZGF0YVsnZW5jb2RlZCddID0gZGF0YVsndG9rZW5zJ10uYXBwbHkoZW5jb2RlX3Rva2Vucyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from collections import Counter

def tokenize(text):
    return text.split()

data['tokens'] = data['text'].apply(tokenize)

all_tokens = [token for tokens in data['tokens'] for token in tokens]
vocab = Counter(all_tokens)
vocab = {word: idx + 1 for idx, (word, _) in enumerate(vocab.items())}

def encode_tokens(tokens):
    return [vocab[token] for token in tokens]

data['encoded'] = data['tokens'].apply(encode_tokens)</pre></div><div class='content'></div><h3>1.5. Padding</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIHBhZF9zZXF1ZW5jZXMoc2VxdWVuY2VzLCBtYXhsZW4pOgogICAgcGFkZGVkID0gbnAuemVyb3MoKGxlbihzZXF1ZW5jZXMpLCBtYXhsZW4pLCBkdHlwZT1pbnQpCiAgICBmb3IgaSwgc2VxIGluIGVudW1lcmF0ZShzZXF1ZW5jZXMpOgogICAgICAgIGlmIGxlbihzZXEpID4gbWF4bGVuOgogICAgICAgICAgICBwYWRkZWRbaSwgOm1heGxlbl0gPSBzZXFbOm1heGxlbl0KICAgICAgICBlbHNlOgogICAgICAgICAgICBwYWRkZWRbaSwgOmxlbihzZXEpXSA9IHNlcQogICAgcmV0dXJuIHBhZGRlZAoKbWF4bGVuID0gMTAwClggPSBwYWRfc2VxdWVuY2VzKGRhdGFbJ2VuY29kZWQnXS52YWx1ZXMsIG1heGxlbikKeSA9IGRhdGFbJ2xhYmVsJ10udmFsdWVz"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def pad_sequences(sequences, maxlen):
    padded = np.zeros((len(sequences), maxlen), dtype=int)
    for i, seq in enumerate(sequences):
        if len(seq) &gt; maxlen:
            padded[i, :maxlen] = seq[:maxlen]
        else:
            padded[i, :len(seq)] = seq
    return padded

maxlen = 100
X = pad_sequences(data['encoded'].values, maxlen)
y = data['label'].values</pre></div><div class='content'></div><h3>1.6. Divisió del Conjunt de Dades</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("WF90cmFpbiwgWF90ZXN0LCB5X3RyYWluLCB5X3Rlc3QgPSB0cmFpbl90ZXN0X3NwbGl0KFgsIHksIHRlc3Rfc2l6ZT0wLjIsIHJhbmRvbV9zdGF0ZT00Mik="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)</pre></div><div class='content'></div><h2><ol start="2">
<li>Construcció del Model</li>
</ol></h2>
<div class='content'></div><h3>2.1. Creació del Dataset Personalitzat</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgVGV4dERhdGFzZXQoRGF0YXNldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgWCwgeSk6CiAgICAgICAgc2VsZi5YID0gWAogICAgICAgIHNlbGYueSA9IHkKCiAgICBkZWYgX19sZW5fXyhzZWxmKToKICAgICAgICByZXR1cm4gbGVuKHNlbGYuWCkKCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgaWR4KToKICAgICAgICByZXR1cm4gdG9yY2gudGVuc29yKHNlbGYuWFtpZHhdLCBkdHlwZT10b3JjaC5sb25nKSwgdG9yY2gudGVuc29yKHNlbGYueVtpZHhdLCBkdHlwZT10b3JjaC5sb25nKQoKdHJhaW5fZGF0YXNldCA9IFRleHREYXRhc2V0KFhfdHJhaW4sIHlfdHJhaW4pCnRlc3RfZGF0YXNldCA9IFRleHREYXRhc2V0KFhfdGVzdCwgeV90ZXN0KQoKdHJhaW5fbG9hZGVyID0gRGF0YUxvYWRlcih0cmFpbl9kYXRhc2V0LCBiYXRjaF9zaXplPTMyLCBzaHVmZmxlPVRydWUpCnRlc3RfbG9hZGVyID0gRGF0YUxvYWRlcih0ZXN0X2RhdGFzZXQsIGJhdGNoX3NpemU9MzIsIHNodWZmbGU9RmFsc2Up"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class TextDataset(Dataset):
    def __init__(self, X, y):
        self.X = X
        self.y = y

    def __len__(self):
        return len(self.X)

    def __getitem__(self, idx):
        return torch.tensor(self.X[idx], dtype=torch.long), torch.tensor(self.y[idx], dtype=torch.long)

train_dataset = TextDataset(X_train, y_train)
test_dataset = TextDataset(X_test, y_test)

train_loader = DataLoader(train_dataset, batch_size=32, shuffle=True)
test_loader = DataLoader(test_dataset, batch_size=32, shuffle=False)</pre></div><div class='content'></div><h3>2.2. Definició de la Xarxa Neuronal</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgVGV4dENsYXNzaWZpZXIobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2b2NhYl9zaXplLCBlbWJlZF9zaXplLCBudW1fY2xhc3Nlcyk6CiAgICAgICAgc3VwZXIoVGV4dENsYXNzaWZpZXIsIHNlbGYpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmVtYmVkZGluZyA9IG5uLkVtYmVkZGluZyh2b2NhYl9zaXplLCBlbWJlZF9zaXplKQogICAgICAgIHNlbGYuZmMgPSBubi5MaW5lYXIoZW1iZWRfc2l6ZSAqIG1heGxlbiwgbnVtX2NsYXNzZXMpCgogICAgZGVmIGZvcndhcmQoc2VsZiwgeCk6CiAgICAgICAgeCA9IHNlbGYuZW1iZWRkaW5nKHgpCiAgICAgICAgeCA9IHgudmlldyh4LnNpemUoMCksIC0xKQogICAgICAgIHggPSBzZWxmLmZjKHgpCiAgICAgICAgcmV0dXJuIHgKCnZvY2FiX3NpemUgPSBsZW4odm9jYWIpICsgMQplbWJlZF9zaXplID0gMTI4Cm51bV9jbGFzc2VzID0gMgoKbW9kZWwgPSBUZXh0Q2xhc3NpZmllcih2b2NhYl9zaXplLCBlbWJlZF9zaXplLCBudW1fY2xhc3Nlcyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class TextClassifier(nn.Module):
    def __init__(self, vocab_size, embed_size, num_classes):
        super(TextClassifier, self).__init__()
        self.embedding = nn.Embedding(vocab_size, embed_size)
        self.fc = nn.Linear(embed_size * maxlen, num_classes)

    def forward(self, x):
        x = self.embedding(x)
        x = x.view(x.size(0), -1)
        x = self.fc(x)
        return x

vocab_size = len(vocab) + 1
embed_size = 128
num_classes = 2

model = TextClassifier(vocab_size, embed_size, num_classes)</pre></div><div class='content'></div><h2><ol start="3">
<li>Entrenament del Model</li>
</ol></h2>
<div class='content'></div><h3>3.1. Definició de la Funció de Pèrdua i l'Optimitzador</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y3JpdGVyaW9uID0gbm4uQ3Jvc3NFbnRyb3B5TG9zcygpCm9wdGltaXplciA9IG9wdGltLkFkYW0obW9kZWwucGFyYW1ldGVycygpLCBscj0wLjAwMSk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=0.001)</pre></div><div class='content'></div><h3>3.2. Bucle d'Entrenament</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnVtX2Vwb2NocyA9IDEwCgpmb3IgZXBvY2ggaW4gcmFuZ2UobnVtX2Vwb2Nocyk6CiAgICBtb2RlbC50cmFpbigpCiAgICBmb3IgWF9iYXRjaCwgeV9iYXRjaCBpbiB0cmFpbl9sb2FkZXI6CiAgICAgICAgb3B0aW1pemVyLnplcm9fZ3JhZCgpCiAgICAgICAgb3V0cHV0cyA9IG1vZGVsKFhfYmF0Y2gpCiAgICAgICAgbG9zcyA9IGNyaXRlcmlvbihvdXRwdXRzLCB5X2JhdGNoKQogICAgICAgIGxvc3MuYmFja3dhcmQoKQogICAgICAgIG9wdGltaXplci5zdGVwKCkKICAgIAogICAgcHJpbnQoZidFcG9jaCBbe2Vwb2NoKzF9L3tudW1fZXBvY2hzfV0sIExvc3M6IHtsb3NzLml0ZW0oKTouNGZ9Jyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>num_epochs = 10

for epoch in range(num_epochs):
    model.train()
    for X_batch, y_batch in train_loader:
        optimizer.zero_grad()
        outputs = model(X_batch)
        loss = criterion(outputs, y_batch)
        loss.backward()
        optimizer.step()
    
    print(f'Epoch [{epoch+1}/{num_epochs}], Loss: {loss.item():.4f}')</pre></div><div class='content'></div><h2><ol start="4">
<li>Avaluació del Model</li>
</ol></h2>
<div class='content'></div><h3>4.1. Avaluació sobre el Conjunt de Prova</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwuZXZhbCgpCmFsbF9wcmVkcyA9IFtdCmFsbF9sYWJlbHMgPSBbXQoKd2l0aCB0b3JjaC5ub19ncmFkKCk6CiAgICBmb3IgWF9iYXRjaCwgeV9iYXRjaCBpbiB0ZXN0X2xvYWRlcjoKICAgICAgICBvdXRwdXRzID0gbW9kZWwoWF9iYXRjaCkKICAgICAgICBfLCBwcmVkcyA9IHRvcmNoLm1heChvdXRwdXRzLCAxKQogICAgICAgIGFsbF9wcmVkcy5leHRlbmQocHJlZHMubnVtcHkoKSkKICAgICAgICBhbGxfbGFiZWxzLmV4dGVuZCh5X2JhdGNoLm51bXB5KCkpCgphY2N1cmFjeSA9IGFjY3VyYWN5X3Njb3JlKGFsbF9sYWJlbHMsIGFsbF9wcmVkcykKcHJpbnQoZidBY2N1cmFjeToge2FjY3VyYWN5Oi40Zn0nKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model.eval()
all_preds = []
all_labels = []

with torch.no_grad():
    for X_batch, y_batch in test_loader:
        outputs = model(X_batch)
        _, preds = torch.max(outputs, 1)
        all_preds.extend(preds.numpy())
        all_labels.extend(y_batch.numpy())

accuracy = accuracy_score(all_labels, all_preds)
print(f'Accuracy: {accuracy:.4f}')</pre></div><div class='content'></div><h2><ol start="5">
<li>Desament i Càrrega del Model</li>
</ol></h2>
<div class='content'></div><h3>5.1. Desament del Model</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dG9yY2guc2F2ZShtb2RlbC5zdGF0ZV9kaWN0KCksICd0ZXh0X2NsYXNzaWZpZXIucHRoJyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>torch.save(model.state_dict(), 'text_classifier.pth')</pre></div><div class='content'></div><h3>5.2. Càrrega del Model</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwgPSBUZXh0Q2xhc3NpZmllcih2b2NhYl9zaXplLCBlbWJlZF9zaXplLCBudW1fY2xhc3NlcykKbW9kZWwubG9hZF9zdGF0ZV9kaWN0KHRvcmNoLmxvYWQoJ3RleHRfY2xhc3NpZmllci5wdGgnKSkKbW9kZWwuZXZhbCgp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model = TextClassifier(vocab_size, embed_size, num_classes)
model.load_state_dict(torch.load('text_classifier.pth'))
model.eval()</pre></div><div class='content'></div><h2>Conclusió</h2>
<div class='content'><p>En aquest projecte, hem après a construir un model de classificació de text utilitzant PyTorch. Hem cobert tot el procés des de la càrrega i preprocessament de dades fins a l'entrenament, avaluació i desament del model. Aquest projecte ens proporciona una base sòlida per abordar problemes de Processament del Llenguatge Natural amb PyTorch.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='07-01-image-classification-project' title="Projecte de Classificació d'Imatges" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='07-01-image-classification-project' title="Projecte de Classificació d'Imatges" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-03-time-series-forecasting-project' title="Projecte de Predicció de Sèries Temporals" class="py-2 px-3 btn btn-primary"
				data-read-mod="pytorch" data-read-unit="7-2">
				Següent &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-03-time-series-forecasting-project' title="Projecte de Predicció de Sèries Temporals" class="py-2 px-3 btn btn-primary" 
				data-read-mod="pytorch" data-read-unit="7-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>PyTorch: De Principiant a Avançat</h1>
<h2>Mòdul 1: Introducció a PyTorch</h2>
<ul>
<li><a href="01-01-what-is-pytorch">Què és PyTorch?</a></li>
<li><a href="01-02-setting-up-environment">Configuració de l'Entorn</a></li>
<li><a href="01-03-basic-tensor-operations">Operacions Bàsiques amb Tensor</a></li>
<li><a href="01-04-autograd">Autograd: Diferenciació Automàtica</a></li>
</ul>
<h2>Mòdul 2: Construcció de Xarxes Neuronals</h2>
<ul>
<li><a href="02-01-introduction-to-neural-networks">Introducció a les Xarxes Neuronals</a></li>
<li><a href="02-02-creating-simple-neural-network">Creació d'una Xarxa Neuronal Simple</a></li>
<li><a href="02-03-activation-functions">Funcions d'Activació</a></li>
<li><a href="02-04-loss-functions-optimization">Funcions de Pèrdua i Optimització</a></li>
</ul>
<h2>Mòdul 3: Entrenament de Xarxes Neuronals</h2>
<ul>
<li><a href="03-01-data-loading-preprocessing">Càrrega i Preprocessament de Dades</a></li>
<li><a href="03-02-training-loop">Bucle d'Entrenament</a></li>
<li><a href="03-03-validation-testing">Validació i Prova</a></li>
<li><a href="03-04-saving-loading-models">Desament i Càrrega de Models</a></li>
</ul>
<h2>Mòdul 4: Xarxes Neuronals Convolucionals (CNNs)</h2>
<ul>
<li><a href="04-01-introduction-to-cnns">Introducció a les CNNs</a></li>
<li><a href="04-02-building-cnn-from-scratch">Construcció d'una CNN des de Zero</a></li>
<li><a href="04-03-transfer-learning">Aprenentatge per Transferència amb Models Preentrenats</a></li>
<li><a href="04-04-fine-tuning-cnns">Ajust Fi de les CNNs</a></li>
</ul>
<h2>Mòdul 5: Xarxes Neuronals Recurrents (RNNs)</h2>
<ul>
<li><a href="05-01-introduction-to-rnns">Introducció a les RNNs</a></li>
<li><a href="05-02-building-rnn-from-scratch">Construcció d'una RNN des de Zero</a></li>
<li><a href="05-03-lstm-networks">Xarxes de Memòria a Llarg i Curt Termini (LSTM)</a></li>
<li><a href="05-04-gru-networks">Unitats Recurrents Gated (GRUs)</a></li>
</ul>
<h2>Mòdul 6: Temes Avançats</h2>
<ul>
<li><a href="06-01-gans">Xarxes Generatives Adversàries (GANs)</a></li>
<li><a href="06-02-reinforcement-learning">Aprenentatge per Reforç amb PyTorch</a></li>
<li><a href="06-03-deploying-models">Desplegament de Models PyTorch</a></li>
<li><a href="06-04-optimizing-performance">Optimització del Rendiment</a></li>
</ul>
<h2>Mòdul 7: Estudis de Cas i Projectes</h2>
<ul>
<li><a href="07-01-image-classification-project">Projecte de Classificació d'Imatges</a></li>
<li><a href="07-02-nlp-project">Projecte de Processament del Llenguatge Natural</a></li>
<li><a href="07-03-time-series-forecasting-project">Projecte de Predicció de Sèries Temporals</a></li>
<li><a href="07-04-custom-project">Projecte Personalitzat</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objectiu" rel="nofollow">El Projecte</a> | 
<a href="/sobre-nosaltres" rel="nofollow">Sobre nosaltres</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donacions</a> | 
<a href="/llicencia" rel="nofollow">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuari no autentificat</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
