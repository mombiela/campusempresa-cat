<!DOCTYPE html>
<html lang="ca">
<head>
    <title> Kafka amb Flink </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, nofollow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/kafka/06-03-kafka-flink" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/kafka/06-03-kafka-flink" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/kafka/06-03-kafka-flink" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.188a386f47.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "ca";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "kafka";
  		var TEMA_NAME = "6-3";
  		var TYPE = "mod";
  		var PATH = "mod/kafka/06-03-kafka-flink";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo_header.png" alt="Logo Campus Empresa"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/courses/kafka/06-03-kafka-flink" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/cursos/kafka/06-03-kafka-flink" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Tot el coneixement al teu abast</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objectiu" rel="nofollow">El Projecte</a> | 
<a href="/sobre-nosaltres" rel="nofollow">Sobre nosaltres</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donacions</a> | 
<a href="/llicencia" rel="nofollow">Llicència</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/els-meus-cursos" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Els meus cursos</b></i>
</a>
<a href="/cursos-finalitzats" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalitzats             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="kafka">
		<a  href="#" class="text-secondary d-none" data-read-mod="kafka" data-read-unit="6-3" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar com a llegit
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="kafka" data-unread-unit="6-3" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar com a no llegit
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contingut del curs
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-02-kafka-spark' title="Kafka amb Spark" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-02-kafka-spark' title="Kafka amb Spark" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Kafka amb Flink</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='06-04-kafka-elasticsearch' title="Kafka amb Elasticsearch" class="py-2 px-3 btn btn-primary"
				data-read-mod="kafka" data-read-unit="6-3">
				Següent &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='06-04-kafka-elasticsearch' title="Kafka amb Elasticsearch" class="py-2 px-3 btn btn-primary" 
				data-read-mod="kafka" data-read-unit="6-3">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, explorarem com integrar Apache Kafka amb Apache Flink per processar fluxos de dades en temps real. Flink és una potent eina per al processament de fluxos i lots, i la seva integració amb Kafka permet construir aplicacions de processament de dades en temps real robustes i escalables.</p>
</div><h2>Objectius del Tema</h2>
<div class='content'><ul>
<li>Entendre la integració entre Kafka i Flink.</li>
<li>Configurar un entorn de desenvolupament per treballar amb Kafka i Flink.</li>
<li>Crear una aplicació de Flink que consumeixi dades de Kafka.</li>
<li>Processar i analitzar dades en temps real amb Flink.</li>
</ul>
</div><h2><ol>
<li>Introducció a Flink</li>
</ol></h2>
<div class='content'></div><h3>Què és Apache Flink?</h3>
<div class='content'><p>Apache Flink és un motor de processament de fluxos i lots de dades que permet processar grans volums de dades en temps real amb baixa latència i alta velocitat. Flink és conegut per la seva capacitat de processar dades en temps real i per la seva API rica i flexible.</p>
</div><h3>Característiques Clau de Flink</h3>
<div class='content'><ul>
<li><strong>Processament de Fluxos i Lots</strong>: Flink pot processar dades tant en mode de fluxos (streaming) com en mode de lots (batch).</li>
<li><strong>Baixa Latència</strong>: Dissenyat per processar dades en temps real amb una latència mínima.</li>
<li><strong>Escalabilitat</strong>: Pot escalar fàcilment per manejar grans volums de dades.</li>
<li><strong>Tolerància a Fallades</strong>: Proporciona mecanismes per a la recuperació automàtica en cas de fallades.</li>
</ul>
</div><h2><ol start="2">
<li>Configuració de l'Entorn</li>
</ol></h2>
<div class='content'></div><h3>Requisits Previs</h3>
<div class='content'><ul>
<li><strong>Apache Kafka</strong>: Assegura't de tenir Kafka instal·lat i en funcionament. Pots seguir les instruccions del mòdul 1 per configurar Kafka.</li>
<li><strong>Apache Flink</strong>: Descarrega i instal·la Flink des del <a href="https://flink.apache.org/downloads.html">lloc oficial</a>.</li>
</ul>
</div><h3>Configuració de Flink</h3>
<div class='content'><ol>
<li>
<p><strong>Descarrega Flink</strong>:</p>
<pre><code class="language-bash">wget https://archive.apache.org/dist/flink/flink-1.13.2/flink-1.13.2-bin-scala_2.11.tgz
tar -xzf flink-1.13.2-bin-scala_2.11.tgz
cd flink-1.13.2
</code></pre>
</li>
<li>
<p><strong>Inicia el Clúster de Flink</strong>:</p>
<pre><code class="language-bash">./bin/start-cluster.sh
</code></pre>
</li>
<li>
<p><strong>Verifica la Instal·lació</strong>: Accedeix a la interfície web de Flink a <code>http://localhost:8081</code>.</p>
</li>
</ol>
</div><h2><ol start="3">
<li>Integració de Kafka amb Flink</li>
</ol></h2>
<div class='content'></div><h3>Dependències del Projecte</h3>
<div class='content'><p>Per integrar Kafka amb Flink, necessitem afegir les dependències necessàries al nostre projecte. Si estàs utilitzant Maven, afegeix les següents dependències al teu <code>pom.xml</code>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGRlcGVuZGVuY2llcz4KICAgIDwhLS0gRmxpbmsgZGVwZW5kZW5jaWVzIC0tPgogICAgPGRlcGVuZGVuY3k+CiAgICAgICAgPGdyb3VwSWQ+b3JnLmFwYWNoZS5mbGluazwvZ3JvdXBJZD4KICAgICAgICA8YXJ0aWZhY3RJZD5mbGluay1zdHJlYW1pbmctamF2YV8yLjExPC9hcnRpZmFjdElkPgogICAgICAgIDx2ZXJzaW9uPjEuMTMuMjwvdmVyc2lvbj4KICAgIDwvZGVwZW5kZW5jeT4KICAgIDxkZXBlbmRlbmN5PgogICAgICAgIDxncm91cElkPm9yZy5hcGFjaGUuZmxpbms8L2dyb3VwSWQ+CiAgICAgICAgPGFydGlmYWN0SWQ+ZmxpbmstY29ubmVjdG9yLWthZmthXzIuMTE8L2FydGlmYWN0SWQ+CiAgICAgICAgPHZlcnNpb24+MS4xMy4yPC92ZXJzaW9uPgogICAgPC9kZXBlbmRlbmN5PgogICAgPCEtLSBLYWZrYSBkZXBlbmRlbmNpZXMgLS0+CiAgICA8ZGVwZW5kZW5jeT4KICAgICAgICA8Z3JvdXBJZD5vcmcuYXBhY2hlLmthZmthPC9ncm91cElkPgogICAgICAgIDxhcnRpZmFjdElkPmthZmthLWNsaWVudHM8L2FydGlmYWN0SWQ+CiAgICAgICAgPHZlcnNpb24+Mi44LjA8L3ZlcnNpb24+CiAgICA8L2RlcGVuZGVuY3k+CjwvZGVwZW5kZW5jaWVzPg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;dependencies&gt;
    &lt;!-- Flink dependencies --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.flink&lt;/groupId&gt;
        &lt;artifactId&gt;flink-streaming-java_2.11&lt;/artifactId&gt;
        &lt;version&gt;1.13.2&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.flink&lt;/groupId&gt;
        &lt;artifactId&gt;flink-connector-kafka_2.11&lt;/artifactId&gt;
        &lt;version&gt;1.13.2&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;!-- Kafka dependencies --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;
        &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt;
        &lt;version&gt;2.8.0&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</pre></div><div class='content'></div><h3>Exemple de Codi: Consumir Dades de Kafka amb Flink</h3>
<div class='content'><p>A continuació, es mostra un exemple de com crear una aplicació de Flink que consumeixi dades d'un tema de Kafka i les processi en temps real.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuZmxpbmsuYXBpLmNvbW1vbi5zZXJpYWxpemF0aW9uLlNpbXBsZVN0cmluZ1NjaGVtYTsKaW1wb3J0IG9yZy5hcGFjaGUuZmxpbmsuc3RyZWFtaW5nLmFwaS5kYXRhc3RyZWFtLkRhdGFTdHJlYW07CmltcG9ydCBvcmcuYXBhY2hlLmZsaW5rLnN0cmVhbWluZy5hcGkuZW52aXJvbm1lbnQuU3RyZWFtRXhlY3V0aW9uRW52aXJvbm1lbnQ7CmltcG9ydCBvcmcuYXBhY2hlLmZsaW5rLnN0cmVhbWluZy5jb25uZWN0b3JzLmthZmthLkZsaW5rS2Fma2FDb25zdW1lcjsKCmltcG9ydCBqYXZhLnV0aWwuUHJvcGVydGllczsKCnB1YmxpYyBjbGFzcyBLYWZrYUZsaW5rSW50ZWdyYXRpb24gewogICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gQ29uZmlndXJhY2nDsyBkZSBsJ2VudG9ybiBkZSBGbGluawogICAgICAgIGZpbmFsIFN0cmVhbUV4ZWN1dGlvbkVudmlyb25tZW50IGVudiA9IFN0cmVhbUV4ZWN1dGlvbkVudmlyb25tZW50LmdldEV4ZWN1dGlvbkVudmlyb25tZW50KCk7CgogICAgICAgIC8vIENvbmZpZ3VyYWNpw7MgZGUgbGVzIHByb3BpZXRhdHMgZGUgS2Fma2EKICAgICAgICBQcm9wZXJ0aWVzIHByb3BlcnRpZXMgPSBuZXcgUHJvcGVydGllcygpOwogICAgICAgIHByb3BlcnRpZXMuc2V0UHJvcGVydHkoImJvb3RzdHJhcC5zZXJ2ZXJzIiwgImxvY2FsaG9zdDo5MDkyIik7CiAgICAgICAgcHJvcGVydGllcy5zZXRQcm9wZXJ0eSgiZ3JvdXAuaWQiLCAiZmxpbmstZ3JvdXAiKTsKCiAgICAgICAgLy8gQ3JlYWNpw7MgZGVsIGNvbnN1bWlkb3IgZGUgS2Fma2EKICAgICAgICBGbGlua0thZmthQ29uc3VtZXI8U3RyaW5nPiBrYWZrYUNvbnN1bWVyID0gbmV3IEZsaW5rS2Fma2FDb25zdW1lcjw+KAogICAgICAgICAgICAgICAgImthZmthX3RvcGljIiwKICAgICAgICAgICAgICAgIG5ldyBTaW1wbGVTdHJpbmdTY2hlbWEoKSwKICAgICAgICAgICAgICAgIHByb3BlcnRpZXMKICAgICAgICApOwoKICAgICAgICAvLyBBZmVnZWl4IGVsIGNvbnN1bWlkb3IgZGUgS2Fma2EgYWwgZmx1eCBkZSBkYWRlcyBkZSBGbGluawogICAgICAgIERhdGFTdHJlYW08U3RyaW5nPiBzdHJlYW0gPSBlbnYuYWRkU291cmNlKGthZmthQ29uc3VtZXIpOwoKICAgICAgICAvLyBQcm9jZXNzYW1lbnQgZGUgbGVzIGRhZGVzCiAgICAgICAgc3RyZWFtLm1hcCh2YWx1ZSAtPiAiUHJvY2Vzc2VkOiAiICsgdmFsdWUpLnByaW50KCk7CgogICAgICAgIC8vIEluaWNpYSBsJ2V4ZWN1Y2nDsyBkZSBGbGluawogICAgICAgIGVudi5leGVjdXRlKCJLYWZrYSBGbGluayBJbnRlZ3JhdGlvbiBFeGFtcGxlIik7CiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.flink.api.common.serialization.SimpleStringSchema;
import org.apache.flink.streaming.api.datastream.DataStream;
import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
import org.apache.flink.streaming.connectors.kafka.FlinkKafkaConsumer;

import java.util.Properties;

public class KafkaFlinkIntegration {
    public static void main(String[] args) throws Exception {
        // Configuraci&oacute; de l'entorn de Flink
        final StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

        // Configuraci&oacute; de les propietats de Kafka
        Properties properties = new Properties();
        properties.setProperty(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
        properties.setProperty(&quot;group.id&quot;, &quot;flink-group&quot;);

        // Creaci&oacute; del consumidor de Kafka
        FlinkKafkaConsumer&lt;String&gt; kafkaConsumer = new FlinkKafkaConsumer&lt;&gt;(
                &quot;kafka_topic&quot;,
                new SimpleStringSchema(),
                properties
        );

        // Afegeix el consumidor de Kafka al flux de dades de Flink
        DataStream&lt;String&gt; stream = env.addSource(kafkaConsumer);

        // Processament de les dades
        stream.map(value -&gt; &quot;Processed: &quot; + value).print();

        // Inicia l'execuci&oacute; de Flink
        env.execute(&quot;Kafka Flink Integration Example&quot;);
    }
}</pre></div><div class='content'></div><h3>Explicació del Codi</h3>
<div class='content'><ol>
<li><strong>Configuració de l'Entorn de Flink</strong>: Es crea un entorn d'execució de Flink.</li>
<li><strong>Propietats de Kafka</strong>: Es configuren les propietats necessàries per connectar-se a Kafka.</li>
<li><strong>Consumidor de Kafka</strong>: Es crea un consumidor de Kafka que llegeix dades del tema <code>kafka_topic</code>.</li>
<li><strong>Flux de Dades</strong>: Es defineix un flux de dades que consumeix missatges de Kafka i els processa.</li>
<li><strong>Processament de Dades</strong>: Es processa cada missatge afegint el prefix &quot;Processed: &quot;.</li>
<li><strong>Execució de Flink</strong>: Es llança l'execució de l'aplicació de Flink.</li>
</ol>
</div><h2><ol start="4">
<li>Exercicis Pràctics</li>
</ol></h2>
<div class='content'></div><h3>Exercici 1: Crear un Productor de Kafka</h3>
<div class='content'><p>Crea un productor de Kafka que enviï missatges a un tema anomenat <code>flink_topic</code>. Utilitza el següent codi com a referència:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5wcm9kdWNlci5LYWZrYVByb2R1Y2VyOwppbXBvcnQgb3JnLmFwYWNoZS5rYWZrYS5jbGllbnRzLnByb2R1Y2VyLlByb2R1Y2VyUmVjb3JkOwoKaW1wb3J0IGphdmEudXRpbC5Qcm9wZXJ0aWVzOwoKcHVibGljIGNsYXNzIEthZmthUHJvZHVjZXJFeGFtcGxlIHsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBQcm9wZXJ0aWVzIHByb3BzID0gbmV3IFByb3BlcnRpZXMoKTsKICAgICAgICBwcm9wcy5wdXQoImJvb3RzdHJhcC5zZXJ2ZXJzIiwgImxvY2FsaG9zdDo5MDkyIik7CiAgICAgICAgcHJvcHMucHV0KCJrZXkuc2VyaWFsaXplciIsICJvcmcuYXBhY2hlLmthZmthLmNvbW1vbi5zZXJpYWxpemF0aW9uLlN0cmluZ1NlcmlhbGl6ZXIiKTsKICAgICAgICBwcm9wcy5wdXQoInZhbHVlLnNlcmlhbGl6ZXIiLCAib3JnLmFwYWNoZS5rYWZrYS5jb21tb24uc2VyaWFsaXphdGlvbi5TdHJpbmdTZXJpYWxpemVyIik7CgogICAgICAgIEthZmthUHJvZHVjZXI8U3RyaW5nLCBTdHJpbmc+IHByb2R1Y2VyID0gbmV3IEthZmthUHJvZHVjZXI8Pihwcm9wcyk7CgogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgMTAwOyBpKyspIHsKICAgICAgICAgICAgcHJvZHVjZXIuc2VuZChuZXcgUHJvZHVjZXJSZWNvcmQ8PigiZmxpbmtfdG9waWMiLCBJbnRlZ2VyLnRvU3RyaW5nKGkpLCAibWVzc2FnZS0iICsgaSkpOwogICAgICAgIH0KCiAgICAgICAgcHJvZHVjZXIuY2xvc2UoKTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.ProducerRecord;

import java.util.Properties;

public class KafkaProducerExample {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
        props.put(&quot;key.serializer&quot;, &quot;org.apache.kafka.common.serialization.StringSerializer&quot;);
        props.put(&quot;value.serializer&quot;, &quot;org.apache.kafka.common.serialization.StringSerializer&quot;);

        KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(props);

        for (int i = 0; i &lt; 100; i++) {
            producer.send(new ProducerRecord&lt;&gt;(&quot;flink_topic&quot;, Integer.toString(i), &quot;message-&quot; + i));
        }

        producer.close();
    }
}</pre></div><div class='content'></div><h3>Exercici 2: Processar Dades amb Flink</h3>
<div class='content'><p>Modifica l'exemple de codi de Flink per comptar el nombre de missatges processats i imprimir el resultat cada 10 segons.</p>
</div><h3>Solució de l'Exercici 2</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuZmxpbmsuYXBpLmNvbW1vbi5zZXJpYWxpemF0aW9uLlNpbXBsZVN0cmluZ1NjaGVtYTsKaW1wb3J0IG9yZy5hcGFjaGUuZmxpbmsuc3RyZWFtaW5nLmFwaS5kYXRhc3RyZWFtLkRhdGFTdHJlYW07CmltcG9ydCBvcmcuYXBhY2hlLmZsaW5rLnN0cmVhbWluZy5hcGkuZW52aXJvbm1lbnQuU3RyZWFtRXhlY3V0aW9uRW52aXJvbm1lbnQ7CmltcG9ydCBvcmcuYXBhY2hlLmZsaW5rLnN0cmVhbWluZy5jb25uZWN0b3JzLmthZmthLkZsaW5rS2Fma2FDb25zdW1lcjsKaW1wb3J0IG9yZy5hcGFjaGUuZmxpbmsuc3RyZWFtaW5nLmFwaS53aW5kb3dpbmcudGltZS5UaW1lOwoKaW1wb3J0IGphdmEudXRpbC5Qcm9wZXJ0aWVzOwoKcHVibGljIGNsYXNzIEthZmthRmxpbmtJbnRlZ3JhdGlvbiB7CiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBmaW5hbCBTdHJlYW1FeGVjdXRpb25FbnZpcm9ubWVudCBlbnYgPSBTdHJlYW1FeGVjdXRpb25FbnZpcm9ubWVudC5nZXRFeGVjdXRpb25FbnZpcm9ubWVudCgpOwoKICAgICAgICBQcm9wZXJ0aWVzIHByb3BlcnRpZXMgPSBuZXcgUHJvcGVydGllcygpOwogICAgICAgIHByb3BlcnRpZXMuc2V0UHJvcGVydHkoImJvb3RzdHJhcC5zZXJ2ZXJzIiwgImxvY2FsaG9zdDo5MDkyIik7CiAgICAgICAgcHJvcGVydGllcy5zZXRQcm9wZXJ0eSgiZ3JvdXAuaWQiLCAiZmxpbmstZ3JvdXAiKTsKCiAgICAgICAgRmxpbmtLYWZrYUNvbnN1bWVyPFN0cmluZz4ga2Fma2FDb25zdW1lciA9IG5ldyBGbGlua0thZmthQ29uc3VtZXI8PigKICAgICAgICAgICAgICAgICJmbGlua190b3BpYyIsCiAgICAgICAgICAgICAgICBuZXcgU2ltcGxlU3RyaW5nU2NoZW1hKCksCiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzCiAgICAgICAgKTsKCiAgICAgICAgRGF0YVN0cmVhbTxTdHJpbmc+IHN0cmVhbSA9IGVudi5hZGRTb3VyY2Uoa2Fma2FDb25zdW1lcik7CgogICAgICAgIHN0cmVhbQogICAgICAgICAgICAubWFwKHZhbHVlIC0+ICJQcm9jZXNzZWQ6ICIgKyB2YWx1ZSkKICAgICAgICAgICAgLnRpbWVXaW5kb3dBbGwoVGltZS5zZWNvbmRzKDEwKSkKICAgICAgICAgICAgLmFwcGx5KCh3aW5kb3csIHZhbHVlcywgb3V0KSAtPiB7CiAgICAgICAgICAgICAgICBsb25nIGNvdW50ID0gdmFsdWVzLnNwbGl0ZXJhdG9yKCkuZ2V0RXhhY3RTaXplSWZLbm93bigpOwogICAgICAgICAgICAgICAgb3V0LmNvbGxlY3QoIk51bWJlciBvZiBtZXNzYWdlcyBwcm9jZXNzZWQgaW4gbGFzdCAxMCBzZWNvbmRzOiAiICsgY291bnQpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAucHJpbnQoKTsKCiAgICAgICAgZW52LmV4ZWN1dGUoIkthZmthIEZsaW5rIEludGVncmF0aW9uIEV4YW1wbGUiKTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.flink.api.common.serialization.SimpleStringSchema;
import org.apache.flink.streaming.api.datastream.DataStream;
import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
import org.apache.flink.streaming.connectors.kafka.FlinkKafkaConsumer;
import org.apache.flink.streaming.api.windowing.time.Time;

import java.util.Properties;

public class KafkaFlinkIntegration {
    public static void main(String[] args) throws Exception {
        final StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

        Properties properties = new Properties();
        properties.setProperty(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
        properties.setProperty(&quot;group.id&quot;, &quot;flink-group&quot;);

        FlinkKafkaConsumer&lt;String&gt; kafkaConsumer = new FlinkKafkaConsumer&lt;&gt;(
                &quot;flink_topic&quot;,
                new SimpleStringSchema(),
                properties
        );

        DataStream&lt;String&gt; stream = env.addSource(kafkaConsumer);

        stream
            .map(value -&gt; &quot;Processed: &quot; + value)
            .timeWindowAll(Time.seconds(10))
            .apply((window, values, out) -&gt; {
                long count = values.spliterator().getExactSizeIfKnown();
                out.collect(&quot;Number of messages processed in last 10 seconds: &quot; + count);
            })
            .print();

        env.execute(&quot;Kafka Flink Integration Example&quot;);
    }
}</pre></div><div class='content'></div><h2>Conclusió</h2>
<div class='content'><p>En aquest tema, hem après com integrar Apache Kafka amb Apache Flink per processar fluxos de dades en temps real. Hem configurat l'entorn, creat una aplicació de Flink que consumeix dades de Kafka i hem processat aquestes dades. A més, hem realitzat exercicis pràctics per reforçar els conceptes apresos. Aquesta integració és fonamental per construir aplicacions de processament de dades en temps real robustes i escalables.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-02-kafka-spark' title="Kafka amb Spark" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-02-kafka-spark' title="Kafka amb Spark" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='06-04-kafka-elasticsearch' title="Kafka amb Elasticsearch" class="py-2 px-3 btn btn-primary"
				data-read-mod="kafka" data-read-unit="6-3">
				Següent &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='06-04-kafka-elasticsearch' title="Kafka amb Elasticsearch" class="py-2 px-3 btn btn-primary" 
				data-read-mod="kafka" data-read-unit="6-3">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curs de Kafka</h1>
<h2>Mòdul 1: Introducció a Kafka</h2>
<ul>
<li><a href="01-01-what-is-kafka">Què és Kafka?</a></li>
<li><a href="01-02-kafka-use-cases">Usos de Kafka</a></li>
<li><a href="01-03-kafka-architecture-overview">Visió general de l'arquitectura de Kafka</a></li>
<li><a href="01-04-setting-up-kafka">Configuració de Kafka</a></li>
</ul>
<h2>Mòdul 2: Conceptes bàsics de Kafka</h2>
<ul>
<li><a href="02-01-producers-and-consumers">Productors i Consumidors</a></li>
<li><a href="02-02-topics-and-partitions">Temes i Particions</a></li>
<li><a href="02-03-brokers-and-clusters">Brokers i Clústers</a></li>
<li><a href="02-04-messages-and-offsets">Missatges i Desplaçaments</a></li>
</ul>
<h2>Mòdul 3: Operacions de Kafka</h2>
<ul>
<li><a href="03-01-producing-messages">Producció de Missatges</a></li>
<li><a href="03-02-consuming-messages">Consum de Missatges</a></li>
<li><a href="03-03-kafka-connect">Kafka Connect</a></li>
<li><a href="03-04-kafka-streams">Kafka Streams</a></li>
</ul>
<h2>Mòdul 4: Configuració i Gestió de Kafka</h2>
<ul>
<li><a href="04-01-configuring-kafka">Configuració de Kafka</a></li>
<li><a href="04-02-managing-kafka-topics">Gestió de Temes de Kafka</a></li>
<li><a href="04-03-monitoring-kafka">Monitorització de Kafka</a></li>
<li><a href="04-04-kafka-security">Seguretat de Kafka</a></li>
</ul>
<h2>Mòdul 5: Temes Avançats de Kafka</h2>
<ul>
<li><a href="05-01-kafka-performance-tuning">Optimització del Rendiment de Kafka</a></li>
<li><a href="05-02-kafka-multi-data-center">Kafka en una Configuració Multi-Centre de Dades</a></li>
<li><a href="05-03-kafka-schema-registry">Kafka amb Registre d'Esquemes</a></li>
<li><a href="05-04-kafka-streams-advanced">Kafka Streams Avançat</a></li>
</ul>
<h2>Mòdul 6: Ecosistema i Integracions de Kafka</h2>
<ul>
<li><a href="06-01-kafka-hadoop">Kafka amb Hadoop</a></li>
<li><a href="06-02-kafka-spark">Kafka amb Spark</a></li>
<li><a href="06-03-kafka-flink">Kafka amb Flink</a></li>
<li><a href="06-04-kafka-elasticsearch">Kafka amb Elasticsearch</a></li>
</ul>
<h2>Mòdul 7: Estudis de Cas i Millors Pràctiques de Kafka</h2>
<ul>
<li><a href="07-01-real-world-kafka-use-cases">Usos Reals de Kafka</a></li>
<li><a href="07-02-kafka-best-practices">Millors Pràctiques de Kafka</a></li>
<li><a href="07-03-common-kafka-pitfalls">Errors Comuns de Kafka</a></li>
<li><a href="07-04-future-of-kafka">Futur de Kafka</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objectiu" rel="nofollow">El Projecte</a> | 
<a href="/sobre-nosaltres" rel="nofollow">Sobre nosaltres</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donacions</a> | 
<a href="/llicencia" rel="nofollow">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuari no autentificat</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
