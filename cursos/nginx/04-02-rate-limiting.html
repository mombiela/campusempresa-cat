<!DOCTYPE html>
<html lang="ca">
<head>
    <title> Limitació de velocitat </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, nofollow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/nginx/04-02-rate-limiting" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/nginx/04-02-rate-limiting" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/nginx/04-02-rate-limiting" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.ea63f62b9e.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "ca";
  		var CATEGORY = "tech-tools";
  		var MOD_NAME = "nginx";
  		var TEMA_NAME = "4-2";
  		var TYPE = "mod";
  		var PATH = "mod/nginx/04-02-rate-limiting";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/courses/nginx/04-02-rate-limiting" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/cursos/nginx/04-02-rate-limiting" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Tot el coneixement al teu abast</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objectiu" rel="nofollow">El Projecte</a> | 
<a href="/sobre-nosaltres" rel="nofollow">Sobre nosaltres</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donacions</a> | 
<a href="/llicencia" rel="nofollow">Llicència</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/els-meus-cursos" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Els meus cursos</b></i>
</a>
<a href="/cursos-finalitzats" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalitzats             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="nginx">
		<a  href="#" class="text-secondary d-none" data-read-mod="nginx" data-read-unit="4-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar com a llegit
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="nginx" data-unread-unit="4-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar com a no llegit
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contingut del curs
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-01-basic-security-practices' title="Pràctiques bàsiques de seguretat" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-01-basic-security-practices' title="Pràctiques bàsiques de seguretat" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">Limitació de velocitat</h2>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='04-03-ssl-tls-configuration' title="Configuració SSL/TLS" class="py-2 px-3 btn btn-primary"
				data-read-mod="nginx" data-read-unit="4-2">
				Següent &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='04-03-ssl-tls-configuration' title="Configuració SSL/TLS" class="py-2 px-3 btn btn-primary" 
				data-read-mod="nginx" data-read-unit="4-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>La limitació de velocitat (rate limiting) és una tècnica utilitzada per controlar la quantitat de sol·licituds que un servidor pot rebre en un període de temps determinat. Això és especialment útil per prevenir abusos, atacs de denegació de servei (DoS) i per assegurar que els recursos del servidor es distribueixin de manera equitativa entre tots els usuaris.</p>
</div><h1>Conceptes clau</h1>
<div class='content'><ul>
<li><strong>Burst</strong>: El nombre màxim de sol·licituds que es poden gestionar en un curt període de temps abans que s'apliqui la limitació.</li>
<li><strong>Rate</strong>: La taxa de sol·licituds per segon que es permet.</li>
<li><strong>Zone</strong>: Una àrea de memòria compartida on es guarda l'estat de la limitació de velocitat.</li>
</ul>
</div><h1>Configuració bàsica de limitació de velocitat</h1>
<div class='content'><p>NGINX proporciona dos mòduls principals per a la limitació de velocitat:</p>
<ol>
<li><code>ngx_http_limit_req_module</code>: Limita la velocitat de sol·licituds per adreça IP.</li>
<li><code>ngx_http_limit_conn_module</code>: Limita el nombre de connexions simultànies per adreça IP.</li>
</ol>
</div><h2>Limitació de sol·licituds (<code>ngx_http_limit_req_module</code>)</h2>
<div class='content'><p>Per configurar la limitació de sol·licituds, primer hem de definir una zona de memòria compartida on es guardarà l'estat de la limitació. Després, aplicarem aquesta limitació a una ubicació específica.</p>
<h4>Exemple de configuració</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICAjIERlZmluaW0gdW5hIHpvbmEgZGUgbWVtw7JyaWEgY29tcGFydGlkYSBhbm9tZW5hZGEgJ215bGltaXQnIGFtYiB1bmEgbWlkYSBkZSAxMCBNQgogICAgbGltaXRfcmVxX3pvbmUgJGJpbmFyeV9yZW1vdGVfYWRkciB6b25lPW15bGltaXQ6MTBtIHJhdGU9MXIvczsKCiAgICBzZXJ2ZXIgewogICAgICAgIGxpc3RlbiA4MDsKICAgICAgICBzZXJ2ZXJfbmFtZSBleGFtcGxlLmNvbTsKCiAgICAgICAgbG9jYXRpb24gLyB7CiAgICAgICAgICAgICMgQXBsaWNhciBsYSBsaW1pdGFjacOzIGRlIHNvbMK3bGljaXR1ZHMKICAgICAgICAgICAgbGltaXRfcmVxIHpvbmU9bXlsaW1pdCBidXJzdD01IG5vZGVsYXk7CiAgICAgICAgICAgIHByb3h5X3Bhc3MgaHR0cDovL2JhY2tlbmQ7CiAgICAgICAgfQogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    # Definim una zona de mem&ograve;ria compartida anomenada 'mylimit' amb una mida de 10 MB
    limit_req_zone $binary_remote_addr zone=mylimit:10m rate=1r/s;

    server {
        listen 80;
        server_name example.com;

        location / {
            # Aplicar la limitaci&oacute; de sol&middot;licituds
            limit_req zone=mylimit burst=5 nodelay;
            proxy_pass http://backend;
        }
    }
}</pre></div><div class='content'><h4>Explicació del codi</h4>
<ul>
<li><code>limit_req_zone $binary_remote_addr zone=mylimit:10m rate=1r/s;</code>: Defineix una zona de memòria compartida anomenada <code>mylimit</code> amb una mida de 10 MB. La taxa de sol·licituds es limita a 1 sol·licitud per segon per adreça IP.</li>
<li><code>limit_req zone=mylimit burst=5 nodelay;</code>: Aplica la limitació de sol·licituds a la ubicació <code>/</code>. Permet un màxim de 5 sol·licituds en un curt període de temps (burst) abans d'aplicar la limitació. L'opció <code>nodelay</code> fa que les sol·licituds excedents siguin rebutjades immediatament en lloc de ser posades en cua.</li>
</ul>
</div><h2>Limitació de connexions (<code>ngx_http_limit_conn_module</code>)</h2>
<div class='content'><p>Aquest mòdul limita el nombre de connexions simultànies per adreça IP.</p>
<h4>Exemple de configuració</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICAjIERlZmluaW0gdW5hIHpvbmEgZGUgbWVtw7JyaWEgY29tcGFydGlkYSBhbm9tZW5hZGEgJ2FkZHInIGFtYiB1bmEgbWlkYSBkZSAxMCBNQgogICAgbGltaXRfY29ubl96b25lICRiaW5hcnlfcmVtb3RlX2FkZHIgem9uZT1hZGRyOjEwbTsKCiAgICBzZXJ2ZXIgewogICAgICAgIGxpc3RlbiA4MDsKICAgICAgICBzZXJ2ZXJfbmFtZSBleGFtcGxlLmNvbTsKCiAgICAgICAgbG9jYXRpb24gLyB7CiAgICAgICAgICAgICMgQXBsaWNhciBsYSBsaW1pdGFjacOzIGRlIGNvbm5leGlvbnMKICAgICAgICAgICAgbGltaXRfY29ubiBhZGRyIDEwOwogICAgICAgICAgICBwcm94eV9wYXNzIGh0dHA6Ly9iYWNrZW5kOwogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    # Definim una zona de mem&ograve;ria compartida anomenada 'addr' amb una mida de 10 MB
    limit_conn_zone $binary_remote_addr zone=addr:10m;

    server {
        listen 80;
        server_name example.com;

        location / {
            # Aplicar la limitaci&oacute; de connexions
            limit_conn addr 10;
            proxy_pass http://backend;
        }
    }
}</pre></div><div class='content'><h4>Explicació del codi</h4>
<ul>
<li><code>limit_conn_zone $binary_remote_addr zone=addr:10m;</code>: Defineix una zona de memòria compartida anomenada <code>addr</code> amb una mida de 10 MB.</li>
<li><code>limit_conn addr 10;</code>: Aplica la limitació de connexions a la ubicació <code>/</code>. Permet un màxim de 10 connexions simultànies per adreça IP.</li>
</ul>
</div><h1>Exercicis pràctics</h1>
<div class='content'></div><h2>Exercici 1: Configurar la limitació de sol·licituds</h2>
<div class='content'><ol>
<li>Defineix una zona de memòria compartida anomenada <code>req_limit</code> amb una mida de 5 MB i una taxa de 2 sol·licituds per segon.</li>
<li>Aplica aquesta limitació a la ubicació <code>/api</code> amb un burst de 10 sol·licituds.</li>
</ol>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICBsaW1pdF9yZXFfem9uZSAkYmluYXJ5X3JlbW90ZV9hZGRyIHpvbmU9cmVxX2xpbWl0OjVtIHJhdGU9MnIvczsKCiAgICBzZXJ2ZXIgewogICAgICAgIGxpc3RlbiA4MDsKICAgICAgICBzZXJ2ZXJfbmFtZSBleGFtcGxlLmNvbTsKCiAgICAgICAgbG9jYXRpb24gL2FwaSB7CiAgICAgICAgICAgIGxpbWl0X3JlcSB6b25lPXJlcV9saW1pdCBidXJzdD0xMCBub2RlbGF5OwogICAgICAgICAgICBwcm94eV9wYXNzIGh0dHA6Ly9iYWNrZW5kOwogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    limit_req_zone $binary_remote_addr zone=req_limit:5m rate=2r/s;

    server {
        listen 80;
        server_name example.com;

        location /api {
            limit_req zone=req_limit burst=10 nodelay;
            proxy_pass http://backend;
        }
    }
}</pre></div><div class='content'></div><h2>Exercici 2: Configurar la limitació de connexions</h2>
<div class='content'><ol>
<li>Defineix una zona de memòria compartida anomenada <code>conn_limit</code> amb una mida de 5 MB.</li>
<li>Aplica aquesta limitació a la ubicació <code>/download</code> amb un màxim de 20 connexions simultànies.</li>
</ol>
<h4>Solució</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICBsaW1pdF9jb25uX3pvbmUgJGJpbmFyeV9yZW1vdGVfYWRkciB6b25lPWNvbm5fbGltaXQ6NW07CgogICAgc2VydmVyIHsKICAgICAgICBsaXN0ZW4gODA7CiAgICAgICAgc2VydmVyX25hbWUgZXhhbXBsZS5jb207CgogICAgICAgIGxvY2F0aW9uIC9kb3dubG9hZCB7CiAgICAgICAgICAgIGxpbWl0X2Nvbm4gY29ubl9saW1pdCAyMDsKICAgICAgICAgICAgcHJveHlfcGFzcyBodHRwOi8vYmFja2VuZDsKICAgICAgICB9CiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    limit_conn_zone $binary_remote_addr zone=conn_limit:5m;

    server {
        listen 80;
        server_name example.com;

        location /download {
            limit_conn conn_limit 20;
            proxy_pass http://backend;
        }
    }
}</pre></div><div class='content'></div><h1>Errors comuns i consells</h1>
<div class='content'><ul>
<li><strong>Error: &quot;limiting requests, excess: 0.000 by zone&quot;</strong>: Això indica que la limitació de sol·licituds s'està aplicant correctament. Si veus aquest missatge massa sovint, potser necessites ajustar la taxa o el burst.</li>
<li><strong>Consell</strong>: Utilitza <code>limit_req_log_level</code> i <code>limit_conn_log_level</code> per ajustar el nivell de registre dels esdeveniments de limitació, facilitant la depuració.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>La limitació de velocitat és una eina poderosa per protegir el teu servidor NGINX contra abusos i assegurar una distribució equitativa dels recursos. Amb els mòduls <code>ngx_http_limit_req_module</code> i <code>ngx_http_limit_conn_module</code>, pots configurar fàcilment la limitació de sol·licituds i connexions per adreça IP. Practica amb els exemples i exercicis proporcionats per dominar aquesta tècnica essencial.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-01-basic-security-practices' title="Pràctiques bàsiques de seguretat" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-01-basic-security-practices' title="Pràctiques bàsiques de seguretat" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='04-03-ssl-tls-configuration' title="Configuració SSL/TLS" class="py-2 px-3 btn btn-primary"
				data-read-mod="nginx" data-read-unit="4-2">
				Següent &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='04-03-ssl-tls-configuration' title="Configuració SSL/TLS" class="py-2 px-3 btn btn-primary" 
				data-read-mod="nginx" data-read-unit="4-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curs de NGINX</h1>
<h2>Mòdul 1: Introducció a NGINX</h2>
<ul>
<li><a href="01-01-what-is-nginx">Què és NGINX?</a></li>
<li><a href="01-02-installing-nginx">Instal·lant NGINX</a></li>
<li><a href="01-03-basic-nginx-configuration">Configuració bàsica de NGINX</a></li>
<li><a href="01-04-starting-stopping-nginx">Iniciant i aturant NGINX</a></li>
</ul>
<h2>Mòdul 2: NGINX com a servidor web</h2>
<ul>
<li><a href="02-01-serving-static-content">Servint contingut estàtic</a></li>
<li><a href="02-02-directory-listings">Llistats de directoris</a></li>
<li><a href="02-03-custom-error-pages">Pàgines d'error personalitzades</a></li>
<li><a href="02-04-logging-log-formats">Registre i formats de registre</a></li>
</ul>
<h2>Mòdul 3: NGINX com a proxy invers</h2>
<ul>
<li><a href="03-01-introduction-reverse-proxy">Introducció al proxy invers</a></li>
<li><a href="03-02-configuring-reverse-proxy">Configurant un proxy invers</a></li>
<li><a href="03-03-load-balancing">Balanceig de càrrega</a></li>
<li><a href="03-04-health-checks">Comprovacions de salut</a></li>
</ul>
<h2>Mòdul 4: Seguretat i optimització</h2>
<ul>
<li><a href="04-01-basic-security-practices">Pràctiques bàsiques de seguretat</a></li>
<li><a href="04-02-rate-limiting">Limitació de velocitat</a></li>
<li><a href="04-03-ssl-tls-configuration">Configuració SSL/TLS</a></li>
<li><a href="04-04-caching">Caché</a></li>
</ul>
<h2>Mòdul 5: Funcions avançades de NGINX</h2>
<ul>
<li><a href="05-01-nginx-modules">Mòduls de NGINX</a></li>
<li><a href="05-02-using-nginx-docker">Utilitzant NGINX amb Docker</a></li>
<li><a href="05-03-nginx-http2">NGINX i HTTP/2</a></li>
<li><a href="05-04-nginx-grpc">NGINX i gRPC</a></li>
</ul>
<h2>Mòdul 6: Monitorització i resolució de problemes</h2>
<ul>
<li><a href="06-01-monitoring-nginx">Monitoritzant NGINX</a></li>
<li><a href="06-02-common-issues-solutions">Problemes comuns i solucions</a></li>
<li><a href="06-03-performance-tuning">Optimització del rendiment</a></li>
<li><a href="06-04-debugging-nginx">Depurant NGINX</a></li>
</ul>
<h2>Mòdul 7: NGINX Plus</h2>
<ul>
<li><a href="07-01-introduction-nginx-plus">Introducció a NGINX Plus</a></li>
<li><a href="07-02-advanced-load-balancing">Balanceig de càrrega avançat</a></li>
<li><a href="07-03-application-health-monitoring">Monitorització de la salut de l'aplicació</a></li>
<li><a href="07-04-dynamic-configuration">Configuració dinàmica</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objectiu" rel="nofollow">El Projecte</a> | 
<a href="/sobre-nosaltres" rel="nofollow">Sobre nosaltres</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donacions</a> | 
<a href="/llicencia" rel="nofollow">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuari no autentificat</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
