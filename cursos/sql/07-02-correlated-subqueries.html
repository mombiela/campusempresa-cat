<!DOCTYPE html>
<html lang="ca">
<head>
    <title> Subconsultes correlacionades </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/sql/07-02-correlated-subqueries" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/sql/07-02-correlated-subqueries" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/sql/07-02-correlated-subqueries" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "ca";
  		var CATEGORY = "languages";
  		var MOD_NAME = "sql";
  		var TEMA_NAME = "7-2";
  		var TYPE = "mod";
  		var PATH = "mod/sql/07-02-correlated-subqueries";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo_header.png" alt="Logo Campus Empresa"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/courses/sql/07-02-correlated-subqueries" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/cursos/sql/07-02-correlated-subqueries" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Tot el coneixement al teu abast</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objectiu" rel="nofollow">El Projecte</a> | 
<a href="/sobre-nosaltres" rel="nofollow">Sobre nosaltres</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donacions</a> | 
<a href="/llicencia" rel="nofollow">Llicència</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/els-meus-cursos" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Els meus cursos</b></i>
</a>
<a href="/cursos-finalitzats" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalitzats             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="sql">
		<a  href="#" class="text-secondary d-none" data-read-mod="sql" data-read-unit="7-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar com a llegit
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="sql" data-unread-unit="7-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar com a no llegit
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contingut del curs
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='07-01-introduction-subqueries' title="Introducció a les subconsultes" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='07-01-introduction-subqueries' title="Introducció a les subconsultes" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Subconsultes correlacionades</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-03-exists-not-exists' title="EXISTS i NOT EXISTS" class="py-2 px-3 btn btn-primary"
				data-read-mod="sql" data-read-unit="7-2">
				Següent &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-03-exists-not-exists' title="EXISTS i NOT EXISTS" class="py-2 px-3 btn btn-primary" 
				data-read-mod="sql" data-read-unit="7-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'></div><h2>Introducció</h2>
<div class='content'><p>Les subconsultes correlacionades són un tipus especial de subconsulta on la subconsulta depèn de la consulta principal per a la seva execució. Això significa que la subconsulta s'executa una vegada per cada fila processada per la consulta principal. Aquest tipus de subconsulta pot ser molt potent, però també pot ser més complex i menys eficient que les subconsultes no correlacionades.</p>
</div><h2>Conceptes clau</h2>
<div class='content'><ul>
<li><strong>Subconsulta</strong>: Una consulta dins d'una altra consulta.</li>
<li><strong>Subconsulta correlacionada</strong>: Una subconsulta que fa referència a una o més columnes de la consulta principal.</li>
<li><strong>Consulta principal</strong>: La consulta que conté la subconsulta.</li>
</ul>
</div><h2>Sintaxi bàsica</h2>
<div class='content'><p>La sintaxi d'una subconsulta correlacionada és similar a la d'una subconsulta no correlacionada, però amb la diferència que la subconsulta fa referència a columnes de la consulta principal.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGNvbHVtbmExLCBjb2x1bW5hMgpGUk9NIHRhdWxhMSBBUyBhbGlhczEKV0hFUkUgY29sdW1uYTMgb3BlcmFkb3IgKFNFTEVDVCBjb2x1bW5hNAogICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSB0YXVsYTIgQVMgYWxpYXMyCiAgICAgICAgICAgICAgICAgICAgICAgICBXSEVSRSBhbGlhczEuY29sdW1uYTUgPSBhbGlhczIuY29sdW1uYTYpOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT columna1, columna2
FROM taula1 AS alias1
WHERE columna3 operador (SELECT columna4
                         FROM taula2 AS alias2
                         WHERE alias1.columna5 = alias2.columna6);</pre></div><div class='content'></div><h2>Exemple pràctic</h2>
<div class='content'><p>Suposem que tenim dues taules: <code>empleats</code> i <code>departaments</code>.</p>
</div><h3>Taula <code>empleats</code></h3>
<div class='content'><table>
<thead>
<tr>
<th>id</th>
<th>nom</th>
<th>departament_id</th>
<th>salari</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Anna</td>
<td>1</td>
<td>50000</td>
</tr>
<tr>
<td>2</td>
<td>Bernat</td>
<td>2</td>
<td>60000</td>
</tr>
<tr>
<td>3</td>
<td>Carla</td>
<td>1</td>
<td>55000</td>
</tr>
<tr>
<td>4</td>
<td>David</td>
<td>3</td>
<td>45000</td>
</tr>
<tr>
<td>5</td>
<td>Eva</td>
<td>2</td>
<td>70000</td>
</tr>
</tbody>
</table>
</div><h3>Taula <code>departaments</code></h3>
<div class='content'><table>
<thead>
<tr>
<th>id</th>
<th>nom</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Recursos Humans</td>
</tr>
<tr>
<td>2</td>
<td>IT</td>
</tr>
<tr>
<td>3</td>
<td>Finances</td>
</tr>
</tbody>
</table>
</div><h3>Objectiu</h3>
<div class='content'><p>Volem trobar els empleats que tenen un salari superior a la mitjana del seu departament.</p>
</div><h3>Consulta SQL</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGUubm9tLCBlLnNhbGFyaQpGUk9NIGVtcGxlYXRzIGUKV0hFUkUgZS5zYWxhcmkgPiAoU0VMRUNUIEFWRyhlMi5zYWxhcmkpCiAgICAgICAgICAgICAgICAgIEZST00gZW1wbGVhdHMgZTIKICAgICAgICAgICAgICAgICAgV0hFUkUgZTIuZGVwYXJ0YW1lbnRfaWQgPSBlLmRlcGFydGFtZW50X2lkKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT e.nom, e.salari
FROM empleats e
WHERE e.salari &gt; (SELECT AVG(e2.salari)
                  FROM empleats e2
                  WHERE e2.departament_id = e.departament_id);</pre></div><div class='content'></div><h3>Explicació</h3>
<div class='content'><ol>
<li><strong>Consulta principal</strong>: Selecciona el nom i el salari dels empleats.</li>
<li><strong>Subconsulta correlacionada</strong>: Calcula el salari mitjà dels empleats dins del mateix departament que l'empleat actual de la consulta principal.</li>
<li><strong>Condició</strong>: La consulta principal només retorna els empleats el salari dels quals és superior a la mitjana del seu departament.</li>
</ol>
</div><h2>Exercici pràctic</h2>
<div class='content'></div><h3>Enunciat</h3>
<div class='content'><p>Utilitzant les taules <code>empleats</code> i <code>departaments</code>, escriu una consulta per trobar els departaments on almenys un empleat té un salari superior a 60000.</p>
</div><h3>Solució</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGQubm9tCkZST00gZGVwYXJ0YW1lbnRzIGQKV0hFUkUgRVhJU1RTIChTRUxFQ1QgMQogICAgICAgICAgICAgIEZST00gZW1wbGVhdHMgZQogICAgICAgICAgICAgIFdIRVJFIGUuZGVwYXJ0YW1lbnRfaWQgPSBkLmlkCiAgICAgICAgICAgICAgQU5EIGUuc2FsYXJpID4gNjAwMDApOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT d.nom
FROM departaments d
WHERE EXISTS (SELECT 1
              FROM empleats e
              WHERE e.departament_id = d.id
              AND e.salari &gt; 60000);</pre></div><div class='content'></div><h3>Explicació</h3>
<div class='content'><ol>
<li><strong>Consulta principal</strong>: Selecciona el nom dels departaments.</li>
<li><strong>Subconsulta correlacionada</strong>: Verifica si existeix almenys un empleat en el departament actual de la consulta principal amb un salari superior a 60000.</li>
<li><strong>Condició</strong>: La consulta principal només retorna els departaments que compleixen la condició de la subconsulta.</li>
</ol>
</div><h2>Errors comuns</h2>
<div class='content'><ul>
<li><strong>No correlacionar correctament</strong>: Assegura't que la subconsulta fa referència a la consulta principal de manera adequada.</li>
<li><strong>Ineficàcia</strong>: Les subconsultes correlacionades poden ser lentes. Considera alternatives com les unions (JOIN) si el rendiment és un problema.</li>
<li><strong>Confusió amb subconsultes no correlacionades</strong>: Recorda que les subconsultes correlacionades depenen de la consulta principal, mentre que les no correlacionades no.</li>
</ul>
</div><h2>Consells addicionals</h2>
<div class='content'><ul>
<li><strong>Optimització</strong>: Utilitza índexs adequats per millorar el rendiment de les subconsultes correlacionades.</li>
<li><strong>Claredat</strong>: Mantén les subconsultes simples i clares per facilitar la comprensió i el manteniment del codi.</li>
</ul>
</div><h2>Conclusió</h2>
<div class='content'><p>Les subconsultes correlacionades són una eina poderosa en SQL que permeten realitzar consultes complexes que depenen de la consulta principal. Tot i que poden ser menys eficients que altres mètodes, la seva flexibilitat les fa molt útils en moltes situacions. Practicar amb exemples reals i comprendre els seus mecanismes interns és clau per dominar aquesta tècnica.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='07-01-introduction-subqueries' title="Introducció a les subconsultes" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='07-01-introduction-subqueries' title="Introducció a les subconsultes" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-03-exists-not-exists' title="EXISTS i NOT EXISTS" class="py-2 px-3 btn btn-primary"
				data-read-mod="sql" data-read-unit="7-2">
				Següent &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-03-exists-not-exists' title="EXISTS i NOT EXISTS" class="py-2 px-3 btn btn-primary" 
				data-read-mod="sql" data-read-unit="7-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curs de SQL</h1>
<h2>Mòdul 1: Introducció a SQL</h2>
<ul>
<li><a href="01-01-what-is-sql">Què és SQL?</a></li>
<li><a href="01-02-setting-up-environment">Configurar el teu entorn SQL</a></li>
<li><a href="01-03-basic-sql-syntax">Sintaxi bàsica de SQL</a></li>
<li><a href="01-04-understanding-databases-tables">Comprendre bases de dades i taules</a></li>
</ul>
<h2>Mòdul 2: Consultes bàsiques de SQL</h2>
<ul>
<li><a href="02-01-select-statement">Instrucció SELECT</a></li>
<li><a href="02-02-filtering-data-where">Filtrar dades amb WHERE</a></li>
<li><a href="02-03-sorting-data-order-by">Ordenar dades amb ORDER BY</a></li>
<li><a href="02-04-limiting-results-limit">Limitar resultats amb LIMIT</a></li>
</ul>
<h2>Mòdul 3: Treballar amb múltiples taules</h2>
<ul>
<li><a href="03-01-join-operations">Operacions JOIN</a></li>
<li><a href="03-02-inner-join">INNER JOIN</a></li>
<li><a href="03-03-left-join">LEFT JOIN</a></li>
<li><a href="03-04-right-join">RIGHT JOIN</a></li>
<li><a href="03-05-full-outer-join">FULL OUTER JOIN</a></li>
</ul>
<h2>Mòdul 4: Filtratge avançat de dades</h2>
<ul>
<li><a href="04-01-using-like-pattern-matching">Utilitzar LIKE per a coincidències de patrons</a></li>
<li><a href="04-02-in-between-operators">Operadors IN i BETWEEN</a></li>
<li><a href="04-03-null-values-is-null">Valors NULL i IS NULL</a></li>
<li><a href="04-04-aggregating-data-group-by">Agrupar dades amb GROUP BY</a></li>
<li><a href="04-05-having-clause">Clàusula HAVING</a></li>
</ul>
<h2>Mòdul 5: Manipulació de dades</h2>
<ul>
<li><a href="05-01-insert-statement">Instrucció INSERT</a></li>
<li><a href="05-02-update-statement">Instrucció UPDATE</a></li>
<li><a href="05-03-delete-statement">Instrucció DELETE</a></li>
<li><a href="05-04-upsert-merge-statement">Instrucció UPSERT (MERGE)</a></li>
</ul>
<h2>Mòdul 6: Funcions avançades de SQL</h2>
<ul>
<li><a href="06-01-string-functions">Funcions de cadena</a></li>
<li><a href="06-02-numeric-functions">Funcions numèriques</a></li>
<li><a href="06-03-date-time-functions">Funcions de data i hora</a></li>
<li><a href="06-04-conditional-expressions">Expressions condicionals</a></li>
</ul>
<h2>Mòdul 7: Subconsultes i consultes niades</h2>
<ul>
<li><a href="07-01-introduction-subqueries">Introducció a les subconsultes</a></li>
<li><a href="07-02-correlated-subqueries">Subconsultes correlacionades</a></li>
<li><a href="07-03-exists-not-exists">EXISTS i NOT EXISTS</a></li>
<li><a href="07-04-using-subqueries-select-from-where">Utilitzar subconsultes en les clàusules SELECT, FROM i WHERE</a></li>
</ul>
<h2>Mòdul 8: Índexs i optimització del rendiment</h2>
<ul>
<li><a href="08-01-understanding-indexes">Comprendre els índexs</a></li>
<li><a href="08-02-creating-managing-indexes">Crear i gestionar índexs</a></li>
<li><a href="08-03-query-optimization-techniques">Tècniques d'optimització de consultes</a></li>
<li><a href="08-04-analyzing-query-performance">Analitzar el rendiment de les consultes</a></li>
</ul>
<h2>Mòdul 9: Transaccions i concurrència</h2>
<ul>
<li><a href="09-01-introduction-transactions">Introducció a les transaccions</a></li>
<li><a href="09-02-acid-properties">Propietats ACID</a></li>
<li><a href="09-03-transaction-control-statements">Instruccions de control de transaccions</a></li>
<li><a href="09-04-handling-concurrency">Gestionar la concurrència</a></li>
</ul>
<h2>Mòdul 10: Temes avançats</h2>
<ul>
<li><a href="10-01-stored-procedures">Procediments emmagatzemats</a></li>
<li><a href="10-02-triggers">Triggers</a></li>
<li><a href="10-03-views">Vistes</a></li>
<li><a href="10-04-common-table-expressions">Expressions de taula comunes (CTEs)</a></li>
<li><a href="10-05-window-functions">Funcions de finestra</a></li>
</ul>
<h2>Mòdul 11: SQL en la pràctica</h2>
<ul>
<li><a href="11-01-real-world-use-cases">Casos d'ús del món real</a></li>
<li><a href="11-02-best-practices">Millors pràctiques</a></li>
<li><a href="11-03-sql-data-analysis">SQL per a l'anàlisi de dades</a></li>
<li><a href="11-04-sql-web-development">SQL en el desenvolupament web</a></li>
</ul>
<h2>Mòdul 12: Projecte final</h2>
<ul>
<li><a href="12-01-project-overview">Visió general del projecte</a></li>
<li><a href="12-02-project-requirements">Requisits del projecte</a></li>
<li><a href="12-03-project-implementation">Implementació del projecte</a></li>
<li><a href="12-04-project-presentation">Presentació del projecte</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objectiu" rel="nofollow">El Projecte</a> | 
<a href="/sobre-nosaltres" rel="nofollow">Sobre nosaltres</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donacions</a> | 
<a href="/llicencia" rel="nofollow">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuari no autentificat</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
