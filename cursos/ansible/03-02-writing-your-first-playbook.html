<!DOCTYPE html>
<html lang="ca">
<head>
    <title> Escrivint el teu primer Playbook </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, nofollow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/ansible/03-02-writing-your-first-playbook" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/ansible/03-02-writing-your-first-playbook" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/ansible/03-02-writing-your-first-playbook" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.188a386f47.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "ca";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "ansible";
  		var TEMA_NAME = "3-2";
  		var TYPE = "mod";
  		var PATH = "mod/ansible/03-02-writing-your-first-playbook";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo_header.png" alt="Logo Campus Empresa"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/courses/ansible/03-02-writing-your-first-playbook" class="px-2">EN</a></b>
	|
	<a href="https://campusempresa.com/cursos/ansible/03-02-writing-your-first-playbook" class="px-2">ES</a></b>
	|
	<b class="px-2">CA</b>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Tot el coneixement al teu abast</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objectiu" rel="nofollow">El Projecte</a> | 
<a href="/sobre-nosaltres" rel="nofollow">Sobre nosaltres</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donacions</a> | 
<a href="/llicencia" rel="nofollow">Llicència</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/els-meus-cursos" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Els meus cursos</b></i>
</a>
<a href="/cursos-finalitzats" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalitzats             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="ansible">
		<a  href="#" class="text-secondary d-none" data-read-mod="ansible" data-read-unit="3-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar com a llegit
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="ansible" data-unread-unit="3-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar com a no llegit
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contingut del curs
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-01-introduction-to-playbooks' title="Introducció als Playbooks" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-01-introduction-to-playbooks' title="Introducció als Playbooks" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Escrivint el teu primer Playbook</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-03-playbook-structure' title="Estructura del Playbook" class="py-2 px-3 btn btn-primary"
				data-read-mod="ansible" data-read-unit="3-2">
				Següent &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-03-playbook-structure' title="Estructura del Playbook" class="py-2 px-3 btn btn-primary" 
				data-read-mod="ansible" data-read-unit="3-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>En aquest tema, aprendrem a escriure el nostre primer Playbook d'Ansible. Un Playbook és un fitxer YAML que conté una sèrie de tasques que Ansible ha d'executar en els nodes gestionats. Els Playbooks són el cor d'Ansible i permeten automatitzar tasques complexes de manera senzilla i repetible.</p>
</div><h2>Objectius</h2>
<div class='content'><ul>
<li>Entendre l'estructura bàsica d'un Playbook.</li>
<li>Escriure un Playbook senzill per instal·lar i configurar un servei.</li>
<li>Executar el Playbook i verificar els resultats.</li>
</ul>
</div><h2>Estructura bàsica d'un Playbook</h2>
<div class='content'><p>Un Playbook d'Ansible està escrit en format YAML i segueix una estructura específica. A continuació es mostra un exemple bàsic de Playbook:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogSW5zdGFswrdsYXIgaSBjb25maWd1cmFyIEFwYWNoZQogIGhvc3RzOiB3ZWJzZXJ2ZXJzCiAgYmVjb21lOiB5ZXMKICB0YXNrczoKICAgIC0gbmFtZTogSW5zdGFswrdsYXIgZWwgcGFxdWV0IEFwYWNoZQogICAgICBhcHQ6CiAgICAgICAgbmFtZTogYXBhY2hlMgogICAgICAgIHN0YXRlOiBwcmVzZW50CgogICAgLSBuYW1lOiBJbmljaWFyIGVsIHNlcnZlaSBBcGFjaGUKICAgICAgc2VydmljZToKICAgICAgICBuYW1lOiBhcGFjaGUyCiAgICAgICAgc3RhdGU6IHN0YXJ0ZWQKICAgICAgICBlbmFibGVkOiB5ZXM="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Instal&middot;lar i configurar Apache
  hosts: webservers
  become: yes
  tasks:
    - name: Instal&middot;lar el paquet Apache
      apt:
        name: apache2
        state: present

    - name: Iniciar el servei Apache
      service:
        name: apache2
        state: started
        enabled: yes</pre></div><div class='content'></div><h3>Explicació del Playbook</h3>
<div class='content'><ol>
<li><code>---</code>: Indica l'inici d'un document YAML.</li>
<li><code>- name: Instal·lar i configurar Apache</code>: Defineix el nom del play. Un play és una sèrie de tasques que s'executen en un grup de hosts.</li>
<li><code>hosts: webservers</code>: Especifica el grup de hosts en els quals s'executarà el play. Aquest grup ha d'estar definit en el fitxer d'inventari.</li>
<li><code>become: yes</code>: Indica que les tasques s'executaran amb privilegis d'administrador (sudo).</li>
<li><code>tasks</code>: Defineix la llista de tasques que s'executaran en els hosts especificats.</li>
<li><code>- name: Instal·lar el paquet Apache</code>: Defineix el nom de la tasca.</li>
<li><code>apt</code>: Utilitza el mòdul <code>apt</code> per gestionar paquets en sistemes basats en Debian.</li>
<li><code>name: apache2</code>: Especifica el nom del paquet a instal·lar.</li>
<li><code>state: present</code>: Indica que el paquet ha d'estar instal·lat.</li>
<li><code>- name: Iniciar el servei Apache</code>: Defineix una altra tasca per iniciar el servei Apache.</li>
<li><code>service</code>: Utilitza el mòdul <code>service</code> per gestionar serveis.</li>
<li><code>name: apache2</code>: Especifica el nom del servei.</li>
<li><code>state: started</code>: Indica que el servei ha d'estar en execució.</li>
<li><code>enabled: yes</code>: Indica que el servei ha d'estar habilitat per iniciar-se automàticament en arrencar el sistema.</li>
</ol>
</div><h2>Executant el Playbook</h2>
<div class='content'><p>Per executar el Playbook, utilitzarem la comanda <code>ansible-playbook</code>. Assegura't que tens un fitxer d'inventari que defineixi el grup de hosts <code>webservers</code>.</p>
</div><h3>Exemple de fitxer d'inventari (<code>hosts</code>):</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("W3dlYnNlcnZlcnNdCjE5Mi4xNjguMS4xMAoxOTIuMTY4LjEuMTE="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>[webservers]
192.168.1.10
192.168.1.11</pre></div><div class='content'></div><h3>Comanda per executar el Playbook:</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS1wbGF5Ym9vayAtaSBob3N0cyBwbGF5Ym9vay55bWw="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-playbook -i hosts playbook.yml</pre></div><div class='content'><p>On <code>hosts</code> és el fitxer d'inventari i <code>playbook.yml</code> és el fitxer del Playbook.</p>
</div><h2>Exercici Pràctic</h2>
<div class='content'></div><h3>Objectiu</h3>
<div class='content'><p>Escriure un Playbook que instal·li Nginx en un grup de hosts anomenat <code>webservers</code> i asseguri que el servei estigui en execució.</p>
</div><h3>Passos</h3>
<div class='content'><ol>
<li>Crea un fitxer anomenat <code>nginx-playbook.yml</code>.</li>
<li>Escriu el següent contingut en el fitxer:</li>
</ol>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogSW5zdGFswrdsYXIgaSBjb25maWd1cmFyIE5naW54CiAgaG9zdHM6IHdlYnNlcnZlcnMKICBiZWNvbWU6IHllcwogIHRhc2tzOgogICAgLSBuYW1lOiBJbnN0YWzCt2xhciBlbCBwYXF1ZXQgTmdpbngKICAgICAgYXB0OgogICAgICAgIG5hbWU6IG5naW54CiAgICAgICAgc3RhdGU6IHByZXNlbnQKCiAgICAtIG5hbWU6IEluaWNpYXIgZWwgc2VydmVpIE5naW54CiAgICAgIHNlcnZpY2U6CiAgICAgICAgbmFtZTogbmdpbngKICAgICAgICBzdGF0ZTogc3RhcnRlZAogICAgICAgIGVuYWJsZWQ6IHllcw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Instal&middot;lar i configurar Nginx
  hosts: webservers
  become: yes
  tasks:
    - name: Instal&middot;lar el paquet Nginx
      apt:
        name: nginx
        state: present

    - name: Iniciar el servei Nginx
      service:
        name: nginx
        state: started
        enabled: yes</pre></div><div class='content'><ol start="3">
<li>Crea un fitxer d'inventari anomenat <code>hosts</code> amb el següent contingut:</li>
</ol>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("W3dlYnNlcnZlcnNdCjE5Mi4xNjguMS4xMAoxOTIuMTY4LjEuMTE="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>[webservers]
192.168.1.10
192.168.1.11</pre></div><div class='content'><ol start="4">
<li>Executa el Playbook amb la comanda:</li>
</ol>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS1wbGF5Ym9vayAtaSBob3N0cyBuZ2lueC1wbGF5Ym9vay55bWw="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-playbook -i hosts nginx-playbook.yml</pre></div><div class='content'></div><h3>Solució</h3>
<div class='content'><p>El Playbook <code>nginx-playbook.yml</code> hauria de tenir aquest aspecte:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogSW5zdGFswrdsYXIgaSBjb25maWd1cmFyIE5naW54CiAgaG9zdHM6IHdlYnNlcnZlcnMKICBiZWNvbWU6IHllcwogIHRhc2tzOgogICAgLSBuYW1lOiBJbnN0YWzCt2xhciBlbCBwYXF1ZXQgTmdpbngKICAgICAgYXB0OgogICAgICAgIG5hbWU6IG5naW54CiAgICAgICAgc3RhdGU6IHByZXNlbnQKCiAgICAtIG5hbWU6IEluaWNpYXIgZWwgc2VydmVpIE5naW54CiAgICAgIHNlcnZpY2U6CiAgICAgICAgbmFtZTogbmdpbngKICAgICAgICBzdGF0ZTogc3RhcnRlZAogICAgICAgIGVuYWJsZWQ6IHllcw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Instal&middot;lar i configurar Nginx
  hosts: webservers
  become: yes
  tasks:
    - name: Instal&middot;lar el paquet Nginx
      apt:
        name: nginx
        state: present

    - name: Iniciar el servei Nginx
      service:
        name: nginx
        state: started
        enabled: yes</pre></div><div class='content'></div><h2>Resum</h2>
<div class='content'><p>En aquest tema, hem après a escriure un Playbook bàsic d'Ansible per instal·lar i configurar un servei. Hem vist l'estructura d'un Playbook, com definir tasques i com executar el Playbook en un grup de hosts. Aquest és el primer pas per automatitzar tasques amb Ansible, i en els següents temes, explorarem funcionalitats més avançades per fer els nostres Playbooks més potents i flexibles.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-01-introduction-to-playbooks' title="Introducció als Playbooks" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-01-introduction-to-playbooks' title="Introducció als Playbooks" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-03-playbook-structure' title="Estructura del Playbook" class="py-2 px-3 btn btn-primary"
				data-read-mod="ansible" data-read-unit="3-2">
				Següent &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-03-playbook-structure' title="Estructura del Playbook" class="py-2 px-3 btn btn-primary" 
				data-read-mod="ansible" data-read-unit="3-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Ansible: De Principiant a Avançat</h1>
<h2>Mòdul 1: Introducció a Ansible</h2>
<ul>
<li><a href="01-01-what-is-ansible">Què és Ansible?</a></li>
<li><a href="01-02-installing-ansible">Instal·lant Ansible</a></li>
<li><a href="01-03-ansible-architecture">Arquitectura d'Ansible</a></li>
<li><a href="01-04-basic-ansible-commands">Comandes bàsiques d'Ansible</a></li>
</ul>
<h2>Mòdul 2: Conceptes bàsics d'Ansible</h2>
<ul>
<li><a href="02-01-inventory-files">Fitxers d'inventari</a></li>
<li><a href="02-02-ansible-configuration">Configuració d'Ansible</a></li>
<li><a href="02-03-ad-hoc-commands">Comandes ad-hoc</a></li>
<li><a href="02-04-ansible-modules">Mòduls d'Ansible</a></li>
</ul>
<h2>Mòdul 3: Playbooks</h2>
<ul>
<li><a href="03-01-introduction-to-playbooks">Introducció als Playbooks</a></li>
<li><a href="03-02-writing-your-first-playbook">Escrivint el teu primer Playbook</a></li>
<li><a href="03-03-playbook-structure">Estructura del Playbook</a></li>
<li><a href="03-04-variables-and-facts">Variables i Fets</a></li>
<li><a href="03-05-conditionals-and-loops">Condicionals i Bucles</a></li>
</ul>
<h2>Mòdul 4: Rols</h2>
<ul>
<li><a href="04-01-introduction-to-roles">Introducció als Rols</a></li>
<li><a href="04-02-creating-roles">Creant Rols</a></li>
<li><a href="04-03-role-directory-structure">Estructura del Directori de Rols</a></li>
<li><a href="04-04-using-roles-in-playbooks">Utilitzant Rols en Playbooks</a></li>
</ul>
<h2>Mòdul 5: Tècniques Avançades de Playbook</h2>
<ul>
<li><a href="05-01-handlers">Handlers</a></li>
<li><a href="05-02-templates">Plantilles</a></li>
<li><a href="05-03-ansible-vault">Ansible Vault</a></li>
<li><a href="05-04-error-handling">Gestió d'Errors</a></li>
<li><a href="05-05-optimizing-playbooks">Optimitzant Playbooks</a></li>
</ul>
<h2>Mòdul 6: Ansible Galaxy</h2>
<ul>
<li><a href="06-01-what-is-ansible-galaxy">Què és Ansible Galaxy?</a></li>
<li><a href="06-02-using-ansible-galaxy">Utilitzant Ansible Galaxy</a></li>
<li><a href="06-03-creating-and-sharing-roles">Creant i Compartint Rols</a></li>
</ul>
<h2>Mòdul 7: Ansible Tower</h2>
<ul>
<li><a href="07-01-introduction-to-ansible-tower">Introducció a Ansible Tower</a></li>
<li><a href="07-02-installing-ansible-tower">Instal·lant Ansible Tower</a></li>
<li><a href="07-03-using-ansible-tower">Utilitzant Ansible Tower</a></li>
<li><a href="07-04-managing-projects-and-inventories">Gestionant Projectes i Inventaris</a></li>
</ul>
<h2>Mòdul 8: Ansible per a DevOps</h2>
<ul>
<li><a href="08-01-ansible-and-docker">Ansible i Docker</a></li>
<li><a href="08-02-ansible-and-kubernetes">Ansible i Kubernetes</a></li>
<li><a href="08-03-ci-cd-with-ansible">CI/CD amb Ansible</a></li>
<li><a href="08-04-ansible-in-cloud-environments">Ansible en Entorns Cloud</a></li>
</ul>
<h2>Mòdul 9: Millors Pràctiques d'Ansible</h2>
<ul>
<li><a href="09-01-code-organization">Organització del Codi</a></li>
<li><a href="09-02-security-best-practices">Millors Pràctiques de Seguretat</a></li>
<li><a href="09-03-performance-tuning">Ajust de Rendiment</a></li>
<li><a href="09-04-testing-ansible-code">Provar el Codi d'Ansible</a></li>
</ul>
<h2>Mòdul 10: Temes Avançats d'Ansible</h2>
<ul>
<li><a href="10-01-custom-modules">Mòduls Personalitzats</a></li>
<li><a href="10-02-dynamic-inventory">Inventari Dinàmic</a></li>
<li><a href="10-03-ansible-plugins">Plugins d'Ansible</a></li>
<li><a href="10-04-ansible-api">API d'Ansible</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objectiu" rel="nofollow">El Projecte</a> | 
<a href="/sobre-nosaltres" rel="nofollow">Sobre nosaltres</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donacions</a> | 
<a href="/llicencia" rel="nofollow">Llicència</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir cookies per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Acceptar</a>
    <a href="/cookies">Més informació</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuari no autentificat</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
